<Type Name="ApplicationDeployment" FullName="System.Deployment.Application.ApplicationDeployment">
  <Metadata><Meta Name="ms.openlocfilehash" Value="01b063a5c9411662370ac4081a828f0297f393cc" /><Meta Name="ms.sourcegitcommit" Value="11d168140aa8fade0768c2a9dde3e3bcacfdfb7d" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="05/27/2020" /><Meta Name="ms.locfileid" Value="83959623" /></Metadata><TypeSignature Language="C#" Value="public sealed class ApplicationDeployment" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit ApplicationDeployment extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Deployment.Application.ApplicationDeployment" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class ApplicationDeployment" />
  <TypeSignature Language="C++ CLI" Value="public ref class ApplicationDeployment sealed" />
  <TypeSignature Language="F#" Value="type ApplicationDeployment = class" />
  <AssemblyInfo>
    <AssemblyName>System.Deployment</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="7ea01-101">支持以编程方式更新当前部署，以及处理文件的按需下载。</span><span class="sxs-lookup"><span data-stu-id="7ea01-101">Supports updates of the current deployment programmatically, and handles on-demand downloading of files.</span></span> <span data-ttu-id="7ea01-102">无法继承此类。</span><span class="sxs-lookup"><span data-stu-id="7ea01-102">This class cannot be inherited.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-103">可以将 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序配置为检查更新，并通过部署清单的 `subscription` 元素自动安装更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-103">You can configure your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application to check for updates and install them automatically through the `subscription` element of the deployment manifest.</span></span> <span data-ttu-id="7ea01-104">但是，某些应用程序需要更好地控制其更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-104">Some applications, however, need finer control over their updates.</span></span> <span data-ttu-id="7ea01-105">你可能想要以编程方式安装所需的更新，并在方便时提示用户安装可选更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-105">You may want to install required updates programmatically, and prompt users to install optional updates at their convenience.</span></span> <span data-ttu-id="7ea01-106">通过关闭部署清单中的订阅更新，可以完全控制应用程序的更新策略。</span><span class="sxs-lookup"><span data-stu-id="7ea01-106">By turning off subscription updates in the deployment manifest, you can take complete control of your application's update policies.</span></span> <span data-ttu-id="7ea01-107">或者，你可以将自动订阅与 <xref:System.Deployment.Application.ApplicationDeployment>一起使用，这使 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 可以定期更新应用程序，但使用 <xref:System.Deployment.Application.ApplicationDeployment> 在发布重要更新后立即下载。</span><span class="sxs-lookup"><span data-stu-id="7ea01-107">Alternatively, you can use automatic subscription in conjunction with <xref:System.Deployment.Application.ApplicationDeployment>, which enables [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] to update the application periodically, but uses <xref:System.Deployment.Application.ApplicationDeployment> to download critical updates shortly after they are released.</span></span>

 <span data-ttu-id="7ea01-108">您可以使用 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> 或 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> 方法测试您的部署是否具有可用的更新;后一种方法会在成功完成后引发 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-108">You can test whether your deployment has an available update by using either the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> or the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> method; the latter method raises the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> event on successful completion.</span></span> <span data-ttu-id="7ea01-109"><xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A> 返回有关更新的重要信息，例如更新的版本号以及当前用户是否需要更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-109"><xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A> returns important information about the update, such as its version number and whether it is a required update for current users.</span></span> <span data-ttu-id="7ea01-110">如果有可用的更新，则可以使用 <xref:System.Deployment.Application.ApplicationDeployment.Update%2A> 或 <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>来安装它;后一种方法在更新安装完成后引发 <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-110">If an update is available, you can install it by using <xref:System.Deployment.Application.ApplicationDeployment.Update%2A> or <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>; the latter method raises the <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted> event after installation of the update is complete.</span></span> <span data-ttu-id="7ea01-111">对于较大的更新，可以通过 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged> 和 <xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged> 事件接收进度通知，并使用 <xref:System.ComponentModel.ProgressChangedEventArgs> 中的信息通知用户下载状态。</span><span class="sxs-lookup"><span data-stu-id="7ea01-111">For large updates, you can receive progress notifications through the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged> and <xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged> events, and use the information in <xref:System.ComponentModel.ProgressChangedEventArgs> to notify the user of the download status.</span></span>

 <span data-ttu-id="7ea01-112">你还可以使用 <xref:System.Deployment.Application.ApplicationDeployment> 按需下载大型文件和程序集。</span><span class="sxs-lookup"><span data-stu-id="7ea01-112">You can also use <xref:System.Deployment.Application.ApplicationDeployment> to download large files and assemblies on demand.</span></span> <span data-ttu-id="7ea01-113">必须在部署的应用程序清单中将这些文件标记为 "可选"，以便在安装过程中不会下载这些文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-113">These files must be marked as "optional" within the deployment's application manifest so that they are not downloaded during installation.</span></span> <span data-ttu-id="7ea01-114">可以通过使用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 或 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> 方法在应用程序持续时间内随时下载文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-114">You can download the files at any point during the application's duration by using the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> or the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method.</span></span> <span data-ttu-id="7ea01-115">您可以在将程序集加载到内存中之前，通过为 <xref:System.AppDomain> 类的 <xref:System.AppDomain.AssemblyResolve> 事件提供事件处理程序来下载程序集。</span><span class="sxs-lookup"><span data-stu-id="7ea01-115">You can download assemblies before they are loaded into memory by supplying an event handler for the <xref:System.AppDomain.AssemblyResolve> event on the <xref:System.AppDomain> class.</span></span> <span data-ttu-id="7ea01-116">有关详细信息，请参阅[演练：在设计器中使用 ClickOnce 部署 API 按需下载程序集](/visualstudio/deployment/walkthrough-downloading-assemblies-on-demand-with-the-clickonce-deployment-api-using-the-designer)。</span><span class="sxs-lookup"><span data-stu-id="7ea01-116">For more information, see [Walkthrough: Downloading Assemblies on Demand with the ClickOnce Deployment API Using the Designer](/visualstudio/deployment/walkthrough-downloading-assemblies-on-demand-with-the-clickonce-deployment-api-using-the-designer).</span></span>

> [!NOTE]
>  <span data-ttu-id="7ea01-117">如果在应用程序运行时更新 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序，则在调用 <xref:System.Windows.Forms.Application>的 <xref:System.Windows.Forms.Application.Restart%2A> 方法之前，用户将看不到更新，这会关闭当前正在运行的应用程序实例，并立即重新启动该应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-117">If you update a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application while the application is running, the user will not see the updates until you call the <xref:System.Windows.Forms.Application.Restart%2A> method of the <xref:System.Windows.Forms.Application>, which will close the current running instance of the application and immediately restart it.</span></span>

 <span data-ttu-id="7ea01-118"><xref:System.Deployment.Application.ApplicationDeployment> 没有公共构造函数;您可以通过 <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> 属性在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中获取类的实例。</span><span class="sxs-lookup"><span data-stu-id="7ea01-118"><xref:System.Deployment.Application.ApplicationDeployment> has no public constructor; you obtain instances of the class within a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application through the <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> property.</span></span> <span data-ttu-id="7ea01-119">使用 <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> 属性验证当前应用程序是否为 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-119">You use the <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> property to verify that the current application is a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application.</span></span>

 <span data-ttu-id="7ea01-120"><xref:System.Deployment.Application.ApplicationDeployment> 支持通过使用新的[基于事件的异步模式概述](/dotnet/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview)（公开完成回调作为类事件），以异步方式检查更新和下载更新文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-120"><xref:System.Deployment.Application.ApplicationDeployment> supports checking for updates and downloading updated files asynchronously by using the new [Event-based Asynchronous Pattern Overview](/dotnet/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview), which exposes completion callbacks as class events.</span></span> <span data-ttu-id="7ea01-121"><xref:System.Deployment.Application.ApplicationDeployment> 为你启动和管理线程，并将你的应用程序重新调用正确的 UI 线程。</span><span class="sxs-lookup"><span data-stu-id="7ea01-121"><xref:System.Deployment.Application.ApplicationDeployment> starts and manages the threads for you, and calls your application back on the correct UI thread.</span></span> <span data-ttu-id="7ea01-122">通过此类，可以在不锁定应用程序的情况下进行更新，以便用户可以在更新安装过程中继续工作。</span><span class="sxs-lookup"><span data-stu-id="7ea01-122">Through this class, you can update without locking up the application, so that the user can continue working while the update installs.</span></span> <span data-ttu-id="7ea01-123">如果用户必须在发生更新时停止所有工作，请考虑改用同步方法。</span><span class="sxs-lookup"><span data-stu-id="7ea01-123">If the user must stop all work while an update takes place, consider using the synchronous methods instead.</span></span>

> [!NOTE]
>  <span data-ttu-id="7ea01-124">执行异步更新要求你的应用程序同时导入 <xref:System.Deployment.Application> 和 <xref:System.ComponentModel> 命名空间。</span><span class="sxs-lookup"><span data-stu-id="7ea01-124">Performing asynchronous updates requires that your application import both the <xref:System.Deployment.Application> and <xref:System.ComponentModel> namespaces.</span></span>



## Examples
 <span data-ttu-id="7ea01-125">下面的代码示例在应用程序加载时确定是否有新的更新可用;如果有必需的更新，则代码示例会以异步方式安装更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-125">The following code example determines at application load time whether a new update is available; if a required update is available, the code example installs the update asynchronously.</span></span> <span data-ttu-id="7ea01-126">应将此代码添加到包含名为 `downloadStatus`的 <xref:System.Windows.Forms.TextBox> 的窗体中。</span><span class="sxs-lookup"><span data-stu-id="7ea01-126">This code should be added to a form that contains a <xref:System.Windows.Forms.TextBox> named `downloadStatus`.</span></span>

 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]

 ]]></format>
    </remarks>
    <related type="Article" href="/visualstudio/deployment/walkthrough-downloading-assemblies-on-demand-with-the-clickonce-deployment-api-using-the-designer"><span data-ttu-id="7ea01-127">演练：在设计器中使用 ClickOnce 部署 API 按需下载程序集</span><span class="sxs-lookup"><span data-stu-id="7ea01-127">Walkthrough: Downloading Assemblies On Demand with the ClickOnce Deployment API Using the Designer</span></span></related>
  </Docs>
  <Members>
    <Member MemberName="ActivationUri">
      <MemberSignature Language="C#" Value="public Uri ActivationUri { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Uri ActivationUri" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.ActivationUri" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ActivationUri As Uri" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Uri ^ ActivationUri { Uri ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.ActivationUri : Uri" Usage="System.Deployment.Application.ApplicationDeployment.ActivationUri" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Uri</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-128">获取用于启动应用程序的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="7ea01-128">Gets the URL used to launch the deployment manifest of the application.</span></span></summary>
        <value><span data-ttu-id="7ea01-129">如果 <see langword="false" />部署清单中的<c>TrustUrlParameters</c>属性，则为零长度字符串; 或者，如果用户已提供 UNC 来打开部署或在本地打开它，则为零长度字符串。</span><span class="sxs-lookup"><span data-stu-id="7ea01-129">A zero-length string if the <c>TrustUrlParameters</c> property in the deployment manifest is <see langword="false" />, or if the user has supplied a UNC to open the deployment or has opened it locally.</span></span> <span data-ttu-id="7ea01-130">否则，返回值为用于启动应用程序的完整 URL（包含所有参数）。</span><span class="sxs-lookup"><span data-stu-id="7ea01-130">Otherwise, the return value is the full URL used to launch the application, including any parameters.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-131">此属性可在完全信任和部分信任的应用程序中使用。</span><span class="sxs-lookup"><span data-stu-id="7ea01-131">This property will work in both fully trusted and partially trusted applications.</span></span>



## Examples
 <span data-ttu-id="7ea01-132">下面的代码演示如何使用 <xref:System.Deployment.Application.ApplicationDeployment.ActivationUri%2A>检索 URL 参数，以及如何使用 <xref:System.Web.HttpUtility> 类安全地分析查询字符串。</span><span class="sxs-lookup"><span data-stu-id="7ea01-132">The following code shows how to retrieve the URL parameters by using <xref:System.Deployment.Application.ApplicationDeployment.ActivationUri%2A>, and how to use the <xref:System.Web.HttpUtility> class to parse the query string safely.</span></span> <span data-ttu-id="7ea01-133">同一查询字符串变量的多个匹配项合并到了返回 <xref:System.Collections.Specialized.NameValueCollection>的一项。</span><span class="sxs-lookup"><span data-stu-id="7ea01-133">Multiple occurrences of the same query string variable are consolidated in one entry of the returned <xref:System.Collections.Specialized.NameValueCollection>.</span></span>

 [!code-csharp[ClickOnceQueryString#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceQueryString/CS/Form1.cs#1)]
 [!code-vb[ClickOnceQueryString#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceQueryString/VB/Form1.vb#1)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="CheckForDetailedUpdate">
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="7ea01-134">执行与 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" /> 相同的操作，但返回有关可用更新的扩展信息。</span><span class="sxs-lookup"><span data-stu-id="7ea01-134">Performs the same operation as <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />, but returns extended information about the available update.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CheckForDetailedUpdate">
      <MemberSignature Language="C#" Value="public System.Deployment.Application.UpdateCheckInfo CheckForDetailedUpdate ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Deployment.Application.UpdateCheckInfo CheckForDetailedUpdate() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate" />
      <MemberSignature Language="VB.NET" Value="Public Function CheckForDetailedUpdate () As UpdateCheckInfo" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Deployment::Application::UpdateCheckInfo ^ CheckForDetailedUpdate();" />
      <MemberSignature Language="F#" Value="member this.CheckForDetailedUpdate : unit -&gt; System.Deployment.Application.UpdateCheckInfo" Usage="applicationDeployment.CheckForDetailedUpdate " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.UpdateCheckInfo</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="7ea01-135">执行与 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" /> 相同的操作，但返回有关可用更新的扩展信息。</span><span class="sxs-lookup"><span data-stu-id="7ea01-135">Performs the same operation as <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />, but returns extended information about the available update.</span></span></summary>
        <returns><span data-ttu-id="7ea01-136">可用更新的 <see cref="T:System.Deployment.Application.UpdateCheckInfo" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-136">An <see cref="T:System.Deployment.Application.UpdateCheckInfo" /> for the available update.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-137">使用 <xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A> 方法，同步调用方可以获取异步调用方使用 <xref:System.Deployment.Application.CheckForUpdateCompletedEventArgs> 类获取的相同扩展信息。</span><span class="sxs-lookup"><span data-stu-id="7ea01-137">The <xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A> method lets synchronous callers get the same extended information that asynchronous callers get using the <xref:System.Deployment.Application.CheckForUpdateCompletedEventArgs> class.</span></span>



## Examples
 <span data-ttu-id="7ea01-138">下面的代码示例使用 <xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A> 检索有关最新更新的信息。</span><span class="sxs-lookup"><span data-stu-id="7ea01-138">The following code example uses <xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A> to retrieve the information about the latest update.</span></span> <span data-ttu-id="7ea01-139">如果更新存在，则它仅在需要更新时才会自动安装;否则，系统将提示用户。</span><span class="sxs-lookup"><span data-stu-id="7ea01-139">If an update exists, it installs it automatically only if it is a required update; otherwise, it prompts the user.</span></span>

 [!code-cpp[ClickOnceAPI#7](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#7)]
 [!code-csharp[ClickOnceAPI#7](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#7)]
 [!code-vb[ClickOnceAPI#7](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#7)]

 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="7ea01-140">当前应用程序未被配置为支持更新，或是已存在另一个已在进行中的更新检查操作。</span><span class="sxs-lookup"><span data-stu-id="7ea01-140">The current application is either not configured to support updates, or there is another update check operation already in progress.</span></span></exception>
        <exception cref="T:System.Deployment.Application.DeploymentDownloadException"><span data-ttu-id="7ea01-141">无法下载部署清单。</span><span class="sxs-lookup"><span data-stu-id="7ea01-141">The deployment manifest cannot be downloaded.</span></span> <span data-ttu-id="7ea01-142">此异常将显示在 <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> 事件的 <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> 属性中。</span><span class="sxs-lookup"><span data-stu-id="7ea01-142">This exception will appear in the <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> property of the <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> event.</span></span></exception>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="7ea01-143">部署清单已损坏。</span><span class="sxs-lookup"><span data-stu-id="7ea01-143">The deployment manifest is corrupted.</span></span> <span data-ttu-id="7ea01-144">在尝试为用户部署此应用程序前，请重新生成应用程序的清单。</span><span class="sxs-lookup"><span data-stu-id="7ea01-144">Regenerate the application's manifest before you attempt to deploy this application to users.</span></span> <span data-ttu-id="7ea01-145">此异常将显示在 <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> 事件的 <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> 属性中。</span><span class="sxs-lookup"><span data-stu-id="7ea01-145">This exception will appear in the <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> property of the <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> event.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="CheckForDetailedUpdate">
      <MemberSignature Language="C#" Value="public System.Deployment.Application.UpdateCheckInfo CheckForDetailedUpdate (bool persistUpdateCheckResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Deployment.Application.UpdateCheckInfo CheckForDetailedUpdate(bool persistUpdateCheckResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Function CheckForDetailedUpdate (persistUpdateCheckResult As Boolean) As UpdateCheckInfo" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Deployment::Application::UpdateCheckInfo ^ CheckForDetailedUpdate(bool persistUpdateCheckResult);" />
      <MemberSignature Language="F#" Value="member this.CheckForDetailedUpdate : bool -&gt; System.Deployment.Application.UpdateCheckInfo" Usage="applicationDeployment.CheckForDetailedUpdate persistUpdateCheckResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.UpdateCheckInfo</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="persistUpdateCheckResult" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="persistUpdateCheckResult"><span data-ttu-id="7ea01-146">如果为 <see langword="false" />，将以静默方式应用该更新，且不会显示任何对话框。</span><span class="sxs-lookup"><span data-stu-id="7ea01-146">If <see langword="false" />, the update will be applied silently and no dialog box will be displayed.</span></span></param>
        <summary><span data-ttu-id="7ea01-147">执行与 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" /> 相同的操作，但返回有关可用更新的扩展信息。</span><span class="sxs-lookup"><span data-stu-id="7ea01-147">Performs the same operation as <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />, but returns extended information about the available update.</span></span></summary>
        <returns><span data-ttu-id="7ea01-148">可用更新的 <see cref="T:System.Deployment.Application.UpdateCheckInfo" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-148">An <see cref="T:System.Deployment.Application.UpdateCheckInfo" /> for the available update.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="CheckForUpdate">
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="7ea01-149">检查 <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> 以确定是否有新的更新可用。</span><span class="sxs-lookup"><span data-stu-id="7ea01-149">Checks <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> to determine whether a new update is available.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CheckForUpdate">
      <MemberSignature Language="C#" Value="public bool CheckForUpdate ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance bool CheckForUpdate() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />
      <MemberSignature Language="VB.NET" Value="Public Function CheckForUpdate () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool CheckForUpdate();" />
      <MemberSignature Language="F#" Value="member this.CheckForUpdate : unit -&gt; bool" Usage="applicationDeployment.CheckForUpdate " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="7ea01-150">检查 <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> 以确定是否有新的更新可用。</span><span class="sxs-lookup"><span data-stu-id="7ea01-150">Checks <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> to determine whether a new update is available.</span></span></summary>
        <returns><span data-ttu-id="7ea01-151">如果有新的更新可用，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-151"><see langword="true" /> if a new update is available; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-152"><xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> 方法将当前安装的部署版本与在 <xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>中找到的部署清单中指定的版本进行比较。</span><span class="sxs-lookup"><span data-stu-id="7ea01-152">The <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> method compares the version of the currently installed deployment with the version specified in the deployment manifest found at <xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>.</span></span> <span data-ttu-id="7ea01-153">如果服务器上的版本不同于已安装的版本，它将返回 `true`。</span><span class="sxs-lookup"><span data-stu-id="7ea01-153">If the version on the server is different from the installed version, it returns `true`.</span></span>

 <span data-ttu-id="7ea01-154">此方法将被阻止，直到完成检查。</span><span class="sxs-lookup"><span data-stu-id="7ea01-154">This method will block until the check has completed.</span></span> <span data-ttu-id="7ea01-155">若要以异步方式检查更新，请改用 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="7ea01-155">To check for an update asynchronously, use the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> method instead.</span></span>

> [!NOTE]
>  <span data-ttu-id="7ea01-156">如果 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> 发现更新可用，并且用户选择不安装，则 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 会在应用程序下一次运行时提示用户提供更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-156">If <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> discovers that an update is available, and the user chooses not to install it, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will prompt the user that an update is available the next time the application is run.</span></span> <span data-ttu-id="7ea01-157">无法禁用此提示。</span><span class="sxs-lookup"><span data-stu-id="7ea01-157">There is no way to disable this prompting.</span></span> <span data-ttu-id="7ea01-158">（如果应用程序是必需的更新，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 将在不提示的情况下安装它。）</span><span class="sxs-lookup"><span data-stu-id="7ea01-158">(If the application is a required update, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will install it without prompting.)</span></span>



## Examples
 <span data-ttu-id="7ea01-159">下面的代码示例检查应用程序更新;如果有一个可用，则它会同步安装。</span><span class="sxs-lookup"><span data-stu-id="7ea01-159">The following code example checks for an application update; if one is available, it installs it synchronously.</span></span>

 [!code-cpp[ClickOnceAPI#5](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#5)]
 [!code-csharp[ClickOnceAPI#5](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#5)]
 [!code-vb[ClickOnceAPI#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#5)]

 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="7ea01-160">如果更新已在进行中，而这时又调用 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" /> 方法，那么 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 会立即引发此异常。</span><span class="sxs-lookup"><span data-stu-id="7ea01-160">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] throws this exception immediately if you call the <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" /> method while an update is already in progress.</span></span></exception>
        <exception cref="T:System.Deployment.Application.DeploymentDownloadException"><span data-ttu-id="7ea01-161">无法下载部署清单。</span><span class="sxs-lookup"><span data-stu-id="7ea01-161">The deployment manifest cannot be downloaded.</span></span></exception>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="7ea01-162">部署清单已损坏。</span><span class="sxs-lookup"><span data-stu-id="7ea01-162">The deployment manifest is corrupted.</span></span> <span data-ttu-id="7ea01-163">您可能需要重新部署应用程序才能修复此问题。</span><span class="sxs-lookup"><span data-stu-id="7ea01-163">You will likely need to redeploy the application to fix this problem.</span></span></exception>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate" />
      </Docs>
    </Member>
    <Member MemberName="CheckForUpdate">
      <MemberSignature Language="C#" Value="public bool CheckForUpdate (bool persistUpdateCheckResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance bool CheckForUpdate(bool persistUpdateCheckResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Function CheckForUpdate (persistUpdateCheckResult As Boolean) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool CheckForUpdate(bool persistUpdateCheckResult);" />
      <MemberSignature Language="F#" Value="member this.CheckForUpdate : bool -&gt; bool" Usage="applicationDeployment.CheckForUpdate persistUpdateCheckResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="persistUpdateCheckResult" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="persistUpdateCheckResult"><span data-ttu-id="7ea01-164">如果为 <see langword="false" />，将以静默方式应用该更新，且不会显示任何对话框。</span><span class="sxs-lookup"><span data-stu-id="7ea01-164">If <see langword="false" />, the update will be applied silently and no dialog box will be displayed.</span></span></param>
        <summary><span data-ttu-id="7ea01-165">检查 <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> 以确定是否有新的更新可用。</span><span class="sxs-lookup"><span data-stu-id="7ea01-165">Checks <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> to determine whether a new update is available.</span></span></summary>
        <returns><span data-ttu-id="7ea01-166">如果有新的更新可用，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-166"><see langword="true" /> if a new update is available; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="CheckForUpdateAsync">
      <MemberSignature Language="C#" Value="public void CheckForUpdateAsync ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void CheckForUpdateAsync() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" />
      <MemberSignature Language="VB.NET" Value="Public Sub CheckForUpdateAsync ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CheckForUpdateAsync();" />
      <MemberSignature Language="F#" Value="member this.CheckForUpdateAsync : unit -&gt; unit" Usage="applicationDeployment.CheckForUpdateAsync " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="7ea01-167">异步检查 <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> 以确定是否有新的更新可用。</span><span class="sxs-lookup"><span data-stu-id="7ea01-167">Checks <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> asynchronously to determine whether a new update is available.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-168"><xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> 立即返回，并启动一个单独的线程来下载已更新的应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-168"><xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> returns immediately and starts a separate thread for downloading the updated application.</span></span> <span data-ttu-id="7ea01-169">当方法完成或取消时，它会引发 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-169">When the method completes or is canceled, it raises the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> event.</span></span> <span data-ttu-id="7ea01-170">您可以在此事件处理程序中使用 <xref:System.ComponentModel.AsyncCompletedEventArgs> 来确定操作是否已取消，或者是否在更新过程中引发了异常。</span><span class="sxs-lookup"><span data-stu-id="7ea01-170">You can use <xref:System.ComponentModel.AsyncCompletedEventArgs> in this event handler to determine whether the operation was canceled, or if an exception was raised during update.</span></span>

 <span data-ttu-id="7ea01-171">可以通过调用 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsyncCancel%2A>取消异步更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-171">You can cancel an asynchronous update by calling <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsyncCancel%2A>.</span></span>

> [!NOTE]
>  <span data-ttu-id="7ea01-172">如果 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> 发现更新可用，并且用户选择不安装，则 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 会在应用程序下一次运行时提示用户提供更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-172">If <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> discovers that an update is available, and the user chooses not to install it, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will prompt the user that an update is available the next time the application is run.</span></span> <span data-ttu-id="7ea01-173">无法禁用此提示。</span><span class="sxs-lookup"><span data-stu-id="7ea01-173">There is no way to disable this prompting.</span></span> <span data-ttu-id="7ea01-174">（如果应用程序是必需的更新，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 将在不提示的情况下安装它。）</span><span class="sxs-lookup"><span data-stu-id="7ea01-174">(If the application is a required update, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will install it without prompting.)</span></span>



## Examples
 <span data-ttu-id="7ea01-175">下面的示例以异步方式检查更新，并安装更新（如果存在）。</span><span class="sxs-lookup"><span data-stu-id="7ea01-175">The following example checks for an update asynchronously, and installs the update if one exists.</span></span>

 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]

 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="7ea01-176">如果更新已在进行中，而这时又调用 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> 方法，那么 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 会立即引发此异常。</span><span class="sxs-lookup"><span data-stu-id="7ea01-176">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] throws this exception immediately if you call the <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> method while an update is already in progress.</span></span></exception>
        <exception cref="T:System.Deployment.Application.DeploymentDownloadException"><span data-ttu-id="7ea01-177">无法下载部署清单。</span><span class="sxs-lookup"><span data-stu-id="7ea01-177">The deployment manifest cannot be downloaded.</span></span> <span data-ttu-id="7ea01-178">此异常出现在 <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> 事件的 <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> 属性中。</span><span class="sxs-lookup"><span data-stu-id="7ea01-178">This exception appears in the <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> property of the <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> event.</span></span></exception>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="7ea01-179">部署清单已损坏。</span><span class="sxs-lookup"><span data-stu-id="7ea01-179">The deployment manifest is corrupted.</span></span> <span data-ttu-id="7ea01-180">您可能需要重新部署应用程序才能修复此问题。</span><span class="sxs-lookup"><span data-stu-id="7ea01-180">You will likely need to redeploy the application to fix this problem.</span></span> <span data-ttu-id="7ea01-181">此异常出现在 <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> 事件的 <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> 属性中。</span><span class="sxs-lookup"><span data-stu-id="7ea01-181">This exception appears in the <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> property of the <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> event.</span></span></exception>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsyncCancel" />
      </Docs>
    </Member>
    <Member MemberName="CheckForUpdateAsyncCancel">
      <MemberSignature Language="C#" Value="public void CheckForUpdateAsyncCancel ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void CheckForUpdateAsyncCancel() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsyncCancel" />
      <MemberSignature Language="VB.NET" Value="Public Sub CheckForUpdateAsyncCancel ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CheckForUpdateAsyncCancel();" />
      <MemberSignature Language="F#" Value="member this.CheckForUpdateAsyncCancel : unit -&gt; unit" Usage="applicationDeployment.CheckForUpdateAsyncCancel " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="7ea01-182">取消异步更新检查。</span><span class="sxs-lookup"><span data-stu-id="7ea01-182">Cancels the asynchronous update check.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-183">使用此方法可取消使用 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> 方法启动的更新检查。</span><span class="sxs-lookup"><span data-stu-id="7ea01-183">Use this method to cancel an update check initiated with the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> method.</span></span>

 <span data-ttu-id="7ea01-184">此方法不会取消任何可能正在进行的后台更新，如作为订阅的一部分启动的更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-184">This method will not cancel any background update that may already be in progress, such as an update started as part of a subscription.</span></span> <span data-ttu-id="7ea01-185">有关订阅的详细信息，请参阅[选择 ClickOnce 更新策略](/visualstudio/deployment/choosing-a-clickonce-update-strategy)。</span><span class="sxs-lookup"><span data-stu-id="7ea01-185">For more information about subscriptions, see [Choosing a ClickOnce Update Strategy](/visualstudio/deployment/choosing-a-clickonce-update-strategy).</span></span>

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CheckForUpdateCompleted">
      <MemberSignature Language="C#" Value="public event System.Deployment.Application.CheckForUpdateCompletedEventHandler CheckForUpdateCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Deployment.Application.CheckForUpdateCompletedEventHandler CheckForUpdateCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event CheckForUpdateCompleted As CheckForUpdateCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Deployment::Application::CheckForUpdateCompletedEventHandler ^ CheckForUpdateCompleted;" />
      <MemberSignature Language="F#" Value="member this.CheckForUpdateCompleted : System.Deployment.Application.CheckForUpdateCompletedEventHandler " Usage="member this.CheckForUpdateCompleted : System.Deployment.Application.CheckForUpdateCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.CheckForUpdateCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-186">在 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> 完成时发生。</span><span class="sxs-lookup"><span data-stu-id="7ea01-186">Occurs when <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> has completed.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-187"><xref:System.Deployment.Application.CheckForUpdateCompletedEventArgs> 类将告诉你，更新的版本、更新的大小以及可用更新是必需的还是可选的。</span><span class="sxs-lookup"><span data-stu-id="7ea01-187">The <xref:System.Deployment.Application.CheckForUpdateCompletedEventArgs> class will tell you, among other things, the version of the update, how large the update is, and whether the available update is required or optional.</span></span>



## Examples
 <span data-ttu-id="7ea01-188">下面的代码示例使用 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> 来确定是否要求用户安装可用的应用程序更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-188">The following code example uses <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> to decide whether to ask the user to install the available application update.</span></span> <span data-ttu-id="7ea01-189">如果更新是必需升级，则 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> 事件处理程序不会提示用户。</span><span class="sxs-lookup"><span data-stu-id="7ea01-189">If the update is a mandatory upgrade, the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> event handler does not prompt the user.</span></span> <span data-ttu-id="7ea01-190">该示例要求你部署一个包含 <xref:System.Windows.Forms.StatusStrip> 控件的 Windows 窗体应用程序，并且此控件包含一个名为 `downloadStatus`<xref:System.Windows.Forms.ToolStripStatusLabel> 控件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-190">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`.</span></span>

 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CheckForUpdateProgressChanged">
      <MemberSignature Language="C#" Value="public event System.Deployment.Application.DeploymentProgressChangedEventHandler CheckForUpdateProgressChanged;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Deployment.Application.DeploymentProgressChangedEventHandler CheckForUpdateProgressChanged" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event CheckForUpdateProgressChanged As DeploymentProgressChangedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Deployment::Application::DeploymentProgressChangedEventHandler ^ CheckForUpdateProgressChanged;" />
      <MemberSignature Language="F#" Value="member this.CheckForUpdateProgressChanged : System.Deployment.Application.DeploymentProgressChangedEventHandler " Usage="member this.CheckForUpdateProgressChanged : System.Deployment.Application.DeploymentProgressChangedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.DeploymentProgressChangedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-191">在调用 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> 时存在可用的进度更新的情况下发生。</span><span class="sxs-lookup"><span data-stu-id="7ea01-191">Occurs when a progress update is available on a <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> call.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-192"><xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged> 报告应用程序的部署清单的下载状态。</span><span class="sxs-lookup"><span data-stu-id="7ea01-192"><xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged> reports on the download status of the application's deployment manifest.</span></span> <span data-ttu-id="7ea01-193">对于在慢速网络连接上下载部署的用户而言，这可能是一项重要的信息。</span><span class="sxs-lookup"><span data-stu-id="7ea01-193">This can be important information for users who are downloading the deployment over slow network connections.</span></span>



## Examples
 <span data-ttu-id="7ea01-194">下面的代码示例使用 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged> 事件来通知用户要下载多少部署清单。</span><span class="sxs-lookup"><span data-stu-id="7ea01-194">The following code example uses the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged> event to inform the user how much of the deployment manifest is left to download.</span></span> <span data-ttu-id="7ea01-195">该示例要求你部署一个包含 <xref:System.Windows.Forms.StatusStrip> 控件的 Windows 窗体应用程序，并且此控件包含一个名为 `downloadStatus`<xref:System.Windows.Forms.ToolStripStatusLabel> 控件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-195">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`.</span></span>

 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CurrentDeployment">
      <MemberSignature Language="C#" Value="public static System.Deployment.Application.ApplicationDeployment CurrentDeployment { get; }" />
      <MemberSignature Language="ILAsm" Value=".property class System.Deployment.Application.ApplicationDeployment CurrentDeployment" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.CurrentDeployment" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property CurrentDeployment As ApplicationDeployment" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Deployment::Application::ApplicationDeployment ^ CurrentDeployment { System::Deployment::Application::ApplicationDeployment ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.CurrentDeployment : System.Deployment.Application.ApplicationDeployment" Usage="System.Deployment.Application.ApplicationDeployment.CurrentDeployment" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.ApplicationDeployment</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-196">返回此部署的当前 <see cref="T:System.Deployment.Application.ApplicationDeployment" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-196">Returns the current <see cref="T:System.Deployment.Application.ApplicationDeployment" /> for this deployment.</span></span></summary>
        <value><span data-ttu-id="7ea01-197">当前部署。</span><span class="sxs-lookup"><span data-stu-id="7ea01-197">The current deployment.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-198">不能直接在应用程序中创建 <xref:System.Deployment.Application.ApplicationDeployment> 的实例;必须通过 <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> 属性检索有效的实例。</span><span class="sxs-lookup"><span data-stu-id="7ea01-198">You cannot create instances of <xref:System.Deployment.Application.ApplicationDeployment> directly in your application; you must retrieve a valid instance through the <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> property.</span></span>

 <span data-ttu-id="7ea01-199"><xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> 静态属性只能从使用 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]部署的应用程序中使用。</span><span class="sxs-lookup"><span data-stu-id="7ea01-199">The <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> static property is valid only from within an application that was deployed using [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)].</span></span> <span data-ttu-id="7ea01-200">尝试从非[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 的应用程序调用此属性将引发异常。</span><span class="sxs-lookup"><span data-stu-id="7ea01-200">Attempts to call this property from non-[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] applications will throw an exception.</span></span> <span data-ttu-id="7ea01-201">如果你正在开发的应用程序可能使用 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]部署，则可以使用 <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> 属性来测试当前程序是否是 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-201">If you are developing an application that may or may not be deployed using [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)], use the <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> property to test whether the current program is a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application.</span></span>



## Examples
 <span data-ttu-id="7ea01-202">下面的代码示例检索 <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A>，并检查以确定是否已在过去三天内更新应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-202">The following code example retrieves <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> and checks to determine whether the application has been updated in the past three days.</span></span>

 [!code-cpp[ClickOnceAPI#3](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#3)]
 [!code-csharp[ClickOnceAPI#3](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#3)]
 [!code-vb[ClickOnceAPI#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#3)]

 ]]></format>
        </remarks>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="7ea01-203">尝试从非 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序调用此静态属性。</span><span class="sxs-lookup"><span data-stu-id="7ea01-203">You attempted to call this static property from a non-[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application.</span></span></exception>
        <altmember cref="P:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed" />
      </Docs>
    </Member>
    <Member MemberName="CurrentVersion">
      <MemberSignature Language="C#" Value="public Version CurrentVersion { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Version CurrentVersion" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.CurrentVersion" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CurrentVersion As Version" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Version ^ CurrentVersion { Version ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.CurrentVersion : Version" Usage="System.Deployment.Application.ApplicationDeployment.CurrentVersion" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Version</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-204">获取当前正在运行的应用程序实例的部署版本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-204">Gets the version of the deployment for the current running instance of the application.</span></span></summary>
        <value><span data-ttu-id="7ea01-205">当前的部署版本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-205">The current deployment version.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-206">如果已安装新的更新，但尚未调用 <xref:System.Windows.Forms.Application.Restart%2A>，<xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A> 将与 <xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A> 不同。</span><span class="sxs-lookup"><span data-stu-id="7ea01-206"><xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A> will differ from <xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A> if a new update has been installed but you have not yet called <xref:System.Windows.Forms.Application.Restart%2A>.</span></span> <span data-ttu-id="7ea01-207">如果将部署清单配置为执行自动更新，可以比较这两个值，以确定是否应重新启动应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-207">If the deployment manifest is configured to perform automatic updates, you can compare these two values to determine if you should restart the application.</span></span>



## Examples
 <span data-ttu-id="7ea01-208">下面的代码示例定义了一个方法，该方法确定 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 是否更新了应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-208">The following code example defines a method that determines whether [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] has updated the application.</span></span>

 [!code-cpp[ClickOnceAPI#3](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#3)]
 [!code-csharp[ClickOnceAPI#3](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#3)]
 [!code-vb[ClickOnceAPI#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#3)]

 ]]></format>
        </remarks>
        <altmember cref="P:System.Deployment.Application.ApplicationDeployment.UpdatedVersion" />
      </Docs>
    </Member>
    <Member MemberName="DataDirectory">
      <MemberSignature Language="C#" Value="public string DataDirectory { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string DataDirectory" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.DataDirectory" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property DataDirectory As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ DataDirectory { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.DataDirectory : string" Usage="System.Deployment.Application.ApplicationDeployment.DataDirectory" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-209">获取 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 数据目录的路径。</span><span class="sxs-lookup"><span data-stu-id="7ea01-209">Gets the path to the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] data directory.</span></span></summary>
        <value><span data-ttu-id="7ea01-210">一个字符串，它包含应用程序的数据目录在本地磁盘上的路径。</span><span class="sxs-lookup"><span data-stu-id="7ea01-210">A string containing the path to the application's data directory on the local disk.</span></span></value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="DownloadFileGroup">
      <MemberSignature Language="C#" Value="public void DownloadFileGroup (string groupName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void DownloadFileGroup(string groupName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFileGroup (groupName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFileGroup(System::String ^ groupName);" />
      <MemberSignature Language="F#" Value="member this.DownloadFileGroup : string -&gt; unit" Usage="applicationDeployment.DownloadFileGroup groupName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="groupName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="groupName"><span data-ttu-id="7ea01-211">要下载的已命名文件组。</span><span class="sxs-lookup"><span data-stu-id="7ea01-211">The named group of files to download.</span></span> <span data-ttu-id="7ea01-212">在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中，标记为“可选”的所有文件均需具备组名称。</span><span class="sxs-lookup"><span data-stu-id="7ea01-212">All files marked "optional" in a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application require a group name.</span></span></param>
        <summary><span data-ttu-id="7ea01-213">根据需要下载一组可选文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-213">Downloads a set of optional files on demand.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-214">在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中，应用程序清单中标记为 "可选" 的文件在初始化或更新过程中不会下载。</span><span class="sxs-lookup"><span data-stu-id="7ea01-214">In a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application, the files marked "optional" in the application manifest are not downloaded during initialization or update.</span></span> <span data-ttu-id="7ea01-215">你可以使用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 方法来按需下载属于命名组的所有文件，以便在你确定用户需要它们之前，不会消耗网络资源和磁盘空间。</span><span class="sxs-lookup"><span data-stu-id="7ea01-215">You can use the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> method to download all of the files belonging to a named group on demand, so that they do not consume network resources and disk space until you are sure the user requires them.</span></span> <span data-ttu-id="7ea01-216">例如，某些用户可能需要每天使用您的应用程序中包含的数据分析包，而其他用户则可能永远不会调用它。</span><span class="sxs-lookup"><span data-stu-id="7ea01-216">For example, certain users may need to use a data analysis package included in your application on a daily basis, while other users may never invoke it.</span></span>

 <span data-ttu-id="7ea01-217">若要使用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A>下载的程序集，请将事件侦听器附加到 <xref:System.AppDomain.CurrentDomain%2A>上的 <xref:System.AppDomain.AssemblyResolve> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-217">To use an assembly you have downloaded with <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A>, you attach an event listener to the <xref:System.AppDomain.AssemblyResolve> event on the <xref:System.AppDomain.CurrentDomain%2A>.</span></span> <span data-ttu-id="7ea01-218">有关示例，请参阅 "[演练：使用设计器使用 ClickOnce 部署 API 按需下载程序集](/visualstudio/deployment/walkthrough-downloading-assemblies-on-demand-with-the-clickonce-deployment-api-using-the-designer)"。</span><span class="sxs-lookup"><span data-stu-id="7ea01-218">For an example, see =[Walkthrough: Downloading Assemblies on Demand with the ClickOnce Deployment API Using the Designer](/visualstudio/deployment/walkthrough-downloading-assemblies-on-demand-with-the-clickonce-deployment-api-using-the-designer).</span></span>

 <span data-ttu-id="7ea01-219">所有文件都下载到 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序缓存中，因此与当前版本的应用程序隔离。</span><span class="sxs-lookup"><span data-stu-id="7ea01-219">All files are downloaded to the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application cache and are therefore isolated to the current version of the application.</span></span> <span data-ttu-id="7ea01-220">假设应用程序下载文件组后，用户会安装新版本的应用程序，但稍后会恢复到应用程序的以前版本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-220">Let's say that after an application downloads a file group, the user installs a new version of the application, but later reverts to the previous version of the application.</span></span> <span data-ttu-id="7ea01-221">在这种情况下，先前版本仍将具有它最初下载的文件的副本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-221">In this case, the previous version will still have the copies of the files it originally downloaded.</span></span> <span data-ttu-id="7ea01-222">有关访问数据文件的详细信息，请参阅[在 ClickOnce 应用程序中访问本地数据和远程数据](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications)。</span><span class="sxs-lookup"><span data-stu-id="7ea01-222">For more information about accessing data files, see [Accessing Local and Remote Data in ClickOnce Applications](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications).</span></span>

 <span data-ttu-id="7ea01-223"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 在部分受信任的应用程序中工作，即，在运行具有受限权限的任何 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中运行。</span><span class="sxs-lookup"><span data-stu-id="7ea01-223"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> works in partially trusted applications, that is, in any [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application running with restricted permission.</span></span> <span data-ttu-id="7ea01-224">但是，如果您尝试动态加载程序集，则您的应用程序将需要完全信任。</span><span class="sxs-lookup"><span data-stu-id="7ea01-224">However, if you attempt to load assemblies dynamically, your application will require full trust.</span></span>

 <span data-ttu-id="7ea01-225">当前不支持按需下载数据文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-225">On-demand downloading of data files is currently not supported.</span></span>

 <span data-ttu-id="7ea01-226">在 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 方法返回之前，应用程序将不会响应用户输入。</span><span class="sxs-lookup"><span data-stu-id="7ea01-226">Your application will not be responsive to user input until the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> method returns.</span></span> <span data-ttu-id="7ea01-227">如果需要在不中断用户工作流的情况下下载文件，请改用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="7ea01-227">If you need to download files without interrupting the user's workflow, use the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method instead.</span></span>

 <span data-ttu-id="7ea01-228">不能单独按文件名下载单个文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-228">You cannot download a single file by its file name alone.</span></span> <span data-ttu-id="7ea01-229">若要下载单个文件，请在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 部署中向其分配一个组名称，并使用此方法下载组。</span><span class="sxs-lookup"><span data-stu-id="7ea01-229">To download a single file, assign it a group name in your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] deployment and download the group using this method.</span></span>



## Examples
 <span data-ttu-id="7ea01-230">下面的代码示例演示如何通过侦听 <xref:System.AppDomain.AssemblyResolve> 事件，按需加载程序集。</span><span class="sxs-lookup"><span data-stu-id="7ea01-230">The following code example demonstrates how to load an assembly on demand by listening for the <xref:System.AppDomain.AssemblyResolve> event.</span></span>

 [!code-csharp[ClickOnceOnDemandCmdLine#2](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceOnDemandCmdLine/CS/Form1.cs#2)]

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="7ea01-231"><paramref name="groupName" /> 参数为 null 或零长度。</span><span class="sxs-lookup"><span data-stu-id="7ea01-231">The <paramref name="groupName" /> parameter is null or zero-length.</span></span></exception>
        <altmember cref="Overload:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync" />
        <related type="Article" href="/visualstudio/deployment/walkthrough-downloading-satellite-assemblies-on-demand-with-the-clickonce-deployment-api"><span data-ttu-id="7ea01-232">演练：使用 ClickOnce 部署 API 按需下载附属程序集</span><span class="sxs-lookup"><span data-stu-id="7ea01-232">Walkthrough: Downloading Satellite Assemblies on Demand with the ClickOnce Deployment API</span></span></related>
        <related type="Article" href="/visualstudio/deployment/clickonce-application-manifest"><span data-ttu-id="7ea01-233">ndptecclick</span><span class="sxs-lookup"><span data-stu-id="7ea01-233">ClickOnce Application Manifest</span></span></related>
        <related type="Article" href="/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications"><span data-ttu-id="7ea01-234">在 ClickOnce 应用程序中访问本地数据和远程数据</span><span class="sxs-lookup"><span data-stu-id="7ea01-234">Accessing Local and Remote Data in ClickOnce Applications</span></span></related>
        <related type="Article" href="/visualstudio/deployment/how-to-include-a-data-file-in-a-clickonce-application"><span data-ttu-id="7ea01-235">如何：将数据文件包括到 ClickOnce 应用程序中</span><span class="sxs-lookup"><span data-stu-id="7ea01-235">How to: Include a Data File in a ClickOnce Application</span></span></related>
        <related type="Article" href="/visualstudio/deployment/clickonce-cache-overview"><span data-ttu-id="7ea01-236">ClickOnce 缓存的体系结构</span><span class="sxs-lookup"><span data-stu-id="7ea01-236">Architecture of the ClickOnce Cache</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="DownloadFileGroupAsync">
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="7ea01-237">根据需要在后台下载一组可选文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-237">Downloads, on demand, a set of optional files in the background.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DownloadFileGroupAsync">
      <MemberSignature Language="C#" Value="public void DownloadFileGroupAsync (string groupName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void DownloadFileGroupAsync(string groupName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFileGroupAsync (groupName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFileGroupAsync(System::String ^ groupName);" />
      <MemberSignature Language="F#" Value="member this.DownloadFileGroupAsync : string -&gt; unit" Usage="applicationDeployment.DownloadFileGroupAsync groupName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="groupName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="groupName"><span data-ttu-id="7ea01-238">要下载的已命名文件组。</span><span class="sxs-lookup"><span data-stu-id="7ea01-238">The named group of files to download.</span></span> <span data-ttu-id="7ea01-239">在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中，标记为“可选”的所有文件均需具备组名称。</span><span class="sxs-lookup"><span data-stu-id="7ea01-239">All files marked "optional" in a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application require a group name.</span></span></param>
        <summary><span data-ttu-id="7ea01-240">根据需要在后台下载一组可选文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-240">Downloads, on demand, a set of optional files in the background.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-241">在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中，应用程序清单中标记为 "可选" 的文件在初始化或更新过程中不会下载。</span><span class="sxs-lookup"><span data-stu-id="7ea01-241">In a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application, the files marked "optional" in the application manifest are not downloaded during initialization or update.</span></span> <span data-ttu-id="7ea01-242">你可以使用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> 方法来按需下载属于命名组的所有文件，以便在你确定用户需要它们之前，不会消耗网络资源和磁盘空间。</span><span class="sxs-lookup"><span data-stu-id="7ea01-242">You can use the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method to download all of the files belonging to a named group on demand, so that they do not consume network resources and disk space until you are sure the user requires them.</span></span> <span data-ttu-id="7ea01-243">此方法不仅可用于静态文件，还可用于应用程序可能需要或不需要的程序集。</span><span class="sxs-lookup"><span data-stu-id="7ea01-243">This approach works not only for static files, but also for assemblies that an application may or may not require.</span></span> <span data-ttu-id="7ea01-244">例如，某些用户可能需要每天使用您的应用程序中包含的数据分析包，而其他用户则可能永远不会调用它。</span><span class="sxs-lookup"><span data-stu-id="7ea01-244">For example, certain users may need to use a data analysis package included in your application on a daily basis, while other users may never invoke it.</span></span>

 <span data-ttu-id="7ea01-245">若要按需下载程序集，请将事件侦听器附加到 <xref:System.AppDomain.CurrentDomain%2A>上的 <xref:System.AppDomain.AssemblyResolve> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-245">To download assemblies on demand, attach an event listener to the <xref:System.AppDomain.AssemblyResolve> event on the <xref:System.AppDomain.CurrentDomain%2A>.</span></span> <span data-ttu-id="7ea01-246">有关示例，请参阅[演练：使用 ClickOnce 部署 API 按需下载程序集](/visualstudio/deployment/walkthrough-downloading-assemblies-on-demand-with-the-clickonce-deployment-api)。</span><span class="sxs-lookup"><span data-stu-id="7ea01-246">For an example, see [Walkthrough: Downloading Assemblies on Demand with the ClickOnce Deployment API](/visualstudio/deployment/walkthrough-downloading-assemblies-on-demand-with-the-clickonce-deployment-api).</span></span>

 <span data-ttu-id="7ea01-247">所有程序集都下载到 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序缓存。</span><span class="sxs-lookup"><span data-stu-id="7ea01-247">All assemblies are downloaded to the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application cache.</span></span>

 <span data-ttu-id="7ea01-248">所有静态文件都下载到 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序的数据目录中，因此与当前版本的应用程序隔离。</span><span class="sxs-lookup"><span data-stu-id="7ea01-248">All static files are downloaded to the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application's data directory and are therefore isolated to the current version of the application.</span></span> <span data-ttu-id="7ea01-249">假设应用程序下载文件组后，用户会安装新版本的应用程序，但稍后会恢复到应用程序的以前版本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-249">Let's say that after an application downloads a file group, the user installs a new version of the application, but later reverts to the previous version of the application.</span></span> <span data-ttu-id="7ea01-250">在这种情况下，先前版本仍将具有它最初下载的文件的副本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-250">In this case, the previous version will still have the copies of the files it originally downloaded.</span></span> <span data-ttu-id="7ea01-251">有关访问静态文件的详细信息，请参阅[在 ClickOnce 应用程序中访问本地数据和远程数据](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications)。</span><span class="sxs-lookup"><span data-stu-id="7ea01-251">For more information about accessing static files, see [Accessing Local and Remote Data in ClickOnce Applications](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications).</span></span>

 <span data-ttu-id="7ea01-252">您可以使用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>同时下载多个文件组。</span><span class="sxs-lookup"><span data-stu-id="7ea01-252">You can download multiple file groups simultaneously using <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>.</span></span> <span data-ttu-id="7ea01-253">您可以通过使用 <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs> 类的 <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs.Group%2A> 属性来区分它们，该属性将传递到 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-253">You can distinguish among them by using the <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs.Group%2A> property of the <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs> class, which is passed to the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged> event.</span></span> <span data-ttu-id="7ea01-254">如果需要传递更复杂的状态，可以使用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> 传入 `state` 对象。</span><span class="sxs-lookup"><span data-stu-id="7ea01-254">If you need to pass more complex state, you can use <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> to pass in a `state` object.</span></span>

 <span data-ttu-id="7ea01-255"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 在部分受信任的应用程序中工作，即，在运行具有受限权限的任何 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中运行。</span><span class="sxs-lookup"><span data-stu-id="7ea01-255"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> works in partially trusted applications, that is, in any [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application running with restricted permission.</span></span> <span data-ttu-id="7ea01-256">但是，如果你试图动态加载程序集，则你的应用程序将需要完全信任。</span><span class="sxs-lookup"><span data-stu-id="7ea01-256">However, if you are attempting to load assemblies dynamically, your application will require full trust.</span></span>

 <span data-ttu-id="7ea01-257">当前不支持按需下载数据文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-257">On-demand downloading of data files is currently not supported.</span></span>

 <span data-ttu-id="7ea01-258">不能单独按文件名下载单个文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-258">You cannot download a single file by its file name alone.</span></span> <span data-ttu-id="7ea01-259">若要下载单个文件，请在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 部署中向其分配一个组名称，并使用此方法下载组。</span><span class="sxs-lookup"><span data-stu-id="7ea01-259">To download a single file, assign it a group name in your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] deployment and download the group using this method.</span></span>

 <span data-ttu-id="7ea01-260">若要取消异步下载，请调用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsyncCancel%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="7ea01-260">To cancel an asynchronous download, call the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsyncCancel%2A> method.</span></span>

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="7ea01-261"><paramref name="groupName" /> 参数为 null 或零长度。</span><span class="sxs-lookup"><span data-stu-id="7ea01-261">The <paramref name="groupName" /> parameter is null or zero-length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="7ea01-262">一次不能启动多个 <paramref name="groupName" /> 下载。</span><span class="sxs-lookup"><span data-stu-id="7ea01-262">You cannot initiate more than one download of <paramref name="groupName" /> at a time.</span></span></exception>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup(System.String)" />
        <related type="Article" href="/visualstudio/deployment/walkthrough-downloading-satellite-assemblies-on-demand-with-the-clickonce-deployment-api"><span data-ttu-id="7ea01-263">演练：使用 ClickOnce 部署 API 按需下载附属程序集</span><span class="sxs-lookup"><span data-stu-id="7ea01-263">Walkthrough: Downloading Satellite Assemblies on Demand with the ClickOnce Deployment API</span></span></related>
        <related type="Article" href="/visualstudio/deployment/clickonce-application-manifest"><span data-ttu-id="7ea01-264">ndptecclick</span><span class="sxs-lookup"><span data-stu-id="7ea01-264">ClickOnce Application Manifest</span></span></related>
        <related type="Article" href="/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications"><span data-ttu-id="7ea01-265">在 ClickOnce 应用程序中访问本地数据和远程数据</span><span class="sxs-lookup"><span data-stu-id="7ea01-265">Accessing Local and Remote Data in ClickOnce Applications</span></span></related>
        <related type="Article" href="/visualstudio/deployment/how-to-include-a-data-file-in-a-clickonce-application"><span data-ttu-id="7ea01-266">如何：将数据文件包括到 ClickOnce 应用程序中</span><span class="sxs-lookup"><span data-stu-id="7ea01-266">How to: Include a Data File in a ClickOnce Application</span></span></related>
        <related type="Article" href="/visualstudio/deployment/clickonce-cache-overview"><span data-ttu-id="7ea01-267">ClickOnce 缓存的体系结构</span><span class="sxs-lookup"><span data-stu-id="7ea01-267">Architecture of the ClickOnce Cache</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DownloadFileGroupAsync">
      <MemberSignature Language="C#" Value="public void DownloadFileGroupAsync (string groupName, object userState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void DownloadFileGroupAsync(string groupName, object userState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync(System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFileGroupAsync (groupName As String, userState As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFileGroupAsync(System::String ^ groupName, System::Object ^ userState);" />
      <MemberSignature Language="F#" Value="member this.DownloadFileGroupAsync : string * obj -&gt; unit" Usage="applicationDeployment.DownloadFileGroupAsync (groupName, userState)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="groupName" Type="System.String" />
        <Parameter Name="userState" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="groupName"><span data-ttu-id="7ea01-268">要下载的已命名文件组。</span><span class="sxs-lookup"><span data-stu-id="7ea01-268">The named group of files to download.</span></span> <span data-ttu-id="7ea01-269">在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中，标记为“可选”的所有文件均需具备组名称。</span><span class="sxs-lookup"><span data-stu-id="7ea01-269">All files marked "optional" in a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application require a group name.</span></span></param>
        <param name="userState"><span data-ttu-id="7ea01-270">包含异步操作状态信息的任意对象。</span><span class="sxs-lookup"><span data-stu-id="7ea01-270">An arbitrary object containing state information for the asynchronous operation.</span></span></param>
        <summary><span data-ttu-id="7ea01-271">根据需要在后台下载一组可选文件，并向事件回调传递一种应用程序状态。</span><span class="sxs-lookup"><span data-stu-id="7ea01-271">Downloads, on demand, a set of optional files in the background, and passes a piece of application state to the event callbacks.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-272">在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中，应用程序清单中标记为 "可选" 的文件在初始化或更新过程中不会下载。</span><span class="sxs-lookup"><span data-stu-id="7ea01-272">In a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application, the files marked "optional" in the application manifest are not downloaded during initialization or update.</span></span> <span data-ttu-id="7ea01-273">你可以使用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> 方法来按需下载属于命名组的所有文件，以便在你确定用户需要它们之前，不会消耗网络资源和磁盘空间。</span><span class="sxs-lookup"><span data-stu-id="7ea01-273">You can use the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method to download all of the files belonging to a named group on demand, so that they do not consume network resources and disk space until you are sure the user requires them.</span></span> <span data-ttu-id="7ea01-274">此方法不仅可用于静态文件，还可用于应用程序可能需要或不需要的程序集。</span><span class="sxs-lookup"><span data-stu-id="7ea01-274">This approach works not only for static files, but also for assemblies that an application may or may not require.</span></span> <span data-ttu-id="7ea01-275">例如，某些用户可能需要每天使用您的应用程序中包含的数据分析包，而其他用户则可能永远不会调用它。</span><span class="sxs-lookup"><span data-stu-id="7ea01-275">For example, certain users may need to use a data analysis package included in your application on a daily basis, while other users may never invoke it.</span></span> <span data-ttu-id="7ea01-276">若要按需下载程序集，请将事件侦听器附加到 <xref:System.AppDomain.CurrentDomain%2A>上的 <xref:System.AppDomain.AssemblyResolve> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-276">To download assemblies on demand, attach an event listener to the <xref:System.AppDomain.AssemblyResolve> event on the <xref:System.AppDomain.CurrentDomain%2A>.</span></span>

 <span data-ttu-id="7ea01-277">您可以使用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> 方法同时下载多个文件组。</span><span class="sxs-lookup"><span data-stu-id="7ea01-277">You can download multiple file groups simultaneously by using the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method.</span></span> <span data-ttu-id="7ea01-278">您可以通过使用 <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs> 类的 <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs.Group%2A> 属性来区分它们，该属性将传递到 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-278">You can distinguish among them by using the <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs.Group%2A> property of the <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs> class, which is passed to the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged> event.</span></span> <span data-ttu-id="7ea01-279">如果需要传递更复杂的状态，可以使用</span><span class="sxs-lookup"><span data-stu-id="7ea01-279">If you need to pass a more complex state, you can use</span></span>

 <span data-ttu-id="7ea01-280">要传入 `state` 对象的 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>。</span><span class="sxs-lookup"><span data-stu-id="7ea01-280"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> to pass in a `state` object.</span></span>

 <span data-ttu-id="7ea01-281">所有静态文件都下载到 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序的数据目录中，因此与当前版本的应用程序隔离。</span><span class="sxs-lookup"><span data-stu-id="7ea01-281">All static files are downloaded to the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application's data directory and are therefore isolated to the current version of the application.</span></span> <span data-ttu-id="7ea01-282">有关访问静态文件的详细信息，请参阅[在 ClickOnce 应用程序中访问本地数据和远程数据](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications)。</span><span class="sxs-lookup"><span data-stu-id="7ea01-282">For more information about accessing static files, see [Accessing Local and Remote Data in ClickOnce Applications](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications).</span></span> <span data-ttu-id="7ea01-283">.</span><span class="sxs-lookup"><span data-stu-id="7ea01-283">.</span></span> <span data-ttu-id="7ea01-284">假设应用程序下载文件组后，用户会安装新版本的应用程序，但以后用户会恢复到应用程序的以前版本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-284">Let's say that after an application downloads a file group, the user installs a new version of the application, but later  user reverts to the previous version of the application.</span></span> <span data-ttu-id="7ea01-285">在这种情况下，先前版本仍将具有它最初下载的文件的副本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-285">In this case, the previous version will still have the copies of the files it originally downloaded.</span></span>

 <span data-ttu-id="7ea01-286"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 在部分受信任的应用程序中工作，即，在运行具有受限权限的任何 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中运行。</span><span class="sxs-lookup"><span data-stu-id="7ea01-286"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> works in partially trusted applications, that is, in any [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application running with restricted permission.</span></span> <span data-ttu-id="7ea01-287">但是，如果你试图动态加载程序集，则你的应用程序将需要完全信任。</span><span class="sxs-lookup"><span data-stu-id="7ea01-287">However, if you are attempting to load assemblies dynamically, your application will require full trust.</span></span>

 <span data-ttu-id="7ea01-288">当前不支持按需下载数据文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-288">On-demand downloading of data files is currently not supported.</span></span>

 <span data-ttu-id="7ea01-289">若要取消异步下载，请调用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsyncCancel%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="7ea01-289">To cancel an asynchronous download, call the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsyncCancel%2A> method.</span></span>

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="7ea01-290"><paramref name="groupName" /> 参数为 null 或零长度。</span><span class="sxs-lookup"><span data-stu-id="7ea01-290">The <paramref name="groupName" /> parameter is null or zero-length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="7ea01-291">一次不能启动多个 <paramref name="groupName" /> 下载。</span><span class="sxs-lookup"><span data-stu-id="7ea01-291">You cannot initiate more than one download of <paramref name="groupName" /> at a time.</span></span></exception>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup(System.String)" />
        <related type="Article" href="/visualstudio/deployment/walkthrough-downloading-satellite-assemblies-on-demand-with-the-clickonce-deployment-api"><span data-ttu-id="7ea01-292">演练：使用 ClickOnce 部署 API 按需下载附属程序集</span><span class="sxs-lookup"><span data-stu-id="7ea01-292">Walkthrough: Downloading Satellite Assemblies on Demand with the ClickOnce Deployment API</span></span></related>
        <related type="Article" href="/visualstudio/deployment/clickonce-application-manifest"><span data-ttu-id="7ea01-293">ndptecclick</span><span class="sxs-lookup"><span data-stu-id="7ea01-293">ClickOnce Application Manifest</span></span></related>
        <related type="Article" href="/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications"><span data-ttu-id="7ea01-294">在 ClickOnce 应用程序中访问本地数据和远程数据</span><span class="sxs-lookup"><span data-stu-id="7ea01-294">Accessing Local and Remote Data in ClickOnce Applications</span></span></related>
        <related type="Article" href="/visualstudio/deployment/how-to-include-a-data-file-in-a-clickonce-application"><span data-ttu-id="7ea01-295">如何：将数据文件包括到 ClickOnce 应用程序中</span><span class="sxs-lookup"><span data-stu-id="7ea01-295">How to: Include a Data File in a ClickOnce Application</span></span></related>
        <related type="Article" href="/visualstudio/deployment/clickonce-cache-overview"><span data-ttu-id="7ea01-296">ClickOnce 缓存的体系结构</span><span class="sxs-lookup"><span data-stu-id="7ea01-296">Architecture of the ClickOnce Cache</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DownloadFileGroupAsyncCancel">
      <MemberSignature Language="C#" Value="public void DownloadFileGroupAsyncCancel (string groupName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void DownloadFileGroupAsyncCancel(string groupName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsyncCancel(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFileGroupAsyncCancel (groupName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFileGroupAsyncCancel(System::String ^ groupName);" />
      <MemberSignature Language="F#" Value="member this.DownloadFileGroupAsyncCancel : string -&gt; unit" Usage="applicationDeployment.DownloadFileGroupAsyncCancel groupName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="groupName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="groupName"><span data-ttu-id="7ea01-297">要下载的已命名文件组。</span><span class="sxs-lookup"><span data-stu-id="7ea01-297">The named group of files to download.</span></span> <span data-ttu-id="7ea01-298">在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中，标记为“可选”的所有文件均需具备组名称。</span><span class="sxs-lookup"><span data-stu-id="7ea01-298">All files marked "optional" in a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application require a group name.</span></span></param>
        <summary><span data-ttu-id="7ea01-299">取消异步文件下载。</span><span class="sxs-lookup"><span data-stu-id="7ea01-299">Cancels an asynchronous file download.</span></span></summary>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="7ea01-300"><paramref name="groupName" /> 不能为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-300"><paramref name="groupName" /> cannot be <see langword="null" />.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="DownloadFileGroupCompleted">
      <MemberSignature Language="C#" Value="public event System.Deployment.Application.DownloadFileGroupCompletedEventHandler DownloadFileGroupCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Deployment.Application.DownloadFileGroupCompletedEventHandler DownloadFileGroupCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event DownloadFileGroupCompleted As DownloadFileGroupCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Deployment::Application::DownloadFileGroupCompletedEventHandler ^ DownloadFileGroupCompleted;" />
      <MemberSignature Language="F#" Value="member this.DownloadFileGroupCompleted : System.Deployment.Application.DownloadFileGroupCompletedEventHandler " Usage="member this.DownloadFileGroupCompleted : System.Deployment.Application.DownloadFileGroupCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.DownloadFileGroupCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-301">完成一个文件下载时在主应用程序线程中发生。</span><span class="sxs-lookup"><span data-stu-id="7ea01-301">Occurs on the main application thread when a file download is complete.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-302">在主应用程序线程上调用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupCompleted> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-302">The <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupCompleted> event is called on the main application thread.</span></span> <span data-ttu-id="7ea01-303">在此回调中直接调用应用程序的 Windows 窗体控件是线程安全的。</span><span class="sxs-lookup"><span data-stu-id="7ea01-303">It is thread safe to call your application's Windows Forms controls directly within this callback.</span></span>

 <span data-ttu-id="7ea01-304">检查提供给此回调的 <xref:System.ComponentModel.AsyncCompletedEventArgs> 的 <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="7ea01-304">Check the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property of the <xref:System.ComponentModel.AsyncCompletedEventArgs> supplied to this callback.</span></span> <span data-ttu-id="7ea01-305">如果 `null`此属性，则下载成功;如果未 `null`，则说明安装未成功，您可以通过 <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> 属性找到有关安装失败的详细信息。</span><span class="sxs-lookup"><span data-stu-id="7ea01-305">If this property is `null`, the download was successful; if it is not `null`, the installation did not succeed, and you can find more information about the installation failure through the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property.</span></span>



## Examples
 <span data-ttu-id="7ea01-306">下面的代码示例在后台下载一组帮助文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-306">The following code example downloads a group of Help files in the background.</span></span> <span data-ttu-id="7ea01-307">该示例要求你部署一个包含 <xref:System.Windows.Forms.StatusStrip> 控件的 Windows 窗体应用程序，并且此控件包含一个名为 `downloadStatus`<xref:System.Windows.Forms.ToolStripStatusLabel> 控件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-307">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`.</span></span>

 [!code-cpp[ClickOnceAPI#8](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#8)]
 [!code-csharp[ClickOnceAPI#8](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#8)]
 [!code-vb[ClickOnceAPI#8](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#8)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="DownloadFileGroupProgressChanged">
      <MemberSignature Language="C#" Value="public event System.Deployment.Application.DeploymentProgressChangedEventHandler DownloadFileGroupProgressChanged;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Deployment.Application.DeploymentProgressChangedEventHandler DownloadFileGroupProgressChanged" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event DownloadFileGroupProgressChanged As DeploymentProgressChangedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Deployment::Application::DeploymentProgressChangedEventHandler ^ DownloadFileGroupProgressChanged;" />
      <MemberSignature Language="F#" Value="member this.DownloadFileGroupProgressChanged : System.Deployment.Application.DeploymentProgressChangedEventHandler " Usage="member this.DownloadFileGroupProgressChanged : System.Deployment.Application.DeploymentProgressChangedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.DeploymentProgressChangedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-308">当由 <see cref="Overload:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync" /> 调用启动的文件下载操作存在可用的状态信息时发生。</span><span class="sxs-lookup"><span data-stu-id="7ea01-308">Occurs when status information is available on a file download operation initiated by a call to <see cref="Overload:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-309">在主应用程序线程上调用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-309">The <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged> event is called on the main application thread.</span></span> <span data-ttu-id="7ea01-310">在此回调中直接调用应用程序的 Windows 窗体控件是线程安全的。</span><span class="sxs-lookup"><span data-stu-id="7ea01-310">It is thread safe to call your application's Windows Forms controls directly within this callback.</span></span>

 <span data-ttu-id="7ea01-311">使用 <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs> 中提供的信息将进度信息传递给用户。</span><span class="sxs-lookup"><span data-stu-id="7ea01-311">Use the information supplied in <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs> to communicate progress information to your users.</span></span>



## Examples
 <span data-ttu-id="7ea01-312">下面的代码示例在后台下载一组帮助文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-312">The following code example downloads a group of Help files in the background.</span></span> <span data-ttu-id="7ea01-313">该示例要求你部署一个包含 <xref:System.Windows.Forms.StatusStrip> 控件的 Windows 窗体应用程序，并且此控件包含一个名为 `downloadStatus`<xref:System.Windows.Forms.ToolStripStatusLabel> 控件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-313">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`.</span></span>

 [!code-cpp[ClickOnceAPI#8](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#8)]
 [!code-csharp[ClickOnceAPI#8](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#8)]
 [!code-vb[ClickOnceAPI#8](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#8)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="IsFileGroupDownloaded">
      <MemberSignature Language="C#" Value="public bool IsFileGroupDownloaded (string groupName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance bool IsFileGroupDownloaded(string groupName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.IsFileGroupDownloaded(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function IsFileGroupDownloaded (groupName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool IsFileGroupDownloaded(System::String ^ groupName);" />
      <MemberSignature Language="F#" Value="member this.IsFileGroupDownloaded : string -&gt; bool" Usage="applicationDeployment.IsFileGroupDownloaded groupName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="groupName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="groupName"><span data-ttu-id="7ea01-314">要下载的已命名文件组。</span><span class="sxs-lookup"><span data-stu-id="7ea01-314">The named group of files to download.</span></span> <span data-ttu-id="7ea01-315">在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序中，标记为“可选”的所有文件均需具备组名称。</span><span class="sxs-lookup"><span data-stu-id="7ea01-315">All files marked "optional" in a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application require a group name.</span></span></param>
        <summary><span data-ttu-id="7ea01-316">检查已命名的文件组是否已下载到客户端计算机中。</span><span class="sxs-lookup"><span data-stu-id="7ea01-316">Checks whether the named file group has already been downloaded to the client computer.</span></span></summary>
        <returns><span data-ttu-id="7ea01-317">如果已为此应用程序的当前版本下载了该文件组，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-317"><see langword="true" /> if the file group has already been downloaded for the current version of this application; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="7ea01-318">如果已安装了新版本的应用程序，而且新版本的应用程序未对文件组中的文件做任何添加、移除或更改，则 <see cref="M:System.Deployment.Application.ApplicationDeployment.IsFileGroupDownloaded(System.String)" /> 返回 <see langword="true" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-318">If a new version of the application has been installed, and the new version has not added, removed, or altered files in the file group, <see cref="M:System.Deployment.Application.ApplicationDeployment.IsFileGroupDownloaded(System.String)" /> returns <see langword="true" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-319"><xref:System.Deployment.Application.ApplicationDeployment.IsFileGroupDownloaded%2A> 在部分受信任的应用程序中工作，无需任何安全要求。</span><span class="sxs-lookup"><span data-stu-id="7ea01-319"><xref:System.Deployment.Application.ApplicationDeployment.IsFileGroupDownloaded%2A> works in a partially trusted application without any security demands.</span></span>

 <span data-ttu-id="7ea01-320">更新应用程序时，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 会将任何按需数据文件从以前版本复制到新版本的数据目录中。</span><span class="sxs-lookup"><span data-stu-id="7ea01-320">When you update an application, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] copies any on-demand data files from the previous version into the new version's data directory.</span></span> <span data-ttu-id="7ea01-321">如果下载这些文件的新版本，应从旧版本中删除任何要保留的数据，并将其移到新版本中。</span><span class="sxs-lookup"><span data-stu-id="7ea01-321">If you download a new version of these files, you should remove any data you want to keep from the old version and move it into the new version.</span></span>



## Examples
 <span data-ttu-id="7ea01-322">下面的代码示例将 `HelpFiles` 组中的所有文件下载到磁盘。</span><span class="sxs-lookup"><span data-stu-id="7ea01-322">The following code example downloads all of the files in the `HelpFiles` group to disk.</span></span>

 [!code-cpp[ClickOnceAPI#8](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#8)]
 [!code-csharp[ClickOnceAPI#8](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#8)]
 [!code-vb[ClickOnceAPI#8](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#8)]

 ]]></format>
        </remarks>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="7ea01-323"><paramref name="groupName" /> 不是应用程序清单中定义的文件组。</span><span class="sxs-lookup"><span data-stu-id="7ea01-323"><paramref name="groupName" /> is not a file group defined in the application manifest.</span></span></exception>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup(System.String)" />
        <altmember cref="Overload:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync" />
      </Docs>
    </Member>
    <Member MemberName="IsFirstRun">
      <MemberSignature Language="C#" Value="public bool IsFirstRun { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool IsFirstRun" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.IsFirstRun" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property IsFirstRun As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool IsFirstRun { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.IsFirstRun : bool" Usage="System.Deployment.Application.ApplicationDeployment.IsFirstRun" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-324">获取一个值，该值指示此应用程序是否是第一次在客户端计算机上运行。</span><span class="sxs-lookup"><span data-stu-id="7ea01-324">Gets a value indicating whether this is the first time this application has run on the client computer.</span></span></summary>
        <value><span data-ttu-id="7ea01-325">如果此版本的应用程序此前未在客户端计算机上运行过，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-325"><see langword="true" /> if this version of the application has never run on the client computer before; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-326">使用 <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> 确定是否需要在首次运行应用程序时执行任何一次性的初始化操作。</span><span class="sxs-lookup"><span data-stu-id="7ea01-326">Use <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> to determine whether you need to perform any one-time initialization operations the first time your application runs.</span></span>

 <span data-ttu-id="7ea01-327">不要假定 <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> 设置为 `true` 指示应用程序的这一实例是向用户显示其用户界面的第一个实例。</span><span class="sxs-lookup"><span data-stu-id="7ea01-327">Do not assume that a <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> setting of `true` indicates that this instance of an application is the first one to show its user interface to the user.</span></span> <span data-ttu-id="7ea01-328">由于系统计划进程的方式，应用程序的一个实例可能会将其 <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> 属性设置为 "`true`，但是另一个实例可能是第一个在屏幕上呈现的实例。</span><span class="sxs-lookup"><span data-stu-id="7ea01-328">Due to the way the system schedules processes, one instance of the application may have its <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> property set to `true`, but another instance may be the first to render on the screen.</span></span> <span data-ttu-id="7ea01-329">每当用户从一个版本升级到下一个版本时，此属性的值就会重置。</span><span class="sxs-lookup"><span data-stu-id="7ea01-329">The value of this property is reset whenever the user upgrades from one version to the next.</span></span> <span data-ttu-id="7ea01-330">如果只想在运行应用程序的任何版本时执行操作，则需要执行其他测试，如检查是否存在首次创建的文件，或使用**应用程序设置**存储标志。</span><span class="sxs-lookup"><span data-stu-id="7ea01-330">If you want to perform an operation only the very first time any version of the application is run, you will need to perform an additional test, such as checking for the existence of a file you created the first time, or storing a flag using **Application Settings**.</span></span>



## Examples
 <span data-ttu-id="7ea01-331">下面的代码示例使用 <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> 来确定是否要检查文件组 `HelpFiles`的更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-331">The following code example uses <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> to decide whether to check for an update to the file group `HelpFiles`.</span></span> <span data-ttu-id="7ea01-332">如果一个或多个文件已更新，它将调用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 以获取新版本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-332">If one or more of the files have been updated, it calls <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> to obtain the new versions.</span></span>

 [!code-csharp[ClickOnceAPI#9](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#9)]
 [!code-vb[ClickOnceAPI#9](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#9)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="IsNetworkDeployed">
      <MemberSignature Language="C#" Value="public static bool IsNetworkDeployed { get; }" />
      <MemberSignature Language="ILAsm" Value=".property bool IsNetworkDeployed" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property IsNetworkDeployed As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool IsNetworkDeployed { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.IsNetworkDeployed : bool" Usage="System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-333">获取一个值，该值指示当前应用程序是否为 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-333">Gets a value indicating whether the current application is a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application.</span></span></summary>
        <value><span data-ttu-id="7ea01-334">如果该应用程序是 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-334"><see langword="true" /> if this is a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-335">如果你希望应用程序在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 部署的内部和外部运行（例如，如果你需要在部署之前在本地计算机上调试应用程序），请先测试 <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A>，然后再访问 <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="7ea01-335">If you want your application to run both inside and outside of a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] deployment (for example, if you need to debug your application on the local computer before deploying it), test <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> before accessing the <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> property.</span></span>

 <span data-ttu-id="7ea01-336">无论应用程序是联机安装还是托管，<xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> 都将返回 `true`，无论该应用程序是从网站、文件共享还是 CD-ROM 安装的，都是如此。</span><span class="sxs-lookup"><span data-stu-id="7ea01-336"><xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> will return `true` regardless of whether the application is installed or hosted online, and regardless of whether it was installed from a Web site, file share, or CD-ROM.</span></span>



## Examples
 <span data-ttu-id="7ea01-337">下面的代码示例首先使用 <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> 检索 <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A>，以确保不 `null`引用。</span><span class="sxs-lookup"><span data-stu-id="7ea01-337">The following code example retrieves <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> by using <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> first to ensure that the reference is not `null`.</span></span>

 [!code-cpp[ClickOnceAPI#2](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#2)]
 [!code-csharp[ClickOnceAPI#2](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#2)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="TimeOfLastUpdateCheck">
      <MemberSignature Language="C#" Value="public DateTime TimeOfLastUpdateCheck { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime TimeOfLastUpdateCheck" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.TimeOfLastUpdateCheck" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property TimeOfLastUpdateCheck As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime TimeOfLastUpdateCheck { DateTime get(); };" />
      <MemberSignature Language="F#" Value="member this.TimeOfLastUpdateCheck : DateTime" Usage="System.Deployment.Application.ApplicationDeployment.TimeOfLastUpdateCheck" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-338">获取 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 上次检查应用程序更新时的日期和时间。</span><span class="sxs-lookup"><span data-stu-id="7ea01-338">Gets the date and the time [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] last checked for an application update.</span></span></summary>
        <value><span data-ttu-id="7ea01-339">上次更新检查的 <see cref="T:System.DateTime" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-339">The <see cref="T:System.DateTime" /> of the last update check.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-340">可以为订阅更新配置 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-340">A [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application can be configured for subscription updates.</span></span> <span data-ttu-id="7ea01-341">在此方案中，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 按部署清单中定义的时间间隔自动轮询应用程序的部署位置，并确定是否有可用的更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-341">In this scenario, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] polls an application's deployment location automatically at intervals defined in the deployment manifest, and determines whether there is an update available.</span></span> <span data-ttu-id="7ea01-342"><xref:System.Deployment.Application.ApplicationDeployment.TimeOfLastUpdateCheck%2A> 返回上次更新检查的时间，而不考虑它是由订阅启动还是通过使用 <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A>、<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A>、<xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A>、<xref:System.Deployment.Application.ApplicationDeployment.Update%2A>或 <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> 方法的显式检查来启动。</span><span class="sxs-lookup"><span data-stu-id="7ea01-342"><xref:System.Deployment.Application.ApplicationDeployment.TimeOfLastUpdateCheck%2A> returns the time of the last update check regardless of whether it was initiated by a subscription or by an explicit check using the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A>, <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A>, <xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A>, <xref:System.Deployment.Application.ApplicationDeployment.Update%2A>, or <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> method.</span></span>

 <span data-ttu-id="7ea01-343">如果自安装应用程序后未执行任何更新检查，<xref:System.Deployment.Application.ApplicationDeployment.TimeOfLastUpdateCheck%2A> 将返回安装时间。</span><span class="sxs-lookup"><span data-stu-id="7ea01-343">If no update check has been performed since the application was installed, <xref:System.Deployment.Application.ApplicationDeployment.TimeOfLastUpdateCheck%2A> returns the installation time.</span></span>



## Examples
 <span data-ttu-id="7ea01-344">下面的代码示例检查是否在过去三天内检查了 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序的可用更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-344">The following code example checks whether a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application has been checked for available updates in the past three days.</span></span>

 [!code-cpp[ClickOnceAPI#3](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#3)]
 [!code-csharp[ClickOnceAPI#3](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#3)]
 [!code-vb[ClickOnceAPI#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#3)]

 ]]></format>
        </remarks>
        <related type="Article" href="/visualstudio/deployment/choosing-a-clickonce-update-strategy"><span data-ttu-id="7ea01-345">选择 ClickOnce 更新策略</span><span class="sxs-lookup"><span data-stu-id="7ea01-345">Choosing a ClickOnce Update Strategy</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Update">
      <MemberSignature Language="C#" Value="public bool Update ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance bool Update() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.Update" />
      <MemberSignature Language="VB.NET" Value="Public Function Update () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool Update();" />
      <MemberSignature Language="F#" Value="member this.Update : unit -&gt; bool" Usage="applicationDeployment.Update " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="7ea01-346">开始同步下载和安装此应用程序的最新版本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-346">Starts a synchronous download and installation of the latest version of this application.</span></span></summary>
        <returns><span data-ttu-id="7ea01-347">如果应用程序已更新，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-347"><see langword="true" /> if an application has been updated; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-348">当你将新版本的应用程序发布到 <xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>指定的位置，并且应用程序的部署清单中的版本号大于用户计算机上当前安装的应用程序的版本号时，应用程序将被视为已更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-348">An application is considered updated when you publish a new version of the application to the location specified by <xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>, and the version number in the application's deployment manifest is greater than the version number of the application currently installed on the user's computer.</span></span>

 <span data-ttu-id="7ea01-349">在更新已下载到客户端计算机并安装到 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 缓存中之前，<xref:System.Deployment.Application.ApplicationDeployment.Update%2A> 调用将会被阻止。在这段时间内，应用程序将不会响应用户。</span><span class="sxs-lookup"><span data-stu-id="7ea01-349">The <xref:System.Deployment.Application.ApplicationDeployment.Update%2A> call will block until the update has been downloaded to the client computer and installed into the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] cache; during this time, the application will not be responsive to the user.</span></span> <span data-ttu-id="7ea01-350">如果要在下载过程中保持应用程序响应或显示进度报告，请改用 <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="7ea01-350">If you want to maintain application responsiveness or display a progress report during download, use the <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> method instead.</span></span>

 <span data-ttu-id="7ea01-351"><xref:System.Deployment.Application.ApplicationDeployment.Update%2A> 下载应用程序清单中未标记为 "可选" 的所有文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-351"><xref:System.Deployment.Application.ApplicationDeployment.Update%2A> downloads all of the files that are not marked as "optional" in the application manifest.</span></span> <span data-ttu-id="7ea01-352">您可以通过使用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 或 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> 方法按需下载可选文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-352">You can download optional files on demand by using the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> or the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method.</span></span>

 <span data-ttu-id="7ea01-353">调用 <xref:System.Deployment.Application.ApplicationDeployment.Update%2A> 方法时，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 可能已自动更新应用程序;如果发生这种情况，调用此方法会引发 <xref:System.InvalidOperationException>。</span><span class="sxs-lookup"><span data-stu-id="7ea01-353">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] may already be updating the application automatically when you call the <xref:System.Deployment.Application.ApplicationDeployment.Update%2A> method; if that happens, calls to this method will throw an <xref:System.InvalidOperationException>.</span></span>

 <span data-ttu-id="7ea01-354">如果已更新部署中的一个或多个文件，但尚未刷新应用程序清单，则会收到 <xref:System.Deployment.Application.InvalidDeploymentException>。</span><span class="sxs-lookup"><span data-stu-id="7ea01-354">If you have updated one or more files in your deployment, but you have not refreshed your application manifest, you will receive an <xref:System.Deployment.Application.InvalidDeploymentException>.</span></span> <span data-ttu-id="7ea01-355">大多数情况下，重新部署 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序就能解决此问题。</span><span class="sxs-lookup"><span data-stu-id="7ea01-355">Most of the time, redeploying your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application solves this problem.</span></span> <span data-ttu-id="7ea01-356">如果部署清单或应用程序清单上的公钥签名无效或缺失，您也会收到此异常。</span><span class="sxs-lookup"><span data-stu-id="7ea01-356">You will also receive this exception if a public-key signature on a deployment manifest or application manifest is invalid or missing.</span></span>

 <span data-ttu-id="7ea01-357">更新可能会在本地计算机上请求比应用程序的以前版本更高的信任级别。</span><span class="sxs-lookup"><span data-stu-id="7ea01-357">An update may request a higher level of trust on the local computer than the previous version of the application.</span></span> <span data-ttu-id="7ea01-358">如果应用程序使用受信任的应用程序部署，则公共语言运行时（CLR）信任关系管理器将检查部署清单，以确定它是否包含有效的信任许可证。</span><span class="sxs-lookup"><span data-stu-id="7ea01-358">If the application uses Trusted Application Deployment, the common language runtime (CLR) trust manager examines the deployment manifest to determine whether it contains a valid trust license.</span></span> <span data-ttu-id="7ea01-359">如果部署清单不包含有效的信任许可证，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 将停止安装并引发 <xref:System.Deployment.Application.TrustNotGrantedException>。</span><span class="sxs-lookup"><span data-stu-id="7ea01-359">If the deployment manifest does not contain a valid trust license, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] stops the installation and throws a <xref:System.Deployment.Application.TrustNotGrantedException>.</span></span> <span data-ttu-id="7ea01-360"><xref:System.Deployment.Application.ApplicationDeployment.Update%2A> 方法将不会显示询问用户是否要授予应用程序运行权限的提示。</span><span class="sxs-lookup"><span data-stu-id="7ea01-360">The <xref:System.Deployment.Application.ApplicationDeployment.Update%2A> method will never display a prompt asking the user whether they want to grant the application permission to run.</span></span>



## Examples
 <span data-ttu-id="7ea01-361">下面的代码示例检查应用程序更新;如果更新可用，则它会同步安装。</span><span class="sxs-lookup"><span data-stu-id="7ea01-361">The following code example checks for an application update; if an update is available, it installs it synchronously.</span></span>

 [!code-cpp[ClickOnceAPI#6](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#6)]
 [!code-csharp[ClickOnceAPI#6](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#6)]
 [!code-vb[ClickOnceAPI#6](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#6)]

 ]]></format>
        </remarks>
        <exception cref="T:System.Deployment.Application.TrustNotGrantedException"><span data-ttu-id="7ea01-362">本地计算机未授予该应用程序执行其请求的操作所需的权限级别。</span><span class="sxs-lookup"><span data-stu-id="7ea01-362">The local computer did not grant the application the permission level it requested to execute.</span></span></exception>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="7ea01-363">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 部署已损坏。</span><span class="sxs-lookup"><span data-stu-id="7ea01-363">Your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] deployment is corrupted.</span></span> <span data-ttu-id="7ea01-364">有关如何诊断和更正问题的提示，请参阅 [ClickOnce 部署疑难解答](/visualstudio/deployment/troubleshooting-clickonce-deployments)。</span><span class="sxs-lookup"><span data-stu-id="7ea01-364">For tips on how to diagnose and correct the problem, see [Troubleshooting ClickOnce Deployments](/visualstudio/deployment/troubleshooting-clickonce-deployments).</span></span></exception>
        <exception cref="T:System.Deployment.Application.DeploymentDownloadException"><span data-ttu-id="7ea01-365">未能从其网络位置下载新部署。</span><span class="sxs-lookup"><span data-stu-id="7ea01-365">The new deployment could not be downloaded from its location on the network.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="7ea01-366">当前应用程序正在更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-366">The application is currently being updated.</span></span></exception>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate" />
        <related type="Article" href="/visualstudio/deployment/choosing-a-clickonce-update-strategy"><span data-ttu-id="7ea01-367">选择 ClickOnce 更新策略</span><span class="sxs-lookup"><span data-stu-id="7ea01-367">Choosing a ClickOnce Update Strategy</span></span></related>
        <related type="Article" href="/visualstudio/deployment/securing-clickonce-applications"><span data-ttu-id="7ea01-368">ClickOnce 部署和安全</span><span class="sxs-lookup"><span data-stu-id="7ea01-368">ClickOnce Deployment and Security</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="UpdateAsync">
      <MemberSignature Language="C#" Value="public void UpdateAsync ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void UpdateAsync() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" />
      <MemberSignature Language="VB.NET" Value="Public Sub UpdateAsync ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UpdateAsync();" />
      <MemberSignature Language="F#" Value="member this.UpdateAsync : unit -&gt; unit" Usage="applicationDeployment.UpdateAsync " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="7ea01-369">开始异步下载和安装此应用程序的最新版本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-369">Starts an asynchronous download and installation of the latest version of this application.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-370">当你将新版本的应用程序发布到 <xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>指定的位置，并且应用程序的部署清单中的版本号大于用户计算机上当前安装的应用程序的版本号时，应用程序将被视为已更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-370">An application is considered updated when you publish a new version of the application to the location specified by <xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>, and the version number in the application's deployment manifest is greater than the version number of the application currently installed on the user's computer.</span></span>

 <span data-ttu-id="7ea01-371">在下载更新时，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 将在主应用程序线程上引发 <xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged> 事件处理程序，以通知你下载的状态。</span><span class="sxs-lookup"><span data-stu-id="7ea01-371">While downloading the update, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will raise the <xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged> event handler on the main application thread to inform you of the status of the download.</span></span> <span data-ttu-id="7ea01-372">当异步更新完成或遇到异常时，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 将在主应用程序线程上引发 <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-372">When the asynchronous update finishes or encounters an exception, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will raise the <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted> event on the main application thread.</span></span> <span data-ttu-id="7ea01-373">检查提供给此事件的 <xref:System.ComponentModel.AsyncCompletedEventArgs>，以确定更新是否成功。</span><span class="sxs-lookup"><span data-stu-id="7ea01-373">Examine the <xref:System.ComponentModel.AsyncCompletedEventArgs> supplied to this event to determine whether the update succeeded.</span></span>

 <span data-ttu-id="7ea01-374">如果 <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> 引发异常，则 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 调用 <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted>，并将 <xref:System.ComponentModel.AsyncCompletedEventArgs> 的 <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> 属性设置为引发的异常。</span><span class="sxs-lookup"><span data-stu-id="7ea01-374">If <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> throws an exception, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] calls <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted> and sets the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property of <xref:System.ComponentModel.AsyncCompletedEventArgs> to the exception that was thrown.</span></span>

 <span data-ttu-id="7ea01-375"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> 将下载部署中的所有文件，这些文件在应用程序清单中未标记为 "可选"。</span><span class="sxs-lookup"><span data-stu-id="7ea01-375"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> will download all files in a deployment not marked as "optional" in the application manifest.</span></span> <span data-ttu-id="7ea01-376">您可以通过使用 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 或 <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> 方法按需下载可选文件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-376">You can download optional files on demand by using the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> or the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method.</span></span>

 <span data-ttu-id="7ea01-377">调用 <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> 方法时，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 可能已自动更新应用程序;如果发生这种情况，调用此方法会引发 <xref:System.InvalidOperationException>。</span><span class="sxs-lookup"><span data-stu-id="7ea01-377">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] may already be updating the application automatically when you call the <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> method; if that happens, calls to this method will throw an <xref:System.InvalidOperationException>.</span></span>

 <span data-ttu-id="7ea01-378">如果已更新部署中的一个或多个文件，但尚未刷新应用程序清单，则会收到 <xref:System.Deployment.Application.InvalidDeploymentException>。</span><span class="sxs-lookup"><span data-stu-id="7ea01-378">If you have updated one or more files in your deployment, but you have not refreshed your application manifest, you will receive an <xref:System.Deployment.Application.InvalidDeploymentException>.</span></span> <span data-ttu-id="7ea01-379">大多数情况下，重新生成应用程序清单会解决此问题。</span><span class="sxs-lookup"><span data-stu-id="7ea01-379">Most of the time, rebuilding your application manifest solves this problem.</span></span> <span data-ttu-id="7ea01-380">如果部署清单或应用程序清单上的公钥签名无效或缺失，您也会收到此异常。</span><span class="sxs-lookup"><span data-stu-id="7ea01-380">You will also receive this exception if a public-key signature on a deployment manifest or application manifest is invalid or missing.</span></span>

 <span data-ttu-id="7ea01-381">更新可能会在本地计算机上请求比应用程序的以前版本更高的信任级别。</span><span class="sxs-lookup"><span data-stu-id="7ea01-381">An update may request a higher level of trust on the local computer than the previous version of the application.</span></span> <span data-ttu-id="7ea01-382">如果应用程序使用受信任的应用程序部署，则公共语言运行时（CLR）信任关系管理器将检查部署清单，以确定它是否包含有效的信任许可证。</span><span class="sxs-lookup"><span data-stu-id="7ea01-382">If the application uses Trusted Application Deployment, the common language runtime (CLR) trust manager examines the deployment manifest to determine whether it contains a valid trust license.</span></span> <span data-ttu-id="7ea01-383">如果部署清单不包含有效的信任许可证，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 将停止安装并引发 <xref:System.Deployment.Application.TrustNotGrantedException>。</span><span class="sxs-lookup"><span data-stu-id="7ea01-383">If the deployment manifest does not contain a valid trust license, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] stops the installation and throws a <xref:System.Deployment.Application.TrustNotGrantedException>.</span></span> <span data-ttu-id="7ea01-384"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> 将不会显示询问用户是否要授予应用程序运行权限的提示。</span><span class="sxs-lookup"><span data-stu-id="7ea01-384"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> will never display a prompt asking the user if they want to grant the application permission to run.</span></span>



## Examples
 <span data-ttu-id="7ea01-385">下面的代码示例确定新的更新在应用程序加载时是否可用;如果有必需的更新，则它会以异步方式安装更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-385">The following code example determines whether a new update is available at application load time; if a required update is available, it installs the update asynchronously.</span></span> <span data-ttu-id="7ea01-386">该示例要求你部署一个包含 <xref:System.Windows.Forms.StatusStrip> 控件的 Windows 窗体应用程序，并且此控件包含一个名为 `downloadStatus`<xref:System.Windows.Forms.ToolStripStatusLabel> 控件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-386">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`.</span></span>

 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]

 ]]></format>
        </remarks>
        <exception cref="T:System.Deployment.Application.TrustNotGrantedException"><span data-ttu-id="7ea01-387">本地计算机未授予此应用程序执行其请求的操作所需的权限级别。</span><span class="sxs-lookup"><span data-stu-id="7ea01-387">The local computer did not grant this application the permission level it requested to execute.</span></span></exception>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="7ea01-388">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 部署已损坏。</span><span class="sxs-lookup"><span data-stu-id="7ea01-388">Your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] deployment is corrupted.</span></span> <span data-ttu-id="7ea01-389">有关如何诊断和更正问题的提示，请参阅 [ClickOnce 部署疑难解答](/visualstudio/deployment/troubleshooting-clickonce-deployments)。</span><span class="sxs-lookup"><span data-stu-id="7ea01-389">For tips on how to diagnose and correct the problem, see [Troubleshooting ClickOnce Deployments](/visualstudio/deployment/troubleshooting-clickonce-deployments).</span></span></exception>
        <exception cref="T:System.Deployment.Application.DeploymentDownloadException"><span data-ttu-id="7ea01-390">未能从其网络位置下载新部署。</span><span class="sxs-lookup"><span data-stu-id="7ea01-390">The new deployment could not be downloaded from its location on the network.</span></span></exception>
        <altmember cref="E:System.Deployment.Application.ApplicationDeployment.UpdateCompleted" />
        <related type="Article" href="/visualstudio/deployment/choosing-a-clickonce-update-strategy"><span data-ttu-id="7ea01-391">选择 ClickOnce 更新策略</span><span class="sxs-lookup"><span data-stu-id="7ea01-391">Choosing a ClickOnce Update Strategy</span></span></related>
        <related type="Article" href="/visualstudio/deployment/securing-clickonce-applications"><span data-ttu-id="7ea01-392">ClickOnce 部署和安全</span><span class="sxs-lookup"><span data-stu-id="7ea01-392">ClickOnce Deployment and Security</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="UpdateAsyncCancel">
      <MemberSignature Language="C#" Value="public void UpdateAsyncCancel ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void UpdateAsyncCancel() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.UpdateAsyncCancel" />
      <MemberSignature Language="VB.NET" Value="Public Sub UpdateAsyncCancel ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UpdateAsyncCancel();" />
      <MemberSignature Language="F#" Value="member this.UpdateAsyncCancel : unit -&gt; unit" Usage="applicationDeployment.UpdateAsyncCancel " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="7ea01-393">取消由 <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" /> 启动的异步更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-393">Cancels an asynchronous update initiated by <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-394"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsyncCancel%2A> 仅取消通过调用 <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>启动的更新;它不会取消作为订阅的一部分启动的更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-394"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsyncCancel%2A> only cancels an update initiated by a call to <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>; it does not cancel an update started as part of a subscription.</span></span>

 ]]></format>
        </remarks>
        <related type="Article" href="/visualstudio/deployment/choosing-a-clickonce-update-strategy"><span data-ttu-id="7ea01-395">选择 ClickOnce 更新策略</span><span class="sxs-lookup"><span data-stu-id="7ea01-395">Choosing a ClickOnce Update Strategy</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="UpdateCompleted">
      <MemberSignature Language="C#" Value="public event System.ComponentModel.AsyncCompletedEventHandler UpdateCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.ComponentModel.AsyncCompletedEventHandler UpdateCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.UpdateCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event UpdateCompleted As AsyncCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::ComponentModel::AsyncCompletedEventHandler ^ UpdateCompleted;" />
      <MemberSignature Language="F#" Value="member this.UpdateCompleted : System.ComponentModel.AsyncCompletedEventHandler " Usage="member this.UpdateCompleted : System.ComponentModel.AsyncCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.ComponentModel.AsyncCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-396">当 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 通过调用 <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" /> 完成了应用程序升级时发生。</span><span class="sxs-lookup"><span data-stu-id="7ea01-396">Occurs when [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] has finished upgrading the application as the result of a call to <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-397">在主应用程序线程上调用 <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-397">The <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted> event is called on the main application thread.</span></span> <span data-ttu-id="7ea01-398">你可以直接在此回调内调用应用程序的 Windows 窗体控件，而不会触发异常。</span><span class="sxs-lookup"><span data-stu-id="7ea01-398">You may call your application's Windows Forms controls directly within this callback without triggering an exception.</span></span>

 <span data-ttu-id="7ea01-399">检查提供给此回调的 <xref:System.ComponentModel.AsyncCompletedEventArgs> 的 <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="7ea01-399">Check the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property of the <xref:System.ComponentModel.AsyncCompletedEventArgs> supplied to this callback.</span></span> <span data-ttu-id="7ea01-400">如果 `null`此属性，则安装成功;如果未 `null`，则说明安装未成功，您可以通过 <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> 属性找到有关此安装失败的详细信息。</span><span class="sxs-lookup"><span data-stu-id="7ea01-400">If this property is `null`, the installation was successful; if it is not `null`, the installation did not succeed, and you can find more information about this installation failure through the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property.</span></span> <span data-ttu-id="7ea01-401">下载更新后，你将需要对 <xref:System.Windows.Forms.Application> 调用 <xref:System.Windows.Forms.Application.Restart%2A> 方法，以使用较新版本的应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-401">Once the update has been downloaded, you will need to call the <xref:System.Windows.Forms.Application.Restart%2A> method on the <xref:System.Windows.Forms.Application> to use the newer version of the application.</span></span>

 <span data-ttu-id="7ea01-402">如果通过调用 <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsyncCancel%2A>取消了更新的安装，则将 `true`<xref:System.ComponentModel.AsyncCompletedEventArgs> 类的 <xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="7ea01-402">If the installation of the update was canceled by a call to <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsyncCancel%2A>, the <xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A> property of the <xref:System.ComponentModel.AsyncCompletedEventArgs> class will be `true`.</span></span>

 <span data-ttu-id="7ea01-403">若要使用此事件处理程序，你的应用程序必须同时导入 <xref:System.Deployment.Application> 和 <xref:System.ComponentModel> 命名空间。</span><span class="sxs-lookup"><span data-stu-id="7ea01-403">To use this event handler, your application must import both the <xref:System.Deployment.Application> and <xref:System.ComponentModel> namespaces.</span></span>



## Examples
 <span data-ttu-id="7ea01-404">下面的代码示例在应用程序加载时确定是否有新的更新可用;如果有必需的更新，则它会以异步方式安装更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-404">The following code example determines at application load time whether a new update is available; if a required update is available, it installs the update asynchronously.</span></span> <span data-ttu-id="7ea01-405">该示例要求你部署一个包含 <xref:System.Windows.Forms.StatusStrip> 控件的 Windows 窗体应用程序，并且此控件包含一个名为 `downloadStatus`<xref:System.Windows.Forms.ToolStripStatusLabel> 控件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-405">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`.</span></span>

 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="UpdatedApplicationFullName">
      <MemberSignature Language="C#" Value="public string UpdatedApplicationFullName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string UpdatedApplicationFullName" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.UpdatedApplicationFullName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property UpdatedApplicationFullName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ UpdatedApplicationFullName { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.UpdatedApplicationFullName : string" Usage="System.Deployment.Application.ApplicationDeployment.UpdatedApplicationFullName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-406">获取应用程序更新后的全名。</span><span class="sxs-lookup"><span data-stu-id="7ea01-406">Gets the full name of the application after it has been updated.</span></span></summary>
        <value><span data-ttu-id="7ea01-407">一个包含应用程序的全名的 <see cref="T:System.String" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-407">A <see cref="T:System.String" /> that contains the full name of the application.</span></span></value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="UpdatedVersion">
      <MemberSignature Language="C#" Value="public Version UpdatedVersion { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Version UpdatedVersion" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.UpdatedVersion" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property UpdatedVersion As Version" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Version ^ UpdatedVersion { Version ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.UpdatedVersion : Version" Usage="System.Deployment.Application.ApplicationDeployment.UpdatedVersion" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Version</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-408">获取最近下载的更新版本。</span><span class="sxs-lookup"><span data-stu-id="7ea01-408">Gets the version of the update that was recently downloaded.</span></span></summary>
        <value><span data-ttu-id="7ea01-409">描述更新版本的 <see cref="T:System.Version" />。</span><span class="sxs-lookup"><span data-stu-id="7ea01-409">The <see cref="T:System.Version" /> describing the version of the update.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-410">如果已安装新的更新，但尚未在 <xref:System.Windows.Forms.Application>上调用 <xref:System.Windows.Forms.Application.Restart%2A>，则 <xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A> 与 <xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A> 不同。</span><span class="sxs-lookup"><span data-stu-id="7ea01-410"><xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A> differs from <xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A> if a new update has been installed but you have not yet called <xref:System.Windows.Forms.Application.Restart%2A> on the <xref:System.Windows.Forms.Application>.</span></span> <span data-ttu-id="7ea01-411">如果将应用程序的部署清单配置为执行自动更新，可以比较这两个值，以确定是否应重新启动应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-411">If the application's deployment manifest is configured to perform automatic updates, you can compare these two values to determine whether you should restart the application.</span></span>

 <span data-ttu-id="7ea01-412">如果应用程序尚未更新，<xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A> 将返回与 <xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A>相同的值。</span><span class="sxs-lookup"><span data-stu-id="7ea01-412">If the application has not been updated, <xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A> returns the same value as <xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A>.</span></span>



## Examples
 <span data-ttu-id="7ea01-413">下面的代码示例定义了一个方法，该方法确定 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 是否更新了应用程序。</span><span class="sxs-lookup"><span data-stu-id="7ea01-413">The following code example defines a method that determines whether [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] has updated the application.</span></span>

 [!code-cpp[ClickOnceAPI#4](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#4)]
 [!code-csharp[ClickOnceAPI#4](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#4)]
 [!code-vb[ClickOnceAPI#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#4)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="UpdateLocation">
      <MemberSignature Language="C#" Value="public Uri UpdateLocation { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Uri UpdateLocation" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property UpdateLocation As Uri" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Uri ^ UpdateLocation { Uri ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.UpdateLocation : Uri" Usage="System.Deployment.Application.ApplicationDeployment.UpdateLocation" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Uri</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-414">获取此应用程序从中更新自身的网站或文件共享。</span><span class="sxs-lookup"><span data-stu-id="7ea01-414">Gets the Web site or file share from which this application updates itself.</span></span></summary>
        <value><span data-ttu-id="7ea01-415">以 HTTP、HTTPS 或文件 URL 表示的更新路径；或以 Windows 网络文件路径 (UNC) 表示的更新路径。</span><span class="sxs-lookup"><span data-stu-id="7ea01-415">The update path, expressed as an HTTP, HTTPS, or file URL; or as a Windows network file path (UNC).</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-416">最初，如果应用程序的部署配置为使用更新重定向，则 <xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A> 可能不同于用于下载应用程序的网站。</span><span class="sxs-lookup"><span data-stu-id="7ea01-416"><xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A> may be different from the Web site used to download the application initially if the application's deployment is configured to use update redirection.</span></span>

 <span data-ttu-id="7ea01-417">只能在应用程序的部署清单中更改此值。</span><span class="sxs-lookup"><span data-stu-id="7ea01-417">This value can be changed only in the application's deployment manifest.</span></span>

 ]]></format>
        </remarks>
        <related type="Article" href="/visualstudio/deployment/how-to-specify-an-alternate-location-for-deployment-updates"><span data-ttu-id="7ea01-418">如何：指定部署更新的其他位置</span><span class="sxs-lookup"><span data-stu-id="7ea01-418">How to: Specify an Alternate Location for Deployment Updates</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="UpdateProgressChanged">
      <MemberSignature Language="C#" Value="public event System.Deployment.Application.DeploymentProgressChangedEventHandler UpdateProgressChanged;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Deployment.Application.DeploymentProgressChangedEventHandler UpdateProgressChanged" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event UpdateProgressChanged As DeploymentProgressChangedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Deployment::Application::DeploymentProgressChangedEventHandler ^ UpdateProgressChanged;" />
      <MemberSignature Language="F#" Value="member this.UpdateProgressChanged : System.Deployment.Application.DeploymentProgressChangedEventHandler " Usage="member this.UpdateProgressChanged : System.Deployment.Application.DeploymentProgressChangedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.DeploymentProgressChangedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="7ea01-419">对于通过调用 <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" /> 方法启动的更新操作，当 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 存在关于此更新操作的新的状态信息时发生。</span><span class="sxs-lookup"><span data-stu-id="7ea01-419">Occurs when [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] has new status information for an update operation initiated by calling the <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" /> method.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 <span data-ttu-id="7ea01-420">在主应用程序线程上调用 <xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged> 事件。</span><span class="sxs-lookup"><span data-stu-id="7ea01-420">The <xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged> event is called on the main application thread.</span></span> <span data-ttu-id="7ea01-421">你可以直接在此回调内调用应用程序的 Windows 窗体控件，而不会触发异常。</span><span class="sxs-lookup"><span data-stu-id="7ea01-421">You may call your application's Windows Forms controls directly within this callback without triggering an exception.</span></span>



## Examples
 <span data-ttu-id="7ea01-422">下面的代码示例在应用程序加载时确定是否有新的更新可用;如果有必需的更新，则它会以异步方式安装更新。</span><span class="sxs-lookup"><span data-stu-id="7ea01-422">The following code example determines at application load time whether a new update is available; if a required update is available, it installs the update asynchronously.</span></span>

 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]

 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>
