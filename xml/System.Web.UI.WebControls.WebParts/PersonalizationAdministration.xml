<Type Name="PersonalizationAdministration" FullName="System.Web.UI.WebControls.WebParts.PersonalizationAdministration">
  <Metadata><Meta Name="ms.openlocfilehash" Value="670677b18ae130dd3a811279c0907cc911b604a9" /><Meta Name="ms.sourcegitcommit" Value="b53d35b4a410c949742abd4c6a989d1af5357bca" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="07/21/2020" /><Meta Name="ms.locfileid" Value="86628496" /></Metadata><TypeSignature Language="C#" Value="public static class PersonalizationAdministration" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi abstract sealed beforefieldinit PersonalizationAdministration extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Web.UI.WebControls.WebParts.PersonalizationAdministration" />
  <TypeSignature Language="VB.NET" Value="Public Class PersonalizationAdministration" />
  <TypeSignature Language="C++ CLI" Value="public ref class PersonalizationAdministration abstract sealed" />
  <TypeSignature Language="F#" Value="type PersonalizationAdministration = class" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>为 Web 部件的个性化设置实现管理功能。 此类不能被继承。</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[

## Remarks
 此类提供多个静态方法和属性，这些方法和属性公开 Web 部件个性化设置的管理和管理功能。 这些方法适用于在 <xref:System.Web.UI.WebControls.WebParts.WebPartManager> 控件中为 Web 部件控件配置的默认个性化设置提供程序。 如果需要管理多个充当个性化设置提供程序的数据存储区，则应直接在单独的个性化设置提供程序类上使用这些方法。 请注意，为控件配置的个性化设置提供程序的集合 <xref:System.Web.UI.WebControls.WebParts.WebPartManager> 可以从 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Providers%2A> 静态属性中获取。

 需要注意的是，如果您的 Web 应用程序不是以默认信任级别或更高级别运行，个性化设置将失败 <xref:System.Web.AspNetHostingPermissionLevel.Medium> (您可以使用元素) 在 Web.config 文件中设置自定义信任级别 `<trust level="" />` 。 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration>和 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider> 类都在初始化时检查的信任级别 <xref:System.Web.AspNetHostingPermissionLevel.Low> 。 如果将应用程序配置为在信任级别运行 <xref:System.Web.AspNetHostingPermissionLevel.Low> ，并使用默认 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider> 提供程序来管理应用程序的个性化设置数据，则该应用程序首次尝试访问个性化设置数据时将失败，因为在信任中运行的 ASP.NET 工作进程 <xref:System.Web.AspNetHostingPermissionLevel.Low> 不具有调用命名空间中的各个类所必需的权限 <xref:System.Data.SqlClient> 。



## Examples
 下面的代码示例演示如何在类中使用几个方法 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration> 。 此示例包含一个 .aspx 页面，该页面引用名为 Web 部件用户控件 `Persadmin.ascx` 。 下面的代码为示例提供 .aspx 文件。

 [!code-aspx-csharp[WebParts_PersAdmin#7](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/defaultcs.aspx#7)]

 此代码提供 `Persadmin.ascx` 控件。

> [!IMPORTANT]
>  此示例具有一个接受用户输入的文本框，这是一个潜在的安全威胁。 默认情况下，ASP.NET 网页验证用户输入是否不包含脚本或 HTML 元素。 有关详细信息，请参阅[脚本侵入概述](https://docs.microsoft.com/previous-versions/aspnet/w1sw53ds(v=vs.100))。

 [!code-aspx-csharp[WebParts_PersAdmin#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/PersAdmin.ascx#1)]

 ]]></format>
    </remarks>
    <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
    <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
    <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
    <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
    <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
    <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/w1sw53ds(v=vs.100)">脚本攻击概述</related>
  </Docs>
  <Members>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public static string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ApplicationName : string with get, set" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>获取或设置提供程序指定的应用程序名称。</summary>
        <value>应用程序名称。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 应用程序名称会影响个性化设置提供程序检索和保存的数据，并允许多个应用程序通过设置相同的应用程序名称来共享数据，或通过指定不同的应用程序名称来对同一数据库中的数据进行分区。 应用程序名称位于 Web.config 或 System.config 文件的 "个性化设置提供程序" 部分中。

> [!CAUTION]
>  由于单个默认配置文件提供程序实例用于某个对象提供的所有请求 <xref:System.Web.HttpApplication> ，因此您可以同时执行多个请求并尝试设置该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName%2A> 属性值。 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName%2A>对于多个写入，属性不是线程安全的，并且更改 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName%2A> 属性值可能会导致应用程序的多个用户产生意外行为。 除非需要，否则建议你避免使用代码来允许用户设置 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName%2A> 属性。 可能需要设置属性的应用程序的一个示例 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName%2A> 是管理多个应用程序的配置文件数据的管理应用程序。 此类应用程序应为单用户应用程序，而不是 Web 应用程序。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">配置中定义的个性化设置提供程序的提供程序类型不正确。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="FindInactiveUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>基于指定参数为非活动用户返回每名用户个性化状态信息的集合。</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </MemberGroup>
    <Member MemberName="FindInactiveUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindInactiveUserState (string pathToMatch, string usernameToMatch, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindInactiveUserState(string pathToMatch, string usernameToMatch, valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindInactiveUserState(System.String,System.String,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindInactiveUserState (pathToMatch As String, usernameToMatch As String, userInactiveSinceDate As DateTime) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindInactiveUserState(System::String ^ pathToMatch, System::String ^ usernameToMatch, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member FindInactiveUserState : string * string * DateTime -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindInactiveUserState (pathToMatch, usernameToMatch, userInactiveSinceDate)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">要匹配的页面的路径。</param>
        <param name="usernameToMatch">要匹配的用户名，该用户名含有与相应页面关联的个性化设置数据。</param>
        <param name="userInactiveSinceDate">上一次访问用户的个性化设置信息的日期。</param>
        <summary>基于指定参数为非活动用户返回每名用户个性化状态信息的集合。</summary>
        <returns>包含每名用户个性化状态信息的 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法返回 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 实例、每用户个性化状态信息的集合，其中 `pathToMatch` 参数值与页面的路径匹配， `usernameToMatch` 与具有与该页面关联的个性化设置数据的用户名匹配，用户被视为不活动状态。 换言之，对于每个返回的记录，用户的 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A> 属性值小于或等于 `userInactiveSinceDate` 。 返回的集合只包含 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 实例。

 此方法将查询通配符传递到基础数据存储区。 对通配符的支持当前依赖于每个访问接口如何处理星号 ( * ) 、百分比符号 (% ) 或下划线 (_) 。

 通常，对于符合 SQL 标准的数据存储区，可以在部分路径上执行通配符搜索，通配符字符显示在属性中搜索字符串文本的开头、末尾或中间 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 。 例如，若要查找以 "/vdir" 开头的所有路径 \~ ，则该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 属性将设置为 " \~ /vdir%"。

 同样，在部分用户名上进行通配符搜索可能会在该属性的文本字符串中的任意位置显示通配符 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 。 例如，若要查找所有以 "John" 开头的用户名，该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 属性将类似于 "john%"。

 使用默认的个性化设置提供程序 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 时，派生对象将按字母顺序返回，并按路径和用户名的组合进行升序排序。 对象在集合中的顺序由提供程序确定。

 如果 `userInactiveSinceDate` 为 <xref:System.DateTime.MaxValue> ，则此方法返回的值等效于 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState%2A> 。

 `pathToMatch`和都 `usernameToMatch` 可以是 `null` 。 `usernameToMatch`参数可以包括逗号 (，) 因为某些数据存储（如那些运行 Microsoft SQL Server 的数据存储区）允许逗号作为通配符。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pathToMatch" /> 或 <paramref name="usernameToMatch" /> 在修整前或修整后是空字符串 ("")。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="FindInactiveUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindInactiveUserState (string pathToMatch, string usernameToMatch, DateTime userInactiveSinceDate, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindInactiveUserState(string pathToMatch, string usernameToMatch, valuetype System.DateTime userInactiveSinceDate, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindInactiveUserState(System.String,System.String,System.DateTime,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindInactiveUserState (pathToMatch As String, usernameToMatch As String, userInactiveSinceDate As DateTime, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindInactiveUserState(System::String ^ pathToMatch, System::String ^ usernameToMatch, DateTime userInactiveSinceDate, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="static member FindInactiveUserState : string * string * DateTime * int * int * int -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindInactiveUserState (pathToMatch, usernameToMatch, userInactiveSinceDate, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">要匹配的页面的路径。</param>
        <param name="usernameToMatch">要匹配的用户名，该用户名含有与相应页面关联的个性化设置数据。</param>
        <param name="userInactiveSinceDate">上一次访问个性化设置信息的日期。</param>
        <param name="pageIndex">要返回的结果页的索引（从零开始）。</param>
        <param name="pageSize">要返回的记录数。</param>
        <param name="totalRecords">可用记录的总数。</param>
        <summary>基于指定参数为非活动用户返回每名用户个性化状态信息的集合。</summary>
        <returns>包含每名用户个性化状态信息的 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法返回 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 实例、每用户个性化状态信息的集合，其中 `pathToMatch` 参数值与页面的路径匹配， `usernameToMatch` 与具有与该页面关联的个性化设置数据的用户名匹配，用户被视为不活动状态。 换言之，对于每个返回的记录，用户的 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A> 属性值小于或等于 `userInactiveSinceDate` 。 集合只包含 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 实例。

 此方法将参数通配符传递到基础个性化设置提供程序，因此数据存储区如何处理这些字符取决于提供程序如何处理星号 ( * ) 、百分比符号 (% ) 或下划线 (_) 。

 通常，对于符合 SQL 标准的数据存储区，可以在部分路径上执行通配符搜索，通配符字符显示在属性中搜索字符串文本的开头、末尾或中间 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 。 例如，若要查找以 "/vdir" 开头的所有路径 \~ ，则该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 属性将设置为 " \~ /vdir%"。

 同样，在部分用户名上进行通配符搜索可能会在该属性的文本字符串中的任意位置显示通配符 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 。 例如，若要查找所有以 "John" 开头的用户名，该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 属性将类似于 "john%"。

 使用默认的个性化设置提供程序 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 时，派生对象将按字母顺序返回，并按路径和用户名的组合进行升序排序。 对象在集合中的顺序由提供程序确定。

 如果 `userInactiveSinceDate` 为 <xref:System.DateTime.MaxValue> ，则此方法返回的值等效于 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState%2A> 。

 `pathToMatch`和都 `usernameToMatch` 可以是 `null` 。 `usernameToMatch`参数可以有逗号 (，) 因为某些数据存储（如那些运行 Microsoft SQL Server 的数据存储区）允许逗号作为通配符。

 返回的数据受和约束 `pageIndex` `pageSize` ，其中 `pageIndex` 控制要返回的记录数并 `pageSize` 控制要返回的记录数。 例如，如果 `pageIndex` 设置为0，并且 `pageSize` 设置为25，则返回的数据将是前25个条目。 如果 `pageIndex` 设置为1，并且 `pageSize` 设置为25，则返回的数据将为第26到50的条目。 `totalRecords`参数返回可用记录的总数。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pathToMatch" /> 或 <paramref name="usernameToMatch" /> 在修整前或修整后是空字符串 ("")。

-或-

 <paramref name="pageIndex" /> 小于零

- 或 -

 <paramref name="pageSize" /> 小于或等于零。

-或-

<paramref name="pageIndex" /> 和 <paramref name="pageSize" /> 的组合超过了 <see cref="F:System.Int32.MaxValue" />。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="FindSharedState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>基于指定参数返回共享个性化状态信息的集合。</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </MemberGroup>
    <Member MemberName="FindSharedState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindSharedState (string pathToMatch);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindSharedState(string pathToMatch) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindSharedState(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindSharedState (pathToMatch As String) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindSharedState(System::String ^ pathToMatch);" />
      <MemberSignature Language="F#" Value="static member FindSharedState : string -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindSharedState pathToMatch" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">要匹配的页面的路径。</param>
        <summary>基于指定路径返回共享个性化设置状态的信息集合。</summary>
        <returns>包含共享的个性化状态信息的 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法返回实例的集合， <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 其中 `pathToMatch` 值与具有共享个性化设置状态数据的页面的路径匹配。 集合只包含 <xref:System.Web.UI.WebControls.WebParts.SharedPersonalizationStateInfo> 实例。

 此方法将参数通配符传递到基础个性化设置提供程序，因此数据存储区如何处理这些字符取决于提供程序如何处理星号 ( * ) 、百分比符号 (% ) 或下划线 (_) 。

 通常，对于符合 SQL 标准的数据存储区，可以在部分路径上执行通配符搜索，通配符字符显示在属性中搜索字符串文本的开头、末尾或中间 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 。 例如，若要查找以 "/vdir" 开头的所有路径 \~ ，则该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 属性将设置为 " \~ /vdir%"。

 使用默认的个性化设置提供程序 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 时，派生对象将按字母顺序返回，并按路径和用户名的组合进行升序排序。 集合中对象的顺序由提供程序确定。

 `pathToMatch`参数可以是 `null` 。 如果设置为 `null` ，则在执行查询时将忽略参数。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pathToMatch" /> 在修整前或修整后是空字符串 ("")。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="FindSharedState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindSharedState (string pathToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindSharedState(string pathToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindSharedState(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindSharedState (pathToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindSharedState(System::String ^ pathToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="static member FindSharedState : string * int * int * int -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindSharedState (pathToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">要匹配的页面的路径。</param>
        <param name="pageIndex">要返回的结果页的索引（从零开始）。</param>
        <param name="pageSize">要返回的记录数。</param>
        <param name="totalRecords">可用记录的总数。</param>
        <summary>基于指定参数返回共享个性化状态信息的集合。</summary>
        <returns>包含共享的个性化状态信息的 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法返回实例的集合， <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 其中 `pathToMatch` 值与具有共享个性化设置状态数据的页面的路径匹配。 集合只包含 <xref:System.Web.UI.WebControls.WebParts.SharedPersonalizationStateInfo> 实例。

 此方法将参数通配符传递到基础个性化设置提供程序，因此数据存储区如何处理这些字符取决于提供程序如何处理星号 ( * ) 、百分比符号 (% ) 或下划线 (_) 。

 通常，对于符合 SQL 标准的数据存储区，可以在部分路径上执行通配符搜索，通配符字符显示在属性中搜索字符串文本的开头、末尾或中间 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 。 例如，若要查找以 "/vdir" 开头的所有路径 \~ ，则该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 属性将设置为 " \~ /vdir%"。

 使用默认的个性化设置提供程序 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 时，派生对象将按字母顺序返回，并按路径和用户名的组合进行升序排序。 对象在集合中的顺序由提供程序确定。

 `pathToMatch`参数可以是 `null` 。 如果设置为 `null` ，则在执行查询时将忽略参数。

 返回的数据受和约束 `pageIndex` `pageSize` ，其中 `pageIndex` 控制要返回的记录数并 `pageSize` 控制要返回的记录数。 例如，如果 `pageIndex` 设置为0，并且 `pageSize` 设置为25，则返回的数据将是前25个条目。 如果 `pageIndex` 设置为1，并且 `pageSize` 设置为25，则返回的数据将为第26到50的条目。 `totalRecords`参数返回可用记录的总数。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pathToMatch" /> 在修整前或修整后是空字符串 ("")。

- 或 -

 <paramref name="pageIndex" /> 小于零。

- 或 -

 <paramref name="pageSize" /> 小于或等于零。

-或-

<paramref name="pageIndex" /> 和 <paramref name="pageSize" /> 的组合超过了 <see cref="F:System.Int32.MaxValue" />。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="FindUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>基于指定参数返回每用户个性化设置状态的信息集合。</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </MemberGroup>
    <Member MemberName="FindUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindUserState (string pathToMatch, string usernameToMatch);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindUserState(string pathToMatch, string usernameToMatch) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindUserState (pathToMatch As String, usernameToMatch As String) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindUserState(System::String ^ pathToMatch, System::String ^ usernameToMatch);" />
      <MemberSignature Language="F#" Value="static member FindUserState : string * string -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState (pathToMatch, usernameToMatch)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="usernameToMatch" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">要匹配的页面的路径。</param>
        <param name="usernameToMatch">要匹配的用户名，该用户名含有与相应页面关联的个性化设置数据。</param>
        <summary>基于用户名和页面路径返回每用户个性化设置状态的信息集合。</summary>
        <returns>包含每名用户个性化状态信息的 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法返回实例的集合 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> `pathToMatch` ，其中参数值与页面的路径匹配，并 `usernameToMatch` 与包含与该页面关联的个性化设置数据的用户名匹配。 集合只包含 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 实例。

 此方法将参数通配符传递到基础个性化设置提供程序，因此数据存储区如何处理这些字符取决于提供程序如何处理星号 ( * ) 、百分比符号 (% ) 或下划线 (_) 。

 通常，对于符合 SQL 标准的数据存储区，可以在部分路径上执行通配符搜索，通配符字符显示在属性中搜索字符串文本的开头、末尾或中间 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 。 例如，若要查找以 "/vdir" 开头的所有路径 \~ ，则该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 属性将设置为 " \~ /vdir%"。

 同样，在部分用户名上进行通配符搜索可能会在该属性的文本字符串中的任意位置显示通配符 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 。 例如，若要查找所有以 "John" 开头的用户名，该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 属性将类似于 "john%"。

 使用默认的个性化设置提供程序 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 时，派生对象将按字母顺序返回，并按路径和用户名的组合进行升序排序。 集合中对象的顺序由提供程序确定。

 `pathToMatch`和都 `usernameToMatch` 可以是 `null` 。 `usernameToMatch`参数可以有逗号 (，) 因为某些数据存储（如那些运行 Microsoft SQL Server 的数据存储区）允许逗号作为通配符。



## Examples
 下面的代码示例演示如何使用 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState%2A> 方法。 可在类概述主题中找到完整的示例 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration> 。

> [!IMPORTANT]
>  此示例具有一个接受用户输入的文本框，这是一个潜在的安全威胁。 默认情况下，ASP.NET 网页验证用户输入是否不包含脚本或 HTML 元素。 有关详细信息，请参阅[脚本侵入概述](https://docs.microsoft.com/previous-versions/aspnet/w1sw53ds(v=vs.100))。

 [!code-csharp[WebParts_PersAdmin#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/PersAdmin.ascx#2)]

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pathToMatch" /> 或 <paramref name="usernameToMatch" /> 在修整前或修整后是空字符串 ("")。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="FindUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindUserState (string pathToMatch, string usernameToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindUserState(string pathToMatch, string usernameToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState(System.String,System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindUserState (pathToMatch As String, usernameToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindUserState(System::String ^ pathToMatch, System::String ^ usernameToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="static member FindUserState : string * string * int * int * int -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState (pathToMatch, usernameToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">要匹配的页面的路径。</param>
        <param name="usernameToMatch">要匹配的用户名，该用户名含有与相应页面关联的个性化设置数据。</param>
        <param name="pageIndex">要返回的结果页的索引（从零开始）。</param>
        <param name="pageSize">要返回的记录数。</param>
        <param name="totalRecords">可用记录的总数。</param>
        <summary>基于指定参数返回每用户个性化设置状态的信息集合。</summary>
        <returns>包含每名用户个性化状态信息的 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法返回实例的集合， <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 其中 `pathToMatch` 参数值与页面路径匹配，并 `usernameToMatch` 与具有与该页面关联的个性化设置数据的用户名匹配。 集合只包含 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 实例。

 此方法将参数通配符传递到基础个性化设置提供程序，因此，数据存储区如何处理这些字符取决于提供程序如何将字符处理为星号 ( * ) 、百分比符号 (% ) 或下划线 (_) 。

 通常，对于符合 SQL 标准的数据存储区，可以在部分路径上执行通配符搜索，通配符字符显示在属性中搜索字符串文本的开头、末尾或中间 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 。 例如，若要查找以 "/vdir" 开头的所有路径 \~ ，则该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 属性将设置为 " \~ /vdir%"。

 同样，在部分用户名上进行通配符搜索可能会在该属性的文本字符串中的任意位置显示通配符 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 。 例如，若要查找所有以 "John" 开头的用户名，该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 属性将类似于 "john%"。

 使用默认的个性化设置提供程序 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 时，派生对象将按字母顺序返回，并按路径和用户名的组合进行升序排序。 对象在集合中的顺序由提供程序确定。

 `pathToMatch`和都 `usernameToMatch` 可以是 `null` 。 `usernameToMatch`参数可以有逗号 (，) 因为某些数据存储（如那些运行 Microsoft SQL Server 的数据存储区）允许逗号作为通配符。

 返回的数据受和约束 `pageIndex` `pageSize` ，其中 `pageIndex` 控制要返回的记录数并 `pageSize` 控制要返回的记录数。 例如，如果 `pageIndex` 设置为0，并且 `pageSize` 设置为25，则返回的数据将是前25个条目。 如果 `pageIndex` 设置为1，并且 `pageSize` 设置为25，则返回的数据将为第26到50的条目。 `totalRecords`参数返回可用记录的总数。



## Examples
 下面的代码示例演示如何使用 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState%2A> 方法。 可在类概述主题中找到完整的示例 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration> 。

> [!IMPORTANT]
>  此示例具有一个接受用户输入的文本框，这是一个潜在的安全威胁。 默认情况下，ASP.NET 网页验证用户输入是否不包含脚本或 HTML 元素。 有关详细信息，请参阅[脚本侵入概述](https://docs.microsoft.com/previous-versions/aspnet/w1sw53ds(v=vs.100))。

 [!code-csharp[WebParts_PersAdmin#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/PersAdmin.ascx#2)]

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pathToMatch" /> 或 <paramref name="usernameToMatch" /> 在修整前或修整后是空字符串 ("")。

- 或 -

 <paramref name="pageIndex" /> 小于零。

- 或 -

 <paramref name="pageSize" /> 小于或等于零。

-或-

<paramref name="pageIndex" /> 和 <paramref name="pageSize" /> 的组合超过了 <see cref="F:System.Int32.MaxValue" />。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetAllInactiveUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>返回与非活动用户关联的所有每用户个性化设置状态的信息集合。</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetAllInactiveUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllInactiveUserState (DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllInactiveUserState(valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllInactiveUserState(System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetAllInactiveUserState (userInactiveSinceDate As DateTime) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ GetAllInactiveUserState(DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member GetAllInactiveUserState : DateTime -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllInactiveUserState userInactiveSinceDate" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="userInactiveSinceDate">上一次访问用户的个性化设置信息的日期。</param>
        <summary>基于指定日期返回与非活动用户关联的所有每用户个性化设置状态的信息集合。</summary>
        <returns><see cref="T:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo" /> 实例的集合。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 返回的集合只包含 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 实例。 使用默认的个性化设置提供程序 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 时，派生对象将按字母顺序返回，并按路径和用户名的组合进行升序排序。 对象在集合中的顺序由提供程序确定。

 此方法返回用户的 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A> 属性值小于或等于 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 属性值的项。 如果 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 为 <xref:System.DateTime.MaxValue> ，则此方法会有效地返回基础数据存储区中的所有每用户数据。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">配置中定义的个性化设置提供程序的提供程序类型不正确。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="GetAllInactiveUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllInactiveUserState (DateTime userInactiveSinceDate, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllInactiveUserState(valuetype System.DateTime userInactiveSinceDate, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllInactiveUserState(System.DateTime,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetAllInactiveUserState (userInactiveSinceDate As DateTime, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ GetAllInactiveUserState(DateTime userInactiveSinceDate, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="static member GetAllInactiveUserState : DateTime * int * int * int -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllInactiveUserState (userInactiveSinceDate, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="userInactiveSinceDate">上一次访问用户的个性化设置信息的日期。</param>
        <param name="pageIndex">要返回的结果页的索引（从零开始）。</param>
        <param name="pageSize">要返回的记录数。</param>
        <param name="totalRecords">可用记录的总数。</param>
        <summary>基于指定参数，返回与非活动用户关联的所有每用户个性化设置状态的信息子集。</summary>
        <returns><see cref="T:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo" /> 实例的集合。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 返回的集合只包含 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 实例。 使用默认的个性化设置提供程序 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 时，派生对象将按字母顺序返回，并按路径和用户名的组合进行升序排序。 对象在集合中的顺序由提供程序确定。

 此方法返回用户的 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A> 属性值小于或等于 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 属性值的项。 如果 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 为 <xref:System.DateTime.MaxValue> ，则此方法会有效地返回基础数据存储区中的所有每用户数据。

 返回值受和参数的约束 `pageIndex` `pageSize` ，其中 `pageIndex` 控制要返回的记录 `pageSize` 数并控制要返回的记录数。 例如，如果 `pageIndex` 设置为0，并且 `pageSize` 设置为25，则返回的数据将是前25个条目。 如果 `pageIndex` 设置为1，并且 `pageSize` 设置为25，则返回的数据将为第26到50的条目。 `totalRecords`参数返回可用记录的总数。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pageIndex" /> 小于零。

- 或 -

 <paramref name="pageSize" /> 小于或等于零。

-或-

<paramref name="pageIndex" /> 和 <paramref name="pageSize" /> 的组合超过了 <see cref="F:System.Int32.MaxValue" />。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetAllState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>对于请求的个性化设置范围和其他指定参数，从基础数据存储区中返回所有个性化设置状态的信息集合。</summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetAllState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllState(System.Web.UI.WebControls.WebParts.PersonalizationScope)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetAllState (scope As PersonalizationScope) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ GetAllState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope);" />
      <MemberSignature Language="F#" Value="static member GetAllState : System.Web.UI.WebControls.WebParts.PersonalizationScope -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllState scope" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
      </Parameters>
      <Docs>
        <param name="scope">要检索的个性化设置信息的范围。</param>
        <summary>对于请求的个性化设置范围，从基础数据存储区中返回所有个性化设置状态的信息集合。</summary>
        <returns>一个 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" />，包含指定范围的状态信息。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 请注意，返回的集合仅包含 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 类型或类型的派生对象 <xref:System.Web.UI.WebControls.WebParts.SharedPersonalizationStateInfo> <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 。 使用默认的个性化设置提供程序 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 时，派生对象将按字母顺序返回，并按路径和用户名的组合进行升序排序。 对象在集合中的顺序由提供程序确定。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">配置中定义的个性化设置提供程序的提供程序类型不正确。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="scope" /> 不是 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> 枚举的有效成员。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="GetAllState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetAllState (scope As PersonalizationScope, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ GetAllState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="static member GetAllState : System.Web.UI.WebControls.WebParts.PersonalizationScope * int * int * int -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllState (scope, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="scope">要检索的个性化设置信息的范围。</param>
        <param name="pageIndex">要返回的结果页的索引（从零开始）。</param>
        <param name="pageSize">要返回的记录数。</param>
        <param name="totalRecords">可用记录的总数。</param>
        <summary>基于指定参数，从基础数据存储区中返回所有个性化设置状态的信息子集。</summary>
        <returns>一个 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" />，包含指定范围和参数的状态信息。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 返回的集合中的项主要基于范围，然后根据和参数将与该范围对应的记录进一步缩小为一个子集 `pageIndex` `pageSize` 。 返回的集合仅包含 <xref:System.Web.UI.WebControls.WebParts.SharedPersonalizationStateInfo> 实例或 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 实例。

 返回的项受 `pageIndex` 和参数的约束 `pageSize` ，其中 `pageIndex` 控制要返回的记录以及要返回的 `pageSize` 记录数。 例如，如果 `pageIndex` 设置为0，并且 `pageSize` 设置为25，则返回的数据将是前25个条目。 如果 `pageIndex` 设置为1，并且 `pageSize` 设置为25，则返回的数据将为第26到50的条目。 `totalRecords`参数返回可用记录的总数。

 使用默认的个性化设置提供程序 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 时，派生对象将按字母顺序返回，并按路径和用户名的组合进行升序排序。 对象在集合中的顺序由提供程序确定。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pageIndex" /> 小于零。

- 或 -

 <paramref name="pageSize" /> 小于或等于零。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

<paramref name="pageIndex" /> 和 <paramref name="pageSize" /> 的组合超过了 <see cref="F:System.Int32.MaxValue" />。</exception>
        <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="scope" /> 不是 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> 枚举的有效成员。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetCountOfInactiveUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>为非活动用户返回基础数据存储区中每用户个性化设置项的计数。</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetCountOfInactiveUserState">
      <MemberSignature Language="C#" Value="public static int GetCountOfInactiveUserState (DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCountOfInactiveUserState(valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfInactiveUserState(System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetCountOfInactiveUserState (userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int GetCountOfInactiveUserState(DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member GetCountOfInactiveUserState : DateTime -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfInactiveUserState userInactiveSinceDate" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName Language="C#">[System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")]</AttributeName>
          <AttributeName Language="F#">[&lt;System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")&gt;]</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="userInactiveSinceDate">上一次访问用户的个性化设置信息的日期。</param>
        <summary>基于指定参数，为非活动用户返回基础数据存储区中每用户个性化设置项的计数。</summary>
        <returns>非活动用户的个性化设置项的数目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法返回用户的 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A> 属性值小于或等于 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 属性值的记录。 如果 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 设置为 <xref:System.DateTime.MaxValue> ，则返回所有用户的个性化设置信息的计数。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

 任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序返回的计数为负。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="GetCountOfInactiveUserState">
      <MemberSignature Language="C#" Value="public static int GetCountOfInactiveUserState (string pathToMatch, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCountOfInactiveUserState(string pathToMatch, valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfInactiveUserState(System.String,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetCountOfInactiveUserState (pathToMatch As String, userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int GetCountOfInactiveUserState(System::String ^ pathToMatch, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member GetCountOfInactiveUserState : string * DateTime -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfInactiveUserState (pathToMatch, userInactiveSinceDate)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">含有要检索的个性化设置状态项的页面的路径。</param>
        <param name="userInactiveSinceDate">上一次访问用户的个性化设置信息的日期。</param>
        <summary>基于指定参数，为非活动用户返回基础数据存储区中每用户个性化设置项的计数。</summary>
        <returns>非活动用户在基础数据存储区中的每用户个性化设置项的计数。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法返回与指定参数匹配的记录 `pathtoMatch` ，并且用户的 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A> 属性值小于或等于 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 属性值。 如果 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 设置为 <xref:System.DateTime.MaxValue> ，则返回所有用户的个性化设置信息的计数。

 请注意， `pathToMatch` 参数可以包含通配符。 方法将通配符传递到基础数据存储区。 通配符支持当前依赖于每个访问接口如何处理星号 ( * ) 、百分比符号 (% ) 或下划线 (_) 。

 通常，对于符合 SQL 标准的数据存储区，可以在部分路径上执行通配符搜索，通配符字符显示在属性中搜索字符串文本的开头、末尾或中间 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 。 例如，若要查找以 "/vdir" 开头的所有路径 \~ ，则该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 属性将设置为 " \~ /vdir%"。

 `pathToMatch`参数可以是 `null` 。 如果设置为 `null` ，则在执行查询时将忽略参数。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pathToMatch" /> 在修整后变成空字符串 ("")。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序返回的计数为负。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetCountOfState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>返回基础数据存储区中对应于指定范围和其他参数的个性化设置状态项的计数。</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetCountOfState">
      <MemberSignature Language="C#" Value="public static int GetCountOfState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCountOfState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState(System.Web.UI.WebControls.WebParts.PersonalizationScope)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetCountOfState (scope As PersonalizationScope) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int GetCountOfState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope);" />
      <MemberSignature Language="F#" Value="static member GetCountOfState : System.Web.UI.WebControls.WebParts.PersonalizationScope -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState scope" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName Language="C#">[System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")]</AttributeName>
          <AttributeName Language="F#">[&lt;System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")&gt;]</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
      </Parameters>
      <Docs>
        <param name="scope">要检索的个性化设置状态项的范围。</param>
        <summary>返回基础数据存储区中对应于指定范围的个性化设置状态项的计数。</summary>
        <returns>对应于指定范围的个性化设置状态项的数目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 使用此方法可以确定基础数据存储区中指定范围的个性化设置状态项的数目。 使用 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState%2A> 方法进一步将计数缩小到特定页。



## Examples
 下面的代码示例演示如何使用 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState%2A> 方法。 可在类概述主题中找到完整的示例 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration> 。

 [!code-csharp[WebParts_PersAdmin#5](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/PersAdmin.ascx#5)]

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="scope" /> 不是 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> 枚举的有效成员。</exception>
        <exception cref="T:System.ArgumentException">配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

 任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序返回的计数为负。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="GetCountOfState">
      <MemberSignature Language="C#" Value="public static int GetCountOfState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, string pathToMatch);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCountOfState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope, string pathToMatch) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetCountOfState (scope As PersonalizationScope, pathToMatch As String) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int GetCountOfState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope, System::String ^ pathToMatch);" />
      <MemberSignature Language="F#" Value="static member GetCountOfState : System.Web.UI.WebControls.WebParts.PersonalizationScope * string -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState (scope, pathToMatch)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
        <Parameter Name="pathToMatch" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="scope">要检索的个性化设置状态项的范围。</param>
        <param name="pathToMatch">含有要检索的个性化设置状态项的页面的路径。</param>
        <summary>返回基础数据存储区中对应于指定参数的个性化设置状态项的计数。</summary>
        <returns>对应于指定范围的个性化设置状态项的数目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 使用此方法可以确定基础数据存储区中指定范围和路径的个性化设置状态项的数目。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

 <paramref name="pathToMatch" /> 在修整后变成空字符串 ("")。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="scope" /> 不是 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> 枚举的有效成员。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序返回的计数为负。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="GetCountOfUserState">
      <MemberSignature Language="C#" Value="public static int GetCountOfUserState (string usernameToMatch);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCountOfUserState(string usernameToMatch) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfUserState(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetCountOfUserState (usernameToMatch As String) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int GetCountOfUserState(System::String ^ usernameToMatch);" />
      <MemberSignature Language="F#" Value="static member GetCountOfUserState : string -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfUserState usernameToMatch" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernameToMatch" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="usernameToMatch">与要检索的个性化设置状态信息关联的用户名。</param>
        <summary>返回基础数据存储区中对应于指定用户的个性化设置状态项的计数。</summary>
        <returns>对应于指定用户的个性化设置状态项的数目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法返回基础数据存储区中给定的每用户个性化设置项的计数 `usernameToMatch` 。

 请注意， `usernameToMatch` 参数可以包含通配符。 此方法将通配符传递到基础数据存储区。 通配符支持当前依赖于每个访问接口如何处理星号 ( * ) 、百分比符号 (% ) 或下划线 (_) 。

 通常，对于与 SQL 兼容的数据存储区，对部分用户名的通配符搜索可以在该属性的文本字符串中的任意位置显示通配符 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 。 例如，若要查找所有以 "John" 开头的用户名，该 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 参数将类似于 "john%"。

 `usernameToMatch`参数可以是 `null` 。 如果设置为 `null` ，则在执行查询时将忽略参数。 此 `usernameToMatch` 参数允许使用逗号 (，) 因为某些数据存储（如那些运行 Microsoft SQL Server 的数据存储区）允许逗号作为通配符。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="usernameToMatch" /> 修整后变成空字符串 ("")。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序返回的计数为负。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="Provider">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationProvider Provider { get; }" />
      <MemberSignature Language="ILAsm" Value=".property class System.Web.UI.WebControls.WebParts.PersonalizationProvider Provider" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Provider" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property Provider As PersonalizationProvider" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Web::UI::WebControls::WebParts::PersonalizationProvider ^ Provider { System::Web::UI::WebControls::WebParts::PersonalizationProvider ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Provider : System.Web.UI.WebControls.WebParts.PersonalizationProvider" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Provider" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationProvider</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>返回默认个性化设置提供程序的一个实例。</summary>
        <value>默认提供程序的 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationProvider" />。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 使用此属性可以检索默认个性化设置提供程序的实例。 这是 Web.config 或 Machine.config 文件的个性化设置提供程序部分中指定的提供程序。



## Examples
 下面的代码示例演示如何使用 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Provider%2A> 属性。

 [!code-csharp[WebParts_PersAdmin#4](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/PersAdmin.ascx#4)]

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">配置中定义的个性化设置提供程序的提供程序类型不正确。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="Providers">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationProviderCollection Providers { get; }" />
      <MemberSignature Language="ILAsm" Value=".property class System.Web.UI.WebControls.WebParts.PersonalizationProviderCollection Providers" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Providers" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property Providers As PersonalizationProviderCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Web::UI::WebControls::WebParts::PersonalizationProviderCollection ^ Providers { System::Web::UI::WebControls::WebParts::PersonalizationProviderCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Providers : System.Web.UI.WebControls.WebParts.PersonalizationProviderCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Providers" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationProviderCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>返回按名称索引的个性化设置提供程序集合。</summary>
        <value>一个只读的 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationProviderCollection" />，包含可用于应用程序的个性化设置提供程序。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此属性返回个性化设置提供程序的集合。 集合在应用程序初始化时填充，并包含对按名称索引的提供程序对象的引用。 默认提供程序按 Web.config 或 Machine.config 配置文件中指定的名称编制索引。

 请注意，返回的集合是只读的;对 `Remove` 、或的调用 `Add` `Clear` 将导致引发异常。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">配置中定义的个性化设置提供程序的提供程序类型不正确。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="ResetAllState">
      <MemberSignature Language="C#" Value="public static int ResetAllState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetAllState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetAllState(System.Web.UI.WebControls.WebParts.PersonalizationScope)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetAllState (scope As PersonalizationScope) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetAllState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope);" />
      <MemberSignature Language="F#" Value="static member ResetAllState : System.Web.UI.WebControls.WebParts.PersonalizationScope -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetAllState scope" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
      </Parameters>
      <Docs>
        <param name="scope">与要删除的个性化设置数据关联的范围。</param>
        <summary>通过删除所有与指定范围关联的行来重置基础数据存储区中的所有个性化设置数据。</summary>
        <returns>重置的项的数目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法删除基础数据存储区中与指定的个性化设置范围相关联的所有行。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="scope" /> 不是 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> 枚举的有效成员。</exception>
        <exception cref="T:System.ArgumentException">配置中定义的个性化设置提供程序的提供程序类型不正确。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序返回的受影响行的计数为负。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="ResetInactiveUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>通过删除基础数据存储区中的关联行来重置每用户个性化设置状态信息。</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </MemberGroup>
    <Member MemberName="ResetInactiveUserState">
      <MemberSignature Language="C#" Value="public static int ResetInactiveUserState (DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetInactiveUserState(valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetInactiveUserState(System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetInactiveUserState (userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetInactiveUserState(DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member ResetInactiveUserState : DateTime -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetInactiveUserState userInactiveSinceDate" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName Language="C#">[System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")]</AttributeName>
          <AttributeName Language="F#">[&lt;System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")&gt;]</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="userInactiveSinceDate">上一次访问用户的个性化设置信息的日期。</param>
        <summary>基于指定参数，重置基础数据存储区中的所有每用户个性化设置状态信息。</summary>
        <returns>基础数据存储区中被重置的行的数目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法将重置基础数据存储区中用户的 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A> 属性值小于或等于值的所有每用户状态信息 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 。

 如果 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 设置为 <xref:System.DateTime.MaxValue> ，此方法将重置基础数据存储区中的所有每用户数据。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

 任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序返回的计数为负。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="ResetInactiveUserState">
      <MemberSignature Language="C#" Value="public static int ResetInactiveUserState (string path, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetInactiveUserState(string path, valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetInactiveUserState(System.String,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetInactiveUserState (path As String, userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetInactiveUserState(System::String ^ path, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member ResetInactiveUserState : string * DateTime -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetInactiveUserState (path, userInactiveSinceDate)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="path">与要重置的个性化设置状态信息关联的页的路径。</param>
        <param name="userInactiveSinceDate">在重置用户状态个性化设置项时使用的上一次活动日期。</param>
        <summary>基于指定参数，为非活动用户重置基础数据存储区中所有的每用户状态信息。</summary>
        <returns>基础数据存储区中被重置的行的数目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法将重置基础数据存储区中与指定路径关联的所有每用户状态，其中用户的 <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A> 属性值小于或等于 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 属性值。

 对于需要多行数据来存储页的个性化设置状态的数据存储区，或者对于用户和页面组合，重置行的计数可能与个性化设置状态的计数不同。 如果基础提供程序公开了事务感知数据存储中的数据，则此方法将在单个事务中执行其操作。

 尝试重置不存在的共享状态并不是错误。

 如果 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 为 <xref:System.DateTime.MaxValue> ，则此方法会有效地为指定的路径重置基础数据存储区中的所有每用户数据。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="path" /> 为 <see langword="null" />。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="path" /> 修整后变成空字符串 ("")。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序返回的计数为负。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="ResetSharedState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>为指定的路径重置基础数据存储区中的共享状态。</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </MemberGroup>
    <Member MemberName="ResetSharedState">
      <MemberSignature Language="C#" Value="public static bool ResetSharedState (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool ResetSharedState(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetSharedState(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetSharedState (path As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool ResetSharedState(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member ResetSharedState : string -&gt; bool" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetSharedState path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">与要重置的个性化设置状态信息关联的页的路径。</param>
        <summary>为指定的路径重置基础数据存储区中的共享状态。</summary>
        <returns>如果个性化设置共享状态已重置，则为 <see langword="true" />；否则为 <see langword="false" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 尝试重置不存在的共享状态并不是错误。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="path" /> 为 <see langword="null" />。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="path" /> 修整后变成空字符串 ("")。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序指示删除行的数目为负数或者大于一。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="ResetSharedState">
      <MemberSignature Language="C#" Value="public static int ResetSharedState (string[] paths);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetSharedState(string[] paths) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetSharedState(System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetSharedState (paths As String()) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetSharedState(cli::array &lt;System::String ^&gt; ^ paths);" />
      <MemberSignature Language="F#" Value="static member ResetSharedState : string[] -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetSharedState paths" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="paths" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="paths">与要重置的个性化设置状态信息关联的页的路径。</param>
        <summary>为指定的路径重置基础数据存储区中的共享状态。</summary>
        <returns>已重置的行数。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法返回重置的行数的计数。 尝试重置不存在的共享状态并不是错误。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="paths" /> 为 <see langword="null" />。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="paths" /> 是一个长度为零的数组。

-或-

<paramref name="paths" /> 的成员修整后变成 <see langword="null" /> 或空字符串 ("")。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序指示删除的行数是负数。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="ResetState">
      <MemberSignature Language="C#" Value="public static int ResetState (System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection data);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetState(class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection data) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetState(System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetState (data As PersonalizationStateInfoCollection) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetState(System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ data);" />
      <MemberSignature Language="F#" Value="static member ResetState : System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetState data" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="data" Type="System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" />
      </Parameters>
      <Docs>
        <param name="data"><see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo" /> 对象的集合，指示应重置的数据。</param>
        <summary>以集合中包含的项为基础，重置数据存储中的个性化数据。</summary>
        <returns>已重置的行数。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法根据集合中包含的对象重置基础数据存储区中的个性化设置数据 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo> 。 您可以使用此方法根据集合的内容有选择地删除共享和每用户数据的混合。 <xref:System.Web.UI.WebControls.WebParts.SharedPersonalizationStateInfo> 对象指示将重置页面的共享数据; <xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo> 对象指示将重置特定页面的每用户数据。

> [!NOTE]
>  此方法不保证在单个事务中发生所有重置，因为该集合指向随机的个性化设置数据集。

 如果集合中包含的对象引用不存在的数据，则不是错误。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="data" /> 为 <see langword="null" />。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="data" /> 为空集合。

-或-

集合中的一个元素为 <see langword="null" />。

-或-

集合中 <see cref="T:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo" /> 实例的路径值为 <see langword="null" /> 或为空字符串 ("")。

-或-

集合中 <see cref="T:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo" /> 实例的 <paramref name="user" /> 值为 <see langword="null" />、空字符串，或含有逗号。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

 -或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序指示删除的行数是负数。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="ResetUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>为指定的参数重置基础数据存储区中的所有每用户状态。</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </MemberGroup>
    <Member MemberName="ResetUserState">
      <MemberSignature Language="C#" Value="public static int ResetUserState (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetUserState(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetUserState (path As String) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetUserState(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member ResetUserState : string -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">与要重置的个性化设置状态信息关联的页的路径。</param>
        <summary>为指定的路径重置基础数据存储区中的所有每用户状态。</summary>
        <returns>已重置的行数。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法返回重置的行数的计数。 尝试重置不存在的共享状态并不是错误。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="path" /> 为 <see langword="null" />。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="path" /> 为空字符串 ("")。

- 或 -

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序指示删除的行数是负数。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="ResetUserState">
      <MemberSignature Language="C#" Value="public static int ResetUserState (string[] usernames);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetUserState(string[] usernames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState(System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetUserState (usernames As String()) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetUserState(cli::array &lt;System::String ^&gt; ^ usernames);" />
      <MemberSignature Language="F#" Value="static member ResetUserState : string[] -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState usernames" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="usernames">应重置每用户数据的用户名的数组。</param>
        <summary>为指定的路径重置基础数据存储区中的所有每用户状态。</summary>
        <returns>已重置的行数。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法将重置基础数据存储区中与参数中包含的用户关联的所有每用户状态 `usernames` ，并返回已重置的行数的计数。

 尝试重置不存在的共享状态并不是错误。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="usernames" /> 为 <see langword="null" />。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="usernames" /> 是一个长度为零的数组。

-或-

<paramref name="usernames" /> 的成员修整后变成 <see langword="null" />，包含逗号，或为空字符串 ("")。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序指示删除的行数是负数。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="ResetUserState">
      <MemberSignature Language="C#" Value="public static bool ResetUserState (string path, string username);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool ResetUserState(string path, string username) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetUserState (path As String, username As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool ResetUserState(System::String ^ path, System::String ^ username);" />
      <MemberSignature Language="F#" Value="static member ResetUserState : string * string -&gt; bool" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState (path, username)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="username" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">与要重置的个性化设置状态信息关联的页的路径。</param>
        <param name="username">与要重置的个性化设置数据关联的用户名。</param>
        <summary>为指定的用户名和路径的组合重置基础数据存储区中的每用户状态。</summary>
        <returns>已重置的行数。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 尝试重置不存在的用户状态不是错误。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="path" /> 或 <paramref name="username" /> 为 <see langword="null" />。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="path" /> 或 <paramref name="username" /> 修整后变成空字符串 ("")。

- 或 -

 <paramref name="username" /> 包含逗号。

- 或 -

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序指示删除的行数是负数。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
    <Member MemberName="ResetUserState">
      <MemberSignature Language="C#" Value="public static int ResetUserState (string path, string[] usernames);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetUserState(string path, string[] usernames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState(System.String,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetUserState (path As String, usernames As String()) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetUserState(System::String ^ path, cli::array &lt;System::String ^&gt; ^ usernames);" />
      <MemberSignature Language="F#" Value="static member ResetUserState : string * string[] -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState (path, usernames)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="usernames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="path">与要重置的个性化设置状态信息关联的页的路径。</param>
        <param name="usernames">与要重置的个性化设置数据关联的用户名。</param>
        <summary>为指定的页面和用户重置基础数据存储区中的每用户状态。</summary>
        <returns>已重置的行数。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[

## Remarks
 此方法会重置基础数据存储区中的每用户状态，该存储区与指定的页面的参数中包含的每个用户相关联 `usernames` 。 `path.`

 尝试重置不存在的用户状态不是错误。

 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="path" /> 或 <paramref name="usernames" /> 为 <see langword="null" />。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="path" /> 修整后变成空字符串 ("")。

-或-

<paramref name="usernames" /> 的成员修整后变成 <see langword="null" />、空字符串，或包含逗号。

-或-

 <paramref name="usernames" /> 是一个长度为零的数组。

-或-

配置中定义的个性化设置提供程序的提供程序类型不正确。

-或-

任何参数的字符串长度超过 256 个字符。</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">尝试创建和初始化已配置的个性化设置提供程序的一个实例时出现配置异常。

-或-

 找不到配置中定义的默认个性化设置提供程序。</exception>
        <exception cref="T:System.Web.HttpException">默认提供程序指示删除的行数是负数。</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)">ASP.NET Web 部件控件</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/z36h8be9(v=vs.100)">Web 部件个性化概述</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/784d8z92(v=vs.100)">演练：使用用户控件实现 Web 部件个性化设置</related>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178182(v=vs.100)">Web 部件个性化</related>
      </Docs>
    </Member>
  </Members>
</Type>
