<Type Name="FileSystem" FullName="Microsoft.VisualBasic.FileIO.FileSystem">
  <Metadata><Meta Name="ms.openlocfilehash" Value="ca5290997f81299c54223c85b72455af9c392a33" /><Meta Name="ms.sourcegitcommit" Value="11d168140aa8fade0768c2a9dde3e3bcacfdfb7d" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="05/27/2020" /><Meta Name="ms.locfileid" Value="83975878" /></Metadata><TypeSignature Language="C#" Value="public class FileSystem" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit FileSystem extends System.Object" />
  <TypeSignature Language="DocId" Value="T:Microsoft.VisualBasic.FileIO.FileSystem" />
  <TypeSignature Language="VB.NET" Value="Public Class FileSystem" />
  <TypeSignature Language="C++ CLI" Value="public ref class FileSystem" />
  <TypeSignature Language="F#" Value="type FileSystem = class" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualBasic</AssemblyName>
    <AssemblyVersion>8.0.0.0</AssemblyVersion>
    <AssemblyVersion>10.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
    <AssemblyVersion>10.0.4.0</AssemblyVersion>
    <AssemblyVersion>10.0.5.0</AssemblyVersion>
    <AssemblyVersion>10.0.6.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="ec017-101">提供了用于处理驱动器、文件和目录的属性和方法。</span><span class="sxs-lookup"><span data-stu-id="ec017-101">Provides properties and methods for working with drives, files, and directories.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-102">下表列出了涉及 `My.Computer.FileSystem` 对象的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-102">The following table lists examples of tasks involving the `My.Computer.FileSystem` object.</span></span>  
  
|<span data-ttu-id="ec017-103">至</span><span class="sxs-lookup"><span data-stu-id="ec017-103">To</span></span>|<span data-ttu-id="ec017-104">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-104">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-105">从文本文件读取</span><span class="sxs-lookup"><span data-stu-id="ec017-105">Read from a text file</span></span>|[<span data-ttu-id="ec017-106">如何：读取文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-106">How to: Read from Text Files</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files)|  
|<span data-ttu-id="ec017-107">从带分隔符的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-107">Read from a delimited text file</span></span>|[<span data-ttu-id="ec017-108">如何：读取逗号分隔的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-108">How to: Read From Comma-Delimited Text Files</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files)|  
|<span data-ttu-id="ec017-109">从固定宽度文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-109">Read from a fixed-width text file</span></span>|[<span data-ttu-id="ec017-110">如何：读取固定宽度的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-110">How to: Read From Fixed-width Text Files</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files)|  
|<span data-ttu-id="ec017-111">从具有多种格式的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-111">Read from a text file with multiple formats</span></span>|[<span data-ttu-id="ec017-112">如何：读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-112">How to: Read From Text Files with Multiple Formats</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats)|  
|<span data-ttu-id="ec017-113">从二进制文件读取</span><span class="sxs-lookup"><span data-stu-id="ec017-113">Read from a binary file</span></span>|[<span data-ttu-id="ec017-114">如何：读取二进制文件</span><span class="sxs-lookup"><span data-stu-id="ec017-114">How to: Read From Binary Files</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-binary-files)|  
|<span data-ttu-id="ec017-115">使用 <xref:System.IO.StreamReader> 读取文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-115">Read from a text file with a <xref:System.IO.StreamReader></span></span>|[<span data-ttu-id="ec017-116">如何：使用 StreamReader 读取文件中的文本</span><span class="sxs-lookup"><span data-stu-id="ec017-116">How to: Read Text from Files with a StreamReader</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-text-from-files-with-a-streamreader)|  
|<span data-ttu-id="ec017-117">写入到文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-117">Write to a text file</span></span>|[<span data-ttu-id="ec017-118">如何：向文件写入文本</span><span class="sxs-lookup"><span data-stu-id="ec017-118">How to: Write Text to Files</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files)|  
|<span data-ttu-id="ec017-119">追加到文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-119">Append to a text file</span></span>|[<span data-ttu-id="ec017-120">如何：向文本文件追加内容</span><span class="sxs-lookup"><span data-stu-id="ec017-120">How to: Append to Text Files</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-append-to-text-files)|  
|<span data-ttu-id="ec017-121">写入二进制文件</span><span class="sxs-lookup"><span data-stu-id="ec017-121">Write to a binary file</span></span>|[<span data-ttu-id="ec017-122">如何：写入二进制文件</span><span class="sxs-lookup"><span data-stu-id="ec017-122">How to: Write to Binary Files</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-to-binary-files)|  
|<span data-ttu-id="ec017-123">写入**MyDocuments**目录中的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-123">Write to text files in the **MyDocuments** directory</span></span>|[<span data-ttu-id="ec017-124">如何：将文本写入“我的文档”目录中的文件</span><span class="sxs-lookup"><span data-stu-id="ec017-124">How to: Write Text to Files in the My Documents Directory</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files-in-the-my-documents-directory)|  
|<span data-ttu-id="ec017-125">使用 `StreamWriter` 写入文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-125">Write to a text file with a `StreamWriter`</span></span>|[<span data-ttu-id="ec017-126">如何：使用 StreamWriter 向文件中写入文本</span><span class="sxs-lookup"><span data-stu-id="ec017-126">How to: Write Text to Files with a StreamWriter</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files-with-a-streamwriter)|  
|<span data-ttu-id="ec017-127">复制具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="ec017-127">Copy files with a specific pattern</span></span>|[<span data-ttu-id="ec017-128">如何：将具有特定模式的文件复制到目录中</span><span class="sxs-lookup"><span data-stu-id="ec017-128">How to: Copy Files with a Specific Pattern to a Directory</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory)|  
|<span data-ttu-id="ec017-129">将文件复制到相同的目录</span><span class="sxs-lookup"><span data-stu-id="ec017-129">Copy a file to the same directory</span></span>|[<span data-ttu-id="ec017-130">如何：在同一目录中创建文件副本</span><span class="sxs-lookup"><span data-stu-id="ec017-130">How to: Create a Copy of a File in the Same Directory</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory)|  
|<span data-ttu-id="ec017-131">将文件复制到其他目录</span><span class="sxs-lookup"><span data-stu-id="ec017-131">Copy a file to a different directory</span></span>|[<span data-ttu-id="ec017-132">如何：在不同的目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="ec017-132">How to: Create a Copy of a File in a Different Directory</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory)|  
|<span data-ttu-id="ec017-133">创建文件</span><span class="sxs-lookup"><span data-stu-id="ec017-133">Create a file</span></span>|[<span data-ttu-id="ec017-134">如何：创建文件</span><span class="sxs-lookup"><span data-stu-id="ec017-134">How to: Create a File</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-file)|  
|<span data-ttu-id="ec017-135">删除文件</span><span class="sxs-lookup"><span data-stu-id="ec017-135">Delete a file</span></span>|[<span data-ttu-id="ec017-136">如何：删除文件</span><span class="sxs-lookup"><span data-stu-id="ec017-136">How to: Delete a File</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file)|  
|<span data-ttu-id="ec017-137">查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="ec017-137">Find files with a specific pattern</span></span>|[<span data-ttu-id="ec017-138">如何：查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="ec017-138">How to: Find Files with a Specific Pattern</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-files-with-a-specific-pattern)|  
|<span data-ttu-id="ec017-139">移动文件</span><span class="sxs-lookup"><span data-stu-id="ec017-139">Move a file</span></span>|[<span data-ttu-id="ec017-140">如何：移动文件</span><span class="sxs-lookup"><span data-stu-id="ec017-140">How to: Move a File</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-move-a-file)|  
|<span data-ttu-id="ec017-141">重命名文件</span><span class="sxs-lookup"><span data-stu-id="ec017-141">Rename a file</span></span>|[<span data-ttu-id="ec017-142">如何：重命名文件</span><span class="sxs-lookup"><span data-stu-id="ec017-142">How to: Rename a File</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file)|  
|<span data-ttu-id="ec017-143">将目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="ec017-143">Copy a directory to another directory</span></span>|[<span data-ttu-id="ec017-144">如何：将一个目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="ec017-144">How to: Copy a Directory to Another Directory</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory)|  
|<span data-ttu-id="ec017-145">创建目录</span><span class="sxs-lookup"><span data-stu-id="ec017-145">Create a directory</span></span>|[<span data-ttu-id="ec017-146">如何：创建目录</span><span class="sxs-lookup"><span data-stu-id="ec017-146">How to: Create a Directory</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-directory)|  
|<span data-ttu-id="ec017-147">查找具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="ec017-147">Find subdirectories with a specific pattern</span></span>|[<span data-ttu-id="ec017-148">如何：查找具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="ec017-148">How to: Find Subdirectories with a Specific Pattern</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern)|  
|<span data-ttu-id="ec017-149">获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="ec017-149">Get the collection of files in a directory</span></span>|[<span data-ttu-id="ec017-150">如何：获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="ec017-150">How to: Get the Collection of Files in a Directory</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory)|  
|<span data-ttu-id="ec017-151">从**MyDocuments**目录中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-151">Read from the **MyDocuments** directory</span></span>|[<span data-ttu-id="ec017-152">如何：检索“我的文档”目录中的内容</span><span class="sxs-lookup"><span data-stu-id="ec017-152">How to: Retrieve the Contents of the My Documents Directory</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-retrieve-the-contents-of-the-my-documents-directory)|  
|<span data-ttu-id="ec017-153">分析文件路径</span><span class="sxs-lookup"><span data-stu-id="ec017-153">Parse a file path</span></span>|[<span data-ttu-id="ec017-154">如何：分析文件路径</span><span class="sxs-lookup"><span data-stu-id="ec017-154">How to: Parse File Paths</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-155">此示例将进行检查以确定文件夹 `C:\backup\logs` 是否存在并检查其属性。</span><span class="sxs-lookup"><span data-stu-id="ec017-155">This example checks to determine whether the folder `C:\backup\logs` exists and checks its properties.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#23](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#23)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:Microsoft.VisualBasic.FileIO.SpecialDirectories" />
    <related type="Article" href="/dotnet/visual-basic/language-reference/objects/"><span data-ttu-id="ec017-156">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="ec017-156">Objects (Visual Basic)</span></span></related>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public FileSystem ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; FileSystem();" />
      <MemberSignature Language="ILAsm" Value=".method public specialname rtspecialname instance void .ctor() cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="ec017-157">初始化 <see cref="T:Microsoft.VisualBasic.FileIO.FileSystem" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="ec017-157">Initializes a new instance of the <see cref="T:Microsoft.VisualBasic.FileIO.FileSystem" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 [<span data-ttu-id="ec017-158">对象（Visual Basic）</span><span class="sxs-lookup"><span data-stu-id="ec017-158">Objects (Visual Basic)</span></span>](/dotnet/visual-basic/language-reference/objects/)  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CombinePath">
      <MemberSignature Language="C#" Value="public static string CombinePath (string baseDirectory, string relativePath);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string CombinePath(string baseDirectory, string relativePath) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.CombinePath(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function CombinePath (baseDirectory As String, relativePath As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ CombinePath(System::String ^ baseDirectory, System::String ^ relativePath);" />
      <MemberSignature Language="F#" Value="static member CombinePath : string * string -&gt; string" Usage="Microsoft.VisualBasic.FileIO.FileSystem.CombinePath (baseDirectory, relativePath)" />
      <MemberSignature Language="ILAsm" Value=".method public static string CombinePath(string baseDirectory, string relativePath) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="baseDirectory" Type="System.String" />
        <Parameter Name="relativePath" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="baseDirectory"><span data-ttu-id="ec017-159"><see langword="String" /> 列中的一个值匹配。</span><span class="sxs-lookup"><span data-stu-id="ec017-159"><see langword="String" />.</span></span> <span data-ttu-id="ec017-160">要组合的第一个路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-160">First path to be combined.</span></span></param>
        <param name="relativePath"><span data-ttu-id="ec017-161"><see langword="String" /> 列中的一个值匹配。</span><span class="sxs-lookup"><span data-stu-id="ec017-161"><see langword="String" />.</span></span> <span data-ttu-id="ec017-162">要组合的第二个路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-162">Second path to be combined.</span></span></param>
        <summary><span data-ttu-id="ec017-163">组合两个路径并返回一个格式正确的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-163">Combines two paths and returns a properly formatted path.</span></span></summary>
        <returns><span data-ttu-id="ec017-164">指定路径的组合。</span><span class="sxs-lookup"><span data-stu-id="ec017-164">The combination of the specified paths.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-165">此方法修整多余的斜杠标记字符，以创建格式正确的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-165">This method trims excess slash-mark characters to create a properly formatted path.</span></span>  
  
 <span data-ttu-id="ec017-166">下表列出了涉及 `My.Computer.FileSystem.CombinePath` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-166">The following table lists an example of a task involving the `My.Computer.FileSystem.CombinePath` method.</span></span>  
  
|<span data-ttu-id="ec017-167">至</span><span class="sxs-lookup"><span data-stu-id="ec017-167">To</span></span>|<span data-ttu-id="ec017-168">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-168">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-169">合并目录路径和文件名</span><span class="sxs-lookup"><span data-stu-id="ec017-169">Combine a directory path and file name</span></span>|[<span data-ttu-id="ec017-170">如何：在 Visual Basic 中分析文件路径</span><span class="sxs-lookup"><span data-stu-id="ec017-170">How to: Parse File Paths in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-171">此示例将目录路径和文件名结合起来，以创建格式正确的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-171">This example combines a directory path and file name to create a properly formatted path.</span></span>  
  
 [!code-vb[VbRefFile#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#3)]  
  
 <span data-ttu-id="ec017-172">此示例合并了两个路径，以创建格式正确的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-172">This example combines two paths to create a properly formatted path.</span></span>  
  
 [!code-vb[VbRefFile#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#4)]  
  
 <span data-ttu-id="ec017-173">此示例将返回 `C:\Dir1\Dir2\Dir4\Dir5\File.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-173">This example returns `C:\Dir1\Dir2\Dir4\Dir5\File.txt`.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-174"><paramref name="baseDirectory" /> 或 <paramref name="relativePath" /> 是格式不正确的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-174"><paramref name="baseDirectory" /> or <paramref name="relativePath" /> are malformed paths.</span></span></exception>
        <altmember cref="M:Microsoft.VisualBasic.FileIO.FileSystem.GetParentPath(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="CopyDirectory">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-175">将目录内容复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-175">Copies the contents of a directory to another directory.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CopyDirectory">
      <MemberSignature Language="C#" Value="public static void CopyDirectory (string sourceDirectoryName, string destinationDirectoryName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CopyDirectory (sourceDirectoryName As String, destinationDirectoryName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CopyDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName);" />
      <MemberSignature Language="F#" Value="static member CopyDirectory : string * string -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory (sourceDirectoryName, destinationDirectoryName)" />
      <MemberSignature Language="ILAsm" Value=".method public static void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="ec017-176">要复制的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-176">The directory to be copied.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="ec017-177">应将目录内容复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-177">The location to which the directory contents should be copied.</span></span></param>
        <summary><span data-ttu-id="ec017-178">将目录内容复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-178">Copies the contents of a directory to another directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-179">此方法将源目录的内容复制到目标目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-179">This method copies the contents of the source directory to the target directory.</span></span> <span data-ttu-id="ec017-180">如果目标目录不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="ec017-180">If the target directory does not exist, it is created.</span></span> <span data-ttu-id="ec017-181">如果目标位置中存在具有相同名称的目录，则将合并这两个目录的内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-181">If a directory with the same name exists in the target location, the contents of the two directories are merged.</span></span> <span data-ttu-id="ec017-182">操作期间可为此目录指定新名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-182">You can specify a new name for the directory during the operation.</span></span>  
  
 <span data-ttu-id="ec017-183">在目录中复制文件时，可能会引发由特定文件导致的异常。</span><span class="sxs-lookup"><span data-stu-id="ec017-183">When copying files within a directory, exceptions may be thrown that are caused by a specific file.</span></span> <span data-ttu-id="ec017-184">如果引发此类异常，则会将它们合并为一个异常，该异常的 `Data` 属性以文件或目录路径为密钥，特定异常消息包含在对应值中的 <xref:System.Collections.IDictionary>。</span><span class="sxs-lookup"><span data-stu-id="ec017-184">When such exceptions are thrown, they are consolidated into a single exception whose `Data` property holds entries in the form of an <xref:System.Collections.IDictionary> in which the file or directory path is the key and the specific exception message is contained in the corresponding value.</span></span> <span data-ttu-id="ec017-185">使用 `For…Each` 来枚举条目。</span><span class="sxs-lookup"><span data-stu-id="ec017-185">Use `For…Each` to enumerate through the entries.</span></span>  
  
 <span data-ttu-id="ec017-186">下表列出了涉及 `My.Computer.FileSystem.CopyDirectory` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-186">The following table lists an example of a task involving the `My.Computer.FileSystem.CopyDirectory` method.</span></span>  
  
|<span data-ttu-id="ec017-187">至</span><span class="sxs-lookup"><span data-stu-id="ec017-187">To</span></span>|<span data-ttu-id="ec017-188">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-188">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-189">复制目录</span><span class="sxs-lookup"><span data-stu-id="ec017-189">Copy a directory</span></span>|[<span data-ttu-id="ec017-190">如何：在 Visual Basic 中将目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="ec017-190">How to: Copy a Directory to Another Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-191">下面的示例将目录 `TestDirectory1` 的内容复制到 `TestDirectory2`中。</span><span class="sxs-lookup"><span data-stu-id="ec017-191">The following example copies the contents of directory `TestDirectory1` into `TestDirectory2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#49](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#94)]  
  
 <span data-ttu-id="ec017-192">将 `C:\TestDirectory1` 和 `C:\TestDirectory2` 替换为要复制的目录的路径和名称以及要将该目录复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-192">Replace `C:\TestDirectory1` and `C:\TestDirectory2` with the path and name of the directory you wish to copy and the location to which you wish to copy it.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-193">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-193">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-194"><paramref name="destinationDirectoryName" /> 或 <paramref name="sourceDirectoryName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-194"><paramref name="destinationDirectoryName" /> or <paramref name="sourceDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-195">源目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-195">The source directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-196">源路径和目标路径相同。</span><span class="sxs-lookup"><span data-stu-id="ec017-196">The source path and target path are the same.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ec017-197">操作为循环。</span><span class="sxs-lookup"><span data-stu-id="ec017-197">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-198">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-198">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-199">路径中的文件夹名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-199">A folder name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-200">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-200">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-201">目标文件存在但无法访问。</span><span class="sxs-lookup"><span data-stu-id="ec017-201">A destination file exists but cannot be accessed.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="CopyDirectory">
      <MemberSignature Language="C#" Value="public static void CopyDirectory (string sourceDirectoryName, string destinationDirectoryName, Microsoft.VisualBasic.FileIO.UIOption showUI);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CopyDirectory (sourceDirectoryName As String, destinationDirectoryName As String, showUI As UIOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CopyDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, Microsoft::VisualBasic::FileIO::UIOption showUI);" />
      <MemberSignature Language="F#" Value="static member CopyDirectory : string * string * Microsoft.VisualBasic.FileIO.UIOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory (sourceDirectoryName, destinationDirectoryName, showUI)" />
      <MemberSignature Language="ILAsm" Value=".method public static void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="ec017-202">要复制的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-202">The directory to be copied.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="ec017-203">应将目录内容复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-203">The location to which the directory contents should be copied.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-204">是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-204">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-205">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-205">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <summary><span data-ttu-id="ec017-206">将目录内容复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-206">Copies the contents of a directory to another directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-207">此方法将源目录的内容复制到目标目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-207">This method copies the contents of the source directory to the target directory.</span></span> <span data-ttu-id="ec017-208">如果目标目录不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="ec017-208">If the target directory does not exist, it is created.</span></span> <span data-ttu-id="ec017-209">如果目标位置中存在具有相同名称的目录，则将合并这两个目录的内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-209">If a directory with the same name exists in the target location, the contents of the two directories are merged.</span></span> <span data-ttu-id="ec017-210">操作期间可为此目录指定新名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-210">You can specify a new name for the directory during the operation.</span></span>  
  
 <span data-ttu-id="ec017-211">在目录中复制文件时，可能会引发由特定文件导致的异常。</span><span class="sxs-lookup"><span data-stu-id="ec017-211">When copying files within a directory, exceptions may be thrown that are caused by a specific file.</span></span> <span data-ttu-id="ec017-212">如果引发此类异常，则会将它们合并为一个异常，该异常的 `Data` 属性以文件或目录路径为密钥，特定异常消息包含在对应值中的 <xref:System.Collections.IDictionary>。</span><span class="sxs-lookup"><span data-stu-id="ec017-212">When such exceptions are thrown, they are consolidated into a single exception whose `Data` property holds entries in the form of an <xref:System.Collections.IDictionary> in which the file or directory path is the key and the specific exception message is contained in the corresponding value.</span></span> <span data-ttu-id="ec017-213">使用 `For…Each` 来枚举条目。</span><span class="sxs-lookup"><span data-stu-id="ec017-213">Use `For…Each` to enumerate through the entries.</span></span>  
  
 <span data-ttu-id="ec017-214">下表列出了涉及 `My.Computer.FileSystem.CopyDirectory` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-214">The following table lists an example of a task involving the `My.Computer.FileSystem.CopyDirectory` method.</span></span>  
  
|<span data-ttu-id="ec017-215">至</span><span class="sxs-lookup"><span data-stu-id="ec017-215">To</span></span>|<span data-ttu-id="ec017-216">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-216">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-217">复制目录</span><span class="sxs-lookup"><span data-stu-id="ec017-217">Copy a directory</span></span>|[<span data-ttu-id="ec017-218">如何：在 Visual Basic 中将目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="ec017-218">How to: Copy a Directory to Another Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-219">下面的示例将目录 `TestDirectory1` 的内容复制到 `TestDirectory2`，并显示进度对话框和任何错误对话框。</span><span class="sxs-lookup"><span data-stu-id="ec017-219">The following example copies the contents of directory `TestDirectory1` into `TestDirectory2`, showing progress dialog and any error dialog.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#49](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#92)]  
  
 <span data-ttu-id="ec017-220">将 `C:\TestDirectory1` 和 `C:\TestDirectory2` 替换为要复制的目录的路径和名称以及要将该目录复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-220">Replace `C:\TestDirectory1` and `C:\TestDirectory2` with the path and name of the directory you wish to copy and the location to which you wish to copy it.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-221">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-221">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-222"><paramref name="destinationDirectoryName" /> 或 <paramref name="sourceDirectoryName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-222"><paramref name="destinationDirectoryName" /> or <paramref name="sourceDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-223">源目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-223">The source directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-224">源路径和目标路径相同。</span><span class="sxs-lookup"><span data-stu-id="ec017-224">The source path and target path are the same.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ec017-225">操作为循环。</span><span class="sxs-lookup"><span data-stu-id="ec017-225">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-226">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-226">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-227">路径中的文件夹名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-227">A folder name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-228">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-228">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-229">目标文件存在但无法访问。</span><span class="sxs-lookup"><span data-stu-id="ec017-229">A destination file exists but cannot be accessed.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="ec017-230"><paramref name="ShowUI" /> 设置为 <see langword="UIOption.AllDialogs" /> 且用户取消了该操作，或者无法复制目录中的一个或多个文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-230"><paramref name="ShowUI" /> is set to <see langword="UIOption.AllDialogs" /> and the user cancels the operation, or one or more files in the directory cannot be copied.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="CopyDirectory">
      <MemberSignature Language="C#" Value="public static void CopyDirectory (string sourceDirectoryName, string destinationDirectoryName, bool overwrite);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName, bool overwrite) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory(System.String,System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CopyDirectory (sourceDirectoryName As String, destinationDirectoryName As String, overwrite As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CopyDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, bool overwrite);" />
      <MemberSignature Language="F#" Value="static member CopyDirectory : string * string * bool -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory (sourceDirectoryName, destinationDirectoryName, overwrite)" />
      <MemberSignature Language="ILAsm" Value=".method public static void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName, bool overwrite) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
        <Parameter Name="overwrite" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="ec017-231">要复制的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-231">The directory to be copied.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="ec017-232">应将目录内容复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-232">The location to which the directory contents should be copied.</span></span></param>
        <param name="overwrite"><span data-ttu-id="ec017-233">要覆盖现有文件，则为 <see langword="True" />；否则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-233"><see langword="True" /> to overwrite existing files; otherwise <see langword="False" />.</span></span> <span data-ttu-id="ec017-234">默认为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-234">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="ec017-235">将目录内容复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-235">Copies the contents of a directory to another directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-236">此方法将源目录的内容复制到目标目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-236">This method copies the contents of the source directory to the target directory.</span></span> <span data-ttu-id="ec017-237">如果目标目录不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="ec017-237">If the target directory does not exist, it is created.</span></span> <span data-ttu-id="ec017-238">如果目标位置中存在具有相同名称的目录，则将合并这两个目录的内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-238">If a directory with the same name exists in the target location, the contents of the two directories are merged.</span></span> <span data-ttu-id="ec017-239">操作期间可为此目录指定新名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-239">You can specify a new name for the directory during the operation.</span></span>  
  
 <span data-ttu-id="ec017-240">在目录中复制文件时，可能会引发由特定文件导致的异常，如 `overwrite` 设置为 `False`时，在合并期间存在的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-240">When copying files within a directory, exceptions may be thrown that are caused by a specific file, such as a file existing during a merge while `overwrite` is set to `False`.</span></span> <span data-ttu-id="ec017-241">如果引发此类异常，则会将它们合并为一个异常，该异常的 `Data` 属性以文件或目录路径为密钥，特定异常消息包含在对应值中的 <xref:System.Collections.IDictionary>。</span><span class="sxs-lookup"><span data-stu-id="ec017-241">When such exceptions are thrown, they are consolidated into a single exception whose `Data` property holds entries in the form of an <xref:System.Collections.IDictionary> in which the file or directory path is the key and the specific exception message is contained in the corresponding value.</span></span> <span data-ttu-id="ec017-242">使用 `For…Each` 来枚举条目。</span><span class="sxs-lookup"><span data-stu-id="ec017-242">Use `For…Each` to enumerate through the entries.</span></span>  
  
 <span data-ttu-id="ec017-243">下表列出了涉及 `My.Computer.FileSystem.CopyDirectory` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-243">The following table lists an example of a task involving the `My.Computer.FileSystem.CopyDirectory` method.</span></span>  
  
|<span data-ttu-id="ec017-244">至</span><span class="sxs-lookup"><span data-stu-id="ec017-244">To</span></span>|<span data-ttu-id="ec017-245">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-245">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-246">复制目录</span><span class="sxs-lookup"><span data-stu-id="ec017-246">Copy a directory</span></span>|[<span data-ttu-id="ec017-247">如何：在 Visual Basic 中将目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="ec017-247">How to: Copy a Directory to Another Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-248">下面的示例将目录 `TestDirectory1` 的内容复制到 `TestDirectory2`，并覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-248">The following example copies the contents of directory `TestDirectory1` into `TestDirectory2`, overwriting existing files.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#49](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#49)]  
  
 <span data-ttu-id="ec017-249">将 `C:\TestDirectory1` 和 `C:\TestDirectory2` 替换为要复制的目录的路径和名称以及要将该目录复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-249">Replace `C:\TestDirectory1` and `C:\TestDirectory2` with the path and name of the directory you wish to copy and the location to which you wish to copy it.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-250">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-250">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-251"><paramref name="destinationDirectoryName" /> 或 <paramref name="sourceDirectoryName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-251"><paramref name="destinationDirectoryName" /> or <paramref name="sourceDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-252">源目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-252">The source directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-253">源路径和目标路径相同。</span><span class="sxs-lookup"><span data-stu-id="ec017-253">The source path and target path are the same.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ec017-254">操作为循环。</span><span class="sxs-lookup"><span data-stu-id="ec017-254">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-255">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-255">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-256">路径中的文件夹名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-256">A folder name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-257">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-257">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-258">目标文件存在但无法访问。</span><span class="sxs-lookup"><span data-stu-id="ec017-258">A destination file exists but cannot be accessed.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="CopyDirectory">
      <MemberSignature Language="C#" Value="public static void CopyDirectory (string sourceDirectoryName, string destinationDirectoryName, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CopyDirectory (sourceDirectoryName As String, destinationDirectoryName As String, showUI As UIOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CopyDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="static member CopyDirectory : string * string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory (sourceDirectoryName, destinationDirectoryName, showUI, onUserCancel)" />
      <MemberSignature Language="ILAsm" Value=".method public static void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="ec017-259">要复制的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-259">The directory to be copied.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="ec017-260">应将目录内容复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-260">The location to which the directory contents should be copied.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-261">是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-261">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-262">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-262">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="ec017-263">指定当用户在操作过程中单击“取消”时应执行的操作。</span><span class="sxs-lookup"><span data-stu-id="ec017-263">Specifies what should be done if the user clicks **Cancel** during the operation.</span></span> <span data-ttu-id="ec017-264">默认为 <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-264">Default is <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span></span></param>
        <summary><span data-ttu-id="ec017-265">将目录内容复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-265">Copies the contents of a directory to another directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-266">此方法将源目录的内容复制到目标目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-266">This method copies the contents of the source directory to the target directory.</span></span> <span data-ttu-id="ec017-267">如果目标目录不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="ec017-267">If the target directory does not exist, it is created.</span></span> <span data-ttu-id="ec017-268">如果目标位置中存在具有相同名称的目录，则将合并这两个目录的内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-268">If a directory with the same name exists in the target location, the contents of the two directories are merged.</span></span> <span data-ttu-id="ec017-269">操作期间可为此目录指定新名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-269">You can specify a new name for the directory during the operation.</span></span>  
  
 <span data-ttu-id="ec017-270">在目录中复制文件时，可能会引发由特定文件导致的异常。</span><span class="sxs-lookup"><span data-stu-id="ec017-270">When copying files within a directory, exceptions may be thrown that are caused by a specific file.</span></span> <span data-ttu-id="ec017-271">如果引发此类异常，则会将它们合并为一个异常，该异常的 `Data` 属性以文件或目录路径为密钥，特定异常消息包含在对应值中的 <xref:System.Collections.IDictionary>。</span><span class="sxs-lookup"><span data-stu-id="ec017-271">When such exceptions are thrown, they are consolidated into a single exception whose `Data` property holds entries in the form of an <xref:System.Collections.IDictionary> in which the file or directory path is the key and the specific exception message is contained in the corresponding value.</span></span> <span data-ttu-id="ec017-272">使用 `For…Each` 来枚举条目。</span><span class="sxs-lookup"><span data-stu-id="ec017-272">Use `For…Each` to enumerate through the entries.</span></span>  
  
 <span data-ttu-id="ec017-273">下表列出了涉及 `My.Computer.FileSystem.CopyDirectory` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-273">The following table lists an example of a task involving the `My.Computer.FileSystem.CopyDirectory` method.</span></span>  
  
|<span data-ttu-id="ec017-274">至</span><span class="sxs-lookup"><span data-stu-id="ec017-274">To</span></span>|<span data-ttu-id="ec017-275">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-275">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-276">复制目录</span><span class="sxs-lookup"><span data-stu-id="ec017-276">Copy a directory</span></span>|[<span data-ttu-id="ec017-277">如何：在 Visual Basic 中将目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="ec017-277">How to: Copy a Directory to Another Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-278">下面的示例将目录 `TestDirectory1` 的内容复制到 `TestDirectory2`，显示进度对话框和任何错误对话框，如果用户在操作过程中单击 "**取消**"，则不执行任何操作。</span><span class="sxs-lookup"><span data-stu-id="ec017-278">The following example copies the contents of directory `TestDirectory1` into `TestDirectory2`, showing progress dialog and any error dialog, and does nothing if the user clicks **Cancel** during the operation.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#49](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#93)]  
  
 <span data-ttu-id="ec017-279">将 `C:\TestDirectory1` 和 `C:\TestDirectory2` 替换为要复制的目录的路径和名称以及要将该目录复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-279">Replace `C:\TestDirectory1` and `C:\TestDirectory2` with the path and name of the directory you wish to copy and the location to which you wish to copy it.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-280">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-280">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-281"><paramref name="destinationDirectoryName" /> 或 <paramref name="sourceDirectoryName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-281"><paramref name="destinationDirectoryName" /> or <paramref name="sourceDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-282">源目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-282">The source directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-283">源路径和目标路径相同。</span><span class="sxs-lookup"><span data-stu-id="ec017-283">The source path and target path are the same.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ec017-284">操作为循环。</span><span class="sxs-lookup"><span data-stu-id="ec017-284">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-285">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-285">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-286">路径中的文件夹名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-286">A folder name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-287">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-287">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-288">目标文件存在但无法访问。</span><span class="sxs-lookup"><span data-stu-id="ec017-288">A destination file exists but cannot be accessed.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="ec017-289"><paramref name="ShowUI" /> 设置为 <see langword="UIOption.AllDialogs" /> 且用户取消了该操作，或者无法复制目录中的一个或多个文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-289"><paramref name="ShowUI" /> is set to <see langword="UIOption.AllDialogs" /> and the user cancels the operation, or one or more files in the directory cannot be copied.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <MemberGroup MemberName="CopyFile">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-290">将文件复制到新的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-290">Copies a file to a new location.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CopyFile">
      <MemberSignature Language="C#" Value="public static void CopyFile (string sourceFileName, string destinationFileName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CopyFile(string sourceFileName, string destinationFileName) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.CopyFile(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CopyFile (sourceFileName As String, destinationFileName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CopyFile(System::String ^ sourceFileName, System::String ^ destinationFileName);" />
      <MemberSignature Language="F#" Value="static member CopyFile : string * string -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.CopyFile (sourceFileName, destinationFileName)" />
      <MemberSignature Language="ILAsm" Value=".method public static void CopyFile(string sourceFileName, string destinationFileName) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="ec017-291">要复制的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-291">The file to be copied.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="ec017-292">文件应复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-292">The location to which the file should be copied.</span></span></param>
        <summary><span data-ttu-id="ec017-293">将文件复制到新的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-293">Copies a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-294">`CopyFile` 不会保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="ec017-294">`CopyFile` does not preserve ACEs (Access Control Entries).</span></span> <span data-ttu-id="ec017-295">新创建的文件从创建它的目录继承默认的 Ace。</span><span class="sxs-lookup"><span data-stu-id="ec017-295">The newly created file inherits default ACEs from the directory in which it is created.</span></span>  
  
 <span data-ttu-id="ec017-296">下表列出了涉及 `My.Computer.FileSystem.CopyFile` 方法的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-296">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyFile` method.</span></span>  
  
|<span data-ttu-id="ec017-297">至</span><span class="sxs-lookup"><span data-stu-id="ec017-297">To</span></span>|<span data-ttu-id="ec017-298">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-298">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-299">将文件复制到相同的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-299">Copy a file to the same directory.</span></span>|[<span data-ttu-id="ec017-300">如何：在 Visual Basic 中的同一目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="ec017-300">How to: Create a Copy of a File in the Same Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory)|  
|<span data-ttu-id="ec017-301">将文件复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-301">Copy a file to a different directory.</span></span>|[<span data-ttu-id="ec017-302">如何：在 Visual Basic 中的其他目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="ec017-302">How to: Create a Copy of a File in a Different Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-303">此示例将文件 `Test.txt` 复制到目录 `TestFiles2` 而不覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-303">This example copies the file `Test.txt` to the directory `TestFiles2` without overwriting existing files.</span></span>  
  
 [!code-vb[VbRefFile#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#15)]  
  
 <span data-ttu-id="ec017-304">将文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-304">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 <span data-ttu-id="ec017-305">此示例将文件 `Test.txt` 复制到目录 `TestFiles2` 并将其重命名 `NewFile.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-305">This example copies the file `Test.txt` to the directory `TestFiles2` and renames it `NewFile.txt`.</span></span>  
  
 [!code-vb[VbRefFile#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#16)]  
  
 <span data-ttu-id="ec017-306">将文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-306">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-307"><paramref name="destinationFileName" /> 包含路径信息。</span><span class="sxs-lookup"><span data-stu-id="ec017-307"><paramref name="destinationFileName" /> contains path information.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-308"><paramref name="destinationFileName" /> 或 <paramref name="sourceFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-308"><paramref name="destinationFileName" /> or <paramref name="sourceFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-309">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-309">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-310">目标目录中的同名文件正被使用。</span><span class="sxs-lookup"><span data-stu-id="ec017-310">A file in the target directory with the same name is in use.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-311">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-311">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-312">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-312">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-313">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-313">The user does not have required permission.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-314">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-314">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="CopyFile">
      <MemberSignature Language="C#" Value="public static void CopyFile (string sourceFileName, string destinationFileName, Microsoft.VisualBasic.FileIO.UIOption showUI);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CopyFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.CopyFile(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CopyFile (sourceFileName As String, destinationFileName As String, showUI As UIOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CopyFile(System::String ^ sourceFileName, System::String ^ destinationFileName, Microsoft::VisualBasic::FileIO::UIOption showUI);" />
      <MemberSignature Language="F#" Value="static member CopyFile : string * string * Microsoft.VisualBasic.FileIO.UIOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.CopyFile (sourceFileName, destinationFileName, showUI)" />
      <MemberSignature Language="ILAsm" Value=".method public static void CopyFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="ec017-315">要复制的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-315">The file to be copied.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="ec017-316">文件应复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-316">The location to which the file should be copied.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-317">是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-317">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-318">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-318">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <summary><span data-ttu-id="ec017-319">将文件复制到新的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-319">Copies a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-320">`CopyFile` 不会保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="ec017-320">`CopyFile` does not preserve ACEs (Access Control Entries).</span></span> <span data-ttu-id="ec017-321">新创建的文件从创建它的目录继承默认的 Ace。</span><span class="sxs-lookup"><span data-stu-id="ec017-321">The newly created file inherits default ACEs from the directory in which it is created.</span></span>  
  
 <span data-ttu-id="ec017-322">下表列出了涉及 `My.Computer.FileSystem.CopyFile` 方法的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-322">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyFile` method.</span></span>  
  
|<span data-ttu-id="ec017-323">至</span><span class="sxs-lookup"><span data-stu-id="ec017-323">To</span></span>|<span data-ttu-id="ec017-324">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-324">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-325">将文件复制到相同的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-325">Copy a file to the same directory.</span></span>|[<span data-ttu-id="ec017-326">如何：在 Visual Basic 中的同一目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="ec017-326">How to: Create a Copy of a File in the Same Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory)|  
|<span data-ttu-id="ec017-327">将文件复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-327">Copy a file to a different directory.</span></span>|[<span data-ttu-id="ec017-328">如何：在 Visual Basic 中的其他目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="ec017-328">How to: Create a Copy of a File in a Different Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-329">此示例将文件 `Test.txt` 复制到目录 `TestFiles2` 而不覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-329">This example copies the file `Test.txt` to the directory `TestFiles2` without overwriting existing files.</span></span>  
  
 [!code-vb[VbRefFile#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#15)]  
  
 <span data-ttu-id="ec017-330">将文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-330">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 <span data-ttu-id="ec017-331">此示例将文件 `Test.txt` 复制到目录 `TestFiles2` 并将其重命名 `NewFile.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-331">This example copies the file `Test.txt` to the directory `TestFiles2` and renames it `NewFile.txt`.</span></span>  
  
 [!code-vb[VbRefFile#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#16)]  
  
 <span data-ttu-id="ec017-332">将文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-332">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-333"><paramref name="destinationFileName" /> 包含路径信息。</span><span class="sxs-lookup"><span data-stu-id="ec017-333"><paramref name="destinationFileName" /> contains path information.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-334"><paramref name="destinationFileName" /> 或 <paramref name="sourceFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-334"><paramref name="destinationFileName" /> or <paramref name="sourceFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-335">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-335">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-336">目标文件存在，并且 <paramref name="overwrite" /> 设置为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-336">The destination file exists and <paramref name="overwrite" /> is set to <see langword="False" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-337">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-337">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-338">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-338">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-339">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-339">The user does not have required permission.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-340">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-340">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="CopyFile">
      <MemberSignature Language="C#" Value="public static void CopyFile (string sourceFileName, string destinationFileName, bool overwrite);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CopyFile(string sourceFileName, string destinationFileName, bool overwrite) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.CopyFile(System.String,System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CopyFile (sourceFileName As String, destinationFileName As String, overwrite As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CopyFile(System::String ^ sourceFileName, System::String ^ destinationFileName, bool overwrite);" />
      <MemberSignature Language="F#" Value="static member CopyFile : string * string * bool -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.CopyFile (sourceFileName, destinationFileName, overwrite)" />
      <MemberSignature Language="ILAsm" Value=".method public static void CopyFile(string sourceFileName, string destinationFileName, bool overwrite) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="overwrite" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="ec017-341">要复制的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-341">The file to be copied.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="ec017-342">文件应复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-342">The location to which the file should be copied.</span></span></param>
        <param name="overwrite"><span data-ttu-id="ec017-343">如果应覆盖现有文件，则为 <see langword="True" />；否则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-343"><see langword="True" /> if existing files should be overwritten; otherwise <see langword="False" />.</span></span> <span data-ttu-id="ec017-344">默认为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-344">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="ec017-345">将文件复制到新的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-345">Copies a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-346">`CopyFile` 不会保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="ec017-346">`CopyFile` does not preserve ACEs (Access Control Entries).</span></span> <span data-ttu-id="ec017-347">新创建的文件从创建它的目录继承默认的 Ace。</span><span class="sxs-lookup"><span data-stu-id="ec017-347">The newly created file inherits default ACEs from the directory in which it is created.</span></span>  
  
 <span data-ttu-id="ec017-348">下表列出了涉及 `My.Computer.FileSystem.CopyFile` 方法的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-348">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyFile` method.</span></span>  
  
|<span data-ttu-id="ec017-349">至</span><span class="sxs-lookup"><span data-stu-id="ec017-349">To</span></span>|<span data-ttu-id="ec017-350">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-350">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-351">将文件复制到相同的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-351">Copy a file to the same directory.</span></span>|[<span data-ttu-id="ec017-352">如何：在 Visual Basic 中的同一目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="ec017-352">How to: Create a Copy of a File in the Same Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory)|  
|<span data-ttu-id="ec017-353">将文件复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-353">Copy a file to a different directory.</span></span>|[<span data-ttu-id="ec017-354">如何：在 Visual Basic 中的其他目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="ec017-354">How to: Create a Copy of a File in a Different Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-355">此示例将文件 `Test.txt` 复制到目录 `TestFiles2` 而不覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-355">This example copies the file `Test.txt` to the directory `TestFiles2` without overwriting existing files.</span></span>  
  
 [!code-vb[VbRefFile#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#15)]  
  
 <span data-ttu-id="ec017-356">将文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-356">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 <span data-ttu-id="ec017-357">此示例将文件 `Test.txt` 复制到目录 `TestFiles2` 并将其重命名 `NewFile.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-357">This example copies the file `Test.txt` to the directory `TestFiles2` and renames it `NewFile.txt`.</span></span>  
  
 [!code-vb[VbRefFile#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#16)]  
  
 <span data-ttu-id="ec017-358">将文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-358">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-359"><paramref name="destinationFileName" /> 包含路径信息。</span><span class="sxs-lookup"><span data-stu-id="ec017-359"><paramref name="destinationFileName" /> contains path information.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-360"><paramref name="destinationFileName" /> 或 <paramref name="sourceFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-360"><paramref name="destinationFileName" /> or <paramref name="sourceFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-361">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-361">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-362">目标文件存在，并且 <paramref name="overwrite" /> 设置为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-362">The destination file exists and <paramref name="overwrite" /> is set to <see langword="False" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-363">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-363">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-364">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-364">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-365">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-365">The user does not have required permission.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-366">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-366">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="CopyFile">
      <MemberSignature Language="C#" Value="public static void CopyFile (string sourceFileName, string destinationFileName, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CopyFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.CopyFile(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CopyFile (sourceFileName As String, destinationFileName As String, showUI As UIOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CopyFile(System::String ^ sourceFileName, System::String ^ destinationFileName, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="static member CopyFile : string * string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.CopyFile (sourceFileName, destinationFileName, showUI, onUserCancel)" />
      <MemberSignature Language="ILAsm" Value=".method public static void CopyFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="ec017-367">要复制的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-367">The file to be copied.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="ec017-368">文件应复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-368">The location to which the file should be copied.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-369">是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-369">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-370">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-370">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="ec017-371">指定当用户在操作过程中单击“取消”时应执行的操作。</span><span class="sxs-lookup"><span data-stu-id="ec017-371">Specifies what should be done if the user clicks **Cancel** during the operation.</span></span> <span data-ttu-id="ec017-372">默认为 <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-372">Default is <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span></span></param>
        <summary><span data-ttu-id="ec017-373">将文件复制到新的位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-373">Copies a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-374">`CopyFile` 不会保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="ec017-374">`CopyFile` does not preserve ACEs (Access Control Entries).</span></span> <span data-ttu-id="ec017-375">新创建的文件从创建它的目录继承默认的 Ace。</span><span class="sxs-lookup"><span data-stu-id="ec017-375">The newly created file inherits default ACEs from the directory in which it is created.</span></span>  
  
 <span data-ttu-id="ec017-376">下表列出了涉及 `My.Computer.FileSystem.CopyFile` 方法的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-376">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyFile` method.</span></span>  
  
|<span data-ttu-id="ec017-377">至</span><span class="sxs-lookup"><span data-stu-id="ec017-377">To</span></span>|<span data-ttu-id="ec017-378">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-378">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-379">将文件复制到相同的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-379">Copy a file to the same directory.</span></span>|[<span data-ttu-id="ec017-380">如何：在 Visual Basic 中的同一目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="ec017-380">How to: Create a Copy of a File in the Same Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory)|  
|<span data-ttu-id="ec017-381">将文件复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-381">Copy a file to a different directory.</span></span>|[<span data-ttu-id="ec017-382">如何：在 Visual Basic 中的其他目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="ec017-382">How to: Create a Copy of a File in a Different Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-383">此示例将文件 `Test.txt` 复制到目录 `TestFiles2` 而不覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-383">This example copies the file `Test.txt` to the directory `TestFiles2` without overwriting existing files.</span></span>  
  
 [!code-vb[VbRefFile#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#15)]  
  
 <span data-ttu-id="ec017-384">将文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-384">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 <span data-ttu-id="ec017-385">此示例将文件 `Test.txt` 复制到目录 `TestFiles2` 并将其重命名 `NewFile.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-385">This example copies the file `Test.txt` to the directory `TestFiles2` and renames it `NewFile.txt`.</span></span>  
  
 [!code-vb[VbRefFile#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#16)]  
  
 <span data-ttu-id="ec017-386">将文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-386">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-387"><paramref name="destinationFileName" /> 包含路径信息。</span><span class="sxs-lookup"><span data-stu-id="ec017-387"><paramref name="destinationFileName" /> contains path information.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-388"><paramref name="destinationFileName" /> 或 <paramref name="sourceFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-388"><paramref name="destinationFileName" /> or <paramref name="sourceFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-389">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-389">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-390">目标文件存在，并且 <paramref name="overwrite" /> 设置为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-390">The destination file exists and <paramref name="overwrite" /> is set to <see langword="False" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-391">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-391">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-392">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-392">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-393">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-393">The user does not have required permission.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-394">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-394">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="ec017-395"><paramref name="UICancelOption" /> 设置为 <see langword="ThrowException" />，并且用户已经取消了该操作或者发生了未指定的 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-395"><paramref name="UICancelOption" /> is set to <see langword="ThrowException" />, and the user has canceled the operation or an unspecified I/O error occurs.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="CreateDirectory">
      <MemberSignature Language="C#" Value="public static void CreateDirectory (string directory);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateDirectory(string directory) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.CreateDirectory(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateDirectory (directory As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateDirectory(System::String ^ directory);" />
      <MemberSignature Language="F#" Value="static member CreateDirectory : string -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.CreateDirectory directory" />
      <MemberSignature Language="ILAsm" Value=".method public static void CreateDirectory(string directory) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-396">目录的名称和位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-396">Name and location of the directory.</span></span></param>
        <summary><span data-ttu-id="ec017-397">创建目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-397">Creates a directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-398">如果该目录已存在，则不引发任何异常。</span><span class="sxs-lookup"><span data-stu-id="ec017-398">If the directory already exists, no exception is thrown.</span></span>  
  
 <span data-ttu-id="ec017-399">下表列出了涉及 `My.Computer.FileSystem.CreateDirectory` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-399">The following table lists an example of a task involving the `My.Computer.FileSystem.CreateDirectory` method.</span></span>  
  
|<span data-ttu-id="ec017-400">至</span><span class="sxs-lookup"><span data-stu-id="ec017-400">To</span></span>|<span data-ttu-id="ec017-401">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-401">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-402">创建目录</span><span class="sxs-lookup"><span data-stu-id="ec017-402">Create a directory</span></span>|[<span data-ttu-id="ec017-403">如何：在 Visual Basic 中创建目录</span><span class="sxs-lookup"><span data-stu-id="ec017-403">How to: Create a Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-directory)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-404">此示例在 `C:\Documents and Settings\All Users\Documents`创建目录 `NewDirectory`。</span><span class="sxs-lookup"><span data-stu-id="ec017-404">This example creates the directory, `NewDirectory`, in `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#17](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#17)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-405">目录名称格式不正确。</span><span class="sxs-lookup"><span data-stu-id="ec017-405">The directory name is malformed.</span></span> <span data-ttu-id="ec017-406">例如，它包含非法字符或仅包含空白。</span><span class="sxs-lookup"><span data-stu-id="ec017-406">For example, it contains illegal characters or is only white space.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-407"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-407"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-408">目录名太长。</span><span class="sxs-lookup"><span data-stu-id="ec017-408">The directory name is too long.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-409">目录名只是一个冒号 (:)。</span><span class="sxs-lookup"><span data-stu-id="ec017-409">The directory name is only a colon (:).</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-410">要创建的目录的父目录是只读的。</span><span class="sxs-lookup"><span data-stu-id="ec017-410">The parent directory of the directory to be created is read-only</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-411">用户没有创建目录的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-411">The user does not have permission to create the directory.</span></span></exception>
        <altmember cref="M:System.IO.Directory.CreateDirectory(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="CurrentDirectory">
      <MemberSignature Language="C#" Value="public static string CurrentDirectory { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property string CurrentDirectory" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.FileIO.FileSystem.CurrentDirectory" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property CurrentDirectory As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::String ^ CurrentDirectory { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.CurrentDirectory : string with get, set" Usage="Microsoft.VisualBasic.FileIO.FileSystem.CurrentDirectory" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ec017-412">获取或设置当前目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-412">Gets or sets the current directory.</span></span></summary>
        <value><span data-ttu-id="ec017-413">文件 I/O 操作的当前目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-413">The current directory for file I/O operations.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-414">`CurrentDirectory` 是系统范围的环境变量。</span><span class="sxs-lookup"><span data-stu-id="ec017-414">`CurrentDirectory` is a system-wide environment variable.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-415">此示例将返回当前目录，并将其显示在消息框中。</span><span class="sxs-lookup"><span data-stu-id="ec017-415">This example returns the current directory and displays it in a message box.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#18)]  
  
 <span data-ttu-id="ec017-416">此示例将当前目录设置为 `C:\TestDirectory`。</span><span class="sxs-lookup"><span data-stu-id="ec017-416">This example sets the current directory to `C:\TestDirectory`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#19](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-417">该路径无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-417">The path is not valid.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-418">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-418">The user lacks necessary permissions.</span></span></exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteDirectory">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-419">删除目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-419">Deletes a directory.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteDirectory">
      <MemberSignature Language="C#" Value="public static void DeleteDirectory (string directory, Microsoft.VisualBasic.FileIO.DeleteDirectoryOption onDirectoryNotEmpty);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteDirectory(string directory, valuetype Microsoft.VisualBasic.FileIO.DeleteDirectoryOption onDirectoryNotEmpty) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.DeleteDirectory(System.String,Microsoft.VisualBasic.FileIO.DeleteDirectoryOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteDirectory (directory As String, onDirectoryNotEmpty As DeleteDirectoryOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteDirectory(System::String ^ directory, Microsoft::VisualBasic::FileIO::DeleteDirectoryOption onDirectoryNotEmpty);" />
      <MemberSignature Language="F#" Value="static member DeleteDirectory : string * Microsoft.VisualBasic.FileIO.DeleteDirectoryOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.DeleteDirectory (directory, onDirectoryNotEmpty)" />
      <MemberSignature Language="ILAsm" Value=".method public static void DeleteDirectory(string directory, valuetype Microsoft.VisualBasic.FileIO.DeleteDirectoryOption onDirectoryNotEmpty) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
        <Parameter Name="onDirectoryNotEmpty" Type="Microsoft.VisualBasic.FileIO.DeleteDirectoryOption" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-420">要删除的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-420">Directory to be deleted.</span></span></param>
        <param name="onDirectoryNotEmpty"><span data-ttu-id="ec017-421">指定当要删除的目录中含有文件或目录时应采取的操作。</span><span class="sxs-lookup"><span data-stu-id="ec017-421">Specifies what should be done when a directory that is to be deleted contains files or directories.</span></span> <span data-ttu-id="ec017-422">默认为 <see langword="DeleteDirectoryOption.DeleteAllContents" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-422">Default is <see langword="DeleteDirectoryOption.DeleteAllContents" />.</span></span></param>
        <summary><span data-ttu-id="ec017-423">删除目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-423">Deletes a directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="ec017-424">仅当目录为空时，此示例才会删除目录 `OldDirectory`。</span><span class="sxs-lookup"><span data-stu-id="ec017-424">The example deletes the directory `OldDirectory` only if it is empty.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#56](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#56)]  
  
 <span data-ttu-id="ec017-425">此示例将删除目录 `OldDirectory` 及其所有内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-425">This example deletes the directory `OldDirectory` and all of its contents.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#57](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#57)]  
  
 <span data-ttu-id="ec017-426">此示例将删除目录 `OldDirectory` 及其所有内容，要求用户确认删除，但不会将内容发送到**回收站**。</span><span class="sxs-lookup"><span data-stu-id="ec017-426">This example deletes the directory `OldDirectory` and all of its contents, asking the user to confirm the deletion, but does not send the contents to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#58](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#58)]  
  
 <span data-ttu-id="ec017-427">此示例将删除目录 `OldDirectory` 及其所有内容，并将其发送到**回收站**，但不会显示操作的进度。</span><span class="sxs-lookup"><span data-stu-id="ec017-427">This example deletes the directory `OldDirectory` and all of its contents, sending them to the **Recycle Bin**, but does not show the progress of the operation.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#59)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-428">路径是零长度字符串、格式不正确、仅包含空白，或者包含无效字符（包括通配符）。</span><span class="sxs-lookup"><span data-stu-id="ec017-428">The path is a zero-length string, is malformed, contains only white space, or contains invalid characters (including wildcard characters).</span></span> <span data-ttu-id="ec017-429">路径是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-429">The path is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-430"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-430"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-431">目录不存在，或者目录是一个文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-431">The directory does not exist or is a file.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-432">目录或子目录中的某个文件正被使用。</span><span class="sxs-lookup"><span data-stu-id="ec017-432">A file in the directory or subdirectory is in use.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-433">目录名中包含冒号 (:)。</span><span class="sxs-lookup"><span data-stu-id="ec017-433">The directory name contains a colon (:).</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-434">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-434">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-435">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-435">The user does not have required permissions.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="ec017-436">用户取消了操作，或无法删除该目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-436">The user cancels the operation or the directory cannot be deleted.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.DeleteDirectoryOption" />
      </Docs>
    </Member>
    <Member MemberName="DeleteDirectory">
      <MemberSignature Language="C#" Value="public static void DeleteDirectory (string directory, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.RecycleOption recycle);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteDirectory(string directory, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.DeleteDirectory(System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.RecycleOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteDirectory (directory As String, showUI As UIOption, recycle As RecycleOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteDirectory(System::String ^ directory, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::RecycleOption recycle);" />
      <MemberSignature Language="F#" Value="static member DeleteDirectory : string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.RecycleOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.DeleteDirectory (directory, showUI, recycle)" />
      <MemberSignature Language="ILAsm" Value=".method public static void DeleteDirectory(string directory, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
        <Parameter Name="recycle" Type="Microsoft.VisualBasic.FileIO.RecycleOption" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-437">要删除的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-437">Directory to be deleted.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-438">指定是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-438">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-439">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-439">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="recycle"><span data-ttu-id="ec017-440">指定是否应将删除的文件发送到“回收站”。</span><span class="sxs-lookup"><span data-stu-id="ec017-440">Specifies whether or not the deleted file should be sent to the **Recycle Bin**.</span></span> <span data-ttu-id="ec017-441">默认为 <see langword="RecycleOption.DeletePermanently" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-441">Default is <see langword="RecycleOption.DeletePermanently" />.</span></span></param>
        <summary><span data-ttu-id="ec017-442">删除目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-442">Deletes a directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-443">不是用户交互的应用程序（如 Windows 服务）不支持 `showUI` 和 `recycle` 参数。</span><span class="sxs-lookup"><span data-stu-id="ec017-443">The `showUI` and `recycle` parameters are not supported in applications that are not user interactive, such as Windows Services.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-444">仅当目录为空时，此示例才会删除目录 `OldDirectory`。</span><span class="sxs-lookup"><span data-stu-id="ec017-444">The example deletes the directory `OldDirectory` only if it is empty.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#56](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#56)]  
  
 <span data-ttu-id="ec017-445">此示例将删除目录 `OldDirectory` 及其所有内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-445">This example deletes the directory `OldDirectory` and all of its contents.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#57](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#57)]  
  
 <span data-ttu-id="ec017-446">此示例将删除目录 `OldDirectory` 及其所有内容，要求用户确认删除，但不会将内容发送到**回收站**。</span><span class="sxs-lookup"><span data-stu-id="ec017-446">This example deletes the directory `OldDirectory` and all of its contents, asking the user to confirm the deletion, but does not send the contents to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#58](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#58)]  
  
 <span data-ttu-id="ec017-447">此示例将删除目录 `OldDirectory` 及其所有内容，并将其发送到**回收站**，但不会显示操作的进度。</span><span class="sxs-lookup"><span data-stu-id="ec017-447">This example deletes the directory `OldDirectory` and all of its contents, sending them to the **Recycle Bin**, but does not show the progress of the operation.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#59)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-448">路径是零长度字符串、格式不正确、仅包含空白，或者包含无效字符（包括通配符）。</span><span class="sxs-lookup"><span data-stu-id="ec017-448">The path is a zero-length string, is malformed, contains only white space, or contains invalid characters (including wildcard characters).</span></span> <span data-ttu-id="ec017-449">路径是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-449">The path is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-450"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-450"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-451">目录不存在，或者目录是一个文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-451">The directory does not exist or is a file.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-452">目录或子目录中的某个文件正被使用。</span><span class="sxs-lookup"><span data-stu-id="ec017-452">A file in the directory or subdirectory is in use.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-453">目录名中包含冒号 (:)。</span><span class="sxs-lookup"><span data-stu-id="ec017-453">The directory name contains a colon (:).</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-454">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-454">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-455">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-455">The user does not have required permissions.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="ec017-456">用户取消了操作，或无法删除该目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-456">The user cancels the operation or the directory cannot be deleted.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.RecycleOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
      </Docs>
    </Member>
    <Member MemberName="DeleteDirectory">
      <MemberSignature Language="C#" Value="public static void DeleteDirectory (string directory, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.RecycleOption recycle, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteDirectory(string directory, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.DeleteDirectory(System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.RecycleOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteDirectory (directory As String, showUI As UIOption, recycle As RecycleOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteDirectory(System::String ^ directory, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::RecycleOption recycle, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="static member DeleteDirectory : string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.RecycleOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.DeleteDirectory (directory, showUI, recycle, onUserCancel)" />
      <MemberSignature Language="ILAsm" Value=".method public static void DeleteDirectory(string directory, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
        <Parameter Name="recycle" Type="Microsoft.VisualBasic.FileIO.RecycleOption" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-457">要删除的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-457">Directory to be deleted.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-458">指定是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-458">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-459">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-459">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="recycle"><span data-ttu-id="ec017-460">指定是否应将删除的文件发送到“回收站”。</span><span class="sxs-lookup"><span data-stu-id="ec017-460">Specifies whether or not the deleted file should be sent to the **Recycle Bin**.</span></span> <span data-ttu-id="ec017-461">默认为 <see langword="RecycleOption.DeletePermanently" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-461">Default is <see langword="RecycleOption.DeletePermanently" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="ec017-462">指定在用户单击“取消”时是否引发异常。</span><span class="sxs-lookup"><span data-stu-id="ec017-462">Specifies whether to throw an exception if the user clicks **Cancel**.</span></span></param>
        <summary><span data-ttu-id="ec017-463">删除目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-463">Deletes a directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-464">不是用户交互的应用程序（如 Windows 服务）不支持 `showUI`、`recycle`和 `onUserCancel` 参数。</span><span class="sxs-lookup"><span data-stu-id="ec017-464">The `showUI`, `recycle`, and `onUserCancel` parameters are not supported in applications that are not user interactive, such as Windows Services.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-465">仅当目录为空时，此示例才会删除目录 `OldDirectory`。</span><span class="sxs-lookup"><span data-stu-id="ec017-465">The example deletes the directory `OldDirectory` only if it is empty.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#56](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#56)]  
  
 <span data-ttu-id="ec017-466">此示例将删除目录 `OldDirectory` 及其所有内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-466">This example deletes the directory `OldDirectory` and all of its contents.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#57](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#57)]  
  
 <span data-ttu-id="ec017-467">此示例将删除目录 `OldDirectory` 及其所有内容，要求用户确认删除，但不会将内容发送到**回收站**。</span><span class="sxs-lookup"><span data-stu-id="ec017-467">This example deletes the directory `OldDirectory` and all of its contents, asking the user to confirm the deletion, but does not send the contents to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#58](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#58)]  
  
 <span data-ttu-id="ec017-468">此示例将删除目录 `OldDirectory` 及其所有内容，并将其发送到**回收站**，但不会显示操作的进度。</span><span class="sxs-lookup"><span data-stu-id="ec017-468">This example deletes the directory `OldDirectory` and all of its contents, sending them to the **Recycle Bin**, but does not show the progress of the operation.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#59)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-469">路径是零长度字符串、格式不正确、仅包含空白，或者包含无效字符（包括通配符）。</span><span class="sxs-lookup"><span data-stu-id="ec017-469">The path is a zero-length string, is malformed, contains only white space, or contains invalid characters (including wildcard characters).</span></span> <span data-ttu-id="ec017-470">路径是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-470">The path is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-471"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-471"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-472">目录不存在，或者目录是一个文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-472">The directory does not exist or is a file.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-473">目录或子目录中的某个文件正被使用。</span><span class="sxs-lookup"><span data-stu-id="ec017-473">A file in the directory or subdirectory is in use.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-474">目录名中包含冒号 (:)。</span><span class="sxs-lookup"><span data-stu-id="ec017-474">The directory name contains a colon (:).</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-475">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-475">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-476">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-476">The user does not have required permissions.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="ec017-477">用户取消了操作，或无法删除该目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-477">The user cancels the operation or the directory cannot be deleted.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.RecycleOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteFile">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-478">删除文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-478">Deletes a file.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteFile">
      <MemberSignature Language="C#" Value="public static void DeleteFile (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteFile(string file) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.DeleteFile(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteFile (file As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteFile(System::String ^ file);" />
      <MemberSignature Language="F#" Value="static member DeleteFile : string -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.DeleteFile file" />
      <MemberSignature Language="ILAsm" Value=".method public static void DeleteFile(string file) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-479">要删除的文件的名称和路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-479">Name and path of the file to be deleted.</span></span></param>
        <summary><span data-ttu-id="ec017-480">删除文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-480">Deletes a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-481">下表列出了涉及 `My.Computer.FileSystem.DeleteFile` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-481">The following table lists an example of a task involving the `My.Computer.FileSystem.DeleteFile` method.</span></span>  
  
|<span data-ttu-id="ec017-482">至</span><span class="sxs-lookup"><span data-stu-id="ec017-482">To</span></span>|<span data-ttu-id="ec017-483">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-483">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-484">删除文件</span><span class="sxs-lookup"><span data-stu-id="ec017-484">To delete a file</span></span>|[<span data-ttu-id="ec017-485">如何：在 Visual Basic 中删除文件</span><span class="sxs-lookup"><span data-stu-id="ec017-485">How to: Delete a File in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-486">此示例将删除文件 `Test.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-486">This example deletes the file `Test.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#3)]  
  
 <span data-ttu-id="ec017-487">此示例将删除 `Test.txt` 的文件，并允许用户确认应删除该文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-487">This example deletes the file `Test.txt` and allows the user to confirm that the file should be deleted.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#4)]  
  
 <span data-ttu-id="ec017-488">此示例将删除文件 `Test.txt` 并将其发送到**回收站**。</span><span class="sxs-lookup"><span data-stu-id="ec017-488">This example deletes the file `Test.txt` and sends it to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-489">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；带有必须指定文件的尾部反斜杠；是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-489">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; it has a trailing slash where a file must be specified; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-490"><paramref name="file" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-490"><paramref name="file" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-491">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-491">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-492">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-492">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-493">该文件正在使用。</span><span class="sxs-lookup"><span data-stu-id="ec017-493">The file is in use.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-494">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-494">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-495">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-495">The file does not exist.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-496">该用户没有删除该文件的权限，或者该文件为只读。</span><span class="sxs-lookup"><span data-stu-id="ec017-496">The user does not have permission to delete the file or the file is read-only.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="DeleteFile">
      <MemberSignature Language="C#" Value="public static void DeleteFile (string file, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.RecycleOption recycle);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteFile(string file, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.DeleteFile(System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.RecycleOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteFile (file As String, showUI As UIOption, recycle As RecycleOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteFile(System::String ^ file, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::RecycleOption recycle);" />
      <MemberSignature Language="F#" Value="static member DeleteFile : string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.RecycleOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.DeleteFile (file, showUI, recycle)" />
      <MemberSignature Language="ILAsm" Value=".method public static void DeleteFile(string file, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
        <Parameter Name="recycle" Type="Microsoft.VisualBasic.FileIO.RecycleOption" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-497">要删除的文件的名称和路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-497">Name and path of the file to be deleted.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-498">是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-498">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-499">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-499">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="recycle"><span data-ttu-id="ec017-500">删除的文件是否应发送到“回收站”。</span><span class="sxs-lookup"><span data-stu-id="ec017-500">Whether or not the deleted file should be sent to the **Recycle Bin**.</span></span> <span data-ttu-id="ec017-501">默认为 <see langword="RecycleOption.DeletePermanently" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-501">Default is <see langword="RecycleOption.DeletePermanently" />.</span></span></param>
        <summary><span data-ttu-id="ec017-502">删除文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-502">Deletes a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-503">不是用户交互的应用程序（如 Windows 服务）不支持 `showUI` 和 `recycle` 参数。</span><span class="sxs-lookup"><span data-stu-id="ec017-503">The `showUI` and `recycle` parameters are not supported in applications that are not user interactive, such as Windows Services.</span></span>  
  
 <span data-ttu-id="ec017-504">下表列出了涉及 `My.Computer.FileSystem.DeleteFile` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-504">The following table lists an example of a task involving the `My.Computer.FileSystem.DeleteFile` method.</span></span>  
  
|<span data-ttu-id="ec017-505">至</span><span class="sxs-lookup"><span data-stu-id="ec017-505">To</span></span>|<span data-ttu-id="ec017-506">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-506">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-507">删除文件</span><span class="sxs-lookup"><span data-stu-id="ec017-507">To delete a file</span></span>|[<span data-ttu-id="ec017-508">如何：在 Visual Basic 中删除文件</span><span class="sxs-lookup"><span data-stu-id="ec017-508">How to: Delete a File in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-509">此示例将删除文件 `Test.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-509">This example deletes the file `Test.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#3)]  
  
 <span data-ttu-id="ec017-510">此示例将删除 `Test.txt` 的文件，并允许用户确认应删除该文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-510">This example deletes the file `Test.txt` and allows the user to confirm that the file should be deleted.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#4)]  
  
 <span data-ttu-id="ec017-511">此示例将删除文件 `Test.txt` 并将其发送到**回收站**。</span><span class="sxs-lookup"><span data-stu-id="ec017-511">This example deletes the file `Test.txt` and sends it to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-512">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；带有必须指定文件的尾部反斜杠；是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-512">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; it has a trailing slash where a file must be specified; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-513"><paramref name="file" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-513"><paramref name="file" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-514">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-514">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-515">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-515">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-516">该文件正在使用。</span><span class="sxs-lookup"><span data-stu-id="ec017-516">The file is in use.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-517">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-517">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-518">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-518">The file does not exist.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-519">该用户没有删除该文件的权限，或者该文件为只读。</span><span class="sxs-lookup"><span data-stu-id="ec017-519">The user does not have permission to delete the file or the file is read-only.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.RecycleOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
      </Docs>
    </Member>
    <Member MemberName="DeleteFile">
      <MemberSignature Language="C#" Value="public static void DeleteFile (string file, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.RecycleOption recycle, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteFile(string file, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.DeleteFile(System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.RecycleOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteFile (file As String, showUI As UIOption, recycle As RecycleOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteFile(System::String ^ file, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::RecycleOption recycle, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="static member DeleteFile : string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.RecycleOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.DeleteFile (file, showUI, recycle, onUserCancel)" />
      <MemberSignature Language="ILAsm" Value=".method public static void DeleteFile(string file, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
        <Parameter Name="recycle" Type="Microsoft.VisualBasic.FileIO.RecycleOption" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-520">要删除的文件的名称和路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-520">Name and path of the file to be deleted.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-521">是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-521">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-522">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-522">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="recycle"><span data-ttu-id="ec017-523">删除的文件是否应发送到“回收站”。</span><span class="sxs-lookup"><span data-stu-id="ec017-523">Whether or not the deleted file should be sent to the **Recycle Bin**.</span></span> <span data-ttu-id="ec017-524">默认为 <see langword="RecycleOption.DeletePermanently" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-524">Default is <see langword="RecycleOption.DeletePermanently" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="ec017-525">指定用户取消操作时是否引发异常。</span><span class="sxs-lookup"><span data-stu-id="ec017-525">Specifies whether or not an exception is thrown when the user cancels the operation.</span></span> <span data-ttu-id="ec017-526">默认为 <see langword="UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-526">Default is <see langword="UICancelOption.ThrowException" />.</span></span></param>
        <summary><span data-ttu-id="ec017-527">删除文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-527">Deletes a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-528">不是用户交互的应用程序（如 Windows 服务）不支持 `showUI`、`recycle`和 `onUserCancel` 参数。</span><span class="sxs-lookup"><span data-stu-id="ec017-528">The `showUI`, `recycle`, and `onUserCancel` parameters are not supported in applications that are not user interactive, such as Windows Services.</span></span>  
  
 <span data-ttu-id="ec017-529">下表列出了涉及 `My.Computer.FileSystem.DeleteFile` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-529">The following table lists an example of a task involving the `My.Computer.FileSystem.DeleteFile` method.</span></span>  
  
|<span data-ttu-id="ec017-530">至</span><span class="sxs-lookup"><span data-stu-id="ec017-530">To</span></span>|<span data-ttu-id="ec017-531">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-531">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-532">删除文件</span><span class="sxs-lookup"><span data-stu-id="ec017-532">To delete a file</span></span>|[<span data-ttu-id="ec017-533">如何：在 Visual Basic 中删除文件</span><span class="sxs-lookup"><span data-stu-id="ec017-533">How to: Delete a File in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-534">此示例将删除文件 `Test.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-534">This example deletes the file `Test.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#3)]  
  
 <span data-ttu-id="ec017-535">此示例将删除 `Test.txt` 的文件，并允许用户确认应删除该文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-535">This example deletes the file `Test.txt` and allows the user to confirm that the file should be deleted.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#4)]  
  
 <span data-ttu-id="ec017-536">此示例将删除文件 `Test.txt` 并将其发送到**回收站**。</span><span class="sxs-lookup"><span data-stu-id="ec017-536">This example deletes the file `Test.txt` and sends it to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-537">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；带有必须指定文件的尾部反斜杠；是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-537">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; it has a trailing slash where a file must be specified; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-538"><paramref name="file" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-538"><paramref name="file" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-539">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-539">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-540">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-540">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-541">该文件正在使用。</span><span class="sxs-lookup"><span data-stu-id="ec017-541">The file is in use.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-542">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-542">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-543">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-543">The file does not exist.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-544">该用户没有删除该文件的权限，或者该文件为只读。</span><span class="sxs-lookup"><span data-stu-id="ec017-544">The user does not have permission to delete the file or the file is read-only.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="ec017-545">用户已取消该操作并且 <paramref name="onUserCancel" /> 已设置为 <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-545">The user cancelled the operation and <paramref name="onUserCancel" /> is set to <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.RecycleOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
      </Docs>
    </Member>
    <Member MemberName="DirectoryExists">
      <MemberSignature Language="C#" Value="public static bool DirectoryExists (string directory);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool DirectoryExists(string directory) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.DirectoryExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function DirectoryExists (directory As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool DirectoryExists(System::String ^ directory);" />
      <MemberSignature Language="F#" Value="static member DirectoryExists : string -&gt; bool" Usage="Microsoft.VisualBasic.FileIO.FileSystem.DirectoryExists directory" />
      <MemberSignature Language="ILAsm" Value=".method public static bool DirectoryExists(string directory) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-546">目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-546">Path of the directory.</span></span></param>
        <summary><span data-ttu-id="ec017-547">如果指定目录存在，则返回 <see langword="True" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-547">Returns <see langword="True" /> if the specified directory exists.</span></span></summary>
        <returns><span data-ttu-id="ec017-548">如果目录存在，则为 <see langword="True" />；否则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-548"><see langword="True" /> if the directory exists; otherwise <see langword="False" />.</span></span> <span data-ttu-id="ec017-549">如果该参数表示文件（而不是目录）的名称和路径，则此方法还会返回 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-549">This method also returns <see langword="False" /> if the parameter represents the name and path of a file rather than a directory.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="ec017-550">此示例确定目录 `C:\backup\logs` 是否存在并检查其属性。</span><span class="sxs-lookup"><span data-stu-id="ec017-550">This example determines whether the directory `C:\backup\logs` exists and checks its properties.</span></span>  
  
 [!code-vb[VbRefFile#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#13)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Drives">
      <MemberSignature Language="C#" Value="public static System.Collections.ObjectModel.ReadOnlyCollection&lt;System.IO.DriveInfo&gt; Drives { get; }" />
      <MemberSignature Language="ILAsm" Value=".property class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;class System.IO.DriveInfo&gt; Drives" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.FileIO.FileSystem.Drives" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property Drives As ReadOnlyCollection(Of DriveInfo)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Collections::ObjectModel::ReadOnlyCollection&lt;System::IO::DriveInfo ^&gt; ^ Drives { System::Collections::ObjectModel::ReadOnlyCollection&lt;System::IO::DriveInfo ^&gt; ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Drives : System.Collections.ObjectModel.ReadOnlyCollection&lt;System.IO.DriveInfo&gt;" Usage="Microsoft.VisualBasic.FileIO.FileSystem.Drives" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.IO.DriveInfo&gt;</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ec017-551">返回所有可用驱动器名称的只读集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-551">Returns a read-only collection of all available drive names.</span></span></summary>
        <value><span data-ttu-id="ec017-552">作为 <see cref="T:System.IO.DriveInfo" /> 对象的所有可用驱动器的只读集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-552">A read-only collection of all available drives as <see cref="T:System.IO.DriveInfo" /> objects.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-553">此属性返回所有逻辑驱动器。</span><span class="sxs-lookup"><span data-stu-id="ec017-553">This property returns all logical drives.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-554">此示例在一个消息框中显示可用的驱动器名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-554">This example displays the available drive names in a message box.</span></span>  
  
 [!code-vb[VbRefFile#19](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#19)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
        <altmember cref="T:System.IO.DriveInfo" />
      </Docs>
    </Member>
    <Member MemberName="FileExists">
      <MemberSignature Language="C#" Value="public static bool FileExists (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool FileExists(string file) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.FileExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FileExists (file As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool FileExists(System::String ^ file);" />
      <MemberSignature Language="F#" Value="static member FileExists : string -&gt; bool" Usage="Microsoft.VisualBasic.FileIO.FileSystem.FileExists file" />
      <MemberSignature Language="ILAsm" Value=".method public static bool FileExists(string file) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-555">文件的名称和路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-555">Name and path of the file.</span></span></param>
        <summary><span data-ttu-id="ec017-556">如果指定文件存在，则返回 <see langword="True" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-556">Returns <see langword="True" /> if the specified file exists.</span></span></summary>
        <returns><span data-ttu-id="ec017-557">如果文件存在，则返回 <see langword="True" />；否则此方法返回 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-557">Returns <see langword="True" /> if the file exists; otherwise this method returns <see langword="False" />.</span></span> <span data-ttu-id="ec017-558">如果该参数表示目录（而不是文件）的路径，则此方法还会返回 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-558">This method also returns <see langword="False" /> if the parameter represents the path of a directory rather than a file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-559">如果应用程序没有足够的权限读取指定文件，`FileExists` 方法将返回 `False`，无论是否存在该路径;方法不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="ec017-559">If the application does not have sufficient permissions to read the specified file, the `FileExists` method returns `False`, regardless of the existence of the path; the method does not throw an exception.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-560">此示例将检查文件 `Check.txt` 是否存在，并在消息框中提供信息。</span><span class="sxs-lookup"><span data-stu-id="ec017-560">This example checks to see whether or not the file `Check.txt` exists and supplies the information in a message box.</span></span>  
  
 [!code-vb[VbRefFile#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-561">文件名称以反斜杠 (\\) 结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-561">The name of the file ends with a backslash (\\).</span></span></exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="FindInFiles">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-562">返回字符串的只读集合，这些字符串表示包含指定文本的文件的名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-562">Returns a read-only collection of strings representing the names of files containing the specified text.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="FindInFiles">
      <MemberSignature Language="C#" Value="public static System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; FindInFiles (string directory, string containsText, bool ignoreCase, Microsoft.VisualBasic.FileIO.SearchOption searchType);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; FindInFiles(string directory, string containsText, bool ignoreCase, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.FindInFiles(System.String,System.String,System.Boolean,Microsoft.VisualBasic.FileIO.SearchOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindInFiles (directory As String, containsText As String, ignoreCase As Boolean, searchType As SearchOption) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ FindInFiles(System::String ^ directory, System::String ^ containsText, bool ignoreCase, Microsoft::VisualBasic::FileIO::SearchOption searchType);" />
      <MemberSignature Language="F#" Value="static member FindInFiles : string * string * bool * Microsoft.VisualBasic.FileIO.SearchOption -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="Microsoft.VisualBasic.FileIO.FileSystem.FindInFiles (directory, containsText, ignoreCase, searchType)" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; FindInFiles(string directory, string containsText, bool ignoreCase, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
        <Parameter Name="containsText" Type="System.String" />
        <Parameter Name="ignoreCase" Type="System.Boolean" />
        <Parameter Name="searchType" Type="Microsoft.VisualBasic.FileIO.SearchOption" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-563">要搜索的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-563">The directory to be searched.</span></span></param>
        <param name="containsText"><span data-ttu-id="ec017-564">搜索文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-564">The search text.</span></span></param>
        <param name="ignoreCase"><span data-ttu-id="ec017-565">如果搜索应区分大小写，则为 <see langword="True" />；否则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-565"><see langword="True" /> if the search should be case-sensitive; otherwise <see langword="False" />.</span></span> <span data-ttu-id="ec017-566">默认为 <see langword="True" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-566">Default is <see langword="True" />.</span></span></param>
        <param name="searchType"><span data-ttu-id="ec017-567">是否包含子文件夹。</span><span class="sxs-lookup"><span data-stu-id="ec017-567">Whether to include subfolders.</span></span> <span data-ttu-id="ec017-568">默认为 <see langword="SearchOption.SearchTopLevelOnly" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-568">Default is <see langword="SearchOption.SearchTopLevelOnly" />.</span></span></param>
        <summary><span data-ttu-id="ec017-569">返回字符串的只读集合，这些字符串表示包含指定文本的文件的名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-569">Returns a read-only collection of strings representing the names of files containing the specified text.</span></span></summary>
        <returns><span data-ttu-id="ec017-570">包含指定文本的文件名的只读集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-570">Read-only collection of the names of files containing the specified text.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-571">如果没有找到与指定模式匹配的文件，则返回一个空集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-571">An empty collection is returned if no files matching the specified pattern are found.</span></span>  
  
 <span data-ttu-id="ec017-572">下表列出了涉及 `My.Computer.FileSystem.FindInFiles` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-572">The following table lists an example of a task involving the `My.Computer.FileSystem.FindInFiles` method.</span></span>  
  
|<span data-ttu-id="ec017-573">至</span><span class="sxs-lookup"><span data-stu-id="ec017-573">To</span></span>|<span data-ttu-id="ec017-574">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-574">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-575">在目录中搜索包含特定字符串的文件</span><span class="sxs-lookup"><span data-stu-id="ec017-575">Search a directory for files containing a specific string</span></span>|[<span data-ttu-id="ec017-576">演练：在 Visual Basic 中操作文件和目录</span><span class="sxs-lookup"><span data-stu-id="ec017-576">Walkthrough: Manipulating Files and Directories in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-577">此示例在目录 `C:\TestDir` 中搜索包含字符串 `"sample string"` 的任何文件，并在 `ListBox1`中显示结果。</span><span class="sxs-lookup"><span data-stu-id="ec017-577">This example searches the directory `C:\TestDir` for any files containing the string `"sample string"` and displays the results in `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#12)]  
  
 <span data-ttu-id="ec017-578">若要工作，该项目必须包含名为 `ListBox1`的 `ListBox`。</span><span class="sxs-lookup"><span data-stu-id="ec017-578">In order to work, the project must contain a `ListBox` named `ListBox1`.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-579">路径由于以下原因之一而无效：是零长度字符串；仅包含空白；包含无效字符；是一个设备路径（开头字符为 <c>\\.\</c>）。</span><span class="sxs-lookup"><span data-stu-id="ec017-579">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with <c>\\.\</c>).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-580"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-580"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-581">指定的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-581">The specified directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-582">指定的目录指向某个现有文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-582">The specified directory points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-583">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-583">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-584">指定的目录路径中包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-584">The specified directory path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-585">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-585">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-586">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-586">The user lacks necessary permissions.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.SearchOption" />
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
      </Docs>
    </Member>
    <Member MemberName="FindInFiles">
      <MemberSignature Language="C#" Value="public static System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; FindInFiles (string directory, string containsText, bool ignoreCase, Microsoft.VisualBasic.FileIO.SearchOption searchType, params string[] fileWildcards);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; FindInFiles(string directory, string containsText, bool ignoreCase, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType, string[] fileWildcards) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.FindInFiles(System.String,System.String,System.Boolean,Microsoft.VisualBasic.FileIO.SearchOption,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindInFiles (directory As String, containsText As String, ignoreCase As Boolean, searchType As SearchOption, ParamArray fileWildcards As String()) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ FindInFiles(System::String ^ directory, System::String ^ containsText, bool ignoreCase, Microsoft::VisualBasic::FileIO::SearchOption searchType, ... cli::array &lt;System::String ^&gt; ^ fileWildcards);" />
      <MemberSignature Language="F#" Value="static member FindInFiles : string * string * bool * Microsoft.VisualBasic.FileIO.SearchOption * string[] -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="Microsoft.VisualBasic.FileIO.FileSystem.FindInFiles (directory, containsText, ignoreCase, searchType, fileWildcards)" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; FindInFiles(string directory, string containsText, bool ignoreCase, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType, string[] fileWildcards) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
        <Parameter Name="containsText" Type="System.String" />
        <Parameter Name="ignoreCase" Type="System.Boolean" />
        <Parameter Name="searchType" Type="Microsoft.VisualBasic.FileIO.SearchOption" />
        <Parameter Name="fileWildcards" Type="System.String[]">
          <Attributes>
            <Attribute FrameworkAlternate="net-5.0">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-587">要搜索的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-587">The directory to be searched.</span></span></param>
        <param name="containsText"><span data-ttu-id="ec017-588">搜索文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-588">The search text.</span></span></param>
        <param name="ignoreCase"><span data-ttu-id="ec017-589">如果搜索应区分大小写，则为 <see langword="True" />；否则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-589"><see langword="True" /> if the search should be case-sensitive; otherwise <see langword="False" />.</span></span> <span data-ttu-id="ec017-590">默认为 <see langword="True" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-590">Default is <see langword="True" />.</span></span></param>
        <param name="searchType"><span data-ttu-id="ec017-591">是否包含子文件夹。</span><span class="sxs-lookup"><span data-stu-id="ec017-591">Whether to include subfolders.</span></span> <span data-ttu-id="ec017-592">默认为 <see langword="SearchOption.SearchTopLevelOnly" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-592">Default is <see langword="SearchOption.SearchTopLevelOnly" />.</span></span></param>
        <param name="fileWildcards"><span data-ttu-id="ec017-593">要匹配的模式。</span><span class="sxs-lookup"><span data-stu-id="ec017-593">Pattern to be matched.</span></span></param>
        <summary><span data-ttu-id="ec017-594">返回字符串的只读集合，这些字符串表示包含指定文本的文件的名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-594">Returns a read-only collection of strings representing the names of files containing the specified text.</span></span></summary>
        <returns><span data-ttu-id="ec017-595">包含指定文本的文件名的只读集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-595">Read-only collection of the names of files containing the specified text.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-596">如果没有找到与指定模式匹配的文件，则返回一个空集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-596">An empty collection is returned if no files matching the specified pattern are found.</span></span>  
  
 <span data-ttu-id="ec017-597">下表列出了涉及 `My.Computer.FileSystem.FindInFiles` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-597">The following table lists an example of a task involving the `My.Computer.FileSystem.FindInFiles` method.</span></span>  
  
|<span data-ttu-id="ec017-598">至</span><span class="sxs-lookup"><span data-stu-id="ec017-598">To</span></span>|<span data-ttu-id="ec017-599">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-599">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-600">在目录中搜索包含特定字符串的文件</span><span class="sxs-lookup"><span data-stu-id="ec017-600">Search a directory for files containing a specific string</span></span>|[<span data-ttu-id="ec017-601">演练：在 Visual Basic 中操作文件和目录</span><span class="sxs-lookup"><span data-stu-id="ec017-601">Walkthrough: Manipulating Files and Directories in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-602">此示例在目录 `C:\TestDir` 中搜索包含字符串 `"sample string"` 的任何文件，并在 `ListBox1`中显示结果。</span><span class="sxs-lookup"><span data-stu-id="ec017-602">This example searches the directory `C:\TestDir` for any files containing the string `"sample string"` and displays the results in `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#12)]  
  
 <span data-ttu-id="ec017-603">若要工作，该项目必须包含名为 `ListBox1`的 `ListBox`。</span><span class="sxs-lookup"><span data-stu-id="ec017-603">In order to work, the project must contain a `ListBox` named `ListBox1`.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-604">路径由于以下原因之一而无效：是零长度字符串；仅包含空白；包含无效字符；是一个设备路径（开头字符为 <c>\\.\</c>）。</span><span class="sxs-lookup"><span data-stu-id="ec017-604">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with <c>\\.\</c>).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-605"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-605"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-606">指定的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-606">The specified directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-607">指定的目录指向某个现有文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-607">The specified directory points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-608">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-608">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-609">指定的目录路径中包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-609">The specified directory path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-610">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-610">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-611">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-611">The user lacks necessary permissions.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.SearchOption" />
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetDirectories">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-612">返回一个字符串集合，这些字符串表示目录内子目录的路径名。</span><span class="sxs-lookup"><span data-stu-id="ec017-612">Returns a collection of strings representing the path names of subdirectories within a directory.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetDirectories">
      <MemberSignature Language="C#" Value="public static System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; GetDirectories (string directory);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetDirectories(string directory) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.GetDirectories(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetDirectories (directory As String) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ GetDirectories(System::String ^ directory);" />
      <MemberSignature Language="F#" Value="static member GetDirectories : string -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="Microsoft.VisualBasic.FileIO.FileSystem.GetDirectories directory" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetDirectories(string directory) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-613">目录的名称和路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-613">Name and path of directory.</span></span></param>
        <summary><span data-ttu-id="ec017-614">返回一个字符串集合，这些字符串表示目录内子目录的路径名。</span><span class="sxs-lookup"><span data-stu-id="ec017-614">Returns a collection of strings representing the path names of subdirectories within a directory.</span></span></summary>
        <returns><span data-ttu-id="ec017-615">所指定目录中，子目录路径名称的只读集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-615">Read-only collection of the path names of subdirectories within the specified directory.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-616">下表列出了涉及 `My.Computer.FileSystem.GetDirectories` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-616">The following table lists an example of a task involving the `My.Computer.FileSystem.GetDirectories` method.</span></span>  
  
|<span data-ttu-id="ec017-617">至</span><span class="sxs-lookup"><span data-stu-id="ec017-617">To</span></span>|<span data-ttu-id="ec017-618">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-618">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-619">列出具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="ec017-619">List subdirectories with a specific pattern</span></span>|[<span data-ttu-id="ec017-620">如何：在 Visual Basic 中查找具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="ec017-620">How to: Find Subdirectories with a Specific Pattern in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-621">下面的示例返回目录结构中的所有目录，其中包含名称中的单词 `Logs`，并将它们添加到 `ListBox1`中。</span><span class="sxs-lookup"><span data-stu-id="ec017-621">The following example returns all the directories in the directory structure that contain the word `Logs` in their names and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#10)]  
  
 <span data-ttu-id="ec017-622">此示例要求窗体上有一个名为 `ListBox1` 的 `ListBox`。</span><span class="sxs-lookup"><span data-stu-id="ec017-622">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-623">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-623">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-624"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-624"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-625">指定的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-625">The specified directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-626">指定的目录指向某个现有文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-626">The specified directory points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-627">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-627">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-628">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-628">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-629">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-629">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-630">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-630">The user lacks necessary permissions.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.SearchOption" />
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
      </Docs>
    </Member>
    <Member MemberName="GetDirectories">
      <MemberSignature Language="C#" Value="public static System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; GetDirectories (string directory, Microsoft.VisualBasic.FileIO.SearchOption searchType, params string[] wildcards);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetDirectories(string directory, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType, string[] wildcards) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.GetDirectories(System.String,Microsoft.VisualBasic.FileIO.SearchOption,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetDirectories (directory As String, searchType As SearchOption, ParamArray wildcards As String()) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ GetDirectories(System::String ^ directory, Microsoft::VisualBasic::FileIO::SearchOption searchType, ... cli::array &lt;System::String ^&gt; ^ wildcards);" />
      <MemberSignature Language="F#" Value="static member GetDirectories : string * Microsoft.VisualBasic.FileIO.SearchOption * string[] -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="Microsoft.VisualBasic.FileIO.FileSystem.GetDirectories (directory, searchType, wildcards)" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetDirectories(string directory, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType, string[] wildcards) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
        <Parameter Name="searchType" Type="Microsoft.VisualBasic.FileIO.SearchOption" />
        <Parameter Name="wildcards" Type="System.String[]">
          <Attributes>
            <Attribute FrameworkAlternate="net-5.0">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-631">目录的名称和路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-631">Name and path of directory.</span></span></param>
        <param name="searchType"><span data-ttu-id="ec017-632">是否包含子文件夹。</span><span class="sxs-lookup"><span data-stu-id="ec017-632">Whether to include subfolders.</span></span> <span data-ttu-id="ec017-633">默认为 <see langword="SearchOption.SearchTopLevelOnly" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-633">Default is <see langword="SearchOption.SearchTopLevelOnly" />.</span></span></param>
        <param name="wildcards"><span data-ttu-id="ec017-634">用于匹配名称的模式。</span><span class="sxs-lookup"><span data-stu-id="ec017-634">Pattern to match names.</span></span></param>
        <summary><span data-ttu-id="ec017-635">返回一个字符串集合，这些字符串表示目录内子目录的路径名。</span><span class="sxs-lookup"><span data-stu-id="ec017-635">Returns a collection of strings representing the path names of subdirectories within a directory.</span></span></summary>
        <returns><span data-ttu-id="ec017-636">所指定目录中，子目录路径名称的只读集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-636">Read-only collection of the path names of subdirectories within the specified directory.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-637">可以使用 `wildcards` 参数来指定特定模式。</span><span class="sxs-lookup"><span data-stu-id="ec017-637">You can use the `wildcards` parameter to specify a specific pattern.</span></span> <span data-ttu-id="ec017-638">如果要在搜索中包含子目录的内容，请将 `searchType` 参数设置为 `SearchAllSubDirectories`。</span><span class="sxs-lookup"><span data-stu-id="ec017-638">If you would like to include the contents of subdirectories in the search, set the `searchType` parameter to `SearchAllSubDirectories`.</span></span>  
  
 <span data-ttu-id="ec017-639">如果没有找到与指定模式匹配的目录，则返回一个空集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-639">An empty collection is returned if no directories matching the specified pattern are found.</span></span>  
  
 <span data-ttu-id="ec017-640">下表列出了涉及 `My.Computer.FileSystem.GetDirectories` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-640">The following table lists an example of a task involving the `My.Computer.FileSystem.GetDirectories` method.</span></span>  
  
|<span data-ttu-id="ec017-641">至</span><span class="sxs-lookup"><span data-stu-id="ec017-641">To</span></span>|<span data-ttu-id="ec017-642">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-642">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-643">列出具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="ec017-643">List subdirectories with a specific pattern</span></span>|[<span data-ttu-id="ec017-644">如何：在 Visual Basic 中查找具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="ec017-644">How to: Find Subdirectories with a Specific Pattern in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-645">下面的示例返回目录结构中的所有目录，其中包含名称中的单词 `Logs`，并将它们添加到 `ListBox1`中。</span><span class="sxs-lookup"><span data-stu-id="ec017-645">The following example returns all the directories in the directory structure that contain the word `Logs` in their names and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#10)]  
  
 <span data-ttu-id="ec017-646">此示例要求窗体上有一个名为 `ListBox1` 的 `ListBox`。</span><span class="sxs-lookup"><span data-stu-id="ec017-646">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-647">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-647">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-648">一个或多个指定的通配符为 <see langword="Nothing" />、空字符串，或者仅包含空格。</span><span class="sxs-lookup"><span data-stu-id="ec017-648">One or more of the specified wildcard characters is <see langword="Nothing" />, an empty string, or contains only spaces.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-649">指定的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-649">The specified directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-650">指定的目录指向某个现有文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-650">The specified directory points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-651">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-651">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-652">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-652">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-653">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-653">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-654">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-654">The user lacks necessary permissions.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.SearchOption" />
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
      </Docs>
    </Member>
    <Member MemberName="GetDirectoryInfo">
      <MemberSignature Language="C#" Value="public static System.IO.DirectoryInfo GetDirectoryInfo (string directory);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.IO.DirectoryInfo GetDirectoryInfo(string directory) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.GetDirectoryInfo(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetDirectoryInfo (directory As String) As DirectoryInfo" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::IO::DirectoryInfo ^ GetDirectoryInfo(System::String ^ directory);" />
      <MemberSignature Language="F#" Value="static member GetDirectoryInfo : string -&gt; System.IO.DirectoryInfo" Usage="Microsoft.VisualBasic.FileIO.FileSystem.GetDirectoryInfo directory" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.IO.DirectoryInfo GetDirectoryInfo(string directory) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.DirectoryInfo</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-655"><see langword="String" /> 列中的一个值匹配。</span><span class="sxs-lookup"><span data-stu-id="ec017-655"><see langword="String" />.</span></span> <span data-ttu-id="ec017-656">目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-656">Path of directory.</span></span></param>
        <summary><span data-ttu-id="ec017-657">返回指定路径的 <see cref="T:System.IO.DirectoryInfo" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-657">Returns a <see cref="T:System.IO.DirectoryInfo" /> object for the specified path.</span></span></summary>
        <returns><span data-ttu-id="ec017-658">指定路径的 <see cref="T:System.IO.DirectoryInfo" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-658"><see cref="T:System.IO.DirectoryInfo" /> object for the specified path.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-659">如果该目录不存在，则只有在第一次访问 <xref:System.IO.DirectoryInfo> 对象上的属性时才会引发异常。</span><span class="sxs-lookup"><span data-stu-id="ec017-659">If the directory does not exist, an exception is not thrown until the first time a property on the <xref:System.IO.DirectoryInfo> object is accessed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-660">此示例获取目录 `C:\Documents and Settings` 的 <xref:System.IO.DirectoryInfo> 对象，并显示目录的创建时间、上次访问时间和上次写入时间。</span><span class="sxs-lookup"><span data-stu-id="ec017-660">This example gets a <xref:System.IO.DirectoryInfo> object for the directory `C:\Documents and Settings` and displays the directory's creation time, last access time, and last write time.</span></span>  
  
 [!code-vb[VbRefFile#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-661">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-661">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-662"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-662"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-663">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-663">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-664">目录路径中包含冒号 (:)，或者格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-664">The directory path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-665">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-665">The user lacks necessary permissions to view the path</span></span></exception>
        <altmember cref="T:System.IO.DirectoryInfo" />
      </Docs>
    </Member>
    <Member MemberName="GetDriveInfo">
      <MemberSignature Language="C#" Value="public static System.IO.DriveInfo GetDriveInfo (string drive);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.IO.DriveInfo GetDriveInfo(string drive) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.GetDriveInfo(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetDriveInfo (drive As String) As DriveInfo" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::IO::DriveInfo ^ GetDriveInfo(System::String ^ drive);" />
      <MemberSignature Language="F#" Value="static member GetDriveInfo : string -&gt; System.IO.DriveInfo" Usage="Microsoft.VisualBasic.FileIO.FileSystem.GetDriveInfo drive" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.IO.DriveInfo GetDriveInfo(string drive) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.DriveInfo</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="drive" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="drive"><span data-ttu-id="ec017-666">要检查的驱动器。</span><span class="sxs-lookup"><span data-stu-id="ec017-666">Drive to be examined.</span></span></param>
        <summary><span data-ttu-id="ec017-667">返回指定驱动器的 <see cref="T:System.IO.DriveInfo" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-667">Returns a <see cref="T:System.IO.DriveInfo" /> object for the specified drive.</span></span></summary>
        <returns><span data-ttu-id="ec017-668">指定驱动器的 <see cref="T:System.IO.DriveInfo" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-668"><see cref="T:System.IO.DriveInfo" /> object for the specified drive.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-669"><xref:System.IO.DriveInfo> 类对驱动器建模，并提供用于查询驱动器信息的方法和属性。</span><span class="sxs-lookup"><span data-stu-id="ec017-669">The <xref:System.IO.DriveInfo> class models a drive and provides methods and properties to query for drive information.</span></span> <span data-ttu-id="ec017-670">使用 <xref:System.IO.DriveInfo> 来确定可用的驱动器和设备的类型。</span><span class="sxs-lookup"><span data-stu-id="ec017-670">Use <xref:System.IO.DriveInfo> to determine what drives are available, and what type of drives they are.</span></span> <span data-ttu-id="ec017-671">您还可以查询属性，以确定驱动器上的容量和可用空间。</span><span class="sxs-lookup"><span data-stu-id="ec017-671">You can also query the property to determine the capacity and available free space on the drive.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-672">此示例将获取 C 驱动器的 <xref:System.IO.DriveInfo> 对象，并使用它来显示有关驱动器的信息。</span><span class="sxs-lookup"><span data-stu-id="ec017-672">This example obtains a <xref:System.IO.DriveInfo> object for the C drive and uses it to display information about the drive.</span></span>  
  
 [!code-vb[VbRefFile#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#11)]  
  
 <span data-ttu-id="ec017-673">有关不同驱动器类型的信息，请参阅 <xref:System.IO.DriveType>。</span><span class="sxs-lookup"><span data-stu-id="ec017-673">For information on the different drive types, see <xref:System.IO.DriveType>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-674">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-674">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-675"><paramref name="drive" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-675"><paramref name="drive" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-676">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-676">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-677">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-677">The user lacks necessary permissions to view the path</span></span></exception>
        <altmember cref="T:System.IO.DriveInfo" />
        <altmember cref="T:System.IO.DriveType" />
      </Docs>
    </Member>
    <Member MemberName="GetFileInfo">
      <MemberSignature Language="C#" Value="public static System.IO.FileInfo GetFileInfo (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.IO.FileInfo GetFileInfo(string file) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.GetFileInfo(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetFileInfo (file As String) As FileInfo" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::IO::FileInfo ^ GetFileInfo(System::String ^ file);" />
      <MemberSignature Language="F#" Value="static member GetFileInfo : string -&gt; System.IO.FileInfo" Usage="Microsoft.VisualBasic.FileIO.FileSystem.GetFileInfo file" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.IO.FileInfo GetFileInfo(string file) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.FileInfo</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-678">文件的名称和路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-678">Name and path of the file.</span></span></param>
        <summary><span data-ttu-id="ec017-679">返回指定文件的 <see cref="T:System.IO.FileInfo" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-679">Returns a <see cref="T:System.IO.FileInfo" /> object for the specified file.</span></span></summary>
        <returns><span data-ttu-id="ec017-680">指定文件的 <see cref="T:System.IO.FileInfo" /> 对象</span><span class="sxs-lookup"><span data-stu-id="ec017-680"><see cref="T:System.IO.FileInfo" /> object for the specified file</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-681">如果文件不存在，则不会引发异常;相反，它将在第一次访问对象的属性时引发。</span><span class="sxs-lookup"><span data-stu-id="ec017-681">An exception is not thrown if the file does not exist; rather, it will be thrown the first time the object's properties are accessed.</span></span>  
  
 <span data-ttu-id="ec017-682">下表列出了涉及 `My.Computer.FileSystem.GetFileInfo` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-682">The following table lists an example of a task involving the `My.Computer.FileSystem.GetFileInfo` method.</span></span>  
  
|<span data-ttu-id="ec017-683">至</span><span class="sxs-lookup"><span data-stu-id="ec017-683">To</span></span>|<span data-ttu-id="ec017-684">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-684">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-685">确定文件的名称和路径</span><span class="sxs-lookup"><span data-stu-id="ec017-685">Determine a file's name and path</span></span>|[<span data-ttu-id="ec017-686">如何：在 Visual Basic 中分析文件路径</span><span class="sxs-lookup"><span data-stu-id="ec017-686">How to: Parse File Paths in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-687">此示例将检索文件的 <xref:System.IO.FileInfo?displayProperty=nameWithType> 对象 `MyLogFile.log` 并使用它来报告文件的完整名称、上次访问时间和长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-687">This example retrieves a <xref:System.IO.FileInfo?displayProperty=nameWithType> object for the file `MyLogFile.log` and uses it to report the file's full name, last access time, and length.</span></span>  
  
 [!code-vb[VbRefFile#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-688">路径名称格式不正确。</span><span class="sxs-lookup"><span data-stu-id="ec017-688">The path name is malformed.</span></span> <span data-ttu-id="ec017-689">例如，包含无效字符或仅为空白。</span><span class="sxs-lookup"><span data-stu-id="ec017-689">For example, it contains invalid characters or is only white space.</span></span> <span data-ttu-id="ec017-690">文件名具有尾随斜杠标记。</span><span class="sxs-lookup"><span data-stu-id="ec017-690">The file name has a trailing slash mark.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-691"><paramref name="file" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-691"><paramref name="file" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-692">路径的字符串中间包含一个冒号。</span><span class="sxs-lookup"><span data-stu-id="ec017-692">The path contains a colon in the middle of the string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-693">路径太长。</span><span class="sxs-lookup"><span data-stu-id="ec017-693">The path is too long.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-694">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-694">The user lacks necessary permissions.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-695">该用户缺少对文件的 ACL（访问控制列表）的访问权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-695">The user lacks ACL (access control list) access to the file.</span></span></exception>
        <altmember cref="T:System.IO.FileInfo" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetFiles">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-696">返回字符串的只读集合，这些字符串表示目录内文件的名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-696">Returns a read-only collection of strings representing the names of files within a directory.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetFiles">
      <MemberSignature Language="C#" Value="public static System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; GetFiles (string directory);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetFiles(string directory) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetFiles (directory As String) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ GetFiles(System::String ^ directory);" />
      <MemberSignature Language="F#" Value="static member GetFiles : string -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="Microsoft.VisualBasic.FileIO.FileSystem.GetFiles directory" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetFiles(string directory) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-697">要搜索的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-697">Directory to be searched.</span></span></param>
        <summary><span data-ttu-id="ec017-698">返回字符串的只读集合，这些字符串表示目录内文件的名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-698">Returns a read-only collection of strings representing the names of files within a directory.</span></span></summary>
        <returns><span data-ttu-id="ec017-699">指定目录中的文件名的只读集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-699">Read-only collection of file names from the specified directory.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-700">如果没有找到与指定模式匹配的文件，则返回一个空集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-700">An empty collection is returned if no files matching the specified pattern are found.</span></span>  
  
 <span data-ttu-id="ec017-701">下表列出了涉及 `My.Computer.FileSystem.GetFiles` 方法的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-701">The following table lists examples of tasks involving the `My.Computer.FileSystem.GetFiles` method.</span></span>  
  
|<span data-ttu-id="ec017-702">至</span><span class="sxs-lookup"><span data-stu-id="ec017-702">To</span></span>|<span data-ttu-id="ec017-703">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-703">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-704">获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="ec017-704">Get the collection of files in a directory</span></span>|[<span data-ttu-id="ec017-705">如何：在 Visual Basic 中获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="ec017-705">How to: Get the Collection of Files in a Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory)|  
|<span data-ttu-id="ec017-706">在目录中查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="ec017-706">Find files with a specific pattern in a directory</span></span>|[<span data-ttu-id="ec017-707">如何：在 Visual Basic 中查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="ec017-707">How to: Find Files with a Specific Pattern in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-files-with-a-specific-pattern)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-708">下面的示例返回目录中的所有文件，并将它们添加到 `ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="ec017-708">The following example returns all files in the directory and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#5)]  
  
 <span data-ttu-id="ec017-709">此示例要求窗体上有一个名为 `ListBox1` 的 `ListBox`。</span><span class="sxs-lookup"><span data-stu-id="ec017-709">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 <span data-ttu-id="ec017-710">此示例返回目录中扩展名为 `.txt` 的所有文件，并将其添加到 `ListBox1`中。</span><span class="sxs-lookup"><span data-stu-id="ec017-710">This example returns all files in the directory with the extension `.txt` and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#6)]  
  
 <span data-ttu-id="ec017-711">此示例要求窗体上有一个名为 `ListBox1` 的 `ListBox`。</span><span class="sxs-lookup"><span data-stu-id="ec017-711">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-712">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-712">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-713"><paramref name="directory" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-713"><paramref name="directory" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-714">要搜索的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-714">The directory to search does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-715"><paramref name="directory" /> 指向某个现有文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-715"><paramref name="directory" /> points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-716">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-716">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-717">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-717">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-718">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-718">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-719">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-719">The user lacks necessary permissions.</span></span></exception>
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
      </Docs>
    </Member>
    <Member MemberName="GetFiles">
      <MemberSignature Language="C#" Value="public static System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; GetFiles (string directory, Microsoft.VisualBasic.FileIO.SearchOption searchType, params string[] wildcards);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetFiles(string directory, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType, string[] wildcards) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles(System.String,Microsoft.VisualBasic.FileIO.SearchOption,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetFiles (directory As String, searchType As SearchOption, ParamArray wildcards As String()) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ GetFiles(System::String ^ directory, Microsoft::VisualBasic::FileIO::SearchOption searchType, ... cli::array &lt;System::String ^&gt; ^ wildcards);" />
      <MemberSignature Language="F#" Value="static member GetFiles : string * Microsoft.VisualBasic.FileIO.SearchOption * string[] -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="Microsoft.VisualBasic.FileIO.FileSystem.GetFiles (directory, searchType, wildcards)" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetFiles(string directory, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType, string[] wildcards) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
        <Parameter Name="searchType" Type="Microsoft.VisualBasic.FileIO.SearchOption" />
        <Parameter Name="wildcards" Type="System.String[]">
          <Attributes>
            <Attribute FrameworkAlternate="net-5.0">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-720">要搜索的目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-720">Directory to be searched.</span></span></param>
        <param name="searchType"><span data-ttu-id="ec017-721">是否包含子文件夹。</span><span class="sxs-lookup"><span data-stu-id="ec017-721">Whether to include subfolders.</span></span> <span data-ttu-id="ec017-722">默认为 <see langword="SearchOption.SearchTopLevelOnly" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-722">Default is <see langword="SearchOption.SearchTopLevelOnly" />.</span></span></param>
        <param name="wildcards"><span data-ttu-id="ec017-723">要匹配的模式。</span><span class="sxs-lookup"><span data-stu-id="ec017-723">Pattern to be matched.</span></span></param>
        <summary><span data-ttu-id="ec017-724">返回字符串的只读集合，这些字符串表示目录内文件的名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-724">Returns a read-only collection of strings representing the names of files within a directory.</span></span></summary>
        <returns><span data-ttu-id="ec017-725">指定目录中的文件名的只读集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-725">Read-only collection of file names from the specified directory.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-726">如果没有找到与指定模式匹配的文件，则返回一个空集合。</span><span class="sxs-lookup"><span data-stu-id="ec017-726">An empty collection is returned if no files matching the specified pattern are found.</span></span>  
  
 <span data-ttu-id="ec017-727">下表列出了涉及 `My.Computer.FileSystem.GetFiles` 方法的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-727">The following table lists examples of tasks involving the `My.Computer.FileSystem.GetFiles` method.</span></span>  
  
|<span data-ttu-id="ec017-728">至</span><span class="sxs-lookup"><span data-stu-id="ec017-728">To</span></span>|<span data-ttu-id="ec017-729">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-729">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-730">获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="ec017-730">Get the collection of files in a directory</span></span>|[<span data-ttu-id="ec017-731">如何：在 Visual Basic 中获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="ec017-731">How to: Get the Collection of Files in a Directory in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory)|  
|<span data-ttu-id="ec017-732">在目录中查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="ec017-732">Find files with a specific pattern in a directory</span></span>|[<span data-ttu-id="ec017-733">如何：在 Visual Basic 中查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="ec017-733">How to: Find Files with a Specific Pattern in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-files-with-a-specific-pattern)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-734">下面的示例返回目录中的所有文件，并将它们添加到 `ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="ec017-734">The following example returns all files in the directory and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#5)]  
  
 <span data-ttu-id="ec017-735">此示例要求窗体上有一个名为 `ListBox1` 的 `ListBox`。</span><span class="sxs-lookup"><span data-stu-id="ec017-735">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 <span data-ttu-id="ec017-736">此示例返回目录中扩展名为 `.txt` 的所有文件，并将其添加到 `ListBox1`中。</span><span class="sxs-lookup"><span data-stu-id="ec017-736">This example returns all files in the directory with the extension `.txt` and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#6)]  
  
 <span data-ttu-id="ec017-737">此示例要求窗体上有一个名为 `ListBox1` 的 `ListBox`。</span><span class="sxs-lookup"><span data-stu-id="ec017-737">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-738">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-738">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-739"><paramref name="directory" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-739"><paramref name="directory" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-740">要搜索的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-740">The directory to search does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-741"><paramref name="directory" /> 指向某个现有文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-741"><paramref name="directory" /> points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-742">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-742">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-743">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-743">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-744">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-744">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-745">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-745">The user lacks necessary permissions.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.SearchOption" />
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
      </Docs>
    </Member>
    <Member MemberName="GetName">
      <MemberSignature Language="C#" Value="public static string GetName (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string GetName(string path) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.GetName(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetName (path As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ GetName(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member GetName : string -&gt; string" Usage="Microsoft.VisualBasic.FileIO.FileSystem.GetName path" />
      <MemberSignature Language="ILAsm" Value=".method public static string GetName(string path) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="ec017-746">必需。</span><span class="sxs-lookup"><span data-stu-id="ec017-746">Required.</span></span> <span data-ttu-id="ec017-747">要分析的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-747">Path to be parsed.</span></span> <span data-ttu-id="ec017-748"><see langword="String" /> 列中的一个值匹配。</span><span class="sxs-lookup"><span data-stu-id="ec017-748"><see langword="String" />.</span></span></param>
        <summary><span data-ttu-id="ec017-749">从提供的路径分析文件名。</span><span class="sxs-lookup"><span data-stu-id="ec017-749">Parses the file name out of the path provided.</span></span></summary>
        <returns><span data-ttu-id="ec017-750">来自指定路径的文件名。</span><span class="sxs-lookup"><span data-stu-id="ec017-750">The file name from the specified path.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-751">这是一个字符串运算;不检查 `FileSystem`。</span><span class="sxs-lookup"><span data-stu-id="ec017-751">This is a string operation; the `FileSystem` is not examined.</span></span>  
  
 <span data-ttu-id="ec017-752">`GetName` 方法忽略在路径末尾出现的斜杠标记。</span><span class="sxs-lookup"><span data-stu-id="ec017-752">The `GetName` method ignores a slash mark occurring at the end of the path.</span></span>  
  
 <span data-ttu-id="ec017-753">下表列出了涉及 `My.Computer.FileSystem.GetFileName` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-753">The following table lists an example of a task involving the `My.Computer.FileSystem.GetFileName` method.</span></span>  
  
|<span data-ttu-id="ec017-754">至</span><span class="sxs-lookup"><span data-stu-id="ec017-754">To</span></span>|<span data-ttu-id="ec017-755">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-755">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-756">分析文件路径</span><span class="sxs-lookup"><span data-stu-id="ec017-756">Parse a file path</span></span>|[<span data-ttu-id="ec017-757">如何：在 Visual Basic 中分析文件路径</span><span class="sxs-lookup"><span data-stu-id="ec017-757">How to: Parse File Paths in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-758">下面的示例分析文件路径，并返回该文件的名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-758">The following example parses a file path and returns the name of the file.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#21)]  
  
 <span data-ttu-id="ec017-759">将路径 `C:\Testdirectory\Testfile` 替换为要分析的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-759">Replace the path `C:\Testdirectory\Testfile` with the path you wish to parse.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="GetParentPath">
      <MemberSignature Language="C#" Value="public static string GetParentPath (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string GetParentPath(string path) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.GetParentPath(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetParentPath (path As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ GetParentPath(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member GetParentPath : string -&gt; string" Usage="Microsoft.VisualBasic.FileIO.FileSystem.GetParentPath path" />
      <MemberSignature Language="ILAsm" Value=".method public static string GetParentPath(string path) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="ec017-760">要检查的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-760">Path to be examined.</span></span></param>
        <summary><span data-ttu-id="ec017-761">返回所提供的路径的父路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-761">Returns the parent path of the provided path.</span></span></summary>
        <returns><span data-ttu-id="ec017-762">所提供的路径的父路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-762">The parent path of the provided path.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-763">这是一个字符串运算;不检查文件系统。</span><span class="sxs-lookup"><span data-stu-id="ec017-763">This is a string operation; the file system is not examined.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-764">此示例获取 `C:\Backups\Tmp\Test`的父路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-764">This example gets the parent path for `C:\Backups\Tmp\Test`.</span></span>  
  
 [!code-vb[VbRefFile#17](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#17)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-765">路径是根路径，因此没有父路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-765">Path does not have a parent path because it is a root path.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-766"><paramref name="path" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-766"><paramref name="path" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-767">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-767">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-768">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-768">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="GetTempFileName">
      <MemberSignature Language="C#" Value="public static string GetTempFileName ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string GetTempFileName() cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.GetTempFileName" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetTempFileName () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ GetTempFileName();" />
      <MemberSignature Language="F#" Value="static member GetTempFileName : unit -&gt; string" Usage="Microsoft.VisualBasic.FileIO.FileSystem.GetTempFileName " />
      <MemberSignature Language="ILAsm" Value=".method public static string GetTempFileName() cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="ec017-769">在磁盘上创建一个唯一命名的零字节临时文件并返回该文件的完整路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-769">Creates a uniquely named zero-byte temporary file on disk and returns the full path of that file.</span></span></summary>
        <returns><span data-ttu-id="ec017-770">包含该临时文件的完整路径的 <see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-770"><see langword="String" /> containing the full path of the temporary file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-771">此方法可用于创建临时文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-771">This method can be used to create a temporary file.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-772">此示例将创建一个临时文件并返回其路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-772">This example creates a temp file and returns its path.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#12)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="MoveDirectory">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-773">将目录从一个位置移动到另一个位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-773">Moves a directory from one location to another.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="MoveDirectory">
      <MemberSignature Language="C#" Value="public static void MoveDirectory (string sourceDirectoryName, string destinationDirectoryName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.MoveDirectory(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub MoveDirectory (sourceDirectoryName As String, destinationDirectoryName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void MoveDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName);" />
      <MemberSignature Language="F#" Value="static member MoveDirectory : string * string -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.MoveDirectory (sourceDirectoryName, destinationDirectoryName)" />
      <MemberSignature Language="ILAsm" Value=".method public static void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="ec017-774">要移动的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-774">Path of the directory to be moved.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="ec017-775">源目录将移到的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-775">Path of the directory to which the source directory is being moved.</span></span></param>
        <summary><span data-ttu-id="ec017-776">将目录从一个位置移动到另一个位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-776">Moves a directory from one location to another.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-777">如果尝试将目录移动到不存在的目录中，则将创建目标结构。</span><span class="sxs-lookup"><span data-stu-id="ec017-777">If an attempt is made to move a directory inside a directory that does not exist, the target structure will be created.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-778">此示例将 `Directory1` 移动 `Directory2`内。</span><span class="sxs-lookup"><span data-stu-id="ec017-778">This example moves `Directory1` inside `Directory2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#81](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#81)]  
  
 <span data-ttu-id="ec017-779">此示例在 `Directory2`内移动 `Directory1`，并覆盖目录（如果已存在）。</span><span class="sxs-lookup"><span data-stu-id="ec017-779">This example moves `Directory1` inside `Directory2`, overwriting the directory if it already exists.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#82](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#82)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-780">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-780">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-781"><paramref name="sourceDirectoryName" /> 或 <paramref name="destinationDirectoryName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-781"><paramref name="sourceDirectoryName" /> or <paramref name="destinationDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-782">该目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-782">The directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-783">源是根目录，或者，源路径与目标路径相同。</span><span class="sxs-lookup"><span data-stu-id="ec017-783">The source is a root directory or The source path and the target path are the same.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-784">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-784">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ec017-785">操作为循环。</span><span class="sxs-lookup"><span data-stu-id="ec017-785">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-786">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-786">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-787">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-787">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-788">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-788">The user does not have required permission.</span></span></exception>
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.MoveFile" />
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory" />
      </Docs>
    </Member>
    <Member MemberName="MoveDirectory">
      <MemberSignature Language="C#" Value="public static void MoveDirectory (string sourceDirectoryName, string destinationDirectoryName, Microsoft.VisualBasic.FileIO.UIOption showUI);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.MoveDirectory(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub MoveDirectory (sourceDirectoryName As String, destinationDirectoryName As String, showUI As UIOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void MoveDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, Microsoft::VisualBasic::FileIO::UIOption showUI);" />
      <MemberSignature Language="F#" Value="static member MoveDirectory : string * string * Microsoft.VisualBasic.FileIO.UIOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.MoveDirectory (sourceDirectoryName, destinationDirectoryName, showUI)" />
      <MemberSignature Language="ILAsm" Value=".method public static void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="ec017-789">要移动的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-789">Path of the directory to be moved.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="ec017-790">源目录将移到的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-790">Path of the directory to which the source directory is being moved.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-791">指定是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-791">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-792">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-792">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <summary><span data-ttu-id="ec017-793">将目录从一个位置移动到另一个位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-793">Moves a directory from one location to another.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-794">如果尝试将目录移动到不存在的目录中，则将创建目标结构。</span><span class="sxs-lookup"><span data-stu-id="ec017-794">If an attempt is made to move a directory inside a directory that does not exist, the target structure will be created.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-795">此示例将 `Directory1` 移动 `Directory2`内。</span><span class="sxs-lookup"><span data-stu-id="ec017-795">This example moves `Directory1` inside `Directory2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#81](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#81)]  
  
 <span data-ttu-id="ec017-796">此示例在 `Directory2`内移动 `Directory1`，并覆盖目录（如果已存在）。</span><span class="sxs-lookup"><span data-stu-id="ec017-796">This example moves `Directory1` inside `Directory2`, overwriting the directory if it already exists.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#82](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#82)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-797">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-797">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-798"><paramref name="sourceDirectoryName" /> 或 <paramref name="destinationDirectoryName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-798"><paramref name="sourceDirectoryName" /> or <paramref name="destinationDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-799">该目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-799">The directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-800">目标目录已存在，并且 <paramref name="overwrite" /> 设置为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-800">The target directory already exists and <paramref name="overwrite" /> is set to <see langword="False" />.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-801">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-801">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ec017-802">操作为循环。</span><span class="sxs-lookup"><span data-stu-id="ec017-802">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-803">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-803">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-804">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-804">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-805">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-805">The user does not have required permission.</span></span></exception>
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.MoveFile" />
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
      </Docs>
    </Member>
    <Member MemberName="MoveDirectory">
      <MemberSignature Language="C#" Value="public static void MoveDirectory (string sourceDirectoryName, string destinationDirectoryName, bool overwrite);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName, bool overwrite) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.MoveDirectory(System.String,System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub MoveDirectory (sourceDirectoryName As String, destinationDirectoryName As String, overwrite As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void MoveDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, bool overwrite);" />
      <MemberSignature Language="F#" Value="static member MoveDirectory : string * string * bool -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.MoveDirectory (sourceDirectoryName, destinationDirectoryName, overwrite)" />
      <MemberSignature Language="ILAsm" Value=".method public static void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName, bool overwrite) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
        <Parameter Name="overwrite" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="ec017-806">要移动的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-806">Path of the directory to be moved.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="ec017-807">源目录将移到的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-807">Path of the directory to which the source directory is being moved.</span></span></param>
        <param name="overwrite"><span data-ttu-id="ec017-808">如果应覆盖现有目录，则为 <see langword="True" />；否则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-808"><see langword="True" /> if existing directories should be overwritten; otherwise <see langword="False" />.</span></span> <span data-ttu-id="ec017-809">默认为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-809">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="ec017-810">将目录从一个位置移动到另一个位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-810">Moves a directory from one location to another.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-811">如果尝试将目录移动到不存在的目录中，则将创建目标结构。</span><span class="sxs-lookup"><span data-stu-id="ec017-811">If an attempt is made to move a directory inside a directory that does not exist, the target structure will be created.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-812">此示例将 `Directory1` 移动 `Directory2`内。</span><span class="sxs-lookup"><span data-stu-id="ec017-812">This example moves `Directory1` inside `Directory2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#81](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#81)]  
  
 <span data-ttu-id="ec017-813">此示例在 `Directory2`内移动 `Directory1`，并覆盖目录（如果已存在）。</span><span class="sxs-lookup"><span data-stu-id="ec017-813">This example moves `Directory1` inside `Directory2`, overwriting the directory if it already exists.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#82](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#82)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-814">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-814">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-815"><paramref name="sourceDirectoryName" /> 或 <paramref name="destinationDirectoryName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-815"><paramref name="sourceDirectoryName" /> or <paramref name="destinationDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-816">该目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-816">The directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-817">目标目录已存在，并且 <paramref name="overwrite" /> 设置为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-817">The target directory already exists and <paramref name="overwrite" /> is set to <see langword="False" />.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-818">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-818">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ec017-819">操作为循环。</span><span class="sxs-lookup"><span data-stu-id="ec017-819">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-820">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-820">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-821">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-821">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-822">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-822">The user does not have required permission.</span></span></exception>
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.MoveFile" />
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory" />
      </Docs>
    </Member>
    <Member MemberName="MoveDirectory">
      <MemberSignature Language="C#" Value="public static void MoveDirectory (string sourceDirectoryName, string destinationDirectoryName, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.MoveDirectory(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub MoveDirectory (sourceDirectoryName As String, destinationDirectoryName As String, showUI As UIOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void MoveDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="static member MoveDirectory : string * string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.MoveDirectory (sourceDirectoryName, destinationDirectoryName, showUI, onUserCancel)" />
      <MemberSignature Language="ILAsm" Value=".method public static void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="ec017-823">要移动的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-823">Path of the directory to be moved.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="ec017-824">源目录将移到的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-824">Path of the directory to which the source directory is being moved.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-825">指定是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-825">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-826">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-826">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="ec017-827">指定用户取消操作时是否引发异常。</span><span class="sxs-lookup"><span data-stu-id="ec017-827">Specifies whether or not an exception is thrown when the user cancels the operation.</span></span> <span data-ttu-id="ec017-828">默认为 <see langword="UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-828">Default is <see langword="UICancelOption.ThrowException" />.</span></span></param>
        <summary><span data-ttu-id="ec017-829">将目录从一个位置移动到另一个位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-829">Moves a directory from one location to another.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-830">如果尝试将目录移动到不存在的目录中，则将创建目标结构。</span><span class="sxs-lookup"><span data-stu-id="ec017-830">If an attempt is made to move a directory inside a directory that does not exist, the target structure will be created.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-831">此示例将 `Directory1` 移动 `Directory2`内。</span><span class="sxs-lookup"><span data-stu-id="ec017-831">This example moves `Directory1` inside `Directory2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#81](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#81)]  
  
 <span data-ttu-id="ec017-832">此示例在 `Directory2`内移动 `Directory1`，并覆盖目录（如果已存在）。</span><span class="sxs-lookup"><span data-stu-id="ec017-832">This example moves `Directory1` inside `Directory2`, overwriting the directory if it already exists.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#82](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#82)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-833">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="ec017-833">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-834"><paramref name="sourceDirectoryName" /> 或 <paramref name="destinationDirectoryName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-834"><paramref name="sourceDirectoryName" /> or <paramref name="destinationDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-835">该目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-835">The directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-836"><paramref name="onUserCancel" /> 设置为 <see langword="ThrowException" /> 并且无法复制子目录中的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-836"><paramref name="onUserCancel" /> is set to <see langword="ThrowException" /> and a subdirectory of the file cannot be copied.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="ec017-837"><paramref name="onUserCancel" /> 设置为 <see langword="ThrowException" />，并且用户取消了该操作，或者无法完成该操作。</span><span class="sxs-lookup"><span data-stu-id="ec017-837"><paramref name="onUserCancel" /> is set to <see langword="ThrowException" />, and the user cancels the operation, or the operation cannot be completed.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-838">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-838">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-839">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-839">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ec017-840">操作为循环。</span><span class="sxs-lookup"><span data-stu-id="ec017-840">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-841">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-841">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-842">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-842">The user does not have required permission.</span></span></exception>
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.MoveFile" />
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <MemberGroup MemberName="MoveFile">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-843">将文件移动到一个新位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-843">Moves a file to a new location.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="MoveFile">
      <MemberSignature Language="C#" Value="public static void MoveFile (string sourceFileName, string destinationFileName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void MoveFile(string sourceFileName, string destinationFileName) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.MoveFile(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub MoveFile (sourceFileName As String, destinationFileName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void MoveFile(System::String ^ sourceFileName, System::String ^ destinationFileName);" />
      <MemberSignature Language="F#" Value="static member MoveFile : string * string -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.MoveFile (sourceFileName, destinationFileName)" />
      <MemberSignature Language="ILAsm" Value=".method public static void MoveFile(string sourceFileName, string destinationFileName) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="ec017-844">要移动的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-844">Path of the file to be moved.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="ec017-845">文件应移到的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-845">Path of the directory into which the file should be moved.</span></span></param>
        <summary><span data-ttu-id="ec017-846">将文件移动到一个新位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-846">Moves a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-847">如果目标结构不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="ec017-847">If the target structure does not exist, it is created.</span></span>  
  
 <span data-ttu-id="ec017-848">仅当在同一卷内移动文件时，`MoveFile` 方法才保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="ec017-848">The `MoveFile` method preserves ACEs (Access Control Entries) only when moving the file within the same volume.</span></span> <span data-ttu-id="ec017-849">这包括继承的 Ace，这会在移动时成为直接的 Ace （直接 Ace 优先于继承的 Ace）。</span><span class="sxs-lookup"><span data-stu-id="ec017-849">This includes inherited ACEs, which become direct ACEs when moved (direct ACEs take precedence over inherited ACEs).</span></span> <span data-ttu-id="ec017-850">如果在卷之间移动文件，则不会复制 Ace。</span><span class="sxs-lookup"><span data-stu-id="ec017-850">If a file is moved between volumes, ACEs will not be copied.</span></span>  
  
 <span data-ttu-id="ec017-851">下表列出了涉及 `My.Computer.FileSystem.MoveFile` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-851">The following table lists an example of a task involving the `My.Computer.FileSystem.MoveFile` method.</span></span>  
  
|<span data-ttu-id="ec017-852">至</span><span class="sxs-lookup"><span data-stu-id="ec017-852">To</span></span>|<span data-ttu-id="ec017-853">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-853">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-854">移动文件</span><span class="sxs-lookup"><span data-stu-id="ec017-854">Move a file</span></span>|[<span data-ttu-id="ec017-855">如何：在 Visual Basic 中移动文件</span><span class="sxs-lookup"><span data-stu-id="ec017-855">How to: Move a File in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-move-a-file)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-856">此示例将文件 `Test.txt` 从 `TestDir1` 移到 `TestDir2`。</span><span class="sxs-lookup"><span data-stu-id="ec017-856">This example moves the file `Test.txt` from `TestDir1` to `TestDir2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#86](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#86)]  
  
 <span data-ttu-id="ec017-857">此示例将文件 `Test.txt` 从 `TestDir1` 移到 `TestDir2`，并将其重命名 `Test2.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-857">This example moves the file `Test.txt` from `TestDir1` to `TestDir2` and renames it `Test2.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#87](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#87)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-858">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-858">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-859"><paramref name="destinationFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-859"><paramref name="destinationFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-860">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-860">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-861">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-861">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-862">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-862">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-863">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-863">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-864">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-864">The user lacks necessary permissions to view the path.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="MoveFile">
      <MemberSignature Language="C#" Value="public static void MoveFile (string sourceFileName, string destinationFileName, Microsoft.VisualBasic.FileIO.UIOption showUI);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void MoveFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.MoveFile(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub MoveFile (sourceFileName As String, destinationFileName As String, showUI As UIOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void MoveFile(System::String ^ sourceFileName, System::String ^ destinationFileName, Microsoft::VisualBasic::FileIO::UIOption showUI);" />
      <MemberSignature Language="F#" Value="static member MoveFile : string * string * Microsoft.VisualBasic.FileIO.UIOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.MoveFile (sourceFileName, destinationFileName, showUI)" />
      <MemberSignature Language="ILAsm" Value=".method public static void MoveFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="ec017-865">要移动的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-865">Path of the file to be moved.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="ec017-866">文件应移到的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-866">Path of the directory into which the file should be moved.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-867">指定是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-867">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-868">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-868">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <summary><span data-ttu-id="ec017-869">将文件移动到一个新位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-869">Moves a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-870">如果目标结构不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="ec017-870">If the target structure does not exist, it is created.</span></span>  
  
 <span data-ttu-id="ec017-871">仅当在同一卷内移动文件时，`MoveFile` 方法才保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="ec017-871">The `MoveFile` method preserves ACEs (Access Control Entries) only when moving the file within the same volume.</span></span> <span data-ttu-id="ec017-872">这包括继承的 Ace，这会在移动时成为直接的 Ace （直接 Ace 优先于继承的 Ace）。</span><span class="sxs-lookup"><span data-stu-id="ec017-872">This includes inherited ACEs, which become direct ACEs when moved (direct ACEs take precedence over inherited ACEs).</span></span> <span data-ttu-id="ec017-873">如果在卷之间移动文件，则不会复制 Ace。</span><span class="sxs-lookup"><span data-stu-id="ec017-873">If a file is moved between volumes, ACEs will not be copied.</span></span>  
  
 <span data-ttu-id="ec017-874">下表列出了涉及 `My.Computer.FileSystem.MoveFile` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-874">The following table lists an example of a task involving the `My.Computer.FileSystem.MoveFile` method.</span></span>  
  
|<span data-ttu-id="ec017-875">至</span><span class="sxs-lookup"><span data-stu-id="ec017-875">To</span></span>|<span data-ttu-id="ec017-876">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-876">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-877">移动文件</span><span class="sxs-lookup"><span data-stu-id="ec017-877">Move a file</span></span>|[<span data-ttu-id="ec017-878">如何：在 Visual Basic 中移动文件</span><span class="sxs-lookup"><span data-stu-id="ec017-878">How to: Move a File in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-move-a-file)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-879">此示例将文件 `Test.txt` 从 `TestDir1` 移到 `TestDir2`。</span><span class="sxs-lookup"><span data-stu-id="ec017-879">This example moves the file `Test.txt` from `TestDir1` to `TestDir2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#86](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#86)]  
  
 <span data-ttu-id="ec017-880">此示例将文件 `Test.txt` 从 `TestDir1` 移到 `TestDir2`，并将其重命名 `Test2.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-880">This example moves the file `Test.txt` from `TestDir1` to `TestDir2` and renames it `Test2.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#87](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#87)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-881">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-881">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-882"><paramref name="destinationFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-882"><paramref name="destinationFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-883">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-883">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-884">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-884">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-885">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-885">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-886">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-886">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-887">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-887">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
      </Docs>
    </Member>
    <Member MemberName="MoveFile">
      <MemberSignature Language="C#" Value="public static void MoveFile (string sourceFileName, string destinationFileName, bool overwrite);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void MoveFile(string sourceFileName, string destinationFileName, bool overwrite) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.MoveFile(System.String,System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub MoveFile (sourceFileName As String, destinationFileName As String, overwrite As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void MoveFile(System::String ^ sourceFileName, System::String ^ destinationFileName, bool overwrite);" />
      <MemberSignature Language="F#" Value="static member MoveFile : string * string * bool -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.MoveFile (sourceFileName, destinationFileName, overwrite)" />
      <MemberSignature Language="ILAsm" Value=".method public static void MoveFile(string sourceFileName, string destinationFileName, bool overwrite) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="overwrite" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="ec017-888">要移动的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-888">Path of the file to be moved.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="ec017-889">文件应移到的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-889">Path of the directory into which the file should be moved.</span></span></param>
        <param name="overwrite"><span data-ttu-id="ec017-890">要覆盖现有文件，则为 <see langword="True" />；否则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-890"><see langword="True" /> to overwrite existing files; otherwise <see langword="False" />.</span></span> <span data-ttu-id="ec017-891">默认为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-891">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="ec017-892">将文件移动到一个新位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-892">Moves a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-893">如果目标结构不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="ec017-893">If the target structure does not exist, it is created.</span></span>  
  
 <span data-ttu-id="ec017-894">仅当在同一卷内移动文件时，`MoveFile` 方法才保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="ec017-894">The `MoveFile` method preserves ACEs (Access Control Entries) only when moving the file within the same volume.</span></span> <span data-ttu-id="ec017-895">这包括继承的 Ace，这会在移动时成为直接的 Ace （直接 Ace 优先于继承的 Ace）。</span><span class="sxs-lookup"><span data-stu-id="ec017-895">This includes inherited ACEs, which become direct ACEs when moved (direct ACEs take precedence over inherited ACEs).</span></span> <span data-ttu-id="ec017-896">如果在卷之间移动文件，则不会复制 Ace。</span><span class="sxs-lookup"><span data-stu-id="ec017-896">If a file is moved between volumes, ACEs will not be copied.</span></span>  
  
 <span data-ttu-id="ec017-897">下表列出了涉及 `My.Computer.FileSystem.MoveFile` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-897">The following table lists an example of a task involving the `My.Computer.FileSystem.MoveFile` method.</span></span>  
  
|<span data-ttu-id="ec017-898">至</span><span class="sxs-lookup"><span data-stu-id="ec017-898">To</span></span>|<span data-ttu-id="ec017-899">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-899">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-900">移动文件</span><span class="sxs-lookup"><span data-stu-id="ec017-900">Move a file</span></span>|[<span data-ttu-id="ec017-901">如何：在 Visual Basic 中移动文件</span><span class="sxs-lookup"><span data-stu-id="ec017-901">How to: Move a File in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-move-a-file)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-902">此示例将文件 `Test.txt` 从 `TestDir1` 移到 `TestDir2`。</span><span class="sxs-lookup"><span data-stu-id="ec017-902">This example moves the file `Test.txt` from `TestDir1` to `TestDir2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#86](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#86)]  
  
 <span data-ttu-id="ec017-903">此示例将文件 `Test.txt` 从 `TestDir1` 移到 `TestDir2`，并将其重命名 `Test2.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-903">This example moves the file `Test.txt` from `TestDir1` to `TestDir2` and renames it `Test2.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#87](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#87)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-904">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-904">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-905"><paramref name="destinationFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-905"><paramref name="destinationFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-906">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-906">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-907">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-907">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-908">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-908">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-909">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-909">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-910">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-910">The user lacks necessary permissions to view the path.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="MoveFile">
      <MemberSignature Language="C#" Value="public static void MoveFile (string sourceFileName, string destinationFileName, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void MoveFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.MoveFile(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub MoveFile (sourceFileName As String, destinationFileName As String, showUI As UIOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void MoveFile(System::String ^ sourceFileName, System::String ^ destinationFileName, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="static member MoveFile : string * string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.MoveFile (sourceFileName, destinationFileName, showUI, onUserCancel)" />
      <MemberSignature Language="ILAsm" Value=".method public static void MoveFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="ec017-911">要移动的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-911">Path of the file to be moved.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="ec017-912">文件应移到的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-912">Path of the directory into which the file should be moved.</span></span></param>
        <param name="showUI"><span data-ttu-id="ec017-913">指定是否对操作进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="ec017-913">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="ec017-914">默认为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-914">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="ec017-915">指定用户取消操作时是否引发异常。</span><span class="sxs-lookup"><span data-stu-id="ec017-915">Specifies whether or not an exception is thrown when the user cancels the operation.</span></span> <span data-ttu-id="ec017-916">默认为 <see langword="UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-916">Default is <see langword="UICancelOption.ThrowException" />.</span></span></param>
        <summary><span data-ttu-id="ec017-917">将文件移动到一个新位置。</span><span class="sxs-lookup"><span data-stu-id="ec017-917">Moves a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-918">如果目标结构不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="ec017-918">If the target structure does not exist, it is created.</span></span>  
  
 <span data-ttu-id="ec017-919">仅当在同一卷内移动文件时，`MoveFile` 方法才保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="ec017-919">The `MoveFile` method preserves ACEs (Access Control Entries) only when moving the file within the same volume.</span></span> <span data-ttu-id="ec017-920">这包括继承的 Ace，这会在移动时成为直接的 Ace （直接 Ace 优先于继承的 Ace）。</span><span class="sxs-lookup"><span data-stu-id="ec017-920">This includes inherited ACEs, which become direct ACEs when moved (direct ACEs take precedence over inherited ACEs).</span></span> <span data-ttu-id="ec017-921">如果在卷之间移动文件，则不会复制 Ace。</span><span class="sxs-lookup"><span data-stu-id="ec017-921">If a file is moved between volumes, ACEs will not be copied.</span></span>  
  
 <span data-ttu-id="ec017-922">下表列出了涉及 `My.Computer.FileSystem.MoveFile` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-922">The following table lists an example of a task involving the `My.Computer.FileSystem.MoveFile` method.</span></span>  
  
|<span data-ttu-id="ec017-923">至</span><span class="sxs-lookup"><span data-stu-id="ec017-923">To</span></span>|<span data-ttu-id="ec017-924">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-924">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-925">移动文件</span><span class="sxs-lookup"><span data-stu-id="ec017-925">Move a file</span></span>|[<span data-ttu-id="ec017-926">如何：在 Visual Basic 中移动文件</span><span class="sxs-lookup"><span data-stu-id="ec017-926">How to: Move a File in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-move-a-file)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-927">此示例将文件 `Test.txt` 从 `TestDir1` 移到 `TestDir2`。</span><span class="sxs-lookup"><span data-stu-id="ec017-927">This example moves the file `Test.txt` from `TestDir1` to `TestDir2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#86](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#86)]  
  
 <span data-ttu-id="ec017-928">此示例将文件 `Test.txt` 从 `TestDir1` 移到 `TestDir2`，并将其重命名 `Test2.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-928">This example moves the file `Test.txt` from `TestDir1` to `TestDir2` and renames it `Test2.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#87](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#87)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-929">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-929">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-930"><paramref name="destinationFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-930"><paramref name="destinationFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-931">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-931">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-932">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-932">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="ec017-933"><paramref name="onUserCancel" /> 设置为 <see langword="ThrowException" />，并且用户已经取消了该操作或者发生了未指定的 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-933"><paramref name="onUserCancel" /> is set to <see langword="ThrowException" />, and either the user has cancelled the operation or an unspecified I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-934">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-934">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-935">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-935">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-936">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-936">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <MemberGroup MemberName="OpenTextFieldParser">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-937">使用 <see langword="OpenTextFieldParser" /> 方法可以创建 <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> 对象，该对象为分析结构化文本文件（例如日志）提供了一种简单而有效的方法。</span><span class="sxs-lookup"><span data-stu-id="ec017-937">The <see langword="OpenTextFieldParser" /> method allows you to create a <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> object, which provides a way to easily and efficiently parse structured text files, such as logs.</span></span> <span data-ttu-id="ec017-938"><see langword="TextFieldParser" /> 对象可用于读取分隔文件和固定宽度文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-938">The <see langword="TextFieldParser" /> object can be used to read both delimited and fixed-width files.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="OpenTextFieldParser">
      <MemberSignature Language="C#" Value="public static Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser(string file) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFieldParser(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function OpenTextFieldParser (file As String) As TextFieldParser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static Microsoft::VisualBasic::FileIO::TextFieldParser ^ OpenTextFieldParser(System::String ^ file);" />
      <MemberSignature Language="F#" Value="static member OpenTextFieldParser : string -&gt; Microsoft.VisualBasic.FileIO.TextFieldParser" Usage="Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFieldParser file" />
      <MemberSignature Language="ILAsm" Value=".method public static class Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser(string file) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualBasic.FileIO.TextFieldParser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-939">要使用 <see langword="TextFieldParser" /> 打开的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-939">The file to be opened with the <see langword="TextFieldParser" />.</span></span></param>
        <summary><span data-ttu-id="ec017-940">使用 <see langword="OpenTextFieldParser" /> 方法可以创建 <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> 对象，该对象为分析结构化文本文件（例如日志）提供了一种简单而有效的方法。</span><span class="sxs-lookup"><span data-stu-id="ec017-940">The <see langword="OpenTextFieldParser" /> method allows you to create a <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> object,  which provides a way to easily and efficiently parse structured text files, such as logs.</span></span> <span data-ttu-id="ec017-941"><see langword="TextFieldParser" /> 对象可用于读取分隔文件和固定宽度文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-941">The <see langword="TextFieldParser" /> object can be used to read both delimited and fixed-width files.</span></span></summary>
        <returns><span data-ttu-id="ec017-942">用于读取指定文件的 <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-942"><see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> to read the specified file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-943">下表列出了涉及 `My.Computer.FileSystem.OpenTextFieldParser` 方法的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-943">The following table lists examples of tasks involving the `My.Computer.FileSystem.OpenTextFieldParser` method.</span></span>  
  
|<span data-ttu-id="ec017-944">至</span><span class="sxs-lookup"><span data-stu-id="ec017-944">To</span></span>|<span data-ttu-id="ec017-945">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-945">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-946">从带分隔符的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-946">Read from a delimited text file</span></span>|[<span data-ttu-id="ec017-947">如何：在 Visual Basic 中读取逗号分隔的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-947">How to: Read From Comma-Delimited Text Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files)|  
|<span data-ttu-id="ec017-948">从固定宽度文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-948">Read from a fixed-width text file</span></span>|[<span data-ttu-id="ec017-949">如何：在 Visual Basic 中读取固定宽度的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-949">How to: Read From Fixed-width Text Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files)|  
|<span data-ttu-id="ec017-950">从具有多种格式的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-950">Read from a text file with multiple formats</span></span>|[<span data-ttu-id="ec017-951">如何：在 Visual Basic 中读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-951">How to: Read From Text Files with Multiple Formats in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-952">此示例将打开 `TextFieldParser.reader`，并使用它从 `C:\TestFolder1\Test1.txt`读取。</span><span class="sxs-lookup"><span data-stu-id="ec017-952">This example opens the `TextFieldParser.reader` and uses it to read from `C:\TestFolder1\Test1.txt`.</span></span>  
  
 [!code-vb[VbRefFile#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-953">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-953">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-954"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-954"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-955">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-955">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-956">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-956">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-957">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-957">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-958">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-958">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:Microsoft.VisualBasic.FileIO.MalformedLineException"><span data-ttu-id="ec017-959">无法使用指定的格式分析某行 ()。</span><span class="sxs-lookup"><span data-stu-id="ec017-959">A row cannot be parsed using the specified format.</span></span> <span data-ttu-id="ec017-960">此异常消息指定导致发生异常的行，同时将 <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> 属性分配给该行中包含的文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-960">The exception message specifies the line causing the exception, while the <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> property is assigned the text contained in the line.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-961">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-961">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />
      </Docs>
    </Member>
    <Member MemberName="OpenTextFieldParser">
      <MemberSignature Language="C#" Value="public static Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser (string file, params int[] fieldWidths);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser(string file, int32[] fieldWidths) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFieldParser(System.String,System.Int32[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function OpenTextFieldParser (file As String, ParamArray fieldWidths As Integer()) As TextFieldParser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static Microsoft::VisualBasic::FileIO::TextFieldParser ^ OpenTextFieldParser(System::String ^ file, ... cli::array &lt;int&gt; ^ fieldWidths);" />
      <MemberSignature Language="F#" Value="static member OpenTextFieldParser : string * int[] -&gt; Microsoft.VisualBasic.FileIO.TextFieldParser" Usage="Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFieldParser (file, fieldWidths)" />
      <MemberSignature Language="ILAsm" Value=".method public static class Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser(string file, int32[] fieldWidths) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualBasic.FileIO.TextFieldParser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="fieldWidths" Type="System.Int32[]">
          <Attributes>
            <Attribute FrameworkAlternate="net-5.0">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-962">要使用 <see langword="TextFieldParser" /> 打开的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-962">The file to be opened with the <see langword="TextFieldParser" />.</span></span></param>
        <param name="fieldWidths"><span data-ttu-id="ec017-963">字段的宽度。</span><span class="sxs-lookup"><span data-stu-id="ec017-963">Widths of the fields.</span></span></param>
        <summary><span data-ttu-id="ec017-964">使用 <see langword="OpenTextFieldParser" /> 方法可以创建 <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> 对象，该对象为分析结构化文本文件（例如日志）提供了一种简单而有效的方法。</span><span class="sxs-lookup"><span data-stu-id="ec017-964">The <see langword="OpenTextFieldParser" /> method allows you to create a <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> object, which provides a way to easily and efficiently parse structured text files, such as logs.</span></span> <span data-ttu-id="ec017-965"><see langword="TextFieldParser" /> 对象可用于读取分隔文件和固定宽度文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-965">The <see langword="TextFieldParser" /> object can be used to read both delimited and fixed-width files.</span></span></summary>
        <returns><span data-ttu-id="ec017-966">用于读取指定文件的 <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-966"><see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> to read the specified file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-967">下表列出了涉及 `My.Computer.FileSystem.OpenTextFieldParser` 方法的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-967">The following table lists examples of tasks involving the `My.Computer.FileSystem.OpenTextFieldParser` method.</span></span>  
  
|<span data-ttu-id="ec017-968">至</span><span class="sxs-lookup"><span data-stu-id="ec017-968">To</span></span>|<span data-ttu-id="ec017-969">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-969">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-970">从带分隔符的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-970">Read from a delimited text file</span></span>|[<span data-ttu-id="ec017-971">如何：在 Visual Basic 中读取逗号分隔的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-971">How to: Read From Comma-Delimited Text Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files)|  
|<span data-ttu-id="ec017-972">从固定宽度文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-972">Read from a fixed-width text file</span></span>|[<span data-ttu-id="ec017-973">如何：在 Visual Basic 中读取固定宽度的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-973">How to: Read From Fixed-width Text Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files)|  
|<span data-ttu-id="ec017-974">从具有多种格式的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-974">Read from a text file with multiple formats</span></span>|[<span data-ttu-id="ec017-975">如何：在 Visual Basic 中读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-975">How to: Read From Text Files with Multiple Formats in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-976">此示例将打开 `TextFieldParser.reader`，并使用它从 `C:\TestFolder1\Test1.txt`读取。</span><span class="sxs-lookup"><span data-stu-id="ec017-976">This example opens the `TextFieldParser.reader` and uses it to read from `C:\TestFolder1\Test1.txt`.</span></span>  
  
 [!code-vb[VbRefFile#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-977">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-977">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-978"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-978"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-979">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-979">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-980">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-980">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-981">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-981">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-982">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-982">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:Microsoft.VisualBasic.FileIO.MalformedLineException"><span data-ttu-id="ec017-983">无法使用指定的格式分析某行 ()。</span><span class="sxs-lookup"><span data-stu-id="ec017-983">A row cannot be parsed using the specified format.</span></span> <span data-ttu-id="ec017-984">此异常消息指定导致发生异常的行，同时将 <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> 属性分配给该行中包含的文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-984">The exception message specifies the line causing the exception, while the <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> property is assigned the text contained in the line.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-985">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-985">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />
      </Docs>
    </Member>
    <Member MemberName="OpenTextFieldParser">
      <MemberSignature Language="C#" Value="public static Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser (string file, params string[] delimiters);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser(string file, string[] delimiters) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFieldParser(System.String,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function OpenTextFieldParser (file As String, ParamArray delimiters As String()) As TextFieldParser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static Microsoft::VisualBasic::FileIO::TextFieldParser ^ OpenTextFieldParser(System::String ^ file, ... cli::array &lt;System::String ^&gt; ^ delimiters);" />
      <MemberSignature Language="F#" Value="static member OpenTextFieldParser : string * string[] -&gt; Microsoft.VisualBasic.FileIO.TextFieldParser" Usage="Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFieldParser (file, delimiters)" />
      <MemberSignature Language="ILAsm" Value=".method public static class Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser(string file, string[] delimiters) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualBasic.FileIO.TextFieldParser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="delimiters" Type="System.String[]">
          <Attributes>
            <Attribute FrameworkAlternate="net-5.0">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-986">要使用 <see langword="TextFieldParser" /> 打开的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-986">The file to be opened with the <see langword="TextFieldParser" />.</span></span></param>
        <param name="delimiters"><span data-ttu-id="ec017-987">字段分隔符。</span><span class="sxs-lookup"><span data-stu-id="ec017-987">Delimiters for the fields.</span></span></param>
        <summary><span data-ttu-id="ec017-988">使用 <see langword="OpenTextFieldParser" /> 方法可以创建 <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> 对象，该对象为分析结构化文本文件（例如日志）提供了一种简单而有效的方法。</span><span class="sxs-lookup"><span data-stu-id="ec017-988">The <see langword="OpenTextFieldParser" /> method allows you to create a <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> object, which provides a way to easily and efficiently parse structured text files, such as logs.</span></span> <span data-ttu-id="ec017-989"><see langword="TextFieldParser" /> 对象可用于读取分隔文件和固定宽度文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-989">The <see langword="TextFieldParser" /> object can be used to read both delimited and fixed-width files.</span></span></summary>
        <returns><span data-ttu-id="ec017-990">用于读取指定文件的 <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-990"><see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> to read the specified file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-991">下表列出了涉及 `My.Computer.FileSystem.OpenTextFieldParser` 方法的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-991">The following table lists examples of tasks involving the `My.Computer.FileSystem.OpenTextFieldParser` method.</span></span>  
  
|<span data-ttu-id="ec017-992">至</span><span class="sxs-lookup"><span data-stu-id="ec017-992">To</span></span>|<span data-ttu-id="ec017-993">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-993">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-994">从带分隔符的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-994">Read from a delimited text file</span></span>|[<span data-ttu-id="ec017-995">如何：在 Visual Basic 中读取逗号分隔的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-995">How to: Read From Comma-Delimited Text Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files)|  
|<span data-ttu-id="ec017-996">从固定宽度文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-996">Read from a fixed-width text file</span></span>|[<span data-ttu-id="ec017-997">如何：在 Visual Basic 中读取固定宽度的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-997">How to: Read From Fixed-width Text Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files)|  
|<span data-ttu-id="ec017-998">从具有多种格式的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="ec017-998">Read from a text file with multiple formats</span></span>|[<span data-ttu-id="ec017-999">如何：在 Visual Basic 中读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-999">How to: Read From Text Files with Multiple Formats in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1000">此示例将打开 `TextFieldParser.reader`，并使用它从 `C:\TestFolder1\Test1.txt`读取。</span><span class="sxs-lookup"><span data-stu-id="ec017-1000">This example opens the `TextFieldParser.reader` and uses it to read from `C:\TestFolder1\Test1.txt`.</span></span>  
  
 [!code-vb[VbRefFile#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1001">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1001">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-1002"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1002"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-1003">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-1003">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-1004">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-1004">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-1005">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-1005">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-1006">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-1006">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:Microsoft.VisualBasic.FileIO.MalformedLineException"><span data-ttu-id="ec017-1007">无法使用指定的格式分析某行 ()。</span><span class="sxs-lookup"><span data-stu-id="ec017-1007">A row cannot be parsed using the specified format.</span></span> <span data-ttu-id="ec017-1008">此异常消息指定导致发生异常的行，同时将 <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> 属性分配给该行中包含的文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-1008">The exception message specifies the line causing the exception, while the <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> property is assigned the text contained in the line.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-1009">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1009">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />
      </Docs>
    </Member>
    <MemberGroup MemberName="OpenTextFileReader">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-1010">打开要从文件中读取的 <see cref="T:System.IO.StreamReader" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-1010">Opens a <see cref="T:System.IO.StreamReader" /> object to read from a file.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="OpenTextFileReader">
      <MemberSignature Language="C#" Value="public static System.IO.StreamReader OpenTextFileReader (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.IO.StreamReader OpenTextFileReader(string file) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileReader(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function OpenTextFileReader (file As String) As StreamReader" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::IO::StreamReader ^ OpenTextFileReader(System::String ^ file);" />
      <MemberSignature Language="F#" Value="static member OpenTextFileReader : string -&gt; System.IO.StreamReader" Usage="Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileReader file" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.IO.StreamReader OpenTextFileReader(string file) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.StreamReader</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-1011">要读取的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1011">File to be read.</span></span></param>
        <summary><span data-ttu-id="ec017-1012">打开要从文件中读取的 <see cref="T:System.IO.StreamReader" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-1012">Opens a <see cref="T:System.IO.StreamReader" /> object to read from a file.</span></span></summary>
        <returns><span data-ttu-id="ec017-1013">要从文件中读取的 <see cref="T:System.IO.StreamReader" /> 对象</span><span class="sxs-lookup"><span data-stu-id="ec017-1013"><see cref="T:System.IO.StreamReader" /> object to read from the file</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1014">只有文本文件才能使用 <xref:System.IO.StreamReader>读取。</span><span class="sxs-lookup"><span data-stu-id="ec017-1014">Only text files can be read with a <xref:System.IO.StreamReader>.</span></span>  
  
 <span data-ttu-id="ec017-1015">下表列出了涉及 `My.Computer.FileSystem.OpenTextFileReader` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-1015">The following table lists an example of a task involving the `My.Computer.FileSystem.OpenTextFileReader` method.</span></span>  
  
|<span data-ttu-id="ec017-1016">至</span><span class="sxs-lookup"><span data-stu-id="ec017-1016">To</span></span>|<span data-ttu-id="ec017-1017">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-1017">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-1018">使用 <xref:System.IO.StreamReader> 打开文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1018">Open a file with a <xref:System.IO.StreamReader></span></span>|[<span data-ttu-id="ec017-1019">如何：使用 StreamReader 读取文件中的文本（Visual Basic）</span><span class="sxs-lookup"><span data-stu-id="ec017-1019">How to: Read Text from Files with a StreamReader (Visual Basic)</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-text-from-files-with-a-streamreader)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1020">此示例将打开 `Testfile.txt`的文件，并读取该文件中的行，并在 `MessageBox`中显示该行。</span><span class="sxs-lookup"><span data-stu-id="ec017-1020">This example opens the file `Testfile.txt`, reads a line from it, and displays the line in a `MessageBox`.</span></span>  
  
 [!code-vb[VbRefFile#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1021">文件名以反斜杠 (\\) 结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1021">The file name ends with a backslash (\\).</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-1022">无法找到指定的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1022">The specified file cannot be found.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-1023">该用户缺少从文件读取所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1023">The user lacks necessary permissions to read from the file.</span></span></exception>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="T:System.IO.StreamReader" />
      </Docs>
    </Member>
    <Member MemberName="OpenTextFileReader">
      <MemberSignature Language="C#" Value="public static System.IO.StreamReader OpenTextFileReader (string file, System.Text.Encoding encoding);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.IO.StreamReader OpenTextFileReader(string file, class System.Text.Encoding encoding) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileReader(System.String,System.Text.Encoding)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function OpenTextFileReader (file As String, encoding As Encoding) As StreamReader" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::IO::StreamReader ^ OpenTextFileReader(System::String ^ file, System::Text::Encoding ^ encoding);" />
      <MemberSignature Language="F#" Value="static member OpenTextFileReader : string * System.Text.Encoding -&gt; System.IO.StreamReader" Usage="Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileReader (file, encoding)" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.IO.StreamReader OpenTextFileReader(string file, class System.Text.Encoding encoding) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.StreamReader</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="encoding" Type="System.Text.Encoding" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-1024">要读取的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1024">File to be read.</span></span></param>
        <param name="encoding"><span data-ttu-id="ec017-1025">要用于文件内容的编码。</span><span class="sxs-lookup"><span data-stu-id="ec017-1025">The encoding to use for the file contents.</span></span> <span data-ttu-id="ec017-1026">默认值为 ASCII。</span><span class="sxs-lookup"><span data-stu-id="ec017-1026">Default is ASCII.</span></span></param>
        <summary><span data-ttu-id="ec017-1027">打开要从文件中读取的 <see cref="T:System.IO.StreamReader" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-1027">Opens a <see cref="T:System.IO.StreamReader" /> object to read from a file.</span></span></summary>
        <returns><span data-ttu-id="ec017-1028">要从文件中读取的 <see cref="T:System.IO.StreamReader" /> 对象</span><span class="sxs-lookup"><span data-stu-id="ec017-1028"><see cref="T:System.IO.StreamReader" /> object to read from the file</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1029">只有文本文件才能使用 <xref:System.IO.StreamReader>读取。</span><span class="sxs-lookup"><span data-stu-id="ec017-1029">Only text files can be read with a <xref:System.IO.StreamReader>.</span></span>  
  
 <span data-ttu-id="ec017-1030">下表列出了涉及 `My.Computer.FileSystem.OpenTextFileReader` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-1030">The following table lists an example of a task involving the `My.Computer.FileSystem.OpenTextFileReader` method.</span></span>  
  
|<span data-ttu-id="ec017-1031">至</span><span class="sxs-lookup"><span data-stu-id="ec017-1031">To</span></span>|<span data-ttu-id="ec017-1032">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-1032">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-1033">使用 <xref:System.IO.StreamReader> 打开文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1033">Open a file with a <xref:System.IO.StreamReader></span></span>|[<span data-ttu-id="ec017-1034">如何：使用 StreamReader 读取文件中的文本（Visual Basic）</span><span class="sxs-lookup"><span data-stu-id="ec017-1034">How to: Read Text from Files with a StreamReader (Visual Basic)</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-text-from-files-with-a-streamreader)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1035">此示例将打开 `Testfile.txt`的文件，并读取该文件中的行，并在 `MessageBox`中显示该行。</span><span class="sxs-lookup"><span data-stu-id="ec017-1035">This example opens the file `Testfile.txt`, reads a line from it, and displays the line in a `MessageBox`.</span></span>  
  
 [!code-vb[VbRefFile#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1036">文件名以反斜杠 (\\) 结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1036">The file name ends with a backslash (\\).</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-1037">无法找到指定的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1037">The specified file cannot be found.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-1038">该用户缺少从文件读取所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1038">The user lacks necessary permissions to read from the file.</span></span></exception>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="T:System.IO.StreamReader" />
      </Docs>
    </Member>
    <MemberGroup MemberName="OpenTextFileWriter">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-1039">打开要写入指定文件的 <see cref="T:System.IO.StreamWriter" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-1039">Opens a <see cref="T:System.IO.StreamWriter" /> object to write to the specified file.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="OpenTextFileWriter">
      <MemberSignature Language="C#" Value="public static System.IO.StreamWriter OpenTextFileWriter (string file, bool append);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.IO.StreamWriter OpenTextFileWriter(string file, bool append) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileWriter(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function OpenTextFileWriter (file As String, append As Boolean) As StreamWriter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::IO::StreamWriter ^ OpenTextFileWriter(System::String ^ file, bool append);" />
      <MemberSignature Language="F#" Value="static member OpenTextFileWriter : string * bool -&gt; System.IO.StreamWriter" Usage="Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileWriter (file, append)" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.IO.StreamWriter OpenTextFileWriter(string file, bool append) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.StreamWriter</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="append" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-1040">要写入的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1040">File to be written to.</span></span></param>
        <param name="append"><span data-ttu-id="ec017-1041">要追加到文件的内容中，则为 <see langword="True" />；要覆盖文件的内容，则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1041"><see langword="True" /> to append to the contents of the file; <see langword="False" /> to overwrite the contents of the file.</span></span> <span data-ttu-id="ec017-1042">默认为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1042">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="ec017-1043">打开要写入指定文件的 <see cref="T:System.IO.StreamWriter" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-1043">Opens a <see cref="T:System.IO.StreamWriter" /> object to write to the specified file.</span></span></summary>
        <returns><span data-ttu-id="ec017-1044">要写入指定文件的 <see cref="T:System.IO.StreamWriter" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-1044"><see cref="T:System.IO.StreamWriter" /> object to write to the specified file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1045">`OpenTextFileWriter` 方法打开并初始化文件的流，然后返回该流的 <xref:System.IO.StreamWriter> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-1045">The `OpenTextFileWriter` method opens and initializes a stream for a file and then returns the <xref:System.IO.StreamWriter> object for that stream.</span></span> <span data-ttu-id="ec017-1046">您可以根据需要多次写入流，然后在完成时将其关闭。</span><span class="sxs-lookup"><span data-stu-id="ec017-1046">You can write to the steam as many times as necessary and then close it when you are finished.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ec017-1047">必须对 <xref:System.IO.StreamWriter> 对象调用 <xref:System.IO.StreamWriter.Close%2A> 方法，以确保所有数据都正确写入基础流。</span><span class="sxs-lookup"><span data-stu-id="ec017-1047">You must call the <xref:System.IO.StreamWriter.Close%2A> method on the <xref:System.IO.StreamWriter> object to make sure that all data is correctly written to the underlying stream.</span></span>  
  
 <span data-ttu-id="ec017-1048">如果只是将几个字符串写入文件，则使用 <xref:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText%2A> 方法可能会更简单。</span><span class="sxs-lookup"><span data-stu-id="ec017-1048">If you are writing only a few strings to a file, it might be simpler to use the <xref:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText%2A> method.</span></span>  
  
 <span data-ttu-id="ec017-1049">下表列出了涉及 `My.Computer.FileSystem.OpenTextFileWriter` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-1049">The following table lists an example of a task involving the `My.Computer.FileSystem.OpenTextFileWriter` method.</span></span>  
  
|<span data-ttu-id="ec017-1050">至</span><span class="sxs-lookup"><span data-stu-id="ec017-1050">To</span></span>|<span data-ttu-id="ec017-1051">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-1051">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-1052">使用 `StreamWriter` 将文本写入文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1052">Write text to a file with a `StreamWriter`</span></span>|[<span data-ttu-id="ec017-1053">如何：在 Visual Basic 中使用 StreamWriter 向文件中写入文本</span><span class="sxs-lookup"><span data-stu-id="ec017-1053">How to: Write Text to Files with a StreamWriter in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files-with-a-streamwriter)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1054">此示例使用 `My.Computer.FileSystem.OpenTextFileWriter` 方法打开 <xref:System.IO.StreamWriter>，并使用它通过 `StreamWriter` 类的 `WriteLine` 方法，将字符串写入文本文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1054">This example opens a <xref:System.IO.StreamWriter> with the `My.Computer.FileSystem.OpenTextFileWriter` method and uses it to write a string to a text file with the `WriteLine` method of the `StreamWriter` class.</span></span>  
  
 [!code-vb[VbRefFile#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-1055"><paramref name="file" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-1055"><paramref name="file" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1056">文件名以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1056">The file name ends with a trailing slash.</span></span></exception>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="T:System.IO.StreamWriter" />
      </Docs>
    </Member>
    <Member MemberName="OpenTextFileWriter">
      <MemberSignature Language="C#" Value="public static System.IO.StreamWriter OpenTextFileWriter (string file, bool append, System.Text.Encoding encoding);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.IO.StreamWriter OpenTextFileWriter(string file, bool append, class System.Text.Encoding encoding) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileWriter(System.String,System.Boolean,System.Text.Encoding)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function OpenTextFileWriter (file As String, append As Boolean, encoding As Encoding) As StreamWriter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::IO::StreamWriter ^ OpenTextFileWriter(System::String ^ file, bool append, System::Text::Encoding ^ encoding);" />
      <MemberSignature Language="F#" Value="static member OpenTextFileWriter : string * bool * System.Text.Encoding -&gt; System.IO.StreamWriter" Usage="Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileWriter (file, append, encoding)" />
      <MemberSignature Language="ILAsm" Value=".method public static class System.IO.StreamWriter OpenTextFileWriter(string file, bool append, class System.Text.Encoding encoding) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.StreamWriter</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="append" Type="System.Boolean" />
        <Parameter Name="encoding" Type="System.Text.Encoding" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-1057">要写入的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1057">File to be written to.</span></span></param>
        <param name="append"><span data-ttu-id="ec017-1058">若要追加到文件的内容中，则为 <see langword="True" />；若要覆盖文件的内容，则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1058"><see langword="True" /> to append to the contents in the file; <see langword="False" /> to overwrite the contents of the file.</span></span> <span data-ttu-id="ec017-1059">默认为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1059">Default is <see langword="False" />.</span></span></param>
        <param name="encoding"><span data-ttu-id="ec017-1060">写入文件时要使用的编码。</span><span class="sxs-lookup"><span data-stu-id="ec017-1060">Encoding to be used in writing to the file.</span></span> <span data-ttu-id="ec017-1061">默认值为 ASCII。</span><span class="sxs-lookup"><span data-stu-id="ec017-1061">Default is ASCII.</span></span></param>
        <summary><span data-ttu-id="ec017-1062">打开要写入指定文件的 <see cref="T:System.IO.StreamWriter" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1062">Opens a <see cref="T:System.IO.StreamWriter" /> to write to the specified file.</span></span></summary>
        <returns><span data-ttu-id="ec017-1063">要写入指定文件的 <see cref="T:System.IO.StreamWriter" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-1063"><see cref="T:System.IO.StreamWriter" /> object to write to the specified file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1064">`OpenTextFileWriter` 方法打开并初始化文件的流，然后返回该流的 <xref:System.IO.StreamWriter> 对象。</span><span class="sxs-lookup"><span data-stu-id="ec017-1064">The `OpenTextFileWriter` method opens and initializes a stream for a file and then returns the <xref:System.IO.StreamWriter> object for that stream.</span></span> <span data-ttu-id="ec017-1065">您可以根据需要多次写入流，然后在完成时将其关闭。</span><span class="sxs-lookup"><span data-stu-id="ec017-1065">You can write to the steam as many times as necessary and then close it when you are finished.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ec017-1066">必须对 <xref:System.IO.StreamWriter> 对象调用 <xref:System.IO.StreamWriter.Close%2A> 方法，以确保所有数据都正确写入基础流。</span><span class="sxs-lookup"><span data-stu-id="ec017-1066">You must call the <xref:System.IO.StreamWriter.Close%2A> method on the <xref:System.IO.StreamWriter> object to make sure that all data is correctly written to the underlying stream.</span></span>  
  
 <span data-ttu-id="ec017-1067">如果只是将几个字符串写入文件，则使用 <xref:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText%2A> 方法可能会更简单。</span><span class="sxs-lookup"><span data-stu-id="ec017-1067">If you are writing only a few strings to a file, it might be simpler to use the <xref:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText%2A> method.</span></span>  
  
 <span data-ttu-id="ec017-1068">下表列出了涉及 `My.Computer.FileSystem.OpenTextFileWriter` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-1068">The following table lists an example of a task involving the `My.Computer.FileSystem.OpenTextFileWriter` method.</span></span>  
  
|<span data-ttu-id="ec017-1069">至</span><span class="sxs-lookup"><span data-stu-id="ec017-1069">To</span></span>|<span data-ttu-id="ec017-1070">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-1070">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-1071">使用 `StreamWriter` 将文本写入文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1071">Write text to a file with a `StreamWriter`</span></span>|[<span data-ttu-id="ec017-1072">如何：在 Visual Basic 中使用 StreamWriter 向文件中写入文本</span><span class="sxs-lookup"><span data-stu-id="ec017-1072">How to: Write Text to Files with a StreamWriter in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files-with-a-streamwriter)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1073">此示例使用带有 `Unicode` 编码的 `My.Computer.FileSystem.OpenTextFileWriter` 方法打开 <xref:System.IO.StreamWriter>，并使用该方法通过 `StreamWriter` 类的 `WriteLine` 方法，将字符串写入文本文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1073">This example opens a <xref:System.IO.StreamWriter> with the `My.Computer.FileSystem.OpenTextFileWriter` method with `Unicode` encoding and uses it to write a string to a text file with the `WriteLine` method of the `StreamWriter` class.</span></span>  
  
 [!code-vb[VbRefFile#23](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#23)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-1074"><paramref name="file" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-1074"><paramref name="file" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1075">文件名以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1075">The file name ends with a trailing slash.</span></span></exception>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="T:System.IO.StreamWriter" />
      </Docs>
    </Member>
    <Member MemberName="ReadAllBytes">
      <MemberSignature Language="C#" Value="public static byte[] ReadAllBytes (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig unsigned int8[] ReadAllBytes(string file) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.ReadAllBytes(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ReadAllBytes (file As String) As Byte()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Byte&gt; ^ ReadAllBytes(System::String ^ file);" />
      <MemberSignature Language="F#" Value="static member ReadAllBytes : string -&gt; byte[]" Usage="Microsoft.VisualBasic.FileIO.FileSystem.ReadAllBytes file" />
      <MemberSignature Language="ILAsm" Value=".method public static unsigned int8[] ReadAllBytes(string file) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Byte[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-1076">要读取的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1076">File to be read.</span></span></param>
        <summary><span data-ttu-id="ec017-1077">以字节数组的形式返回文件的内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-1077">Returns the contents of a file as a byte array.</span></span></summary>
        <returns><span data-ttu-id="ec017-1078">包含文件内容的 <see langword="Byte" /> 数组。</span><span class="sxs-lookup"><span data-stu-id="ec017-1078"><see langword="Byte" /> array containing the contents of the file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1079">使用 `My.Computer.FileSystem` 对象的 `ReadAllBytes` 方法，您可以从二进制文件中读取。</span><span class="sxs-lookup"><span data-stu-id="ec017-1079">The `ReadAllBytes` method of the `My.Computer.FileSystem` object allows you to read from a binary file.</span></span> <span data-ttu-id="ec017-1080">文件的内容作为字节数组返回。</span><span class="sxs-lookup"><span data-stu-id="ec017-1080">The contents of the file are returned as a byte array.</span></span>  
  
 <span data-ttu-id="ec017-1081">不要根据文件的名称来判断文件的内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-1081">Do not make decisions about the contents of the file based on the name of the file.</span></span> <span data-ttu-id="ec017-1082">例如，文件 Form1.vb 可能不是 Visual Basic 源文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1082">For example, the file Form1.vb may not be a Visual Basic source file.</span></span> <span data-ttu-id="ec017-1083">在应用程序中使用输入的数据之前，需验证所有的输入内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-1083">Verify all inputs before using the data in your application.</span></span>  
  
 <span data-ttu-id="ec017-1084">下表列出了涉及 `My.Computer.FileSystem.ReadAllBytes` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-1084">The following table lists an example of a task involving the `My.Computer.FileSystem.ReadAllBytes` method.</span></span>  
  
|<span data-ttu-id="ec017-1085">至</span><span class="sxs-lookup"><span data-stu-id="ec017-1085">To</span></span>|<span data-ttu-id="ec017-1086">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-1086">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-1087">从二进制文件读取</span><span class="sxs-lookup"><span data-stu-id="ec017-1087">Read from a binary file</span></span>|[<span data-ttu-id="ec017-1088">如何：读取 Visual Basic 中的二进制文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1088">How to: Read From Binary Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-binary-files)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1089">此示例从文件读取 `C:/Documents and Settings/selfportrait.jpg.`</span><span class="sxs-lookup"><span data-stu-id="ec017-1089">This example reads from the file `C:/Documents and Settings/selfportrait.jpg.`</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#33](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#33)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1090">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1090">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-1091"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1091"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-1092">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-1092">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-1093">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-1093">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-1094">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-1094">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-1095">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-1095">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="ec017-1096">内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="ec017-1096">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-1097">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1097">The user lacks necessary permissions to view the path.</span></span></exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="ReadAllText">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-1098">将文本文件的内容作为 <see langword="String" /> 返回。</span><span class="sxs-lookup"><span data-stu-id="ec017-1098">Returns the contents of a text file as a <see langword="String" />.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReadAllText">
      <MemberSignature Language="C#" Value="public static string ReadAllText (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string ReadAllText(string file) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.ReadAllText(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ReadAllText (file As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ ReadAllText(System::String ^ file);" />
      <MemberSignature Language="F#" Value="static member ReadAllText : string -&gt; string" Usage="Microsoft.VisualBasic.FileIO.FileSystem.ReadAllText file" />
      <MemberSignature Language="ILAsm" Value=".method public static string ReadAllText(string file) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-1099">要读取的文件的名称和路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-1099">Name and path of the file to read.</span></span></param>
        <summary><span data-ttu-id="ec017-1100">将文本文件的内容作为 <see langword="String" /> 返回。</span><span class="sxs-lookup"><span data-stu-id="ec017-1100">Returns the contents of a text file as a <see langword="String" />.</span></span></summary>
        <returns><span data-ttu-id="ec017-1101">包含文件内容的 <see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1101"><see langword="String" /> containing the contents of the file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1102">通过 `ReadAllText` 对象的 `My.Computer.FileSystem` 方法，可以读取文本文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1102">The `ReadAllText` method of the `My.Computer.FileSystem` object allows you to read from a text file.</span></span> <span data-ttu-id="ec017-1103">文件的内容作为字符串返回。</span><span class="sxs-lookup"><span data-stu-id="ec017-1103">The contents of the file are returned as a string.</span></span>  
  
 <span data-ttu-id="ec017-1104">如果文件内容的编码格式为 ASCII 或 utf-8，则可以指定文件编码。</span><span class="sxs-lookup"><span data-stu-id="ec017-1104">The file encoding can be specified if the contents of the file are in an encoding such as ASCII or UTF-8.</span></span> <span data-ttu-id="ec017-1105">如果要从文件中读取包含扩展字符的文件，则需要使用 <xref:Microsoft.VisualBasic.FileIO.FileSystem.ReadAllText%2A> 方法的另一个重载来指定文件编码。</span><span class="sxs-lookup"><span data-stu-id="ec017-1105">If you are reading from a file with extended characters, you need to specify the file encoding using another overload of the <xref:Microsoft.VisualBasic.FileIO.FileSystem.ReadAllText%2A> method.</span></span>  
  
 <span data-ttu-id="ec017-1106">不要根据文件的名称来判断文件的内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-1106">Do not make decisions about the contents of the file based on the name of the file.</span></span> <span data-ttu-id="ec017-1107">例如，文件 Form1.vb 可能不是 Visual Basic 源文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1107">For example, the file Form1.vb may not be a Visual Basic source file.</span></span> <span data-ttu-id="ec017-1108">在应用程序中使用输入的数据之前，需验证所有的输入内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-1108">Verify all inputs before using the data in your application.</span></span>  
  
 <span data-ttu-id="ec017-1109">下表列出了涉及 `My.Computer.FileSystem.ReadAllText` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-1109">The following table lists an example of a task involving the `My.Computer.FileSystem.ReadAllText` method.</span></span>  
  
|<span data-ttu-id="ec017-1110">至</span><span class="sxs-lookup"><span data-stu-id="ec017-1110">To</span></span>|<span data-ttu-id="ec017-1111">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-1111">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-1112">从文本文件读取</span><span class="sxs-lookup"><span data-stu-id="ec017-1112">Read from a text file</span></span>|[<span data-ttu-id="ec017-1113">如何：读取 Visual Basic 中的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1113">How to: Read From Text Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1114">此示例将 `Test.txt` 的内容读入字符串中，然后将其显示在消息框中。</span><span class="sxs-lookup"><span data-stu-id="ec017-1114">This example reads the contents of `Test.txt` into a string and then displays it in a message box.</span></span>  
  
 [!code-vb[VbRefFile#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#8)]  
  
 <span data-ttu-id="ec017-1115">此示例将 ASCII 文件 `Test.txt` 的内容读入字符串中，然后将其显示在消息框中。</span><span class="sxs-lookup"><span data-stu-id="ec017-1115">This example reads the contents of the ASCII file `Test.txt` into a string and then displays it in a message box.</span></span>  
  
 [!code-vb[VbRefFile#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1116">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1116">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-1117"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1117"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-1118">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-1118">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-1119">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-1119">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-1120">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-1120">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-1121">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-1121">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="ec017-1122">内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="ec017-1122">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-1123">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1123">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.ReadAllText" />
        <altmember cref="M:System.IO.StreamReader.#ctor(System.IO.Stream,System.Text.Encoding)" />
      </Docs>
    </Member>
    <Member MemberName="ReadAllText">
      <MemberSignature Language="C#" Value="public static string ReadAllText (string file, System.Text.Encoding encoding);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string ReadAllText(string file, class System.Text.Encoding encoding) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.ReadAllText(System.String,System.Text.Encoding)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ReadAllText (file As String, encoding As Encoding) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ ReadAllText(System::String ^ file, System::Text::Encoding ^ encoding);" />
      <MemberSignature Language="F#" Value="static member ReadAllText : string * System.Text.Encoding -&gt; string" Usage="Microsoft.VisualBasic.FileIO.FileSystem.ReadAllText (file, encoding)" />
      <MemberSignature Language="ILAsm" Value=".method public static string ReadAllText(string file, class System.Text.Encoding encoding) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="encoding" Type="System.Text.Encoding" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-1124">要读取的文件的名称和路径。</span><span class="sxs-lookup"><span data-stu-id="ec017-1124">Name and path of the file to read.</span></span></param>
        <param name="encoding"><span data-ttu-id="ec017-1125">读取文件时要使用的字符编码。</span><span class="sxs-lookup"><span data-stu-id="ec017-1125">Character encoding to use in reading the file.</span></span> <span data-ttu-id="ec017-1126">默认值为 UTF-8。</span><span class="sxs-lookup"><span data-stu-id="ec017-1126">Default is UTF-8.</span></span></param>
        <summary><span data-ttu-id="ec017-1127">将文本文件的内容作为 <see langword="String" /> 返回。</span><span class="sxs-lookup"><span data-stu-id="ec017-1127">Returns the contents of a text file as a <see langword="String" />.</span></span></summary>
        <returns><span data-ttu-id="ec017-1128">包含文件内容的 <see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1128"><see langword="String" /> containing the contents of the file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1129">通过 `ReadAllText` 对象的 `My.Computer.FileSystem` 方法，可以读取文本文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1129">The `ReadAllText` method of the `My.Computer.FileSystem` object allows you to read from a text file.</span></span> <span data-ttu-id="ec017-1130">文件的内容作为字符串返回。</span><span class="sxs-lookup"><span data-stu-id="ec017-1130">The contents of the file are returned as a string.</span></span>  
  
 <span data-ttu-id="ec017-1131">如果文件内容的编码格式为 ASCII 或 utf-8，则可以指定文件编码。</span><span class="sxs-lookup"><span data-stu-id="ec017-1131">The file encoding can be specified if the contents of the file are in an encoding such as ASCII or UTF-8.</span></span> <span data-ttu-id="ec017-1132">如果要从文件中读取包含扩展字符的文件，则需要指定文件编码。</span><span class="sxs-lookup"><span data-stu-id="ec017-1132">If you are reading from a file with extended characters, you need to specify the file encoding.</span></span>  
  
 <span data-ttu-id="ec017-1133">不要根据文件的名称来判断文件的内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-1133">Do not make decisions about the contents of the file based on the name of the file.</span></span> <span data-ttu-id="ec017-1134">例如，文件 Form1.vb 可能不是 Visual Basic 源文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1134">For example, the file Form1.vb may not be a Visual Basic source file.</span></span> <span data-ttu-id="ec017-1135">在应用程序中使用输入的数据之前，需验证所有的输入内容。</span><span class="sxs-lookup"><span data-stu-id="ec017-1135">Verify all inputs before using the data in your application.</span></span>  
  
 <span data-ttu-id="ec017-1136">下表列出了涉及 `My.Computer.FileSystem.ReadAllText` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-1136">The following table lists an example of a task involving the `My.Computer.FileSystem.ReadAllText` method.</span></span>  
  
|<span data-ttu-id="ec017-1137">至</span><span class="sxs-lookup"><span data-stu-id="ec017-1137">To</span></span>|<span data-ttu-id="ec017-1138">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-1138">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-1139">从文本文件读取</span><span class="sxs-lookup"><span data-stu-id="ec017-1139">Read from a text file</span></span>|[<span data-ttu-id="ec017-1140">如何：读取 Visual Basic 中的文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1140">How to: Read From Text Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1141">此示例将 `Test.txt` 的内容读入字符串中，然后将其显示在消息框中。</span><span class="sxs-lookup"><span data-stu-id="ec017-1141">This example reads the contents of `Test.txt` into a string and then displays it in a message box.</span></span>  
  
 [!code-vb[VbRefFile#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#8)]  
  
 <span data-ttu-id="ec017-1142">此示例将 ASCII 文件 `Test.txt` 的内容读入字符串中，然后将其显示在消息框中。</span><span class="sxs-lookup"><span data-stu-id="ec017-1142">This example reads the contents of the ASCII file `Test.txt` into a string and then displays it in a message box.</span></span>  
  
 [!code-vb[VbRefFile#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1143">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1143">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-1144"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1144"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-1145">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-1145">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-1146">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-1146">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-1147">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-1147">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-1148">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-1148">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="ec017-1149">内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="ec017-1149">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-1150">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1150">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="M:System.IO.StreamReader.#ctor(System.IO.Stream,System.Text.Encoding)" />
      </Docs>
    </Member>
    <Member MemberName="RenameDirectory">
      <MemberSignature Language="C#" Value="public static void RenameDirectory (string directory, string newName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void RenameDirectory(string directory, string newName) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.RenameDirectory(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub RenameDirectory (directory As String, newName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void RenameDirectory(System::String ^ directory, System::String ^ newName);" />
      <MemberSignature Language="F#" Value="static member RenameDirectory : string * string -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.RenameDirectory (directory, newName)" />
      <MemberSignature Language="ILAsm" Value=".method public static void RenameDirectory(string directory, string newName) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" />
        <Parameter Name="newName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="ec017-1151">要重命名的目录的路径和名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-1151">Path and name of directory to be renamed.</span></span></param>
        <param name="newName"><span data-ttu-id="ec017-1152">目录的新名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-1152">New name for directory.</span></span></param>
        <summary><span data-ttu-id="ec017-1153">重命名目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-1153">Renames a directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1154">此方法不能用于移动目录;使用 `MoveDirectory` 方法移动和重命名目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-1154">This method cannot be used to move a directory; use the `MoveDirectory` method to move and rename the directory.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1155">此示例将 `Test` 目录重命名为 `SecondTest`。</span><span class="sxs-lookup"><span data-stu-id="ec017-1155">This example renames the `Test` directory to `SecondTest`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1156"><paramref name="newName" /> 包含路径信息。</span><span class="sxs-lookup"><span data-stu-id="ec017-1156"><paramref name="newName" /> contains path information.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-1157"><paramref name="directory" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1157"><paramref name="directory" /> is <see langword="Nothing" />.</span></span>  
  
<span data-ttu-id="ec017-1158">- 或 -</span><span class="sxs-lookup"><span data-stu-id="ec017-1158">-or-</span></span> 
 <span data-ttu-id="ec017-1159"><paramref name="newName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-1159"><paramref name="newName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="ec017-1160">该目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-1160">The directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-1161">存在一个具有 <paramref name="newName" /> 中指定的名称的文件或目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-1161">There is an existing file or directory with the name specified in <paramref name="newName" />.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-1162">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-1162">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-1163">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-1163">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-1164">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1164">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-1165">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1165">The user does not have required permission.</span></span></exception>
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.MoveDirectory" />
      </Docs>
    </Member>
    <Member MemberName="RenameFile">
      <MemberSignature Language="C#" Value="public static void RenameFile (string file, string newName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void RenameFile(string file, string newName) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.RenameFile(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub RenameFile (file As String, newName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void RenameFile(System::String ^ file, System::String ^ newName);" />
      <MemberSignature Language="F#" Value="static member RenameFile : string * string -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.RenameFile (file, newName)" />
      <MemberSignature Language="ILAsm" Value=".method public static void RenameFile(string file, string newName) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="newName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-1166">要重命名的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1166">File to be renamed.</span></span></param>
        <param name="newName"><span data-ttu-id="ec017-1167">文件的新名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-1167">New name of file.</span></span></param>
        <summary><span data-ttu-id="ec017-1168">重命名文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1168">Renames a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1169">此方法不能用于移动文件；使用 <xref:Microsoft.VisualBasic.FileIO.FileSystem.MoveFile%2A> 方法可移动并重命名文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1169">This method cannot be used to move a file; use the <xref:Microsoft.VisualBasic.FileIO.FileSystem.MoveFile%2A> method to move and rename the file.</span></span>  
  
 <span data-ttu-id="ec017-1170">下表列出了涉及 `My.Computer.FileSystem.RenameFile` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-1170">The following table lists an example of a task involving the `My.Computer.FileSystem.RenameFile` method.</span></span>  
  
|<span data-ttu-id="ec017-1171">至</span><span class="sxs-lookup"><span data-stu-id="ec017-1171">To</span></span>|<span data-ttu-id="ec017-1172">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-1172">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-1173">重命名文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1173">Rename a file</span></span>|[<span data-ttu-id="ec017-1174">如何：在 Visual Basic 中重命名文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1174">How to: Rename a File in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1175">此示例将文件 `Test.txt` 重命名为 `SecondTest.txt`。</span><span class="sxs-lookup"><span data-stu-id="ec017-1175">This example renames the file `Test.txt` to `SecondTest.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#1)]  
  
 <span data-ttu-id="ec017-1176">将 "`C:\Test.txt`" 更改为要重命名的文件的路径和文件名。</span><span class="sxs-lookup"><span data-stu-id="ec017-1176">Change "`C:\Test.txt`" to the path and file name of the file that you want to rename.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1177"><paramref name="newName" /> 包含路径信息或以反斜杠 (\\) 结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1177"><paramref name="newName" /> contains path information or ends with a backslash (\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-1178"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1178"><paramref name="file" /> is <see langword="Nothing" />.</span></span>  
  
<span data-ttu-id="ec017-1179">- 或 -</span><span class="sxs-lookup"><span data-stu-id="ec017-1179">-or-</span></span> 
 <span data-ttu-id="ec017-1180"><paramref name="newName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="ec017-1180"><paramref name="newName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-1181">该目录不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-1181">The directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-1182">存在一个具有 <paramref name="newName" /> 中指定的名称的文件或目录。</span><span class="sxs-lookup"><span data-stu-id="ec017-1182">There is an existing file or directory with the name specified in <paramref name="newName" />.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-1183">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-1183">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-1184">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-1184">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-1185">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1185">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="ec017-1186">该用户没有必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1186">The user does not have required permission.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteAllBytes">
      <MemberSignature Language="C#" Value="public static void WriteAllBytes (string file, byte[] data, bool append);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteAllBytes(string file, unsigned int8[] data, bool append) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllBytes(System.String,System.Byte[],System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteAllBytes (file As String, data As Byte(), append As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteAllBytes(System::String ^ file, cli::array &lt;System::Byte&gt; ^ data, bool append);" />
      <MemberSignature Language="F#" Value="static member WriteAllBytes : string * byte[] * bool -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.WriteAllBytes (file, data, append)" />
      <MemberSignature Language="ILAsm" Value=".method public static void WriteAllBytes(string file, unsigned int8[] data, bool append) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="data" Type="System.Byte[]" />
        <Parameter Name="append" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-1187">要写入的文件的路径和名称。</span><span class="sxs-lookup"><span data-stu-id="ec017-1187">Path and name of the file to be written to.</span></span></param>
        <param name="data"><span data-ttu-id="ec017-1188">要写入文件的数据。</span><span class="sxs-lookup"><span data-stu-id="ec017-1188">Data to be written to the file.</span></span></param>
        <param name="append"><span data-ttu-id="ec017-1189">若要追加到文件内容中，则为 <see langword="True" />；若要覆盖文件内容，则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1189"><see langword="True" /> to append to the file contents; <see langword="False" /> to overwrite the file contents.</span></span> <span data-ttu-id="ec017-1190">默认为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1190">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="ec017-1191">将数据写入二进制文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1191">Writes data to a binary file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1192">如果指定的路径（不包括文件名）无效，则会引发 <xref:System.IO.DirectoryNotFoundException> 异常。</span><span class="sxs-lookup"><span data-stu-id="ec017-1192">If the specified path, excluding the file name, is not valid, a <xref:System.IO.DirectoryNotFoundException> exception will be thrown.</span></span> <span data-ttu-id="ec017-1193">如果该路径有效，但该文件不存在，则创建该文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1193">If the path is valid but the file does not exist, the file is created.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ec017-1194">`WriteAllBytes` 方法会打开一个文件，向其中写入数据，然后将其关闭。</span><span class="sxs-lookup"><span data-stu-id="ec017-1194">The `WriteAllBytes` method opens a file, writes to it, and then closes it.</span></span> <span data-ttu-id="ec017-1195">使用 `WriteAllBytes` 方法的代码比使用 <xref:System.IO.BinaryWriter> 对象的代码更简单。</span><span class="sxs-lookup"><span data-stu-id="ec017-1195">Code that uses the `WriteAllBytes` method is simpler than code that uses a <xref:System.IO.BinaryWriter> object.</span></span> <span data-ttu-id="ec017-1196">但是，如果使用循环将数据添加到文件，则 <xref:System.IO.BinaryWriter> 对象可以提供更好的性能，因为只需打开并关闭该文件一次。</span><span class="sxs-lookup"><span data-stu-id="ec017-1196">However, if you are adding data to a file using a loop, a <xref:System.IO.BinaryWriter> object can provide better performance because you only have to open and close the file once.</span></span>  
  
 <span data-ttu-id="ec017-1197">下表列出了涉及 `My.Computer.FileSystem.WriteAllBytes` 方法的任务的示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-1197">The following table lists an example of a task involving the `My.Computer.FileSystem.WriteAllBytes` method.</span></span>  
  
|<span data-ttu-id="ec017-1198">至</span><span class="sxs-lookup"><span data-stu-id="ec017-1198">To</span></span>|<span data-ttu-id="ec017-1199">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-1199">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-1200">写入二进制文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1200">Write to a binary file</span></span>|[<span data-ttu-id="ec017-1201">如何：在 Visual Basic 中写入二进制文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1201">How to: Write to Binary Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-to-binary-files)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1202">此示例将 `CustomerData` 的数据数组追加到文件 `CollectedData`。</span><span class="sxs-lookup"><span data-stu-id="ec017-1202">This example appends the data array `CustomerData` to the file `CollectedData`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#50](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#50)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1203">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1203">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-1204"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1204"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-1205">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-1205">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-1206">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-1206">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-1207">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-1207">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-1208">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-1208">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="ec017-1209">内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="ec017-1209">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-1210">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1210">The user lacks necessary permissions to view the path.</span></span></exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteAllText">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ec017-1211">向文件写入文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-1211">Writes text to a file.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteAllText">
      <MemberSignature Language="C#" Value="public static void WriteAllText (string file, string text, bool append);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteAllText(string file, string text, bool append) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText(System.String,System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteAllText (file As String, text As String, append As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteAllText(System::String ^ file, System::String ^ text, bool append);" />
      <MemberSignature Language="F#" Value="static member WriteAllText : string * string * bool -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText (file, text, append)" />
      <MemberSignature Language="ILAsm" Value=".method public static void WriteAllText(string file, string text, bool append) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="text" Type="System.String" />
        <Parameter Name="append" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-1212">要写入的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1212">File to be written to.</span></span></param>
        <param name="text"><span data-ttu-id="ec017-1213">要写入文件的文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-1213">Text to be written to file.</span></span></param>
        <param name="append"><span data-ttu-id="ec017-1214">要追加到文件的内容中，则为 <see langword="True" />；要覆盖文件的内容，则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1214"><see langword="True" /> to append to the contents of the file; <see langword="False" /> to overwrite the contents of the file.</span></span></param>
        <summary><span data-ttu-id="ec017-1215">向文件写入文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-1215">Writes text to a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1216">UTF-8 编码用于写入文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1216">The UTF-8 encoding is used to write to the file.</span></span> <span data-ttu-id="ec017-1217">若要指定不同的编码，请使用 <xref:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText%2A> 方法的其他重载。</span><span class="sxs-lookup"><span data-stu-id="ec017-1217">To specify a different encoding, use a different overload of the <xref:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText%2A> method.</span></span>  
  
 <span data-ttu-id="ec017-1218">如果指定的文件不存在，则会创建一个。</span><span class="sxs-lookup"><span data-stu-id="ec017-1218">If the specified file does not exist, it is created.</span></span>  
  
 <span data-ttu-id="ec017-1219">如果指定的编码与文件的现有编码不匹配，则忽略指定的编码。</span><span class="sxs-lookup"><span data-stu-id="ec017-1219">If the specified encoding does not match the existing encoding of the file, the specified coding is ignored.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ec017-1220">`WriteAllText` 方法会打开一个文件，向其中写入数据，然后将其关闭。</span><span class="sxs-lookup"><span data-stu-id="ec017-1220">The `WriteAllText` method opens a file, writes to it, and then closes it.</span></span> <span data-ttu-id="ec017-1221">使用 `WriteAllText` 方法的代码比使用 <xref:System.IO.StreamWriter> 对象的代码更简单。</span><span class="sxs-lookup"><span data-stu-id="ec017-1221">Code that uses the `WriteAllText` method is simpler than code that uses a <xref:System.IO.StreamWriter> object.</span></span> <span data-ttu-id="ec017-1222">但是，如果要使用循环将字符串添加到文件，则 <xref:System.IO.StreamWriter> 对象可以提供更好的性能，因为只需打开并关闭该文件一次。</span><span class="sxs-lookup"><span data-stu-id="ec017-1222">However, if you are adding strings to a file by using a loop, a <xref:System.IO.StreamWriter> object can provide better performance because you only have to open and close the file one time.</span></span> <span data-ttu-id="ec017-1223">有关更多信息，请参见 <xref:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileWriter%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="ec017-1223">For more information, see the <xref:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileWriter%2A> method.</span></span>  
  
 <span data-ttu-id="ec017-1224">下表列出了涉及 `My.Computer.FileSystem.WriteAllText` 方法的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-1224">The following table lists examples of tasks involving the `My.Computer.FileSystem.WriteAllText` method.</span></span>  
  
|<span data-ttu-id="ec017-1225">至</span><span class="sxs-lookup"><span data-stu-id="ec017-1225">To</span></span>|<span data-ttu-id="ec017-1226">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-1226">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-1227">将文本写入文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1227">Write text to a file</span></span>|[<span data-ttu-id="ec017-1228">如何：在 Visual Basic 中将文本写入文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1228">How to: Write Text to Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files)|  
|<span data-ttu-id="ec017-1229">向文件中追加文本</span><span class="sxs-lookup"><span data-stu-id="ec017-1229">Append text to a file</span></span>|[<span data-ttu-id="ec017-1230">如何：在 Visual Basic 中追加到文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1230">How to: Append to Text Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-append-to-text-files)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1231">此示例将行 `"This is new text to be added."` 写入文件 `Test.txt`，并覆盖文件中的任何现有文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-1231">This example writes the line `"This is new text to be added."` to the file `Test.txt`, overwriting any existing text in the file.</span></span>  
  
 [!code-vb[VbRefFile#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#21)]  
  
 <span data-ttu-id="ec017-1232">此示例将 `Documents and Settings` 文件夹中的文件名称写入 `FileList.txt`，并在每个文件之间插入一个回车符，以便更好地阅读。</span><span class="sxs-lookup"><span data-stu-id="ec017-1232">This example writes the names of the files in the `Documents and Settings` folder to `FileList.txt`, inserting a carriage return between each for better readability.</span></span>  
  
 [!code-vb[VbRefFile#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#22)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1233">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1233">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-1234"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1234"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-1235">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-1235">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-1236">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-1236">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-1237">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-1237">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-1238">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-1238">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="ec017-1239">内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="ec017-1239">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-1240">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1240">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText" />
      </Docs>
    </Member>
    <Member MemberName="WriteAllText">
      <MemberSignature Language="C#" Value="public static void WriteAllText (string file, string text, bool append, System.Text.Encoding encoding);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteAllText(string file, string text, bool append, class System.Text.Encoding encoding) cil managed" FrameworkAlternate="net-5.0;netcore-3.0;netcore-3.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText(System.String,System.String,System.Boolean,System.Text.Encoding)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteAllText (file As String, text As String, append As Boolean, encoding As Encoding)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteAllText(System::String ^ file, System::String ^ text, bool append, System::Text::Encoding ^ encoding);" />
      <MemberSignature Language="F#" Value="static member WriteAllText : string * string * bool * System.Text.Encoding -&gt; unit" Usage="Microsoft.VisualBasic.FileIO.FileSystem.WriteAllText (file, text, append, encoding)" />
      <MemberSignature Language="ILAsm" Value=".method public static void WriteAllText(string file, string text, bool append, class System.Text.Encoding encoding) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
        <AssemblyVersion>10.0.5.0</AssemblyVersion>
        <AssemblyVersion>10.0.6.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" />
        <Parameter Name="text" Type="System.String" />
        <Parameter Name="append" Type="System.Boolean" />
        <Parameter Name="encoding" Type="System.Text.Encoding" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="ec017-1241">要写入的文件。</span><span class="sxs-lookup"><span data-stu-id="ec017-1241">File to be written to.</span></span></param>
        <param name="text"><span data-ttu-id="ec017-1242">要写入文件的文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-1242">Text to be written to file.</span></span></param>
        <param name="append"><span data-ttu-id="ec017-1243">要追加到文件的内容中，则为 <see langword="True" />；要覆盖文件的内容，则为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1243"><see langword="True" /> to append to the contents of the file; <see langword="False" /> to overwrite the contents of the file.</span></span></param>
        <param name="encoding"><span data-ttu-id="ec017-1244">写入文件时要使用的编码。</span><span class="sxs-lookup"><span data-stu-id="ec017-1244">What encoding to use when writing to file.</span></span></param>
        <summary><span data-ttu-id="ec017-1245">向文件写入文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-1245">Writes text to a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ec017-1246">如果指定的文件不存在，则会创建一个。</span><span class="sxs-lookup"><span data-stu-id="ec017-1246">If the specified file does not exist, it is created.</span></span>  
  
 <span data-ttu-id="ec017-1247">如果指定的编码与文件的现有编码不匹配，则忽略指定的编码。</span><span class="sxs-lookup"><span data-stu-id="ec017-1247">If the specified encoding does not match the existing encoding of the file, the specified coding is ignored.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ec017-1248">`WriteAllText` 方法会打开一个文件，向其中写入数据，然后将其关闭。</span><span class="sxs-lookup"><span data-stu-id="ec017-1248">The `WriteAllText` method opens a file, writes to it, and then closes it.</span></span> <span data-ttu-id="ec017-1249">使用 `WriteAllText` 方法的代码比使用 <xref:System.IO.StreamWriter> 对象的代码更简单。</span><span class="sxs-lookup"><span data-stu-id="ec017-1249">Code that uses the `WriteAllText` method is simpler than code that uses a <xref:System.IO.StreamWriter> object.</span></span> <span data-ttu-id="ec017-1250">但是，如果要使用循环将字符串添加到文件，则 <xref:System.IO.StreamWriter> 对象可以提供更好的性能，因为只需打开并关闭该文件一次。</span><span class="sxs-lookup"><span data-stu-id="ec017-1250">However, if you are adding strings to a file by using a loop, a <xref:System.IO.StreamWriter> object can provide better performance because you only have to open and close the file one time.</span></span> <span data-ttu-id="ec017-1251">有关更多信息，请参见 <xref:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileWriter%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="ec017-1251">For more information, see the <xref:Microsoft.VisualBasic.FileIO.FileSystem.OpenTextFileWriter%2A> method.</span></span>  
  
 <span data-ttu-id="ec017-1252">下表列出了涉及 `My.Computer.FileSystem.WriteAllText` 方法的任务示例。</span><span class="sxs-lookup"><span data-stu-id="ec017-1252">The following table lists examples of tasks involving the `My.Computer.FileSystem.WriteAllText` method.</span></span>  
  
|<span data-ttu-id="ec017-1253">至</span><span class="sxs-lookup"><span data-stu-id="ec017-1253">To</span></span>|<span data-ttu-id="ec017-1254">请参阅</span><span class="sxs-lookup"><span data-stu-id="ec017-1254">See</span></span>|  
|-|-|  
|<span data-ttu-id="ec017-1255">将文本写入文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1255">Write text to a file</span></span>|[<span data-ttu-id="ec017-1256">如何：在 Visual Basic 中将文本写入文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1256">How to: Write Text to Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files)|  
|<span data-ttu-id="ec017-1257">向文件中追加文本</span><span class="sxs-lookup"><span data-stu-id="ec017-1257">Append text to a file</span></span>|[<span data-ttu-id="ec017-1258">如何：在 Visual Basic 中追加到文本文件</span><span class="sxs-lookup"><span data-stu-id="ec017-1258">How to: Append to Text Files in Visual Basic</span></span>](/dotnet/visual-basic/developing-apps/programming/drives-directories-files/how-to-append-to-text-files)|  
  
   
  
## Examples  
 <span data-ttu-id="ec017-1259">此示例将行 `"This is new text to be added."` 写入文件 `Test.txt`，并覆盖文件中的任何现有文本。</span><span class="sxs-lookup"><span data-stu-id="ec017-1259">This example writes the line `"This is new text to be added."` to the file `Test.txt`, overwriting any existing text in the file.</span></span>  
  
 [!code-vb[VbRefFile#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#21)]  
  
 <span data-ttu-id="ec017-1260">此示例将 `Documents and Settings` 文件夹中的文件名称写入 `FileList.txt`，并在每个文件之间插入一个回车符，以便更好地阅读。</span><span class="sxs-lookup"><span data-stu-id="ec017-1260">This example writes the names of the files in the `Documents and Settings` folder to `FileList.txt`, inserting a carriage return between each for better readability.</span></span>  
  
 [!code-vb[VbRefFile#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#22)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="ec017-1261">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="ec017-1261">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ec017-1262"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="ec017-1262"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="ec017-1263">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="ec017-1263">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="ec017-1264">文件正由另一个进程使用，或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="ec017-1264">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="ec017-1265">路径超过了系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="ec017-1265">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="ec017-1266">路径中的文件名或目录名包含冒号 (:)，或格式无效。</span><span class="sxs-lookup"><span data-stu-id="ec017-1266">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="ec017-1267">内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="ec017-1267">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="ec017-1268">该用户缺少查看该路径所必需的权限。</span><span class="sxs-lookup"><span data-stu-id="ec017-1268">The user lacks necessary permissions to view the path.</span></span></exception>
        <altmember cref="T:System.Text.Encoding" />
      </Docs>
    </Member>
  </Members>
</Type>
