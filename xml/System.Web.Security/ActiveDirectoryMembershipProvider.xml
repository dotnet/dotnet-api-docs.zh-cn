<Type Name="ActiveDirectoryMembershipProvider" FullName="System.Web.Security.ActiveDirectoryMembershipProvider">
  <Metadata><Meta Name="ms.openlocfilehash" Value="e312588e9e696419041f276b5f7eefa8064aa795" /><Meta Name="ms.sourcegitcommit" Value="397961a0164281b579f68064c3bb66c071f374d9" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="07/14/2020" /><Meta Name="ms.locfileid" Value="76825529" /></Metadata><TypeSignature Language="C#" Value="public class ActiveDirectoryMembershipProvider : System.Web.Security.MembershipProvider" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit ActiveDirectoryMembershipProvider extends System.Web.Security.MembershipProvider" />
  <TypeSignature Language="DocId" Value="T:System.Web.Security.ActiveDirectoryMembershipProvider" />
  <TypeSignature Language="VB.NET" Value="Public Class ActiveDirectoryMembershipProvider&#xA;Inherits MembershipProvider" />
  <TypeSignature Language="C++ CLI" Value="public ref class ActiveDirectoryMembershipProvider : System::Web::Security::MembershipProvider" />
  <TypeSignature Language="F#" Value="type ActiveDirectoryMembershipProvider = class&#xA;    inherit MembershipProvider" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Web.Security.MembershipProvider</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="9eb37-101">为 Active Directory 和 Active Directory 应用程序模式服务器中的 ASP.NET 应用程序管理成员资格信息的存储。</span><span class="sxs-lookup"><span data-stu-id="9eb37-101">Manages storage of membership information for an ASP.NET application in Active Directory and Active Directory Application Mode servers.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-102">和类使用此类 <xref:System.Web.Security.Membership> <xref:System.Web.Security.MembershipUser> 为使用 ACTIVE DIRECTORY （AD）或 Active Directory 应用程序模式（ADAM）服务器的 ASP.NET 应用程序提供成员身份服务。</span><span class="sxs-lookup"><span data-stu-id="9eb37-102">This class is used by the <xref:System.Web.Security.Membership> and <xref:System.Web.Security.MembershipUser> classes to provide membership services for an ASP.NET application using an Active Directory (AD) or Active Directory Application Mode (ADAM) server.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9eb37-103">使用 ADAM 服务器需要特定的配置。</span><span class="sxs-lookup"><span data-stu-id="9eb37-103">Using an ADAM server requires specific configuration.</span></span> <span data-ttu-id="9eb37-104">有关详细信息，请参阅下面的 ADAM 配置部分。</span><span class="sxs-lookup"><span data-stu-id="9eb37-104">For more information, see the ADAM Configuration section below.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9eb37-105"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>实例仅适用于 ASP.NET 的完全信任策略默认配置。</span><span class="sxs-lookup"><span data-stu-id="9eb37-105">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance works only in the full-trust policy default configuration of ASP.NET.</span></span> <span data-ttu-id="9eb37-106">若要 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 在任何部分信任级别使用实例，你必须对应用程序进行相应的信任策略文件的更改，或者必须创建一个部署在 GAC 中的 "沙盒" 程序集。</span><span class="sxs-lookup"><span data-stu-id="9eb37-106">In order to use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance at any partial-trust level, either you must make changes to the appropriate trust policy file for your application or you must create a "sandbox" assembly that is deployed in the GAC.</span></span>  
>   
>  <span data-ttu-id="9eb37-107"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类需要无限制 <xref:System.DirectoryServices.DirectoryServicesPermission> 的权限才能运行。</span><span class="sxs-lookup"><span data-stu-id="9eb37-107">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class requires unrestricted <xref:System.DirectoryServices.DirectoryServicesPermission> permission to run.</span></span> <span data-ttu-id="9eb37-108">此权限不会添加到 ASP.NET 提供的任何部分信任策略文件中。</span><span class="sxs-lookup"><span data-stu-id="9eb37-108">This permission is not added to any of the partial-trust policy files supplied with ASP.NET.</span></span> <span data-ttu-id="9eb37-109">尽管向 <xref:System.DirectoryServices.DirectoryServicesPermission> 部分信任策略文件添加权限将允许使用 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类，但这样做会使 <xref:System.DirectoryServices> 命名空间类可用于在 ASP.NET 页中运行的任何代码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-109">Although adding the <xref:System.DirectoryServices.DirectoryServicesPermission> permission to a partial-trust policy file will enable use of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class, doing so makes the <xref:System.DirectoryServices> namespace classes available to any code running in your ASP.NET pages.</span></span> <span data-ttu-id="9eb37-110">对于需要在安全、锁定模式下运行的任何 Web 服务器，不建议使用此选项。</span><span class="sxs-lookup"><span data-stu-id="9eb37-110">This option is not recommended for any Web servers that need to run in a secure, locked-down mode.</span></span>  
>   
>  <span data-ttu-id="9eb37-111">作为替代方法，可以创建调用类的 "沙盒" 程序集 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-111">As an alternative, you can create a "sandbox" assembly that calls the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span> <span data-ttu-id="9eb37-112">此程序集可以包含将方法调用转发给类的包装类 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 或从类派生的类 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-112">This assembly can contain either a wrapper class that forwards method calls to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class or a class that derives from the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span> <span data-ttu-id="9eb37-113">在任一情况下，包装类都必须断言无限制 <xref:System.DirectoryServices.DirectoryServicesPermission> 权限。</span><span class="sxs-lookup"><span data-stu-id="9eb37-113">In either case, the wrapper class must assert unrestricted <xref:System.DirectoryServices.DirectoryServicesPermission> permission.</span></span> <span data-ttu-id="9eb37-114">在 GAC 中部署沙盒程序集，并将程序集标记为 <xref:System.Security.AllowPartiallyTrustedCallersAttribute> （APTCA）特性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-114">Deploy the sandbox assembly in the GAC and mark the assembly with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) attribute.</span></span> <span data-ttu-id="9eb37-115">这将允许部分受信任的 ASP.NET 代码调用包装器类，因此，由于包装类在内部断言无限制的 <xref:System.DirectoryServices.DirectoryServicesPermission> 权限，因此包装类将能够成功调用该提供程序</span><span class="sxs-lookup"><span data-stu-id="9eb37-115">This will enable your partially trusted ASP.NET code to call your wrapper class, and since the wrapper class internally asserts the unrestricted <xref:System.DirectoryServices.DirectoryServicesPermission> permission, your wrapper class will be able to successfully call the provider</span></span>  
  
 <span data-ttu-id="9eb37-116">你必须在 Web.config 文件中创建一个[ConnectionStrings 元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bf7sd233(v=vs.100))条目，该条目用于标识要使用的 Active Directory 服务器、Active Directory 域或 ADAM 应用程序分区。</span><span class="sxs-lookup"><span data-stu-id="9eb37-116">You must create a [connectionStrings Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bf7sd233(v=vs.100)) entry in the Web.config file that identifies the Active Directory server, Active Directory domain, or ADAM application partition to use.</span></span> <span data-ttu-id="9eb37-117">提供程序将仅在域范围内或在域内的 subscope 中运行。</span><span class="sxs-lookup"><span data-stu-id="9eb37-117">The provider will only operate at domain scope, or in a subscope within a domain.</span></span> <span data-ttu-id="9eb37-118">下表列出了允许的连接字符串和所使用的作用域。</span><span class="sxs-lookup"><span data-stu-id="9eb37-118">The following table lists allowed connection strings and the scope used.</span></span>  
  
|<span data-ttu-id="9eb37-119">连接字符串</span><span class="sxs-lookup"><span data-stu-id="9eb37-119">Connection string</span></span>|<span data-ttu-id="9eb37-120">范围</span><span class="sxs-lookup"><span data-stu-id="9eb37-120">Scope</span></span>|  
|-----------------------|-----------|  
|<span data-ttu-id="9eb37-121">LDAP:// \<domain or server> ： [端口]</span><span class="sxs-lookup"><span data-stu-id="9eb37-121">LDAP://\<domain or server>:[port]</span></span><br /><br /> <span data-ttu-id="9eb37-122">端口号对于 ADAM 是可选的，不需要 Active Directory。</span><span class="sxs-lookup"><span data-stu-id="9eb37-122">Port number is optional for ADAM and not needed for Active Directory.</span></span>|<span data-ttu-id="9eb37-123">提供程序针对指定的域或服务器运行。</span><span class="sxs-lookup"><span data-stu-id="9eb37-123">The provider runs against the specified domain or server.</span></span> <span data-ttu-id="9eb37-124">在 AD 中，用户创建和删除是在默认的用户容器中完成的。</span><span class="sxs-lookup"><span data-stu-id="9eb37-124">With AD, user creation and deletion is done in the default users container.</span></span> <span data-ttu-id="9eb37-125">所有其他操作（包括任何搜索方法）将以域的默认命名上下文为根。</span><span class="sxs-lookup"><span data-stu-id="9eb37-125">All other operations, including any search methods, will be rooted at the default naming context for the domain.</span></span><br /><br /> <span data-ttu-id="9eb37-126">如果连接字符串指定 Active Directory 域而不是特定服务器，并且 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性为 `true` ，则 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例将始终连接到具有域 PDC 角色的服务器，以确保密码更改生效，并在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> 调用方法时可用。</span><span class="sxs-lookup"><span data-stu-id="9eb37-126">If the connection string specifies an Active Directory domain rather than a specific server and the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will always connect to the server with the PDC role for the domain to ensure that password changes take effect and are available when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method is called.</span></span><br /><br /> <span data-ttu-id="9eb37-127">使用 ADAM 时不允许使用此连接字符串，并且将引发 <xref:System.NotSupportedException> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-127">This connection string is not allowed when using ADAM, and will throw a <xref:System.NotSupportedException>.</span></span>|  
|<span data-ttu-id="9eb37-128">LDAP:// \<domain or server> ： [端口]/\<container dn></span><span class="sxs-lookup"><span data-stu-id="9eb37-128">LDAP://\<domain or server>:[port]/\<container dn></span></span><br /><br /> <span data-ttu-id="9eb37-129">端口号对于 ADAM 是可选的，不需要 Active Directory。</span><span class="sxs-lookup"><span data-stu-id="9eb37-129">Port number is optional for ADAM and not needed for Active Directory.</span></span>|<span data-ttu-id="9eb37-130">提供程序针对指定的域或服务器运行。</span><span class="sxs-lookup"><span data-stu-id="9eb37-130">The provider runs against the specified domain or server.</span></span> <span data-ttu-id="9eb37-131">仅在指定的容器中创建和删除用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-131">User creation and deletion is only done in the specified container.</span></span> <span data-ttu-id="9eb37-132">所有其他操作（包括任何搜索方法）都会在容器中执行子树搜索。</span><span class="sxs-lookup"><span data-stu-id="9eb37-132">All other operations, including any search methods, perform subtree searches rooted at the container.</span></span><br /><br /> <span data-ttu-id="9eb37-133">对于 ADAM 服务器，容器在应用程序分区中指定应用程序分区的根目录或容器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-133">For ADAM servers, the container specifies the root of an application partition, or a container within an application partition.</span></span><br /><br /> <span data-ttu-id="9eb37-134">建议连接字符串定义特定容器以提高性能。</span><span class="sxs-lookup"><span data-stu-id="9eb37-134">We recommend that the connection string define a specific container to improve performance.</span></span>|  
  
 <span data-ttu-id="9eb37-135"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>实例将目录特性映射到 <xref:System.Web.Security.ActiveDirectoryMembershipUser> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-135">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance maps directory attributes to <xref:System.Web.Security.ActiveDirectoryMembershipUser> properties.</span></span> <span data-ttu-id="9eb37-136">如果在 Web.config 文件中没有完成任何属性映射，则使用默认属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-136">Default attributes are used if no attribute mapping is done in the Web.config file.</span></span> <span data-ttu-id="9eb37-137">有关属性映射的详细信息，请参阅类文档中的各个属性 <xref:System.Web.Security.ActiveDirectoryMembershipUser> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-137">For more information on attribute mappings, see the individual properties in the <xref:System.Web.Security.ActiveDirectoryMembershipUser> class documentation.</span></span>  
  
 <span data-ttu-id="9eb37-138">下表列出了 <xref:System.Web.Security.ActiveDirectoryMembershipUser> 属性及其默认属性映射。</span><span class="sxs-lookup"><span data-stu-id="9eb37-138">The following table lists the <xref:System.Web.Security.ActiveDirectoryMembershipUser> properties and their default attribute mappings.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9eb37-139"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类不显式检查提供程序特性是否未映射到目录中的用户对象的核心特性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-139">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not explicitly check that provider attributes are not mapped to core attributes of the user object in the directory.</span></span> <span data-ttu-id="9eb37-140">必须确保不会通过映射属性公开目录中的敏感信息。</span><span class="sxs-lookup"><span data-stu-id="9eb37-140">You must ensure that sensitive information from the directory is not exposed through mapped attributes.</span></span>  
  
|<span data-ttu-id="9eb37-141">Property</span><span class="sxs-lookup"><span data-stu-id="9eb37-141">Property</span></span>|<span data-ttu-id="9eb37-142">默认目录属性</span><span class="sxs-lookup"><span data-stu-id="9eb37-142">Default directory attribute</span></span>|<span data-ttu-id="9eb37-143">是否可以映射？</span><span class="sxs-lookup"><span data-stu-id="9eb37-143">Can be mapped?</span></span>|  
|--------------|---------------------------------|--------------------|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.ProviderUserKey%2A>|<span data-ttu-id="9eb37-144">securityIdentifier</span><span class="sxs-lookup"><span data-stu-id="9eb37-144">securityIdentifier</span></span>|<span data-ttu-id="9eb37-145">否</span><span class="sxs-lookup"><span data-stu-id="9eb37-145">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.UserName%2A>|<span data-ttu-id="9eb37-146">userPrincipalName</span><span class="sxs-lookup"><span data-stu-id="9eb37-146">userPrincipalName</span></span>|<span data-ttu-id="9eb37-147">是，但必须是 userPrincipalName 或 sAMAccountName</span><span class="sxs-lookup"><span data-stu-id="9eb37-147">Yes, but must be either userPrincipalName or sAMAccountName</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.Comment%2A>|<span data-ttu-id="9eb37-148">注释</span><span class="sxs-lookup"><span data-stu-id="9eb37-148">comment</span></span>|<span data-ttu-id="9eb37-149">否</span><span class="sxs-lookup"><span data-stu-id="9eb37-149">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.CreationDate%2A>|<span data-ttu-id="9eb37-150">whenCreated</span><span class="sxs-lookup"><span data-stu-id="9eb37-150">whenCreated</span></span>|<span data-ttu-id="9eb37-151">否</span><span class="sxs-lookup"><span data-stu-id="9eb37-151">No</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.Email%2A>|<span data-ttu-id="9eb37-152">邮件</span><span class="sxs-lookup"><span data-stu-id="9eb37-152">mail</span></span>|<span data-ttu-id="9eb37-153">是，但必须是 Unicode 字符串类型的单值属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-153">Yes, but must be a single-valued attribute of type Unicode String.</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.LastActivityDate%2A>|<span data-ttu-id="9eb37-154">n/a</span><span class="sxs-lookup"><span data-stu-id="9eb37-154">n/a</span></span>|<span data-ttu-id="9eb37-155">不受 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 支持。</span><span class="sxs-lookup"><span data-stu-id="9eb37-155">Not supported by <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.LastLoginDate%2A>|<span data-ttu-id="9eb37-156">n/a</span><span class="sxs-lookup"><span data-stu-id="9eb37-156">n/a</span></span>|<span data-ttu-id="9eb37-157">不受 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 支持。</span><span class="sxs-lookup"><span data-stu-id="9eb37-157">Not supported by <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span></span>|  
|<xref:System.Web.Security.MembershipUser.LastPasswordChangedDate%2A>|<span data-ttu-id="9eb37-158">pwdLastSet</span><span class="sxs-lookup"><span data-stu-id="9eb37-158">pwdLastSet</span></span>|<span data-ttu-id="9eb37-159">否</span><span class="sxs-lookup"><span data-stu-id="9eb37-159">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.PasswordQuestion%2A>|<span data-ttu-id="9eb37-160">无</span><span class="sxs-lookup"><span data-stu-id="9eb37-160">none</span></span>|<span data-ttu-id="9eb37-161">是，但必须是 Unicode 字符串类型的单值属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-161">Yes, but must be a single-valued attribute of type Unicode String.</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.IsApproved%2A>|<span data-ttu-id="9eb37-162">用户帐户控制（AD）</span><span class="sxs-lookup"><span data-stu-id="9eb37-162">User-Account-Control (AD)</span></span><br /><br /> <span data-ttu-id="9eb37-163">mDS-Msds-useraccountdisabled （ADAM）</span><span class="sxs-lookup"><span data-stu-id="9eb37-163">mDS-UserAccountDisabled (ADAM)</span></span>|<span data-ttu-id="9eb37-164">否</span><span class="sxs-lookup"><span data-stu-id="9eb37-164">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.IsLockedOut%2A>|<span data-ttu-id="9eb37-165">lockoutTime 和 AD 锁定持续时间（Windows 2000 上的 AD）的计算</span><span class="sxs-lookup"><span data-stu-id="9eb37-165">computed from lockoutTime and the AD lockout duration (AD on Windows 2000)</span></span><br /><br /> <span data-ttu-id="9eb37-166">用户-帐户控制-计算（Windows Server 2003 上的 AD）</span><span class="sxs-lookup"><span data-stu-id="9eb37-166">msDS-User-Account-Control-Computed (AD on Windows Server 2003)</span></span><br /><br /> <span data-ttu-id="9eb37-167">用户-帐户-控制--已计算（ADAM）</span><span class="sxs-lookup"><span data-stu-id="9eb37-167">msDS-User-Account-Control-Computed (ADAM)</span></span>|<span data-ttu-id="9eb37-168">否</span><span class="sxs-lookup"><span data-stu-id="9eb37-168">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.LastLockoutDate%2A>|<span data-ttu-id="9eb37-169">如果用户因错误密码尝试次数过多而被锁定，则将返回 "锁定时间" 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-169">If user is locked out due to too many bad password attempts, the lockout time attribute is returned.</span></span><br /><br /> <span data-ttu-id="9eb37-170">如果用户因错误密码答案尝试次数过多而被锁定，则返回由定义的属性中存储的值 `attributeMapFailedPasswordAnswerLockoutTime` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-170">If user is locked out due to too many bad password answer attempts, the value stored in the attribute defined by `attributeMapFailedPasswordAnswerLockoutTime` is returned.</span></span><br /><br /> <span data-ttu-id="9eb37-171">如果用户因密码错误而被锁定，并且密码尝试次数过多，则返回最近的日期/时间值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-171">If user is locked out due to both a bad password and too many bad password attempts, the most recent date/time value is returned.</span></span><br /><br /> <span data-ttu-id="9eb37-172">如果该帐户未锁定，则返回1/1/1754 以了解 SQL 兼容性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-172">If the account is not locked out, return 1/1/1754 for SQL compatibility.</span></span>|<span data-ttu-id="9eb37-173">否</span><span class="sxs-lookup"><span data-stu-id="9eb37-173">No</span></span>|  
  
 <span data-ttu-id="9eb37-174">当 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> 和 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性均为时 `true` ， <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类通过要求用户回答预先确定的问题来支持密码重置安全。</span><span class="sxs-lookup"><span data-stu-id="9eb37-174">When both the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> and <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> properties are `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class supports password-reset security by requiring the user to answer a predetermined question.</span></span> <span data-ttu-id="9eb37-175">若要支持问题和答案，必须使用应用程序配置文件中的 "[为成员身份提供程序的 Add 元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/whae3t94(v=vs.100)) " 设置以下配置特性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-175">To support the question and answer, you must set the following configuration attributes using the [add Element for providers for membership (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/whae3t94(v=vs.100)) in the application configuration file.</span></span>  
  
|<span data-ttu-id="9eb37-176">配置属性</span><span class="sxs-lookup"><span data-stu-id="9eb37-176">Configuration attribute</span></span>|<span data-ttu-id="9eb37-177">特性类型</span><span class="sxs-lookup"><span data-stu-id="9eb37-177">Attribute type</span></span>|  
|-----------------------------|--------------------|  
|`attributeMapPasswordQuestion`|<span data-ttu-id="9eb37-178">必须是 Unicode 字符串类型的单值属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-178">Must be a single-valued attribute of type Unicode String.</span></span>|  
|`attributeMapPasswordAnswer`|<span data-ttu-id="9eb37-179">必须是 Unicode 字符串类型的单值属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-179">Must be a single-valued attribute of type Unicode String.</span></span>|  
|`attributeMapFailedPasswordAnswerCount`|<span data-ttu-id="9eb37-180">必须是整数类型的单值属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-180">Must be a single-valued attribute of type Integer.</span></span>|  
|`attributeMapFailedPasswordAnswerTime`|<span data-ttu-id="9eb37-181">必须是类型为大整数/间隔的单值属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-181">Must be a single-valued attribute of type Large Integer/Interval.</span></span>|  
|`attributeMapFailedPasswordAnswerLockoutTime`|<span data-ttu-id="9eb37-182">必须是类型为大整数/间隔的单值属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-182">Must be a single-valued attribute of type Large Integer/Interval.</span></span>|  
  
 <span data-ttu-id="9eb37-183">有关使用密码重置安全性的详细信息，请参阅 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-183">For more information on using password-reset security, see the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property.</span></span>  
  
## <a name="active-directory-connections"></a><span data-ttu-id="9eb37-184">Active Directory 连接</span><span class="sxs-lookup"><span data-stu-id="9eb37-184">Active Directory connections</span></span>  
 <span data-ttu-id="9eb37-185">当 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类用于连接到 Active Directory 或 Active Directory 应用程序模式（ADAM）服务器时， `connectionProtection` 使用应用程序配置文件中的[提供程序的 Providers 的 add 元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/whae3t94(v=vs.100))设置的属性可能会限制 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 该类可通过连接执行的操作的类型。</span><span class="sxs-lookup"><span data-stu-id="9eb37-185">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is used to connect to an Active Directory or an Active Directory Application Mode (ADAM) server, the `connectionProtection` attribute that is set using the [add Element for providers for membership (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/whae3t94(v=vs.100)) in the application configuration file may restrict the types of operations the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class can perform over the connection.</span></span> <span data-ttu-id="9eb37-186">`connectionProtection`属性还确定 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例将用于创建与 ACTIVE DIRECTORY 或 ADAM 服务器的连接的方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-186">The `connectionProtection` attribute also determines the methods the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will use to create the connection to the Active Directory or ADAM server.</span></span>  
  
 <span data-ttu-id="9eb37-187">下表显示了在 `connectionProtection` 连接到 Active Directory 时属性的效果。</span><span class="sxs-lookup"><span data-stu-id="9eb37-187">The following table shows the effect of the `connectionProtection` attribute when connecting to an Active Directory.</span></span>  
  
|<span data-ttu-id="9eb37-188">`connectionProtection` 设置</span><span class="sxs-lookup"><span data-stu-id="9eb37-188">`connectionProtection` setting</span></span>|<span data-ttu-id="9eb37-189">效果</span><span class="sxs-lookup"><span data-stu-id="9eb37-189">Effect</span></span>|  
|------------------------------------|------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|<span data-ttu-id="9eb37-190"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类将连接到 Active Directory，并具有这些限制。</span><span class="sxs-lookup"><span data-stu-id="9eb37-190">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will connect to an Active Directory, with these restrictions.</span></span><br /><br /> <span data-ttu-id="9eb37-191">-任何用于设置密码的方法都将失败。</span><span class="sxs-lookup"><span data-stu-id="9eb37-191">-   Any method that sets a password will fail.</span></span> <span data-ttu-id="9eb37-192">更改密码时，Active Directory 需要安全连接。</span><span class="sxs-lookup"><span data-stu-id="9eb37-192">Active Directory requires a secure connection when changing passwords.</span></span><br /><span data-ttu-id="9eb37-193">-必须 `connectionUsername` `connectionPassword` 使用应用程序配置文件中的 "[为成员身份提供程序的 add 元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/whae3t94(v=vs.100)) " 显式设置和属性; 否则， <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例将引发 <xref:System.Configuration.Provider.ProviderException> 异常。</span><span class="sxs-lookup"><span data-stu-id="9eb37-193">-   You must explicitly set the `connectionUsername` and `connectionPassword` attributes using the [add Element for providers for membership (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/whae3t94(v=vs.100)) in the application configuration file; otherwise, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will throw a <xref:System.Configuration.Provider.ProviderException> exception.</span></span>|  
|`Secure`|<span data-ttu-id="9eb37-194"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类将尝试使用 SSL 连接到 Active Directory。</span><span class="sxs-lookup"><span data-stu-id="9eb37-194">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will attempt to connect to Active Directory using SSL.</span></span> <span data-ttu-id="9eb37-195">如果 SSL 失败，将进行第二次尝试使用签名连接到 Active Directory。</span><span class="sxs-lookup"><span data-stu-id="9eb37-195">If SSL fails, a second attempt to connect to Active Directory using sign-and-seal will be made.</span></span> <span data-ttu-id="9eb37-196">如果两次尝试都失败，则 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例将引发 <xref:System.Configuration.Provider.ProviderException> 异常。</span><span class="sxs-lookup"><span data-stu-id="9eb37-196">If both attempts fail, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will throw a <xref:System.Configuration.Provider.ProviderException> exception.</span></span><br /><br /> <span data-ttu-id="9eb37-197">同时支持进程凭据和显式凭据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-197">Both process credentials and explicit credentials are supported.</span></span>|  
  
 <span data-ttu-id="9eb37-198">下表显示了在 `connectionProtection` 连接到 ADAM 服务器时属性的影响。</span><span class="sxs-lookup"><span data-stu-id="9eb37-198">The following table shows the effect of the `connectionProtection` attribute when connecting to an ADAM server.</span></span>  
  
|<span data-ttu-id="9eb37-199">`connectionProtection` 设置</span><span class="sxs-lookup"><span data-stu-id="9eb37-199">`connectionProtection` setting</span></span>|<span data-ttu-id="9eb37-200">效果</span><span class="sxs-lookup"><span data-stu-id="9eb37-200">Effect</span></span>|  
|------------------------------------|------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|<span data-ttu-id="9eb37-201"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类将连接到具有此限制的 ADAM 服务器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-201">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will connect to an ADAM server, with this restriction.</span></span><br /><br /> <span data-ttu-id="9eb37-202">-任何用于设置密码的方法都将失败，除非你显式配置 ADAM 服务器以允许通过不安全连接发送和更改密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-202">-   Any method that sets passwords will fail unless you explicitly configure the ADAM server to allow passwords to be sent and changed over an insecure connection.</span></span><br /><br /> <span data-ttu-id="9eb37-203">同时支持进程凭据和显式凭据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-203">Both process credentials and explicit credentials are supported.</span></span>|  
|`Secure`|<span data-ttu-id="9eb37-204"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类将尝试使用 SSL 连接到 ADAM 服务器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-204">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will attempt to connect to the ADAM server using SSL.</span></span> <span data-ttu-id="9eb37-205">如果无法建立连接，则 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例将引发 <xref:System.Configuration.Provider.ProviderException> 异常。</span><span class="sxs-lookup"><span data-stu-id="9eb37-205">If a connection cannot be made, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will throw a <xref:System.Configuration.Provider.ProviderException> exception.</span></span><br /><br /> <span data-ttu-id="9eb37-206">同时支持进程凭据和显式凭据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-206">Both process credentials and explicit credentials are supported.</span></span>|  
  
## <a name="adam-configuration"></a><span data-ttu-id="9eb37-207">ADAM 配置</span><span class="sxs-lookup"><span data-stu-id="9eb37-207">ADAM Configuration</span></span>  
 <span data-ttu-id="9eb37-208">使用 ADAM 服务器时，ADAM 实例必须包含定义类的架构 `User` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-208">When using an ADAM server, the ADAM instance must contain a schema that defines the `User` class.</span></span> <span data-ttu-id="9eb37-209">您可以 `User` 使用 `MS-User.ldf` ADAM 安装目录中提供的文件的 LDIF 导入类。</span><span class="sxs-lookup"><span data-stu-id="9eb37-209">You can import the `User` class with an LDIF import of the `MS-User.ldf` file available in the ADAM install directory.</span></span>  
  
 <span data-ttu-id="9eb37-210"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类将与配置为使用默认网络端口的 ADAM 服务器一起工作。</span><span class="sxs-lookup"><span data-stu-id="9eb37-210">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will work with an ADAM server configured to use the default network ports.</span></span> <span data-ttu-id="9eb37-211">下表显示了 ADAM 服务器需要的默认值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-211">The following table shows the defaults expected for the ADAM server.</span></span>  
  
|<span data-ttu-id="9eb37-212">connectionProtection 设置</span><span class="sxs-lookup"><span data-stu-id="9eb37-212">connectionProtection setting</span></span>|<span data-ttu-id="9eb37-213">预期的 ADAM 端口</span><span class="sxs-lookup"><span data-stu-id="9eb37-213">Expected ADAM port</span></span>|  
|----------------------------------|------------------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|<span data-ttu-id="9eb37-214">389</span><span class="sxs-lookup"><span data-stu-id="9eb37-214">389</span></span>|  
|`Secure`|<span data-ttu-id="9eb37-215">636</span><span class="sxs-lookup"><span data-stu-id="9eb37-215">636</span></span>|  
  
 <span data-ttu-id="9eb37-216">如果你的 ADAM 服务器未使用默认端口，请参阅[Microsoft 知识库](https://go.microsoft.com/fwlink/?linkid=37115)中的文章 Q817583，"Active Directory Services 不请求通过 SSL 连接的安全授权"。</span><span class="sxs-lookup"><span data-stu-id="9eb37-216">If your ADAM server is not using the default ports, see article Q817583, "Active Directory Services does not request secure authorization over an SSL connection," in the [Microsoft Knowledge Base](https://go.microsoft.com/fwlink/?linkid=37115).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-217">下面的代码示例显示了配置为使用实例的 ASP.NET 应用程序的 Web.config 文件 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-217">The following code examples show the Web.config file for an ASP.NET application configured to use an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance.</span></span> <span data-ttu-id="9eb37-218">第一个示例使用 Active Directory 特性的默认映射，并且不支持使用问题和答案的密码重置安全性，也不支持调用搜索方法的功能。</span><span class="sxs-lookup"><span data-stu-id="9eb37-218">The first example uses the default mappings for Active Directory attributes, and does not support password-reset security with question-and-answer nor the ability to call search methods.</span></span> <span data-ttu-id="9eb37-219">第二个示例显示了实例允许的所有属性设置 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-219">The second example shows all the attribute settings allowed for an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance.</span></span>  
  
 <span data-ttu-id="9eb37-220">第一个示例是使用 Active Directory 特性的默认映射的简单配置文件。</span><span class="sxs-lookup"><span data-stu-id="9eb37-220">The first example is a simple configuration file using default mappings for Active Directory attributes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 <span data-ttu-id="9eb37-221">此示例显示可用于实例的所有属性设置 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-221">This example shows all of the attribute settings that are available for an instance of <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership  
      defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"  
          type="System.Web.Security.ActiveDirectoryMembershipProvider,  
          System.Web, Version=1.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionStringName="ADService"  
          connectionUsername="UserWithAppropriateRights"  
          connectionPassword="PasswordForUser"  
          connectionProtection="Secure"  
          enablePasswordReset="true"  
          enableSearchMethods="true"  
          requiresQuestionAndAnswer="true"  
          applicationName="/"  
          description="Default AD connection"  
          requiresUniqueEmail="false"  
          clientSearchTimeout="30"  
          serverSearchTimeout="30"  
          timeoutUnit="Minutes"  
          attributeMapPasswordQuestion="department"  
          attributeMapPasswordAnswer="division"  
          attributeMapFailedPasswordAnswerCount="singleIntAttribute"  
         attributeMapFailedPasswordAnswerTime="singleLargeIntAttribute"  
         attributeMapFailedPasswordAnswerLockoutTime="singleLargeIntAttribute"  
          attributeMapEmail = "mail"  
          attributeMapUsername = "userPrincipalName"  
          maxInvalidPasswordAttempts = "5"  
          passwordAttemptWindow = "10"  
          passwordAnswerAttemptLockoutDuration = "30"  
          minRequiredPasswordLength="7"  
          minRequiredNonalphanumericCharacters="1"  
          passwordStrengthRegularExpression="  
          @\"(?=.{6,})(?=(.*\d){1,})(?=(.*\W){1,})" />  
        />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 <span data-ttu-id="9eb37-222">`clientSearchTimeout``serverSearchTimeout`默认值为分钟。</span><span class="sxs-lookup"><span data-stu-id="9eb37-222">`clientSearchTimeout` and `serverSearchTimeout` default to minutes.</span></span> <span data-ttu-id="9eb37-223">若要更改单位，请将 `timeoutUnit` 属性值设置为 "天"、"小时"、"分钟"、"秒" 或 "毫秒"。</span><span class="sxs-lookup"><span data-stu-id="9eb37-223">To change the units, set the `timeoutUnit` attribute value to one of "Days", "Hours", "Minutes", "Seconds", or "Milliseconds".</span></span> <span data-ttu-id="9eb37-224">如果未指定该属性，则默认值为 "分钟"。</span><span class="sxs-lookup"><span data-stu-id="9eb37-224">If the attribute is not specified, the default is "Minutes".</span></span>  
  
 ]]></format>
    </remarks>
    <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-225">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-225">Introduction to ASP.NET Membership</span></span></related>
    <related type="ExternalDocumentation" href="https://go.microsoft.com/fwlink/?linkid=149233"><span data-ttu-id="9eb37-226">如何：在 ASP.NET 2.0 中使用成员资格</span><span class="sxs-lookup"><span data-stu-id="9eb37-226">How to: Use Membership in ASP.NET 2.0</span></span></related>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ActiveDirectoryMembershipProvider ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; ActiveDirectoryMembershipProvider();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9eb37-227">创建 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="9eb37-227">Creates a new instance of the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-228"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>构造函数由 ASP.NET 调用，以创建 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 在应用程序的配置中指定的类的实例。</span><span class="sxs-lookup"><span data-stu-id="9eb37-228">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> constructor is called by ASP.NET to create an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class as specified in the configuration for the application.</span></span> <span data-ttu-id="9eb37-229">不应在代码中使用此构造函数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-229">This constructor is not intended to be used from your code.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-230">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-230">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public override string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ApplicationName : string with get, set" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-231">使用自定义成员资格提供程序的应用程序的名称。</span><span class="sxs-lookup"><span data-stu-id="9eb37-231">The name of the application using the custom membership provider.</span></span></summary>
        <value><span data-ttu-id="9eb37-232">使用自定义成员资格提供程序的应用程序的名称。</span><span class="sxs-lookup"><span data-stu-id="9eb37-232">The name of the application using the custom membership provider.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-233"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName%2A>属性可以设置为 ASP.NET 应用程序的名称，但类不使用应用程序名称 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-233">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName%2A> property can be set to the name of the ASP.NET application; however, the application name is not used by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span>  
  
 <span data-ttu-id="9eb37-234">因此，与其他 <xref:System.Web.Security.MembershipProvider> 实现不同，访问同一 Active Directory 数据存储的所有 ASP.NET 应用程序都将始终共享相同的用户数据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-234">Therefore, unlike other <xref:System.Web.Security.MembershipProvider> implementations, all ASP.NET applications that access the same Active Directory data store will always share the same user data.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="9eb37-235">已尝试设置 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-235">An attempt was made to set the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> property.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-236">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> 实例之前，已尝试访问 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-236">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="ChangePassword">
      <MemberSignature Language="C#" Value="public override bool ChangePassword (string username, string oldPassword, string newPassword);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ChangePassword(string username, string oldPassword, string newPassword) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ChangePassword (username As String, oldPassword As String, newPassword As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ChangePassword(System::String ^ username, System::String ^ oldPassword, System::String ^ newPassword);" />
      <MemberSignature Language="F#" Value="override this.ChangePassword : string * string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ChangePassword (username, oldPassword, newPassword)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="oldPassword" Type="System.String" />
        <Parameter Name="newPassword" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="9eb37-237">要为其更新密码的用户的名称。</span><span class="sxs-lookup"><span data-stu-id="9eb37-237">The name of the user to update the password for.</span></span></param>
        <param name="oldPassword"><span data-ttu-id="9eb37-238">指定的用户的当前密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-238">The current password for the specified user.</span></span></param>
        <param name="newPassword"><span data-ttu-id="9eb37-239">指定的用户的新密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-239">The new password for the specified user.</span></span></param>
        <summary><span data-ttu-id="9eb37-240">更改指定用户的密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-240">Changes the password for the specified user.</span></span></summary>
        <returns><span data-ttu-id="9eb37-241">如果密码更新成功，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-241"><see langword="true" /> if the password was updated successfully; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-242"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A>方法用于更新 Active Directory 的数据存储中的用户密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-242">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A> method is used to update the user's password in the Active Directory data store.</span></span> <span data-ttu-id="9eb37-243">无论 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例配置为使用的凭据如何，提供程序都使用 `username` 和 `oldPassword` 参数作为连接凭据连接到 Active Directory 服务器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-243">Regardless of the credentials that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance is configured to use, the provider connects to the Active Directory server using the `username` and `oldPassword` parameters as the connection credentials.</span></span>  
  
 <span data-ttu-id="9eb37-244">如果该 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性为 `true` ，则当该帐户以前被锁定，则用户无法更改其密码，因为用户尝试回答密码提示问题的次数过多。</span><span class="sxs-lookup"><span data-stu-id="9eb37-244">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user cannot change his or her password if the account was previously locked because the user made too many attempts to answer the password question.</span></span> <span data-ttu-id="9eb37-245">用户需要等待属性中指定的分钟数， <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> 然后再更改密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-245">The user will need to wait the number of minutes specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property before changing the password.</span></span>  
  
 <span data-ttu-id="9eb37-246">如果密码更改成功并且 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性为 `true` ，则重置用户的错误密码答案跟踪计数器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-246">If the password change succeeds and the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, then the user's bad password answer tracking counters are reset.</span></span>  
  
 <span data-ttu-id="9eb37-247">提供程序通过在连接字符串中指定的搜索点上执行子树搜索来查找要更新的用户实例。</span><span class="sxs-lookup"><span data-stu-id="9eb37-247">The provider finds the user instance to update by performing a subtree search for the user name starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-248">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-248">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="9eb37-249">若要更改 Active Directory 服务器上的密码，该 `connectionProtection` 属性必须设置为 <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-249">To change passwords on an Active Directory server the `connectionProtection` attribute must be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span></span>  
  
 <span data-ttu-id="9eb37-250">使用 ADAM 服务器时， `connectionProtection` 可以将属性设置为 <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None> ，但仅当你显式配置 ADAM 服务器以允许通过不安全连接进行密码更改时才可以设置为。</span><span class="sxs-lookup"><span data-stu-id="9eb37-250">When using an ADAM server, the `connectionProtection` attribute can be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, but only if you explicitly configure the ADAM server to allow password change over unsecured connections.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-251"><paramref name="username" /> 为空，或超过用户名的最大长度（通常为 256 个字符）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-251"><paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="9eb37-252">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-252">-or-</span></span> 
 <span data-ttu-id="9eb37-253"><paramref name="username" /> 包含逗号。</span><span class="sxs-lookup"><span data-stu-id="9eb37-253"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="9eb37-254">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-254">-or-</span></span> 
<span data-ttu-id="9eb37-255">用户名映射到 <see langword="userPrincipalName" /> 特性，并且 <paramref name="username" /> 参数包含反斜杠。</span><span class="sxs-lookup"><span data-stu-id="9eb37-255">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.</span></span>  
  
<span data-ttu-id="9eb37-256">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-256">-or-</span></span> 
 <span data-ttu-id="9eb37-257"><paramref name="oldPassword" /> 或 <paramref name="newPassword" /> 是长度为零的字符串。</span><span class="sxs-lookup"><span data-stu-id="9eb37-257"><paramref name="oldPassword" /> or <paramref name="newPassword" /> is a zero-length string.</span></span>  
  
<span data-ttu-id="9eb37-258">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-258">-or-</span></span> 
 <span data-ttu-id="9eb37-259"><paramref name="oldPassword" /> 或 <paramref name="newPassword" /> 超过最大密码长度（通常为 128 个字符）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-259"><paramref name="oldPassword" /> or <paramref name="newPassword" /> exceeds the maximum password length (usually 128 characters).</span></span>  
  
<span data-ttu-id="9eb37-260">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-260">-or-</span></span> 
 <span data-ttu-id="9eb37-261"><paramref name="newPassword" /> 小于 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> 属性所指定的最小密码长度</span><span class="sxs-lookup"><span data-stu-id="9eb37-261"><paramref name="newPassword" /> is less than the minimum password size specified in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> property</span></span> 
<span data-ttu-id="9eb37-262">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-262">-or-</span></span> 
 <span data-ttu-id="9eb37-263"><paramref name="newPassword" /> 包含的非字母字符数比 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> 属性所指定的数目少。</span><span class="sxs-lookup"><span data-stu-id="9eb37-263"><paramref name="newPassword" /> contains fewer than the number of non-alphabetic characters specified in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> property.</span></span>  
  
<span data-ttu-id="9eb37-264">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-264">-or-</span></span> 
 <span data-ttu-id="9eb37-265">根据 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> 属性中定义的正则表达式进行的 <paramref name="newPassword" /> 验证失败。</span><span class="sxs-lookup"><span data-stu-id="9eb37-265"><paramref name="newPassword" /> fails validation by the regular expression defined in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> property.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9eb37-266"><paramref name="username" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-266"><paramref name="username" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="9eb37-267">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-267">-or-</span></span> 
 <span data-ttu-id="9eb37-268"><paramref name="oldPassword" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-268"><paramref name="oldPassword" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="9eb37-269">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-269">-or-</span></span> 
 <span data-ttu-id="9eb37-270"><paramref name="newPassword" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-270"><paramref name="newPassword" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Web.Security.MembershipPasswordException"><span data-ttu-id="9eb37-271"><paramref name="newPassword" /> 不满足 Active Directory 服务器所定义的复杂性要求。</span><span class="sxs-lookup"><span data-stu-id="9eb37-271"><paramref name="newPassword" /> does not meet the complexity requirements defined by the Active Directory server.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="9eb37-272">未能建立到 Active Directory 应用程序模式服务器的安全连接。</span><span class="sxs-lookup"><span data-stu-id="9eb37-272">A secure connection could not be made to an Active Directory Application Mode server.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-273">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(System.String,System.String,System.String)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-273">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(System.String,System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.Exception"><span data-ttu-id="9eb37-274">发生了未经处理的异常。</span><span class="sxs-lookup"><span data-stu-id="9eb37-274">An unhandled exception occurred.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-275">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-275">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ChangePasswordQuestionAndAnswer">
      <MemberSignature Language="C#" Value="public override bool ChangePasswordQuestionAndAnswer (string username, string password, string newPasswordQuestion, string newPasswordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ChangePasswordQuestionAndAnswer(string username, string password, string newPasswordQuestion, string newPasswordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ChangePasswordQuestionAndAnswer (username As String, password As String, newPasswordQuestion As String, newPasswordAnswer As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ChangePasswordQuestionAndAnswer(System::String ^ username, System::String ^ password, System::String ^ newPasswordQuestion, System::String ^ newPasswordAnswer);" />
      <MemberSignature Language="F#" Value="override this.ChangePasswordQuestionAndAnswer : string * string * string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer (username, password, newPasswordQuestion, newPasswordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="newPasswordQuestion" Type="System.String" />
        <Parameter Name="newPasswordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="9eb37-276">要为其更改密码提示问题和答案的用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-276">The user to change the password question and answer for.</span></span></param>
        <param name="password"><span data-ttu-id="9eb37-277">指定的用户的密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-277">The password for the specified user.</span></span></param>
        <param name="newPasswordQuestion"><span data-ttu-id="9eb37-278">指定的用户的新密码提示问题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-278">The new password question for the specified user.</span></span></param>
        <param name="newPasswordAnswer"><span data-ttu-id="9eb37-279">指定的用户的新密码提示问题答案。</span><span class="sxs-lookup"><span data-stu-id="9eb37-279">The new password answer for the specified user.</span></span></param>
        <summary><span data-ttu-id="9eb37-280">更新 Active Directory 存储区中的用户密码提示问题和答案。</span><span class="sxs-lookup"><span data-stu-id="9eb37-280">Updates the password question and answer for a user in the Active Directory store.</span></span></summary>
        <returns><span data-ttu-id="9eb37-281">如果更新操作成功，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-281"><see langword="true" /> if the update was successful; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="9eb37-282">如果密码不正确、用户已锁定或用户不在 Active Directory 数据存储区中，也会返回一个 <see langword="false" /> 值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-282">A value of <see langword="false" /> is also returned if the password is incorrect, the user is locked out, or the user does not exist in the Active Directory data store.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-283">类调用方法 <xref:System.Web.Security.ActiveDirectoryMembershipUser> 来更新 Active Directory 成员资格存储区中用户的密码提示问题和答案。</span><span class="sxs-lookup"><span data-stu-id="9eb37-283">The method is called by the <xref:System.Web.Security.ActiveDirectoryMembershipUser> class to update the password question and answer for a user in the Active Directory membership store.</span></span>  
  
 <span data-ttu-id="9eb37-284">在重置用户密码时，需要密码提示问题和答案会提供额外的安全层。</span><span class="sxs-lookup"><span data-stu-id="9eb37-284">Requiring a password question and answer provides an additional layer of security when resetting a user's password.</span></span> <span data-ttu-id="9eb37-285">创建用户名时，用户可以提供稍后可用于重置忘记密码的问题和答案。</span><span class="sxs-lookup"><span data-stu-id="9eb37-285">When creating a user name, a user can supply a question and answer that can later be used to reset a forgotten password.</span></span> <span data-ttu-id="9eb37-286"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A>方法将成员资格用户的密码提示问题和答案更新为新值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-286">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> method updates the password question and answer for a membership user to new values.</span></span>  
  
 <span data-ttu-id="9eb37-287">若要使用 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> 方法，必须在应用程序的配置文件中设置以下附加属性：</span><span class="sxs-lookup"><span data-stu-id="9eb37-287">In order to use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> method, you must set these additional attributes in your application's configuration file:</span></span>  
  
-   <span data-ttu-id="9eb37-288">`requiresQuestionAndAnswer`必须为`true.`</span><span class="sxs-lookup"><span data-stu-id="9eb37-288">`requiresQuestionAndAnswer` must be `true.`</span></span>  
  
-   <span data-ttu-id="9eb37-289">`attributeMapPasswordQuestion`和 `attributeMapPasswordAnswer` 必须映射到 Active Directory 架构中的属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-289">`attributeMapPasswordQuestion` and `attributeMapPasswordAnswer` must be mapped to attributes in the Active Directory schema.</span></span>  
  
 <span data-ttu-id="9eb37-290">如果未满足上述条件， <xref:System.Configuration.Provider.ProviderException> 则在初始化时引发。</span><span class="sxs-lookup"><span data-stu-id="9eb37-290">If the above criteria are not met, a <xref:System.Configuration.Provider.ProviderException> is thrown at initialization.</span></span>  
  
 <span data-ttu-id="9eb37-291"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>实例用和参数中提供的凭据连接到 Active Directory 数据存储， `username` `password` 以验证用户名/密码组合。</span><span class="sxs-lookup"><span data-stu-id="9eb37-291">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance connects to the Active Directory data store with the credentials provided in the `username` and `password` parameters to validate the user name/password combination.</span></span> <span data-ttu-id="9eb37-292">问题和答案的实际更新是通过提供程序的已配置连接凭据来执行的。</span><span class="sxs-lookup"><span data-stu-id="9eb37-292">The actual update of the question and answer is performed with the configured connection credentials of the provider.</span></span>  
  
 <span data-ttu-id="9eb37-293">如果为方法提供了不正确的密码 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> ，目录服务器将递增跟踪无效密码尝试次数的计数器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-293">If an incorrect password is supplied to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> method, the directory server will increment the counters that track invalid password attempts.</span></span> <span data-ttu-id="9eb37-294">这可能会导致用户被锁定，并且在通过调用方法清除锁定状态 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A> 或在目录传递中指定的锁定持续时间之前，将无法登录。</span><span class="sxs-lookup"><span data-stu-id="9eb37-294">This can result in the user being locked and unable to log on until either the lock status is cleared by a call to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A> method or the locked duration specified in the directory passes.</span></span>  
  
 <span data-ttu-id="9eb37-295">如果问题和答案的更新成功并且 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性为，则将 `true` 重置用户的错误密码答案跟踪计数器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-295">If the update to the question and answer succeeds and the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user's bad password answer tracking counters are reset.</span></span>  
  
 <span data-ttu-id="9eb37-296">使用方法对密码答案进行加密， <xref:System.Web.Security.MembershipProvider.EncryptPassword%2A> 然后将其存储在 Active Directory 数据存储中。</span><span class="sxs-lookup"><span data-stu-id="9eb37-296">The password answer is encrypted using the <xref:System.Web.Security.MembershipProvider.EncryptPassword%2A> method before it is stored in the Active Directory data store.</span></span> <span data-ttu-id="9eb37-297">加密密钥和算法由[MachineKey 元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100))配置元素指定。</span><span class="sxs-lookup"><span data-stu-id="9eb37-297">The encryption key and algorithm are specified by the [machineKey Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100)) configuration element.</span></span> <span data-ttu-id="9eb37-298">必须指定[MachineKey 元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100))元素上的解密属性， <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 该类不支持自动生成的加密密钥。</span><span class="sxs-lookup"><span data-stu-id="9eb37-298">The decryption attribute on the [machineKey Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100)) element must be specified, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support auto-generated encryption keys.</span></span>  
  
 <span data-ttu-id="9eb37-299">密码提示问题的最大长度为256个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-299">The maximum length for the password question is 256 characters.</span></span> <span data-ttu-id="9eb37-300">密码答案的最大长度为128个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-300">The maximum length for the password answer is 128 characters.</span></span>  
  
 <span data-ttu-id="9eb37-301">除之外的所有参数值中，还会修整前导空格和尾随空格 `password` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-301">Leading and trailing spaces are trimmed from all parameter values except for `password`.</span></span>  
  
 <span data-ttu-id="9eb37-302">提供程序通过在连接字符串中指定的搜索点上执行子树搜索来查找要更新的用户实例。</span><span class="sxs-lookup"><span data-stu-id="9eb37-302">The provider finds the user instance to update by performing a subtree search for the user name starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-303">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-303">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="9eb37-304">管理员尚未将密码提示问题和答案字段映射到 Active Directory 架构的特性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-304">The administrator has not mapped the password question-and-answer fields to attributes of the Active Directory schema.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-305"><paramref name="username" /> 为空，或超过用户名的最大长度（通常为 256 个字符）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-305"><paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="9eb37-306">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-306">-or-</span></span> 
 <span data-ttu-id="9eb37-307"><paramref name="username" /> 包含逗号。</span><span class="sxs-lookup"><span data-stu-id="9eb37-307"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="9eb37-308">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-308">-or-</span></span> 
<span data-ttu-id="9eb37-309">用户名映射到 <see langword="userPrincipalName" /> 特性，并且 <paramref name="username" /> 参数包含反斜杠。</span><span class="sxs-lookup"><span data-stu-id="9eb37-309">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.</span></span>  
  
<span data-ttu-id="9eb37-310">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-310">-or-</span></span> 
 <span data-ttu-id="9eb37-311"><paramref name="password" /> 是一个长度为零的字符串。</span><span class="sxs-lookup"><span data-stu-id="9eb37-311"><paramref name="password" /> is a zero-length string.</span></span>  
  
<span data-ttu-id="9eb37-312">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-312">-or-</span></span> 
 <span data-ttu-id="9eb37-313"><paramref name="password" /> 超过最大密码长度（通常为 128 个字符）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-313"><paramref name="password" /> exceeds the maximum password length (usually 128 characters).</span></span>  
  
<span data-ttu-id="9eb37-314">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-314">-or-</span></span> 
 <span data-ttu-id="9eb37-315"><paramref name="newPasswordQuestion" /> 为空，并且 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> 属性值为 <see langword="true" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-315"><paramref name="newPasswordQuestion" /> is empty and the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property value is <see langword="true" />.</span></span>  
  
<span data-ttu-id="9eb37-316">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-316">-or-</span></span> 
 <span data-ttu-id="9eb37-317"><paramref name="newPasswordQuestion" /> 的长度超过 256 个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-317"><paramref name="newPasswordQuestion" /> exceeds 256 characters.</span></span>  
  
<span data-ttu-id="9eb37-318">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-318">-or-</span></span> 
 <span data-ttu-id="9eb37-319"><paramref name="newPasswordAnswer" /> 加密后的长度超过 128 个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-319"><paramref name="newPasswordAnswer" /> exceeds 128 characters after the answer is encrypted.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9eb37-320"><paramref name="username" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-320"><paramref name="username" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="9eb37-321">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-321">-or-</span></span> 
 <span data-ttu-id="9eb37-322"><paramref name="password" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-322"><paramref name="password" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="9eb37-323">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-323">-or-</span></span> 
 <span data-ttu-id="9eb37-324"><paramref name="newPasswordQuestion" /> 为 <see langword="null" />，但 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> 属性为 <see langword="true" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-324"><paramref name="newPasswordQuestion" /> is <see langword="null" /> and <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property is <see langword="true" />.</span></span>  
  
<span data-ttu-id="9eb37-325">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-325">-or-</span></span> 
 <span data-ttu-id="9eb37-326"><paramref name="newPasswordAnswer" /> 为 <see langword="null" />，但 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> 属性为 <see langword="true" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-326"><paramref name="newPasswordAnswer" /> is <see langword="null" /> and <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property is <see langword="true" />.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="9eb37-327">[machineKey 元素（ASP.NET 设置框架）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100))配置元素指示自动生成的计算机加密密钥。</span><span class="sxs-lookup"><span data-stu-id="9eb37-327">The [machineKey Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100)) configuration element indicates an auto-generated machine encryption key.</span></span> <span data-ttu-id="9eb37-328">必须将 [machineKey 元素（ASP.NET 设置框架）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100))元素的 <see langword="decryptionKey" /> 属性显式设置为使用 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 存储密码提示问题答案。</span><span class="sxs-lookup"><span data-stu-id="9eb37-328">You must explicitly set the <see langword="decryptionKey" /> attribute of the [machineKey Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100)) element to store password answers with the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-329">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-329">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-330">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-330">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CreateUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser CreateUser (string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, out System.Web.Security.MembershipCreateStatus status);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser CreateUser(string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, [out] valuetype System.Web.Security.MembershipCreateStatus&amp; status) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function CreateUser (username As String, password As String, email As String, passwordQuestion As String, passwordAnswer As String, isApproved As Boolean, providerUserKey As Object, ByRef status As MembershipCreateStatus) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ CreateUser(System::String ^ username, System::String ^ password, System::String ^ email, System::String ^ passwordQuestion, System::String ^ passwordAnswer, bool isApproved, System::Object ^ providerUserKey, [Runtime::InteropServices::Out] System::Web::Security::MembershipCreateStatus % status);" />
      <MemberSignature Language="F#" Value="override this.CreateUser : string * string * string * string * string * bool * obj * MembershipCreateStatus -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.CreateUser (username, password, email, passwordQuestion, passwordAnswer, isApproved, providerUserKey, status)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="email" Type="System.String" />
        <Parameter Name="passwordQuestion" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
        <Parameter Name="isApproved" Type="System.Boolean" />
        <Parameter Name="providerUserKey" Type="System.Object" />
        <Parameter Name="status" Type="System.Web.Security.MembershipCreateStatus" RefType="out" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="9eb37-331">新用户的用户名。</span><span class="sxs-lookup"><span data-stu-id="9eb37-331">The user name for the new user.</span></span></param>
        <param name="password"><span data-ttu-id="9eb37-332">新用户的密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-332">The password for the new user.</span></span></param>
        <param name="email"><span data-ttu-id="9eb37-333">新用户的电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="9eb37-333">The email address of the new user.</span></span></param>
        <param name="passwordQuestion"><span data-ttu-id="9eb37-334">新用户的密码提示问题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-334">The password question for the new user.</span></span></param>
        <param name="passwordAnswer"><span data-ttu-id="9eb37-335">新用户的密码提示问题答案。</span><span class="sxs-lookup"><span data-stu-id="9eb37-335">The password answer for the new user.</span></span></param>
        <param name="isApproved"><span data-ttu-id="9eb37-336">是否批准对新的用户进行验证。</span><span class="sxs-lookup"><span data-stu-id="9eb37-336">Whether or not the new user is approved to be validated.</span></span></param>
        <param name="providerUserKey"><span data-ttu-id="9eb37-337">用户的成员资格数据源中的唯一标识符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-337">The unique identifier from the membership data source for the user.</span></span> <span data-ttu-id="9eb37-338">使用 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 类时，此参数必须为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-338">This parameter must be <see langword="null" /> when using the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class.</span></span></param>
        <param name="status"><span data-ttu-id="9eb37-339">此方法返回时，包含一个 <see cref="T:System.Web.Security.MembershipCreateStatus" /> 枚举值，指示是否成功创建了用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-339">When this method returns, contains one of the <see cref="T:System.Web.Security.MembershipCreateStatus" /> enumeration values indicating whether the user was created successfully.</span></span></param>
        <summary><span data-ttu-id="9eb37-340">将新用户添加到 Active Directory 数据存储区。</span><span class="sxs-lookup"><span data-stu-id="9eb37-340">Adds a new user to the Active Directory data store.</span></span></summary>
        <returns><span data-ttu-id="9eb37-341">一个 <see cref="T:System.Web.Security.ActiveDirectoryMembershipUser" /> 实例，包含新创建用户的信息；如果未成功创建用户，则为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-341">An <see cref="T:System.Web.Security.ActiveDirectoryMembershipUser" /> instance containing the information for the newly created user, or <see langword="null" /> if the user was not successfully created.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-342"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A>方法由 <xref:System.Web.Security.Membership> 类调用，以在 Active Directory 数据存储区中创建新用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-342">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A> method is called by the <xref:System.Web.Security.Membership> class to create a new user in the Active Directory data store.</span></span>  
  
 <span data-ttu-id="9eb37-343">对于 Active Directory 和 Active Directory 应用程序模式（ADAM）服务器，此 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类要求目录中的实例类为 `user` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-343">For both Active Directory and Active Directory Application Mode (ADAM) servers, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class requires that the instance class in the directory be `user`.</span></span> <span data-ttu-id="9eb37-344">不支持等其他用户类 `inetOrgPerson` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-344">Alternative user classes such as `inetOrgPerson` are not supported.</span></span>  
  
 <span data-ttu-id="9eb37-345">当使用 Active Directory 服务器并且用户名映射到 `userPrincipalName` 属性时， <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 该类会自动为参数生成一个随机的20个字符的用户名 `sAMAccountName` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-345">When using an Active Directory server and the user name is mapped to the `userPrincipalName` attribute, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will automatically generate a random 20-character user name for the `sAMAccountName` parameter on your behalf.</span></span>  
  
 <span data-ttu-id="9eb37-346">参数默认为以下最大长度。</span><span class="sxs-lookup"><span data-stu-id="9eb37-346">Parameters default to the following maximum lengths.</span></span>  
  
|<span data-ttu-id="9eb37-347">参数</span><span class="sxs-lookup"><span data-stu-id="9eb37-347">Parameter</span></span>|<span data-ttu-id="9eb37-348">最大长度</span><span class="sxs-lookup"><span data-stu-id="9eb37-348">Maximum length</span></span>|  
|---------------|--------------------|  
|`username`|<span data-ttu-id="9eb37-349">如果使用属性，则为64个字符 `userPrincipalName` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-349">64 characters if using the `userPrincipalName` attribute.</span></span> <span data-ttu-id="9eb37-350">如果使用 `sAMAccountName` 属性，则常见限制为20个字符或更少。</span><span class="sxs-lookup"><span data-stu-id="9eb37-350">If using the `sAMAccountName` attribute, the common restriction is 20 characters or less.</span></span>|  
|`password`|<span data-ttu-id="9eb37-351">128个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-351">128 characters.</span></span>|  
|`email`|<span data-ttu-id="9eb37-352">256 个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-352">256 characters.</span></span>|  
|`passwordQuestion`|<span data-ttu-id="9eb37-353">256 个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-353">256 characters.</span></span>|  
|`passwordAnswer`|<span data-ttu-id="9eb37-354">加密之前和之后为128个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-354">128 characters before and after encrypting.</span></span>|  
  
 <span data-ttu-id="9eb37-355"><xref:System.Web.Security.ActiveDirectoryMembershipUser.Comment%2A>返回的实例的属性 <xref:System.Web.Security.ActiveDirectoryMembershipUser> 限制为1024个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-355">The <xref:System.Web.Security.ActiveDirectoryMembershipUser.Comment%2A> property on the returned <xref:System.Web.Security.ActiveDirectoryMembershipUser> instance is limited to 1024 characters.</span></span>  
  
 <span data-ttu-id="9eb37-356">如果通过减少这些属性允许的最大长度来修改目录架构，则这些长度将优先。</span><span class="sxs-lookup"><span data-stu-id="9eb37-356">If the directory schema has been modified by reducing the maximum allowable lengths for these attributes, these lengths will take precedence.</span></span>  
  
 <span data-ttu-id="9eb37-357">在创建用户之前， <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类将确保用户名是唯一的。</span><span class="sxs-lookup"><span data-stu-id="9eb37-357">Before creating the user, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will make sure the user name is unique.</span></span> <span data-ttu-id="9eb37-358">如果 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例配置为要求唯一的电子邮件地址，则它还将确保电子邮件地址是唯一的。</span><span class="sxs-lookup"><span data-stu-id="9eb37-358">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance is configured to require unique email addresses, it will also make sure the email address is unique.</span></span>  
  
 <span data-ttu-id="9eb37-359">在中，如果用户名映射到，则会执行垃圾搜索，从而强制执行用户名的 Active Directory `userPrincipalName` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-359">In an Active Directory user-name uniqueness is enforced by performing a GC search when the user name is mapped to `userPrincipalName`.</span></span> <span data-ttu-id="9eb37-360">如果 `sAMAccountName` 使用，则目录将自动强制实施 `sAMAccountName` 跨 Active Directory 域的唯一性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-360">If `sAMAccountName` is used, then the directory will automatically enforce uniqueness of the `sAMAccountName` across the Active Directory domain.</span></span>  
  
 <span data-ttu-id="9eb37-361">ADAM 服务器会在 `userPrincipalName` 所有应用程序分区中自动强制实施用户名的唯一名称。</span><span class="sxs-lookup"><span data-stu-id="9eb37-361">An ADAM server will automatically enforce user name uniqueness of the `userPrincipalName` across all application partitions.</span></span>  
  
 <span data-ttu-id="9eb37-362">电子邮件地址的唯一性是通过执行子树搜索来执行的，该地址从创建用户的容器的根目录开始搜索。</span><span class="sxs-lookup"><span data-stu-id="9eb37-362">Uniqueness of the email address is enforced by performing a subtree search for a duplicate email address starting at the root of the container in which users are created.</span></span> <span data-ttu-id="9eb37-363">这是默认的用户容器（如果已连接到 Active Directory，且未在连接字符串中指定容器）或连接字符串中指定的容器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-363">This is either the default user container (if connected to an Active Directory and no container was specified in the connection string) or the container specified in the connection string.</span></span>  
  
 <span data-ttu-id="9eb37-364"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类直接在连接字符串中指定的用户容器中创建用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-364">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class creates the user directly in the user container specified in the connection string.</span></span> <span data-ttu-id="9eb37-365">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-365">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="9eb37-366">对于要在 Active Directory 服务器上设置的密码， `connectionProtection` 特性必须设置为 <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-366">For passwords to be set on an Active Directory server, the `connectionProtection` attribute must be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span></span>  
  
 <span data-ttu-id="9eb37-367">使用 ADAM 服务器时， `connectionProtection` 可以将属性设置为 <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None> ，但仅当你显式配置 adam 服务器以允许通过不安全连接进行密码更改时。</span><span class="sxs-lookup"><span data-stu-id="9eb37-367">When an ADAM server is being used, the `connectionProtection` attribute can be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, but only if you explicitly configure the ADAM server to allow password changes over unsecured connections.</span></span>  
  
 <span data-ttu-id="9eb37-368">除了之外的所有字符串参数值，前导空格和尾随空格都将被截断 `password` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-368">Leading and trailing spaces are trimmed from all string parameter values except `password`.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9eb37-369">除非用于连接到 Active Directory 服务器的凭据具有域管理员权限（不推荐）或 "创建子实例"、"删除子实例" 和 "设置密码" 访问权限，否则不能创建新用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-369">You cannot create new users unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "create child instance," "delete child instance," and "set password" access rights.</span></span> <span data-ttu-id="9eb37-370">"删除子实例" 访问权限是必需的，因为创建用户是一个多步骤过程，如果用户创建的任何步骤失败， <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 该类将删除该用户实例，而不是在目录中保留部分构造的用户实例。</span><span class="sxs-lookup"><span data-stu-id="9eb37-370">The "delete child instance" access right is required because creating a user is a multi-step process, and if any step of user creation fails, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will delete the user instance rather than leave a partially constructed user instance in the directory.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-371"><paramref name="providerUserKey" /> 参数不是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-371">The <paramref name="providerUserKey" /> parameter is not <see langword="null" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="9eb37-372">管理员尚未将密码提示问题和答案字段映射到 Active Directory 架构的特性，并且 <paramref name="passwordQuestion" /> 或 <paramref name="passwordAnswer" /> 参数不是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-372">The administrator has not mapped the password question-and-answer fields to attributes of the Active Directory schema, and either the <paramref name="passwordQuestion" /> or <paramref name="passwordAnswer" /> parameter is not <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="9eb37-373">[machineKey 元素（ASP.NET 设置框架）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100))配置元素指示自动生成的计算机加密密钥。</span><span class="sxs-lookup"><span data-stu-id="9eb37-373">The [machineKey Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100)) configuration element indicates an auto-generated machine encryption key.</span></span> <span data-ttu-id="9eb37-374">必须将 [machineKey 元素（ASP.NET 设置框架）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100))元素的 <see langword="decryptionKey" /> 属性显式设置为使用 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 存储密码提示问题答案。</span><span class="sxs-lookup"><span data-stu-id="9eb37-374">You must explicitly set the <see langword="decryptionKey" /> attribute of the [machineKey Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/w8h3skw9(v=vs.100)) element to store password answers with the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span></span>  
  
<span data-ttu-id="9eb37-375">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-375">-or-</span></span> 
<span data-ttu-id="9eb37-376">尝试设置新用户的密码时，<see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 无法建立到目录的安全连接。</span><span class="sxs-lookup"><span data-stu-id="9eb37-376">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> was unable to establish a secure connection to the directory when attempting to set the password for the new user.</span></span></exception>
        <exception cref="T:System.Runtime.InteropServices.COMException"><span data-ttu-id="9eb37-377">尝试创建用户时出现错误。</span><span class="sxs-lookup"><span data-stu-id="9eb37-377">An error occurred while attempting to create the user.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-378">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-378">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-379">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-379">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CurrentConnectionProtection">
      <MemberSignature Language="C#" Value="public System.Web.Security.ActiveDirectoryConnectionProtection CurrentConnectionProtection { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.Security.ActiveDirectoryConnectionProtection CurrentConnectionProtection" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CurrentConnectionProtection As ActiveDirectoryConnectionProtection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::Security::ActiveDirectoryConnectionProtection CurrentConnectionProtection { System::Web::Security::ActiveDirectoryConnectionProtection get(); };" />
      <MemberSignature Language="F#" Value="member this.CurrentConnectionProtection : System.Web.Security.ActiveDirectoryConnectionProtection" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.ActiveDirectoryConnectionProtection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-380">获取用于保护与服务器的通信的当前安全级别。</span><span class="sxs-lookup"><span data-stu-id="9eb37-380">Gets the current level of security being used to protect communications with the server.</span></span></summary>
        <value><span data-ttu-id="9eb37-381"><see cref="T:System.Web.Security.ActiveDirectoryConnectionProtection" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="9eb37-381">One of the <see cref="T:System.Web.Security.ActiveDirectoryConnectionProtection" /> values.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-382"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A>属性指示 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例配置为使用的当前安全级别。</span><span class="sxs-lookup"><span data-stu-id="9eb37-382">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property indicates the current level of security that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance is configured to use.</span></span> <span data-ttu-id="9eb37-383"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A>属性基于 `connnectionProtection` 应用程序配置文件中为[成员资格的 add 元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/whae3t94(v=vs.100))设置的属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-383">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property is based on the `connnectionProtection` attribute set with the [add Element for providers for membership (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/whae3t94(v=vs.100)) in the application configuration file.</span></span>  
  
 <span data-ttu-id="9eb37-384">`connectionProtection`特性只能在 <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None> <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> 配置文件中设置为或。</span><span class="sxs-lookup"><span data-stu-id="9eb37-384">The `connectionProtection` attribute can only be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None> or <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> in the configuration file.</span></span>  
  
 <span data-ttu-id="9eb37-385">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-385">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-386">下面的代码示例演示了一个 Web.config 条目，该条目将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例配置为使用 SSL 安全协议连接到 Active Directory 服务器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-386">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to use the SSL security protocol to connect to an Active Directory server.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionProtection="SignAndSeal" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-387">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" /> 实例之前，已尝试访问 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-387">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-388">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-388">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DeleteUser">
      <MemberSignature Language="C#" Value="public override bool DeleteUser (string username, bool deleteAllRelatedData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool DeleteUser(string username, bool deleteAllRelatedData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function DeleteUser (username As String, deleteAllRelatedData As Boolean) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool DeleteUser(System::String ^ username, bool deleteAllRelatedData);" />
      <MemberSignature Language="F#" Value="override this.DeleteUser : string * bool -&gt; bool" Usage="activeDirectoryMembershipProvider.DeleteUser (username, deleteAllRelatedData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="deleteAllRelatedData" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="9eb37-389">要删除的用户的名称。</span><span class="sxs-lookup"><span data-stu-id="9eb37-389">The name of the user to delete.</span></span></param>
        <param name="deleteAllRelatedData"><span data-ttu-id="9eb37-390"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> 方法将此参数忽略。</span><span class="sxs-lookup"><span data-stu-id="9eb37-390">This parameter is ignored by the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> method.</span></span></param>
        <summary><span data-ttu-id="9eb37-391">从 Active Directory 数据存储区移除用户的成员资格信息。</span><span class="sxs-lookup"><span data-stu-id="9eb37-391">Removes a user's membership information from the Active Directory data store.</span></span></summary>
        <returns><span data-ttu-id="9eb37-392">如果删除了用户，则为 <see langword="true" />；如果在数据存储区中未找到该用户，则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-392"><see langword="true" /> if the user was deleted; otherwise, <see langword="false" /> if the user was not found in the data store.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-393"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A>方法会立即删除由参数标识的用户 `username` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-393">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A> method immediately removes the user identified by the `username` parameter.</span></span> <span data-ttu-id="9eb37-394">由于 Active Directory 的数据存储不会将用户信息存储在目录的单独区域中， `deleteAllRelatedData` 因此将忽略参数，但该参数必须设置为 `true` 或 `false` 在调用方法时设置 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-394">Since the Active Directory data store does not store user information in separate areas of the directory, the `deleteAllRelatedData` parameter is ignored, although it must be set to either `true` or `false` when calling the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A> method.</span></span>  
  
 <span data-ttu-id="9eb37-395"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类通过对连接字符串确定的用户容器中的用户名执行单级搜索，查找要删除的用户实例。</span><span class="sxs-lookup"><span data-stu-id="9eb37-395">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class finds the user instance to delete by performing a single-level search for the user name in the users container determined by the connection string.</span></span> <span data-ttu-id="9eb37-396">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-396">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="9eb37-397">`username`长度不得超过64个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-397">`username` must be 64 characters or less.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9eb37-398">你无法删除用户，除非用于连接到 Active Directory 服务器的凭据具有域管理员权限（不推荐）或 "删除子实例" 访问权限。</span><span class="sxs-lookup"><span data-stu-id="9eb37-398">You cannot delete users unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "delete child instances" access right.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-399"><paramref name="username" /> 为空，或超过用户名的最大长度（通常为 256 个字符）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-399"><paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="9eb37-400">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-400">-or-</span></span> 
 <span data-ttu-id="9eb37-401"><paramref name="username" /> 包含逗号。</span><span class="sxs-lookup"><span data-stu-id="9eb37-401"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="9eb37-402">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-402">-or-</span></span> 
<span data-ttu-id="9eb37-403">用户名映射到 <see langword="userPrincipalName" /> 特性，并且 <paramref name="userName" /> 参数包含反斜杠。</span><span class="sxs-lookup"><span data-stu-id="9eb37-403">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="userName" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9eb37-404"><paramref name="username" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-404"><paramref name="username" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Runtime.InteropServices.COMException"><span data-ttu-id="9eb37-405">尝试删除用户时出现错误。</span><span class="sxs-lookup"><span data-stu-id="9eb37-405">An error occurred while attempting to delete the user.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-406">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-406">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-407">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-407">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="EnablePasswordReset">
      <MemberSignature Language="C#" Value="public override bool EnablePasswordReset { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnablePasswordReset" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property EnablePasswordReset As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool EnablePasswordReset { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnablePasswordReset : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-408">获取一个值，该值指示 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 实例是否已配置为允许用户重置其密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-408">Gets a value indicating whether the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is configured to allow users to reset their passwords.</span></span></summary>
        <value><span data-ttu-id="9eb37-409">如果允许密码重置，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-409"><see langword="true" /> if password reset is allowed; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="9eb37-410">默认值为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-410">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-411"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>属性指示是否可以使用 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> 方法重置用户的密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-411">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property indicates whether you can use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method to reset a user's password.</span></span> <span data-ttu-id="9eb37-412">在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 应用程序的配置文件中，使用 `enablePasswordReset` [成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素的特性设置该属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-412">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is set in your application's configuration file using the `enablePasswordReset` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element.</span></span>  
  
 <span data-ttu-id="9eb37-413">仅当设置了 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> `true` 以下[成员身份元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素设置时，才能设置属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-413">You can only set the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property `true` when the following [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element settings have been made.</span></span>  
  
-   <span data-ttu-id="9eb37-414">`requiresQuestionAndAnswer` 必须为 `true`。</span><span class="sxs-lookup"><span data-stu-id="9eb37-414">`requiresQuestionAndAnswer` must be `true`.</span></span>  
  
-   <span data-ttu-id="9eb37-415">必须修改 Active Directory 架构，使其包含用于存储密码提示问题和答案的属性，以及用于密码答案更改尝试的三个跟踪字段。</span><span class="sxs-lookup"><span data-stu-id="9eb37-415">The Active Directory schema must be modified to contain attributes for storing the password question and answer, as well as the three tracking fields for password-answer change attempts.</span></span>  
  
-   <span data-ttu-id="9eb37-416">`attributeMapPasswordQuestion`、、、 `attributeMapPasswordAnswer` `attributeMapFailedPasswordAnswerCount` `attributeMapFailedPasswordAnswerTime` 和 `attributeMapFailedPasswordAnswerLockoutTime` 必须映射到 Active Directory 架构中的属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-416">`attributeMapPasswordQuestion`, `attributeMapPasswordAnswer`, `attributeMapFailedPasswordAnswerCount`, `attributeMapFailedPasswordAnswerTime`, and `attributeMapFailedPasswordAnswerLockoutTime` must be mapped to attributes in the Active Directory schema.</span></span>  
  
 <span data-ttu-id="9eb37-417">如果未满足上述条件， <xref:System.Configuration.Provider.ProviderException> 则在初始化时引发。</span><span class="sxs-lookup"><span data-stu-id="9eb37-417">If the above criteria are not met, a <xref:System.Configuration.Provider.ProviderException> is thrown at initialization.</span></span>  
  
 <span data-ttu-id="9eb37-418">当应用程序配置文件中的连接字符串指定的 Active Directory 域而不是特定服务器时，该 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例将始终连接到域控制器，该控制器具有域的 PDC 角色，以确保密码更改生效，并在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> 调用方法时可用。</span><span class="sxs-lookup"><span data-stu-id="9eb37-418">When the connection string in the application configuration file specifies an Active Directory domain rather than a specific server, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will always connect to the domain controller that has the PDC role for the domain to ensure that password changes take effect and are available when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method is called.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9eb37-419">即使 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性为 `true` ，也不能重置用户密码，除非用于连接到 Active Directory 服务器的凭据具有域管理员权限（不推荐）或 "重置密码" 访问权限。</span><span class="sxs-lookup"><span data-stu-id="9eb37-419">Even if the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, you cannot reset user passwords unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "reset password" access right.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-420">下面的代码示例演示了一个 Web.config 条目，该条目将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例配置为启用密码重置。</span><span class="sxs-lookup"><span data-stu-id="9eb37-420">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to enable password resets.</span></span> <span data-ttu-id="9eb37-421">它使用给定了 "重置密码" 访问权限的用户的显式凭据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-421">It uses the explicit credentials of a user given the "reset password" access right.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9eb37-422">在 Web.config 文件中放置用户凭据时，会存在潜在的安全威胁。</span><span class="sxs-lookup"><span data-stu-id="9eb37-422">When you place user credentials in your Web.config file, there are potential security threats.</span></span> <span data-ttu-id="9eb37-423">对包含 Web.config 文件的目录具有访问权限的用户可以读取该文件，从而查看凭据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-423">Users with access rights to the directory containing the Web.config file can read the file, and thus see the credentials.</span></span> <span data-ttu-id="9eb37-424">有关如何防范此威胁的详细信息，请参阅[使用受保护的配置加密配置信息](https://docs.microsoft.com/previous-versions/aspnet/53tyfkaw(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="9eb37-424">For details on how to protect against this threat, see [Encrypting Configuration Information Using Protected Configuration](https://docs.microsoft.com/previous-versions/aspnet/53tyfkaw(v=vs.100)).</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionUsername="UserWithResetPasswordRights"  
          connectionPassword="PasswordForUser"  
          enablePasswordReset="true"  
          requiresQuestionAndAnswer="true"  
          attributeMapPasswordQuestion="PasswordQuestionADAttribute"  
          attributeMapPasswordAnswer="PasswordAnswerADAttribute"  
          attributeMapFailedPasswordAnswerCount="AnswerCountADAttribute"  
          attributeMapFailedPasswordAnswerTime="AnswerTimeADAttribute"  
          attributeMapFailedPasswordAnswerLockoutTime="LockOutTimeADAttribute" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-425">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> 实例之前，已尝试访问 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-425">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-426">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-426">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="EnablePasswordRetrieval">
      <MemberSignature Language="C#" Value="public override bool EnablePasswordRetrieval { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnablePasswordRetrieval" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property EnablePasswordRetrieval As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool EnablePasswordRetrieval { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnablePasswordRetrieval : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-427">获取一个值，该值指示是否可从 Active Directory 数据存储区检索用户密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-427">Gets a value indicating whether the user's password can be retrieved from the Active Directory data store.</span></span> <span data-ttu-id="9eb37-428">此属性始终返回 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-428">This property always returns <see langword="false" />.</span></span></summary>
        <value><span data-ttu-id="9eb37-429"><see langword="false" /> 指示 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 类不支持密码检索。</span><span class="sxs-lookup"><span data-stu-id="9eb37-429"><see langword="false" /> to indicate that password retrieval is not supported by the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-430"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类不支持密码检索。</span><span class="sxs-lookup"><span data-stu-id="9eb37-430">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support password retrieval.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-431">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" /> 实例之前，已尝试访问 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-431">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="EnableSearchMethods">
      <MemberSignature Language="C#" Value="public bool EnableSearchMethods { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableSearchMethods" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property EnableSearchMethods As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableSearchMethods { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnableSearchMethods : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-432">获取一个值，该值指示面向搜索的 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法是否可用。</span><span class="sxs-lookup"><span data-stu-id="9eb37-432">Gets a value indicating whether search-oriented <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> methods are available.</span></span></summary>
        <value><span data-ttu-id="9eb37-433">如果搜索方法可用，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-433"><see langword="true" /> if search methods are available; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="9eb37-434">默认值为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-434">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-435">由于搜索 Active Directory 服务器可能会消耗大量资源，因此 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> 可以使用属性关闭面向搜索的 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-435">Because searching an Active Directory server is potentially resource intensive, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property enables you to turn off search-oriented <xref:System.Web.Security.ActiveDirectoryMembershipProvider> methods.</span></span> <span data-ttu-id="9eb37-436">在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> 应用程序的配置文件中，使用 `enableSearchMethods` [成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素的特性设置该属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-436">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property is set in your application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element.</span></span>  
  
 <span data-ttu-id="9eb37-437">当 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> 属性为时 `false` ，以下方法不可用：</span><span class="sxs-lookup"><span data-stu-id="9eb37-437">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property is `false`, the following methods are not available:</span></span>  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A>  
  
 <span data-ttu-id="9eb37-438">提供程序使用子树搜索，从连接字符串中指定的搜索点开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-438">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-439">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-439">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="9eb37-440">建议您不要在生产系统上启用搜索，直到您确认类发出的搜索查询 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 不会对目录服务器的性能产生负面影响。</span><span class="sxs-lookup"><span data-stu-id="9eb37-440">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="9eb37-441">由于 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类是为无状态 Web 环境设计的，因此无法使用由基础 api 公开的分页优化 <xref:System.DirectoryServices> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-441">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="9eb37-442">这意味着，搜索大型目录时的分页操作非常昂贵，应避免这样做。</span><span class="sxs-lookup"><span data-stu-id="9eb37-442">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="9eb37-443">搜索操作始终针对在连接字符串中配置的目录服务器发出，或在指向域的连接字符串的情况下，为自动选择的服务器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-443">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="9eb37-444">提供程序不会将全局编录用于其搜索方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-444">The provider does not use a global catalog for its search methods.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-445">下面的代码示例演示了一个 Web.config 条目，该条目将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例配置为允许搜索 Active Directory 服务器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-445">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to enable searching an Active Directory server.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          enableSearchMethods="true" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-446">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> 实例之前，已尝试访问 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-446">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-447">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-447">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="FindUsersByEmail">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection FindUsersByEmail (string emailToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection FindUsersByEmail(string emailToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindUsersByEmail (emailToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ FindUsersByEmail(System::String ^ emailToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindUsersByEmail : string * int * int * int -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.FindUsersByEmail (emailToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="emailToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="emailToMatch"><span data-ttu-id="9eb37-448">要搜索的电子邮件地址或部分电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="9eb37-448">Email address or portion of email address to search for.</span></span></param>
        <param name="pageIndex"><span data-ttu-id="9eb37-449">要返回的结果页的索引。</span><span class="sxs-lookup"><span data-stu-id="9eb37-449">The index of the page of results to return.</span></span> <span data-ttu-id="9eb37-450"><paramref name="pageIndex" /> 从零开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-450"><paramref name="pageIndex" /> is zero-based.</span></span></param>
        <param name="pageSize"><span data-ttu-id="9eb37-451">要返回的结果页的大小。</span><span class="sxs-lookup"><span data-stu-id="9eb37-451">The size of the page of results to return.</span></span></param>
        <param name="totalRecords"><span data-ttu-id="9eb37-452">此方法返回时，包含集合中返回的用户总数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-452">When this method returns, contains the total number of users returned in the collection.</span></span> <span data-ttu-id="9eb37-453">此参数未经初始化即被传递。</span><span class="sxs-lookup"><span data-stu-id="9eb37-453">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="9eb37-454">根据用户的电子邮件地址，从 Active Directory 数据存储返回成员资格用户集合。</span><span class="sxs-lookup"><span data-stu-id="9eb37-454">Returns a collection of membership users from the Active Directory data store based on the user's email address.</span></span></summary>
        <returns><span data-ttu-id="9eb37-455">一个 <see cref="T:System.Web.Security.MembershipUserCollection" />，其中包含从 <paramref name="pageSize" /> 所指定的页开始的 <paramref name="pageIndex" /><see cref="T:System.Web.Security.MembershipUser" /> 实例。</span><span class="sxs-lookup"><span data-stu-id="9eb37-455">A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-456"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>方法 <xref:System.Web.Security.MembershipUserCollection> 从与参数匹配的 Active Directory 存储中获取包含用户记录的 `emailToMatch` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-456">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> method gets a <xref:System.Web.Security.MembershipUserCollection> containing the user records from the Active Directory store that match the `emailToMatch` parameters.</span></span> <span data-ttu-id="9eb37-457">按电子邮件地址按升序顺序返回用户记录。</span><span class="sxs-lookup"><span data-stu-id="9eb37-457">The user records are returned sorted in ascending order by email address.</span></span>  
  
 <span data-ttu-id="9eb37-458">`emailToMatch`参数限制为256个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-458">The `emailToMatch` parameter is limited to 256 characters.</span></span>  
  
 <span data-ttu-id="9eb37-459"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类将使用 `clientSearchTimeout` 和 `serverSearchTimeout` 配置值发出搜索。</span><span class="sxs-lookup"><span data-stu-id="9eb37-459">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will issue the search using both the `clientSearchTimeout` and `serverSearchTimeout` configuration values.</span></span> <span data-ttu-id="9eb37-460">由于 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类使用每页包含512行的页对目录服务器执行搜索，因此超时适用于类所获取的每个结果页 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-460">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class performs searches against the directory server using pages with 512 rows per page, the time-outs apply to each page of results fetched by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span> <span data-ttu-id="9eb37-461">例如，如果搜索查询导致了1000行的数据，则 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类会将此信息作为两页数据提取。</span><span class="sxs-lookup"><span data-stu-id="9eb37-461">For example, if a search query results in 1,000 rows of data, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will fetch this information as two pages of data.</span></span> <span data-ttu-id="9eb37-462">这意味着当 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类请求第二页数据时，客户端和搜索超时值将从零开始计数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-462">This means that the client and search time-outs will start counting from zero when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class requests the second page of data.</span></span>  
  
 <span data-ttu-id="9eb37-463">方法返回的结果 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> 受 `pageIndex` 和参数的约束 `pageSize` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-463">The results returned by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> method are constrained by the `pageIndex` and `pageSize` parameters.</span></span> <span data-ttu-id="9eb37-464">`pageSize`参数指定 <xref:System.Web.Security.MembershipUser> 要在中返回的最大实例数 <xref:System.Web.Security.MembershipUserCollection> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-464">The `pageSize` parameter specifies the maximum number of <xref:System.Web.Security.MembershipUser> instances to return in the <xref:System.Web.Security.MembershipUserCollection>.</span></span> <span data-ttu-id="9eb37-465">`pageIndex`参数指定要返回的结果页，其中0（零）指示第一页。</span><span class="sxs-lookup"><span data-stu-id="9eb37-465">The `pageIndex` parameter specifies which page of results to return, where 0 (zero) indicates the first page.</span></span>  
  
 <span data-ttu-id="9eb37-466">`totalRecords`参数是 `out` 设置为在 Active Directory 数据存储中找到的匹配成员身份用户总数的参数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-466">The `totalRecords` parameter is an `out` parameter that is set to the total number of matching membership users found in the Active Directory data store.</span></span> <span data-ttu-id="9eb37-467">例如，如果已配置的数据存储有13个用户，并且值为 `pageIndex` 1 且为 `pageSize` 5，则 <xref:System.Web.Security.MembershipUserCollection> 返回的将包含第六到第十个用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-467">For example, if there are 13 users for the configured data store, and the `pageIndex` value was 1 with a `pageSize` of 5, the <xref:System.Web.Security.MembershipUserCollection> returned would contain the sixth through the tenth users.</span></span> <span data-ttu-id="9eb37-468">`totalRecords`参数将设置为13。</span><span class="sxs-lookup"><span data-stu-id="9eb37-468">The `totalRecords` parameter would be set to 13.</span></span>  
  
 <span data-ttu-id="9eb37-469">您可以通过在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> 应用程序的配置文件中使用 `enableSearchMethods` [成员资格元素（ASP.NET Settings Schema）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素的属性设置属性，来控制是否允许搜索用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-469">You can control whether to allow searching for users, by setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property in the application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element.</span></span> <span data-ttu-id="9eb37-470">如果将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> 属性设置为， `false` 则会 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> 引发 <xref:System.NotSupportedException> 异常。</span><span class="sxs-lookup"><span data-stu-id="9eb37-470">Setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property to `false` causes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> method to throw a <xref:System.NotSupportedException> exception.</span></span>  
  
 <span data-ttu-id="9eb37-471">提供程序使用子树搜索，从连接字符串中指定的搜索点开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-471">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-472">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-472">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="9eb37-473">建议您不要在生产系统上启用搜索，直到您确认类发出的搜索查询 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 不会对目录服务器的性能产生负面影响。</span><span class="sxs-lookup"><span data-stu-id="9eb37-473">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="9eb37-474">由于 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类是为无状态 Web 环境设计的，因此无法使用由基础 api 公开的分页优化 <xref:System.DirectoryServices> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-474">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="9eb37-475">这意味着，搜索大型目录时的分页操作非常昂贵，应避免这样做。</span><span class="sxs-lookup"><span data-stu-id="9eb37-475">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="9eb37-476">搜索操作始终针对在连接字符串中配置的目录服务器发出，或在指向域的连接字符串的情况下，为自动选择的服务器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-476">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="9eb37-477">提供程序不会将全局编录用于其搜索方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-477">The provider does not use a global catalog for its search methods.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-478">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-478">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-479"><paramref name="emailToMatch" /> 为空。</span><span class="sxs-lookup"><span data-stu-id="9eb37-479"><paramref name="emailToMatch" /> is empty.</span></span>  
  
<span data-ttu-id="9eb37-480">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-480">-or-</span></span> 
 <span data-ttu-id="9eb37-481"><paramref name="emailToMatch" /> 的长度超过 256 个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-481"><paramref name="emailToMatch" /> exceeds 256 characters.</span></span>  
  
<span data-ttu-id="9eb37-482">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-482">-or-</span></span> 
 <span data-ttu-id="9eb37-483"><paramref name="pageIndex" /> 小于 0。</span><span class="sxs-lookup"><span data-stu-id="9eb37-483"><paramref name="pageIndex" /> is less than 0.</span></span>  
  
<span data-ttu-id="9eb37-484">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-484">-or-</span></span> 
 <span data-ttu-id="9eb37-485"><paramref name="pageSize" /> 小于 1。</span><span class="sxs-lookup"><span data-stu-id="9eb37-485"><paramref name="pageSize" /> is less than 1.</span></span>  
  
<span data-ttu-id="9eb37-486">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-486">-or-</span></span> 
 <span data-ttu-id="9eb37-487"><paramref name="pageSize" /> 乘以 <paramref name="pageIndex" />，然后加上 <paramref name="pageSize" />，再减去 1 后得到的值大于 <see cref="F:System.Int32.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-487"><paramref name="pageSize" /> multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="9eb37-488"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> 属性为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-488">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-489">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-489">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="FindUsersByName">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection FindUsersByName (string usernameToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection FindUsersByName(string usernameToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindUsersByName (usernameToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ FindUsersByName(System::String ^ usernameToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindUsersByName : string * int * int * int -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.FindUsersByName (usernameToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="usernameToMatch"><span data-ttu-id="9eb37-490">要搜索的用户名或部分用户名。</span><span class="sxs-lookup"><span data-stu-id="9eb37-490">The user name or portion of a user name to search for.</span></span></param>
        <param name="pageIndex"><span data-ttu-id="9eb37-491">要返回的结果页的索引。</span><span class="sxs-lookup"><span data-stu-id="9eb37-491">The index of the page of results to return.</span></span> <span data-ttu-id="9eb37-492"><paramref name="pageIndex" /> 从零开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-492"><paramref name="pageIndex" /> is zero-based.</span></span></param>
        <param name="pageSize"><span data-ttu-id="9eb37-493">要返回的结果页的大小。</span><span class="sxs-lookup"><span data-stu-id="9eb37-493">The size of the page of results to return.</span></span></param>
        <param name="totalRecords"><span data-ttu-id="9eb37-494">当此方法返回时，此参数包含在集合中返回的记录的总数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-494">When this method returns, contains the total number of records returned in the collection.</span></span> <span data-ttu-id="9eb37-495">此参数未经初始化即被传递。</span><span class="sxs-lookup"><span data-stu-id="9eb37-495">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="9eb37-496">根据用户名从 Active Directory 数据存储区返回用户的集合。</span><span class="sxs-lookup"><span data-stu-id="9eb37-496">Returns a collection of users from the Active Directory data store based on the user name.</span></span></summary>
        <returns><span data-ttu-id="9eb37-497">一个 <see cref="T:System.Web.Security.MembershipUserCollection" />，其中包含从 <paramref name="pageSize" /> 所指定的页开始的 <paramref name="pageIndex" /><see cref="T:System.Web.Security.MembershipUser" /> 实例。</span><span class="sxs-lookup"><span data-stu-id="9eb37-497">A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-498"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>方法返回一个实例，该 <xref:System.Web.Security.MembershipUserCollection> 实例包含与参数匹配的所有用户名的 Active Directory 数据存储区中的用户记录 `userNameToMatch` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-498">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> method returns a <xref:System.Web.Security.MembershipUserCollection> instance containing the user records from the Active Directory data store for all user names that match the `userNameToMatch` parameters.</span></span> <span data-ttu-id="9eb37-499">返回按用户名字母顺序排序的记录。</span><span class="sxs-lookup"><span data-stu-id="9eb37-499">The records are returned sorted alphabetically by user name.</span></span>  
  
 <span data-ttu-id="9eb37-500">方法返回的结果 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> 受 `pageIndex` 和参数的约束 `pageSize` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-500">The results returned by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> method are constrained by the `pageIndex` and `pageSize` parameters.</span></span> <span data-ttu-id="9eb37-501">`pageSize`参数指定 <xref:System.Web.Security.MembershipUser> 要在中返回的最大实例数 <xref:System.Web.Security.MembershipUserCollection> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-501">The `pageSize` parameter specifies the maximum number of <xref:System.Web.Security.MembershipUser> instances to return in the <xref:System.Web.Security.MembershipUserCollection>.</span></span> <span data-ttu-id="9eb37-502">`pageIndex`参数指定要返回的结果页，其中0（零）指示第一页。</span><span class="sxs-lookup"><span data-stu-id="9eb37-502">The `pageIndex` parameter specifies which page of results to return, where 0 (zero) indicates the first page.</span></span>  
  
 <span data-ttu-id="9eb37-503">`totalRecords`参数是 `out` 设置为在 Active Directory 数据存储中找到的匹配成员身份用户总数的参数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-503">The `totalRecords` parameter is an `out` parameter that is set to the total number of matching membership users found in the Active Directory data store.</span></span> <span data-ttu-id="9eb37-504">例如，如果已配置的数据存储有13个用户，并且值为 `pageIndex` 1 且为 `pageSize` 5，则 <xref:System.Web.Security.MembershipUserCollection> 返回的将包含第六到第十个用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-504">For example, if there are 13 users for the configured data store, and the `pageIndex` value was 1 with a `pageSize` of 5, the <xref:System.Web.Security.MembershipUserCollection> returned would contain the sixth through the tenth users.</span></span> <span data-ttu-id="9eb37-505">`totalRecords`参数将设置为13。</span><span class="sxs-lookup"><span data-stu-id="9eb37-505">The `totalRecords` parameter would be set to 13.</span></span>  
  
 <span data-ttu-id="9eb37-506">您可以通过在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> 应用程序的配置文件中使用 `enableSearchMethods` [成员资格元素（ASP.NET Settings Schema）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素的属性设置属性，来控制是否允许搜索用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-506">You can control whether to allow searching for users, by setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property in the application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element.</span></span> <span data-ttu-id="9eb37-507">如果将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> 属性值设置为， `false` 则会 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> 引发 <xref:System.NotSupportedException> 异常。</span><span class="sxs-lookup"><span data-stu-id="9eb37-507">Setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property value to `false` causes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> method to throw a <xref:System.NotSupportedException> exception.</span></span>  
  
 <span data-ttu-id="9eb37-508">提供程序使用子树搜索，从连接字符串中指定的搜索点开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-508">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-509">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-509">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="9eb37-510">建议您不要在生产系统上启用搜索，直到您确认类发出的搜索查询 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 不会对目录服务器的性能产生负面影响。</span><span class="sxs-lookup"><span data-stu-id="9eb37-510">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="9eb37-511">由于 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类是为无状态 Web 环境设计的，因此无法使用由基础 api 公开的分页优化 <xref:System.DirectoryServices> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-511">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="9eb37-512">这意味着，搜索大型目录时的分页操作非常昂贵，应避免这样做。</span><span class="sxs-lookup"><span data-stu-id="9eb37-512">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="9eb37-513">搜索操作始终针对在连接字符串中配置的目录服务器发出，或在指向域的连接字符串的情况下，为自动选择的服务器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-513">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="9eb37-514">提供程序不会将全局编录用于其搜索方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-514">The provider does not use a global catalog for its search methods.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-515">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-515">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-516"><paramref name="usernameToMatch" /> 为空，或超过用户名的最大长度（通常为 256 个字符）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-516"><paramref name="usernameToMatch" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="9eb37-517">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-517">-or-</span></span> 
 <span data-ttu-id="9eb37-518"><paramref name="usernameToMatch" /> 包含逗号。</span><span class="sxs-lookup"><span data-stu-id="9eb37-518"><paramref name="usernameToMatch" /> contains commas.</span></span>  
  
<span data-ttu-id="9eb37-519">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-519">-or-</span></span> 
 <span data-ttu-id="9eb37-520"><paramref name="pageIndex" /> 小于 0。</span><span class="sxs-lookup"><span data-stu-id="9eb37-520"><paramref name="pageIndex" /> is less than 0.</span></span>  
  
<span data-ttu-id="9eb37-521">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-521">-or</span></span> 
 <span data-ttu-id="9eb37-522"><paramref name="pageSize" /> 小于 1。</span><span class="sxs-lookup"><span data-stu-id="9eb37-522"><paramref name="pageSize" /> is less than 1.</span></span>  
  
<span data-ttu-id="9eb37-523">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-523">-or-</span></span> 
 <span data-ttu-id="9eb37-524"><paramref name="pageSize" /> 乘以 <paramref name="pageIndex" />，然后加上 <paramref name="pageSize" />，再减去 1 后得到的值大于 <see cref="F:System.Int32.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-524"><paramref name="pageSize" /> multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9eb37-525"><paramref name="usernameToMatch" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-525"><paramref name="usernameToMatch" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="9eb37-526"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> 属性为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-526">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-527">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-527">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GeneratePassword">
      <MemberSignature Language="C#" Value="public virtual string GeneratePassword ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string GeneratePassword() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GeneratePassword () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::String ^ GeneratePassword();" />
      <MemberSignature Language="F#" Value="abstract member GeneratePassword : unit -&gt; string&#xA;override this.GeneratePassword : unit -&gt; string" Usage="activeDirectoryMembershipProvider.GeneratePassword " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9eb37-528">生成随机密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-528">Generates a random password.</span></span></summary>
        <returns><span data-ttu-id="9eb37-529">随机密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-529">A random password.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-530"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A>类的方法 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 调用类的 <xref:System.Web.Security.Membership.GeneratePassword%2A> 方法 <xref:System.Web.Security.Membership> 来检索随机密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-530">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A> method of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class calls the <xref:System.Web.Security.Membership.GeneratePassword%2A> method of the <xref:System.Web.Security.Membership> class to retrieve a random password.</span></span> <span data-ttu-id="9eb37-531">密码长度设置为属性的值 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-531">The password length is set to the value of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> property.</span></span> <span data-ttu-id="9eb37-532">密码长度绝不能小于14。</span><span class="sxs-lookup"><span data-stu-id="9eb37-532">The password length can never be less than 14.</span></span>  
  
 <span data-ttu-id="9eb37-533">您可以 <xref:System.Web.Security.Membership.GeneratePassword%2A> 通过 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 直接从类的提供程序属性引用类来专门调用方法 <xref:System.Web.Security.Membership> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-533">You can specifically call the <xref:System.Web.Security.Membership.GeneratePassword%2A> method by referencing the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class directly from the Provider property of the <xref:System.Web.Security.Membership> class.</span></span>  
  
 <span data-ttu-id="9eb37-534">生成的密码只包含字母数字字符和以下标点符号：！ @ # $% ^& \* （） _-+ = [{]};： <>&#124;./？。</span><span class="sxs-lookup"><span data-stu-id="9eb37-534">The generated password only contains alphanumeric characters and the following punctuation marks: !@#$%^&\*()_-+=[{]};:<>&#124;./?.</span></span> <span data-ttu-id="9eb37-535">生成的密码中不包含隐藏或不可打印的控制字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-535">No hidden or non-printable control characters are included in the generated password.</span></span>  
  
 <span data-ttu-id="9eb37-536">生成的密码将至少包含属性中指定的非字母数字字符数 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-536">The generated password will contain at least the number of non-alphanumeric characters specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> property.</span></span> <span data-ttu-id="9eb37-537">生成的密码不会在属性中用正则表达式进行测试 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-537">The generated password will not be tested with the regular expression in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9eb37-538"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类不会生成与目录中设置的复杂性要求匹配的密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-538">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not generate passwords that match complexity requirements set in the directory.</span></span> <span data-ttu-id="9eb37-539">可以生成随机密码，该密码会导致目录设置的密码复杂性规则失败。</span><span class="sxs-lookup"><span data-stu-id="9eb37-539">It is possible to generate a random password that fails the password complexity rules set by the directory.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-540">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-540">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetAllUsers">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection GetAllUsers (int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection GetAllUsers(int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetAllUsers (pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ GetAllUsers(int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.GetAllUsers : int * int * int -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.GetAllUsers (pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="pageIndex"><span data-ttu-id="9eb37-541">要返回的结果页的索引。</span><span class="sxs-lookup"><span data-stu-id="9eb37-541">The index of the page of results to return.</span></span> <span data-ttu-id="9eb37-542"><paramref name="pageIndex" /> 从零开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-542"><paramref name="pageIndex" /> is zero-based.</span></span></param>
        <param name="pageSize"><span data-ttu-id="9eb37-543">要返回的结果页的大小。</span><span class="sxs-lookup"><span data-stu-id="9eb37-543">The size of the page of results to return.</span></span></param>
        <param name="totalRecords"><span data-ttu-id="9eb37-544">当此方法返回时，此参数包含在集合中返回的记录的总数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-544">When this method returns, contains the total number of records returned in the collection.</span></span> <span data-ttu-id="9eb37-545">此参数未经初始化即被传递。</span><span class="sxs-lookup"><span data-stu-id="9eb37-545">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="9eb37-546">获取 Active Directory 数据源中存储的所有用户的集合。</span><span class="sxs-lookup"><span data-stu-id="9eb37-546">Gets a collection of all the users stored in an Active Directory data source.</span></span></summary>
        <returns><span data-ttu-id="9eb37-547">一个 <see cref="T:System.Web.Security.MembershipUserCollection" />，其中包含从 <paramref name="pageSize" /> 所指定的页开始的 <paramref name="pageIndex" /><see cref="T:System.Web.Security.MembershipUser" /> 实例。</span><span class="sxs-lookup"><span data-stu-id="9eb37-547">A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-548">此方法由 <xref:System.Web.Security.Membership> 类调用，以从 ASP.NET 应用程序的配置文件中指定的 Active Directory 数据存储区中检索用户信息。</span><span class="sxs-lookup"><span data-stu-id="9eb37-548">This method is called by the <xref:System.Web.Security.Membership> class to retrieve user information from the Active Directory data store specified in the ASP.NET application's configuration file.</span></span>  
  
 <span data-ttu-id="9eb37-549">方法返回的结果 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A> 受 `pageIndex` 和参数的约束 `pageSize` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-549">The results returned by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A> method are constrained by the `pageIndex` and `pageSize` parameters.</span></span> <span data-ttu-id="9eb37-550">`pageSize`参数指定 <xref:System.Web.Security.MembershipUser> 要在集合中返回的实例的最大数量 <xref:System.Web.Security.MembershipUserCollection> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-550">The `pageSize` parameter specifies the maximum number of <xref:System.Web.Security.MembershipUser> instances to return in the <xref:System.Web.Security.MembershipUserCollection> collection.</span></span> <span data-ttu-id="9eb37-551">`pageIndex`参数指定要返回的结果页，其中0（零）指示第一页。</span><span class="sxs-lookup"><span data-stu-id="9eb37-551">The `pageIndex` parameter specifies which page of results to return, where 0 (zero) indicates the first page.</span></span>  
  
 <span data-ttu-id="9eb37-552">`totalRecords`参数是 `out` 设置为在 Active Directory 数据存储中找到的匹配成员身份用户总数的参数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-552">The `totalRecords` parameter is an `out` parameter that is set to the total number of matching membership users found in the Active Directory data store.</span></span> <span data-ttu-id="9eb37-553">例如，如果已配置的数据存储有13个用户，并且 `pageIndex` 值为1且 la 为 `pageSize` 5，则返回的 <xref:System.Web.Security.MembershipUserCollection> 将包含第六到第十个用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-553">For example, if there are 13 users for the configured data store, and the `pageIndex` value was 1 with la `pageSize` of 5, the <xref:System.Web.Security.MembershipUserCollection> returned would contain the sixth through the tenth users.</span></span> <span data-ttu-id="9eb37-554">`totalRecords`参数将设置为13。</span><span class="sxs-lookup"><span data-stu-id="9eb37-554">The `totalRecords` parameter would be set to 13.</span></span>  
  
 <span data-ttu-id="9eb37-555">可以通过在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> 应用程序的配置文件中使用 `enableSearchMethods` [成员资格元素（ASP.NET Settings Schema）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素的属性设置属性来控制是否允许搜索用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-555">You can control whether to allow searching for users by setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property in the application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element.</span></span> <span data-ttu-id="9eb37-556">如果将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> 属性设置为， `false` 则会 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A> 引发 <xref:System.NotSupportedException> 异常。</span><span class="sxs-lookup"><span data-stu-id="9eb37-556">Setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property to `false` causes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A> method to throw a <xref:System.NotSupportedException> exception.</span></span>  
  
 <span data-ttu-id="9eb37-557">提供程序使用子树搜索，从连接字符串中指定的搜索点开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-557">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-558">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-558">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="9eb37-559">建议您不要在生产系统上启用搜索，直到您确认类发出的搜索查询 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 不会对目录服务器的性能产生负面影响。</span><span class="sxs-lookup"><span data-stu-id="9eb37-559">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="9eb37-560">由于 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类是为无状态 Web 环境设计的，因此无法使用由基础 api 公开的分页优化 <xref:System.DirectoryServices> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-560">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="9eb37-561">这意味着，搜索大型目录时的分页操作非常昂贵，应避免这样做。</span><span class="sxs-lookup"><span data-stu-id="9eb37-561">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="9eb37-562">搜索操作始终针对在连接字符串中配置的目录服务器发出，或在指向域的连接字符串的情况下，为自动选择的服务器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-562">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="9eb37-563">提供程序不会将全局编录用于其搜索方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-563">The provider does not use a global catalog for its search methods.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-564">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-564">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-565"><paramref name="pageIndex" /> 小于 0。</span><span class="sxs-lookup"><span data-stu-id="9eb37-565"><paramref name="pageIndex" /> is less than 0.</span></span>  
  
<span data-ttu-id="9eb37-566">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-566">-or</span></span> 
 <span data-ttu-id="9eb37-567"><paramref name="pageSize" /> 小于 1。</span><span class="sxs-lookup"><span data-stu-id="9eb37-567"><paramref name="pageSize" /> is less than 1.</span></span>  
  
<span data-ttu-id="9eb37-568">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-568">-or-</span></span> 
 <span data-ttu-id="9eb37-569"><paramref name="pageSize" /> 乘以 <paramref name="pageIndex" />，然后加上 <paramref name="pageSize" />，再减去 1 后得到的值大于 <see cref="F:System.Int32.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-569"><paramref name="pageSize" /> multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="9eb37-570"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> 属性为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-570">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-571">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-571">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetNumberOfUsersOnline">
      <MemberSignature Language="C#" Value="public override int GetNumberOfUsersOnline ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 GetNumberOfUsersOnline() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetNumberOfUsersOnline" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetNumberOfUsersOnline () As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int GetNumberOfUsersOnline();" />
      <MemberSignature Language="F#" Value="override this.GetNumberOfUsersOnline : unit -&gt; int" Usage="activeDirectoryMembershipProvider.GetNumberOfUsersOnline " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9eb37-572">在所有情况下都会引发 <see cref="T:System.NotSupportedException" /> 异常。</span><span class="sxs-lookup"><span data-stu-id="9eb37-572">Throws a <see cref="T:System.NotSupportedException" /> exception in all cases.</span></span></summary>
        <returns><span data-ttu-id="9eb37-573">所有情况下均为 <see cref="T:System.NotSupportedException" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-573">A <see cref="T:System.NotSupportedException" /> in all cases.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-574"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类不支持返回联机用户数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-574">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support returning the number of users online.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="9eb37-575">对 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetNumberOfUsersOnline" /> 方法的任何调用。</span><span class="sxs-lookup"><span data-stu-id="9eb37-575">Any call to the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetNumberOfUsersOnline" /> method.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-576">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-576">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetPassword">
      <MemberSignature Language="C#" Value="public override string GetPassword (string username, string passwordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string GetPassword(string username, string passwordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetPassword(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetPassword (username As String, passwordAnswer As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ GetPassword(System::String ^ username, System::String ^ passwordAnswer);" />
      <MemberSignature Language="F#" Value="override this.GetPassword : string * string -&gt; string" Usage="activeDirectoryMembershipProvider.GetPassword (username, passwordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="9eb37-577">要为其检索密码的用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-577">The user to retrieve the password for.</span></span></param>
        <param name="passwordAnswer"><span data-ttu-id="9eb37-578">用户的密码提示问题答案。</span><span class="sxs-lookup"><span data-stu-id="9eb37-578">The password answer for the user.</span></span></param>
        <summary><span data-ttu-id="9eb37-579">从数据库返回指定用户的密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-579">Returns the password of the specified user from the database.</span></span> <span data-ttu-id="9eb37-580"><see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 类不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-580">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class does not support this method.</span></span></summary>
        <returns><span data-ttu-id="9eb37-581">总是引发 <see cref="T:System.NotSupportedException" /> 异常。</span><span class="sxs-lookup"><span data-stu-id="9eb37-581">Always throws a <see cref="T:System.NotSupportedException" /> exception.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-582"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>类不支持返回用户的密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-582">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support returning the user's password.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="9eb37-583"><see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 不支持密码检索。</span><span class="sxs-lookup"><span data-stu-id="9eb37-583">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> does not support password retrieval.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-584">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-584">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetUser">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9eb37-585">获取 Active Directory 数据存储区中的成员资格用户的信息。</span><span class="sxs-lookup"><span data-stu-id="9eb37-585">Gets the information from a membership user in the Active Directory data store.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser GetUser (object providerUserKey, bool userIsOnline);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser GetUser(object providerUserKey, bool userIsOnline) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUser (providerUserKey As Object, userIsOnline As Boolean) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ GetUser(System::Object ^ providerUserKey, bool userIsOnline);" />
      <MemberSignature Language="F#" Value="override this.GetUser : obj * bool -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.GetUser (providerUserKey, userIsOnline)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="providerUserKey" Type="System.Object" />
        <Parameter Name="userIsOnline" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="providerUserKey"><span data-ttu-id="9eb37-586">用户的唯一标识符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-586">The unique identifier for the user.</span></span></param>
        <param name="userIsOnline"><span data-ttu-id="9eb37-587"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> 方法忽略此参数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-587">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> method ignores this parameter.</span></span></param>
        <summary><span data-ttu-id="9eb37-588">获取与指定用户密钥关联的成员资格用户信息。</span><span class="sxs-lookup"><span data-stu-id="9eb37-588">Gets the membership user information associated with the specified user key.</span></span></summary>
        <returns><span data-ttu-id="9eb37-589">一个 <see cref="T:System.Web.Security.MembershipUser" /> 实例，它表示指定的用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-589">A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user specified.</span></span> <span data-ttu-id="9eb37-590">如果在 Active Directory 数据存储区中没有找到任何具有指定 <paramref name="providerUserKey" /> 值的用户，则返回 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-590">If no user is found in the Active Directory data store for the specified <paramref name="providerUserKey" /> value, <see langword="null" /> is returned.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-591"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A>方法由 <xref:System.Web.Security.Membership> 类调用，以从 Active Directory 数据存储中检索有关指定用户的信息。</span><span class="sxs-lookup"><span data-stu-id="9eb37-591">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A> method is called by the <xref:System.Web.Security.Membership> class to retrieve information on the specified user from the Active Directory data store.</span></span>  
  
 <span data-ttu-id="9eb37-592">搜索将查找 `objectSID` 属性与参数匹配的用户实例 `providerUserKey` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-592">The search looks for a user instance where the `objectSID` attribute matches the `providerUserKey` parameter.</span></span>  
  
 <span data-ttu-id="9eb37-593">提供程序使用子树搜索，从连接字符串中指定的搜索点开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-593">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-594">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-594">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-595">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-595">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-596"><paramref name="providerUserKey" /> 的类型不是 <see cref="T:System.Security.Principal.SecurityIdentifier" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-596"><paramref name="providerUserKey" /> is not of type <see cref="T:System.Security.Principal.SecurityIdentifier" />.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9eb37-597"><paramref name="providerUserKey" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-597"><paramref name="providerUserKey" /> is <see langword="null" />.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="GetUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser GetUser (string username, bool userIsOnline);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser GetUser(string username, bool userIsOnline) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUser (username As String, userIsOnline As Boolean) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ GetUser(System::String ^ username, bool userIsOnline);" />
      <MemberSignature Language="F#" Value="override this.GetUser : string * bool -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.GetUser (username, userIsOnline)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="userIsOnline" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="9eb37-598">要为其获取信息的用户的名称。</span><span class="sxs-lookup"><span data-stu-id="9eb37-598">The name of the user to get information for.</span></span></param>
        <param name="userIsOnline"><span data-ttu-id="9eb37-599"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> 方法忽略此参数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-599">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> method ignores this parameter.</span></span></param>
        <summary><span data-ttu-id="9eb37-600">获取与指定用户名关联的成员资格用户信息。</span><span class="sxs-lookup"><span data-stu-id="9eb37-600">Gets the membership user information associated with the specified user name.</span></span></summary>
        <returns><span data-ttu-id="9eb37-601">一个 <see cref="T:System.Web.Security.MembershipUser" /> 实例，它表示指定的用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-601">A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user specified.</span></span> <span data-ttu-id="9eb37-602">如果在 Active Directory 数据存储区中没有找到任何具有指定 <paramref name="username" /> 值的用户，则返回 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-602">If no user is found in the Active Directory data store for the specified <paramref name="username" /> value, <see langword="null" /> is returned.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-603"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A>方法由 <xref:System.Web.Security.Membership> 类调用，以从 Active Directory 数据存储中检索有关指定用户的信息。</span><span class="sxs-lookup"><span data-stu-id="9eb37-603">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A> method is called by the <xref:System.Web.Security.Membership> class to retrieve information on the specified user from the Active Directory data store.</span></span>  
  
 <span data-ttu-id="9eb37-604">提供程序使用子树搜索，从连接字符串中指定的搜索点开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-604">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-605">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-605">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="9eb37-606">删除 `username` 参数值的前导和尾随空格。</span><span class="sxs-lookup"><span data-stu-id="9eb37-606">Leading and trailing spaces are trimmed from the `username` parameter value.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-607"><paramref name="username" /> 为空，或超过用户名的最大长度（通常为 256 个字符）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-607"><paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="9eb37-608">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-608">-or-</span></span> 
 <span data-ttu-id="9eb37-609"><paramref name="username" /> 包含逗号。</span><span class="sxs-lookup"><span data-stu-id="9eb37-609"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="9eb37-610">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-610">-or-</span></span> 
<span data-ttu-id="9eb37-611">用户名映射到 <see langword="userPrincipalName" /> 特性，并且 <paramref name="username" /> 参数包含反斜杠。</span><span class="sxs-lookup"><span data-stu-id="9eb37-611">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9eb37-612"><paramref name="username" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-612"><paramref name="username" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-613">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-613">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-614">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-614">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetUserNameByEmail">
      <MemberSignature Language="C#" Value="public override string GetUserNameByEmail (string email);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string GetUserNameByEmail(string email) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUserNameByEmail(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUserNameByEmail (email As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ GetUserNameByEmail(System::String ^ email);" />
      <MemberSignature Language="F#" Value="override this.GetUserNameByEmail : string -&gt; string" Usage="activeDirectoryMembershipProvider.GetUserNameByEmail email" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="email" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="email"><span data-ttu-id="9eb37-615">要搜索的电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="9eb37-615">The email address to search for.</span></span></param>
        <summary><span data-ttu-id="9eb37-616">获取与指定电子邮件地址关联的用户名。</span><span class="sxs-lookup"><span data-stu-id="9eb37-616">Gets the user name associated with the specified email address.</span></span></summary>
        <returns><span data-ttu-id="9eb37-617">与指定电子邮件地址关联的用户名。</span><span class="sxs-lookup"><span data-stu-id="9eb37-617">The user name associated with the specified email address.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-618">此方法由 <xref:System.Web.Security.Membership> 类调用，以根据用户的电子邮件地址从 Active Directory 数据存储区中检索用户名。</span><span class="sxs-lookup"><span data-stu-id="9eb37-618">This method is called by the <xref:System.Web.Security.Membership> class to retrieve a user name from the Active Directory data store based on the email address for the user.</span></span>  
  
 <span data-ttu-id="9eb37-619">如果成员资格数据存储区中有多个用户具有相同的电子邮件地址，则返回第一个遇到的用户名。</span><span class="sxs-lookup"><span data-stu-id="9eb37-619">If more than one user in the membership data store has the same email address, the first user name encountered is returned.</span></span> <span data-ttu-id="9eb37-620">您可以 `requiresUniqueEmail` 在应用程序配置文件中将[成员资格元素（ASP.NET Settings Schema）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素的特性设置为， `true` 以确保数据库中的每个电子邮件地址都是唯一的。</span><span class="sxs-lookup"><span data-stu-id="9eb37-620">You can set the `requiresUniqueEmail` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element to `true` in the application configuration file to ensure that each email address in the database is unique.</span></span>  
  
 <span data-ttu-id="9eb37-621">删除 `email` 参数值的前导和尾随空格。</span><span class="sxs-lookup"><span data-stu-id="9eb37-621">Leading and trailing spaces are trimmed from the `email` parameter value.</span></span> <span data-ttu-id="9eb37-622">如果在修整后电子邮件地址为空， <xref:System.ArgumentException> 则会引发。</span><span class="sxs-lookup"><span data-stu-id="9eb37-622">If the email address is empty after trimming, an <xref:System.ArgumentException> is thrown.</span></span> <span data-ttu-id="9eb37-623">如果电子邮件地址为 `null` ，则会搜索 Active Directory 的数据存储中的所有用户名，并返回第一个用户名。</span><span class="sxs-lookup"><span data-stu-id="9eb37-623">If the email address is `null`, all user names in the Active Directory data store are searched, and the first user name is returned.</span></span>  
  
 <span data-ttu-id="9eb37-624">建议您不要在生产系统上启用搜索，直到您确认类发出的搜索查询 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 不会对目录服务器的性能产生负面影响。</span><span class="sxs-lookup"><span data-stu-id="9eb37-624">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9eb37-625"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUserNameByEmail%2A>即使属性为，该方法也会运行 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> `false` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-625">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUserNameByEmail%2A> method will run even when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property is `false`.</span></span>  
  
 <span data-ttu-id="9eb37-626">由于 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 类是为无状态 Web 环境设计的，因此无法使用由基础 api 公开的分页优化 <xref:System.DirectoryServices> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-626">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="9eb37-627">这意味着，搜索大型目录时的分页操作非常昂贵，应避免这样做。</span><span class="sxs-lookup"><span data-stu-id="9eb37-627">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="9eb37-628">搜索操作始终针对在连接字符串中配置的目录服务器发出，或在指向域的连接字符串的情况下，为自动选择的服务器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-628">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="9eb37-629">提供程序不会将全局编录用于其搜索方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-629">The provider does not use a global catalog for its search methods.</span></span>  
  
 <span data-ttu-id="9eb37-630">提供程序使用子树搜索，从连接字符串中指定的搜索点开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-630">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-631">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-631">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-632"><paramref name="email" /> 的长度超过 256 个字符</span><span class="sxs-lookup"><span data-stu-id="9eb37-632"><paramref name="email" /> exceeds 256 characters</span></span> 
<span data-ttu-id="9eb37-633">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-633">-or-</span></span> 
<span data-ttu-id="9eb37-634">修整后，<paramref name="email" /> 为空。</span><span class="sxs-lookup"><span data-stu-id="9eb37-634">after trimming, <paramref name="email" /> is empty.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="9eb37-635">数据存储区中存在多个具有相同电子邮件地址的用户，而 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> 属性值为 <see langword="true" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-635">More than one user exists in the data store with the same email address and the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property value is <see langword="true" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-636">该提供程序未初始化。</span><span class="sxs-lookup"><span data-stu-id="9eb37-636">The provider is not initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-637">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-637">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Initialize">
      <MemberSignature Language="C#" Value="public override void Initialize (string name, System.Collections.Specialized.NameValueCollection config);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Initialize(string name, class System.Collections.Specialized.NameValueCollection config) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Initialize (name As String, config As NameValueCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Initialize(System::String ^ name, System::Collections::Specialized::NameValueCollection ^ config);" />
      <MemberSignature Language="F#" Value="override this.Initialize : string * System.Collections.Specialized.NameValueCollection -&gt; unit" Usage="activeDirectoryMembershipProvider.Initialize (name, config)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="name" Type="System.String" />
        <Parameter Name="config" Type="System.Collections.Specialized.NameValueCollection" />
      </Parameters>
      <Docs>
        <param name="name"><span data-ttu-id="9eb37-638">要初始化的 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 实例的名称。</span><span class="sxs-lookup"><span data-stu-id="9eb37-638">The name of the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance to initialize.</span></span></param>
        <param name="config"><span data-ttu-id="9eb37-639">包含名称和值的 <see cref="T:System.Collections.Specialized.NameValueCollection" />，这些名称和值用于成员资格提供程序的配置选项。</span><span class="sxs-lookup"><span data-stu-id="9eb37-639">A <see cref="T:System.Collections.Specialized.NameValueCollection" /> containing the names and values of the configuration options for the membership provider.</span></span></param>
        <summary><span data-ttu-id="9eb37-640">使用应用程序配置文件中的属性值初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 实例。</span><span class="sxs-lookup"><span data-stu-id="9eb37-640">Initializes the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance with the property values from the application's configuration files.</span></span> <span data-ttu-id="9eb37-641">此方法不应在您的代码中调用。</span><span class="sxs-lookup"><span data-stu-id="9eb37-641">This method is not intended to be called from your code.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-642">此方法 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 使用在 ASP.NET 应用程序配置文件（Web.config）中指定的属性值初始化对象，但不应在代码中直接使用。</span><span class="sxs-lookup"><span data-stu-id="9eb37-642">This method initializes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> object with the property values specified in the ASP.NET application configuration file (Web.config) and is not intended to be used directly from your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9eb37-643"><paramref name="config" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-643"><paramref name="config" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="9eb37-644">在应用程序配置中指定的 <see langword="applicationName" /> 特性超过 256 个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-644">The <see langword="applicationName" /> attribute specified in the application configuration exceeds 256 characters.</span></span>  
  
<span data-ttu-id="9eb37-645">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-645">-or-</span></span> 
<span data-ttu-id="9eb37-646"><see langword="connectionStringName" /> 特性为空或应用程序配置中不存在该特性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-646">The <see langword="connectionStringName" /> attribute is empty or does not exist in the application configuration.</span></span>  
  
<span data-ttu-id="9eb37-647">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-647">-or-</span></span> 
<span data-ttu-id="9eb37-648">在应用程序配置文件中的 <see langword="connectionStringName" /> 特性中指定的连接字符串为空或不存在。</span><span class="sxs-lookup"><span data-stu-id="9eb37-648">The connection string specified in the <see langword="connectionStringName" /> attribute in the application configuration file is empty or does not exist.</span></span>  
  
<span data-ttu-id="9eb37-649">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-649">-or-</span></span> 
<span data-ttu-id="9eb37-650">在应用程序配置文件中，<see langword="connectionProtection" /> 特性设置为 <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" /> 或 <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" /> 以外的值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-650">The <see langword="connectionProtection" /> attribute is set to a value other than <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" /> or <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" /> in the application configuration file.</span></span>  
  
<span data-ttu-id="9eb37-651">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-651">-or-</span></span> 
<span data-ttu-id="9eb37-652">应用程序配置文件中指定了 <see langword="connectionUsername" /> 特性，但其值为空。</span><span class="sxs-lookup"><span data-stu-id="9eb37-652">The <see langword="connectionUsername" /> attribute is specified in the application configuration file but its value is empty.</span></span>  
  
<span data-ttu-id="9eb37-653">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-653">-or-</span></span> 
<span data-ttu-id="9eb37-654">应用程序配置文件中指定了 <see langword="connectionPassword" /> 特性，但其值为空。</span><span class="sxs-lookup"><span data-stu-id="9eb37-654">The <see langword="connectionPassword" /> attribute is specified in the application configuration file but its value is empty.</span></span>  
  
<span data-ttu-id="9eb37-655">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-655">-or-</span></span> 
<span data-ttu-id="9eb37-656">在应用程序配置文件中指定了 <see langword="connectionUsername" /> 特性或 <see langword="connectionPassword" /> 特性，但未同时指定两者。</span><span class="sxs-lookup"><span data-stu-id="9eb37-656">Either the <see langword="connectionUsername" /> attribute or the <see langword="connectionPassword" /> attribute is specified in the application configuration file, but not both.</span></span>  
  
<span data-ttu-id="9eb37-657">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-657">-or-</span></span> 
<span data-ttu-id="9eb37-658">指定了 <see langword="clientSearchTimeout" /> 特性，但它不是正整数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-658">The <see langword="clientSearchTimeout" /> attribute is specified but is not a positive integer.</span></span>  
  
<span data-ttu-id="9eb37-659">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-659">-or-</span></span> 
<span data-ttu-id="9eb37-660">指定了 <see langword="serverSearchTimeout" /> 特性，但它不是正整数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-660">The <see langword="serverSearchTimeout" /> attribute is specified but is not a positive integer.</span></span>  
  
<span data-ttu-id="9eb37-661">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-661">-or-</span></span> 
<span data-ttu-id="9eb37-662">指定了 <see langword="enableSearchMethods" /> 特性，但它不是布尔值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-662">The <see langword="enableSearchMethods" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="9eb37-663">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-663">-or-</span></span> 
<span data-ttu-id="9eb37-664">指定了 <see langword="requiresUniqueEmail" /> 特性，但它不是布尔值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-664">The <see langword="requiresUniqueEmail" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="9eb37-665">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-665">-or-</span></span> 
<span data-ttu-id="9eb37-666">指定了 <see langword="enablePasswordReset" /> 特性，但它不是布尔值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-666">The <see langword="enablePasswordReset" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="9eb37-667">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-667">-or-</span></span> 
<span data-ttu-id="9eb37-668">指定了 <see langword="requiresQuestionAndAnswer" /> 特性，但它不是布尔值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-668">The <see langword="requiresQuestionAndAnswer" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="9eb37-669">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-669">-or-</span></span> 
<span data-ttu-id="9eb37-670">指定了 <see langword="minRequiredPasswordLength" /> 特性，但它为负或大于 128。</span><span class="sxs-lookup"><span data-stu-id="9eb37-670">The <see langword="minRequiredPasswordLength" /> attribute is specified and it is either negative or greater than 128.</span></span>  
  
<span data-ttu-id="9eb37-671">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-671">-or-</span></span> 
<span data-ttu-id="9eb37-672">指定了 <see langword="minRequiredNonalphanumericCharacters" /> 特性，但它为负或大于 128。</span><span class="sxs-lookup"><span data-stu-id="9eb37-672">The <see langword="minRequiredNonalphanumericCharacters" /> attribute is specified and it is either negative or greater than 128.</span></span>  
  
<span data-ttu-id="9eb37-673">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-673">-or-</span></span> 
<span data-ttu-id="9eb37-674">在应用程序配置文件的 <see langword="passwordStrengthRegularExpression" /> 特性中指定的正则表达式不是有效的正则表达式</span><span class="sxs-lookup"><span data-stu-id="9eb37-674">The regular expression specified in the <see langword="passwordStrengthRegularExpression" /> attribute in the application configuration file is not a valid regular expression</span></span> 
<span data-ttu-id="9eb37-675">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-675">-or-</span></span> 
<span data-ttu-id="9eb37-676">指定了 <see langword="attributeMapUsername" /> 特性，但它是一个空字符串。</span><span class="sxs-lookup"><span data-stu-id="9eb37-676">The <see langword="attributeMapUsername" /> attribute is specified, but it is an empty string.</span></span>  
  
<span data-ttu-id="9eb37-677">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-677">-or-</span></span> 
<span data-ttu-id="9eb37-678"><see langword="connectionString" /> 特性不以“LDAP”开头。</span><span class="sxs-lookup"><span data-stu-id="9eb37-678">The <see langword="connectionString" /> attribute does not begin with "LDAP".</span></span>  
  
<span data-ttu-id="9eb37-679">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-679">-or-</span></span> 
<span data-ttu-id="9eb37-680">在 <see langword="connectionString" /> 特性中指定的连接字符串无效。</span><span class="sxs-lookup"><span data-stu-id="9eb37-680">The connection string specified in the <see langword="connectionString" /> attribute is invalid.</span></span>  
  
<span data-ttu-id="9eb37-681">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-681">-or-</span></span> 
<span data-ttu-id="9eb37-682"><see langword="connectionString" /> 特性中的连接字符串指定了一个无服务器绑定。</span><span class="sxs-lookup"><span data-stu-id="9eb37-682">The connection string in the <see langword="connectionString" /> attribute specifies a server-less bind.</span></span>  
  
<span data-ttu-id="9eb37-683">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-683">-or-</span></span> 
<span data-ttu-id="9eb37-684"><see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 未能建立与域或目录服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="9eb37-684">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not establish a connection with the domain or directory server.</span></span>  
  
<span data-ttu-id="9eb37-685">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-685">-or-</span></span> 
<span data-ttu-id="9eb37-686"><see langword="connectionProtection" /> 特性设置为 <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" />，但不能与服务器建立 SSL 和经过签名且密封的连接。</span><span class="sxs-lookup"><span data-stu-id="9eb37-686">The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" />, but neither an SSL nor a signed and sealed connection can be established with the server.</span></span>  
  
<span data-ttu-id="9eb37-687">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-687">-or-</span></span> 
<span data-ttu-id="9eb37-688"><see langword="connectionProtection" /> 特性设置为 <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" />，但未设置 <see langword="connectionUsername" /> 和 <see langword="connectionPassword" /> 特性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-688">The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" /> but the <see langword="connectionUsername" /> and <see langword="connectionPassword" /> attributes are not set.</span></span>  
  
<span data-ttu-id="9eb37-689">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-689">-or-</span></span> 
<span data-ttu-id="9eb37-690"><see langword="connectionProtection" /> 特性设置为 <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" />，但 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 未能与 ADAM 服务器建立 SSL 连接。</span><span class="sxs-lookup"><span data-stu-id="9eb37-690">The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" /> but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not establish an SSL connection with an ADAM server.</span></span>  
  
<span data-ttu-id="9eb37-691">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-691">-or-</span></span> 
<span data-ttu-id="9eb37-692"><see langword="connectionString" /> 特性指定全局编录 (GC) 或 SSL 全局编录端口。</span><span class="sxs-lookup"><span data-stu-id="9eb37-692">The <see langword="connectionString" /> attribute specifies either the global catalog (GC) or an SSL global catalog port.</span></span>  
  
<span data-ttu-id="9eb37-693">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-693">-or-</span></span> 
<span data-ttu-id="9eb37-694"><see langword="connectionString" /> 特性指定 Active Directory 服务器或域，但 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 未能检索域的默认命名上下文。</span><span class="sxs-lookup"><span data-stu-id="9eb37-694">The <see langword="connectionString" /> attribute specifies an Active Directory server or domain, but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not retrieve the default naming context for the domain.</span></span>  
  
<span data-ttu-id="9eb37-695">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-695">-or-</span></span> 
<span data-ttu-id="9eb37-696"><see langword="connectionString" /> 特性指定 Active Directory 服务器或域，但 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 未能检索默认用户容器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-696">The <see langword="connectionString" /> attribute specifies an Active Directory server or domain, but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not retrieve the default users container.</span></span>  
  
<span data-ttu-id="9eb37-697">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-697">-or-</span></span> 
<span data-ttu-id="9eb37-698"><see langword="connectionString" /> 特性指定 ADAM 服务器，但未指定应用程序分区或容器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-698">The <see langword="connectionString" /> attribute specifies an ADAM server, but it does not specify an application partition or container.</span></span>  
  
<span data-ttu-id="9eb37-699">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-699">-or-</span></span> 
<span data-ttu-id="9eb37-700"><see langword="connectionString" /> 特性指定应用程序分区或容器，但指定的容器不存在。</span><span class="sxs-lookup"><span data-stu-id="9eb37-700">The <see langword="connectionString" /> attribute specifies an application partition or container, but the specified container does not exist.</span></span>  
  
<span data-ttu-id="9eb37-701">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-701">-or-</span></span> 
<span data-ttu-id="9eb37-702"><see langword="connectionString" /> 特性指定的容器不允许包含用户实例。</span><span class="sxs-lookup"><span data-stu-id="9eb37-702">The <see langword="connectionString" /> attribute specifies a container that is not allowed to contain user instances.</span></span>  
  
<span data-ttu-id="9eb37-703">指定了一个特性映射，但该特性映射的值为空。</span><span class="sxs-lookup"><span data-stu-id="9eb37-703">An attribute mapping is specified but its value was empty.</span></span>  
  
<span data-ttu-id="9eb37-704">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-704">-or-</span></span> 
<span data-ttu-id="9eb37-705">同一个特性映射指定了两次。</span><span class="sxs-lookup"><span data-stu-id="9eb37-705">An attribute mapping is specified twice.</span></span>  
  
<span data-ttu-id="9eb37-706">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-706">-or-</span></span> 
<span data-ttu-id="9eb37-707">指定了一个特性映射，但用户实例中不存在该特性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-707">An attribute mapping is specified but the attribute does not exist on the user instance.</span></span>  
  
<span data-ttu-id="9eb37-708">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-708">-or-</span></span> 
<span data-ttu-id="9eb37-709">指定了一个特性映射，但该目录特性的数据类型不正确。</span><span class="sxs-lookup"><span data-stu-id="9eb37-709">An attribute mapping is specified but the directory attribute is not of the correct data type.</span></span>  
  
<span data-ttu-id="9eb37-710">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-710">-or-</span></span> 
<span data-ttu-id="9eb37-711">指定了一个特性映射，但该目录特性是多值特性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-711">An attribute mapping is specified but the directory attribute is multi-valued.</span></span>  
  
<span data-ttu-id="9eb37-712">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-712">-or-</span></span> 
<span data-ttu-id="9eb37-713">指定了 <see langword="attributeMapUserName" /> 特性，但在连接到 Active Directory 时未将该特性映射到 <c>sAMAccountName</c> 或 <c>userPrincipalName</c> 目录特性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-713">The <see langword="attributeMapUserName" /> attribute is specified but was mapped to neither the <c>sAMAccountName</c> nor the <c>userPrincipalName</c> directory attribute when connecting to an Active Directory.</span></span>  
  
<span data-ttu-id="9eb37-714">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-714">-or-</span></span> 
<span data-ttu-id="9eb37-715">指定了 <see langword="attributeMapUserName" /> 特性，但在连接到 ADAM 服务器时未将该特性映射到 <c>userPrincipalName</c> 目录特性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-715">The <see langword="attributeMapUserName" /> attribute is specified but was not mapped to the <c>userPrincipalName</c> directory attribute when connecting to an ADAM server.</span></span>  
  
<span data-ttu-id="9eb37-716">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-716">-or-</span></span> 
<span data-ttu-id="9eb37-717">在应用程序配置文件中，<see langword="enablePasswordReset" /> 特性为 <see langword="true" />，<see langword="requiresQuestionAndAnswer" /> 特性为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-717">The <see langword="enablePasswordReset" /> attribute is <see langword="true" /> and the <see langword="requiresQuestionAndAnswer" /> attribute is <see langword="false" /> in the application configuration file.</span></span>  
  
<span data-ttu-id="9eb37-718">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-718">-or-</span></span> 
<span data-ttu-id="9eb37-719">指定了 <see langword="maxInvalidPasswordAttempts" /> 特性，但它不是非零正整数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-719">The <see langword="maxInvalidPasswordAttempts" /> attribute was specified but is not a non-zero positive integer.</span></span>  
  
<span data-ttu-id="9eb37-720">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-720">-or-</span></span> 
<span data-ttu-id="9eb37-721">指定了 <see langword="passwordAttemptWindow" /> 特性，但它不是非零正整数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-721">The <see langword="passwordAttemptWindow" /> attribute was specified but is not a non-zero positive integer.</span></span>  
  
<span data-ttu-id="9eb37-722">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-722">-or-</span></span> 
<span data-ttu-id="9eb37-723">指定了 <see langword="passwordAnswerAttemptLockoutDuration" /> 特性，但它不是非零正整数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-723">The <see langword="passwordAnswerAttemptLockoutDuration" /> attribute was specified but is not a non-zero positive integer.</span></span>  
  
<span data-ttu-id="9eb37-724">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-724">-or-</span></span> 
<span data-ttu-id="9eb37-725"><see langword="enablePasswordReset" /> 特性为 <see langword="true" />，但 <see langword="attributeMapFailedPasswordAnswerCount" />、<see langword="attributeMapFailedPasswordAnswerTime" /> 和 <see langword="attributeMapFailedPasswordAnswerLockoutTime" /> 特性中的任何一个为空。</span><span class="sxs-lookup"><span data-stu-id="9eb37-725">The <see langword="enablePasswordReset" /> attribute is <see langword="true" /> and any of the <see langword="attributeMapFailedPasswordAnswerCount" />, <see langword="attributeMapFailedPasswordAnswerTime" />, and <see langword="attributeMapFailedPasswordAnswerLockoutTime" /> attributes are empty.</span></span>  
  
<span data-ttu-id="9eb37-726">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-726">-or-</span></span> 
<span data-ttu-id="9eb37-727"><see langword="requiresQuestionAndAnswer" /> 特性为 <see langword="true" />，但 <see langword="attributeMapPasswordQuestion" /> 或 <see langword="attributeMapPasswordAnswer" /> 特性为空。</span><span class="sxs-lookup"><span data-stu-id="9eb37-727">The <see langword="requiresQuestionAndAnswer" /> attribute is <see langword="true" /> but either the <see langword="attributeMapPasswordQuestion" /> or the <see langword="attributeMapPasswordAnswer" /> attribute is empty.</span></span>  
  
<span data-ttu-id="9eb37-728">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-728">-or-</span></span> 
<span data-ttu-id="9eb37-729">在应用程序配置文件中指定的一个特性无效。</span><span class="sxs-lookup"><span data-stu-id="9eb37-729">An attribute specified in the application configuration file is not valid.</span></span></exception>
        <exception cref="T:System.Web.HttpException"><span data-ttu-id="9eb37-730">应用程序在承载环境中运行，但 <see cref="T:System.Web.AspNetHostingPermissionLevel" /> 设置为 <see cref="F:System.Web.AspNetHostingPermissionLevel.Minimal" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-730">The application is running in a hosted environment and the <see cref="T:System.Web.AspNetHostingPermissionLevel" /> is set to <see cref="F:System.Web.AspNetHostingPermissionLevel.Minimal" />.</span></span></exception>
        <exception cref="T:System.Runtime.InteropServices.COMException"><span data-ttu-id="9eb37-731">查询目录时发生错误。</span><span class="sxs-lookup"><span data-stu-id="9eb37-731">An error occurred while querying the directory.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-732">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-732">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MaxInvalidPasswordAttempts">
      <MemberSignature Language="C#" Value="public override int MaxInvalidPasswordAttempts { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MaxInvalidPasswordAttempts" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MaxInvalidPasswordAttempts As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MaxInvalidPasswordAttempts { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MaxInvalidPasswordAttempts : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-733">获取用户回答密码重置问题时允许失败的次数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-733">Gets the number of failed answer attempts a user is allowed for the password-reset question.</span></span></summary>
        <value><span data-ttu-id="9eb37-734">在帐户被锁定之前，允许用户回答密码提示问题的失败次数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-734">The number of failed password answer attempts a user is allowed before the account is locked.</span></span> <span data-ttu-id="9eb37-735">默认值为<c>5</c>。</span><span class="sxs-lookup"><span data-stu-id="9eb37-735">The default is <c>5</c>.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-736">当 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性为时 `true` ，用户必须回答密码问题才能重置其密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-736">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user must answer the password question to reset his or her password.</span></span> <span data-ttu-id="9eb37-737">允许用户在属性所建立的时间范围内进行有限数量的答案尝试 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-737">The user is allowed a limited number of answer attempts within the time window established by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property.</span></span> <span data-ttu-id="9eb37-738">如果密码答案尝试次数大于或等于属性中存储的值 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> ，则用户将被锁定，以便进一步尝试存储在属性中的分钟数 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-738">If the number of password answer attempts is greater than or equal to the value stored in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property, the user is locked out of further attempts for the number of minutes stored in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9eb37-739">此属性不控制用户在锁定之前可以执行的失败登录尝试次数。Active Directory 服务器处理失败的登录尝试，并且不受此属性的值的影响。</span><span class="sxs-lookup"><span data-stu-id="9eb37-739">This property does not control the number of failed logon attempts a user can make before being locked out. The Active Directory server handles failed logon attempts and is not affected by the value of this property.</span></span>  
  
 <span data-ttu-id="9eb37-740">在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> 应用程序的配置文件中，使用 `maxInvalidPasswordAttempts` [成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素的特性设置该属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-740">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property is set in your application's configuration file using the `maxInvalidPasswordAttempts` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element.</span></span> <span data-ttu-id="9eb37-741">如果未在应用程序的配置文件中设置该属性，则 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> 属性将设置为的默认值 `5` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-741">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property is set to the default value of `5`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-742">下面的代码示例演示了一个 Web.config 条目，该条目可将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例配置为锁定在10分钟时间范围内尝试输入密码答案的三次尝试失败的用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-742">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to lock out users who make three failed attempts to enter the password answer in a 10-minute time window.</span></span> <span data-ttu-id="9eb37-743">如果用户被锁定，则不会再进一步回答密码问题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-743">If the user is locked out, no further attempts to answer the password question may be made for 15 minutes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
          passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-744">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" /> 实例之前，已尝试访问 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-744">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-745">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-745">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MinRequiredNonAlphanumericCharacters">
      <MemberSignature Language="C#" Value="public override int MinRequiredNonAlphanumericCharacters { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinRequiredNonAlphanumericCharacters" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MinRequiredNonAlphanumericCharacters As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MinRequiredNonAlphanumericCharacters { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinRequiredNonAlphanumericCharacters : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-746">获取有效密码中必须包含的最少特殊字符数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-746">Gets the minimum number of special characters that must be present in a valid password.</span></span></summary>
        <value><span data-ttu-id="9eb37-747">有效密码中必须包含的最少特殊字符数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-747">The minimum number of special characters that must be present in a valid password.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-748"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>属性返回创建有效密码时必须输入的特殊非字母数字字符的最小数目。</span><span class="sxs-lookup"><span data-stu-id="9eb37-748">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> property returns the minimum number of special, non-alphanumeric characters that must be entered to create a valid password.</span></span>  
  
 <span data-ttu-id="9eb37-749"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>属性值是使用 `minRequiredNonalphanumericCharacters` [成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))配置元素的特性在应用程序配置中设置的。</span><span class="sxs-lookup"><span data-stu-id="9eb37-749">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> property value is set in the application configuration using the `minRequiredNonalphanumericCharacters` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) configuration element.</span></span>  
  
 <span data-ttu-id="9eb37-750">非字母数字字符是该 <xref:System.Char.IsLetterOrDigit%2A> 方法返回的字符 `false` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-750">A non-alphanumeric character is a character for which the <xref:System.Char.IsLetterOrDigit%2A> method returns `false`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-751">下面的示例显示应用程序 Web.config 文件的部分中的[成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))配置元素 `system.web` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-751">The following example shows the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) configuration element in the `system.web` section of the application's Web.config file.</span></span> <span data-ttu-id="9eb37-752">它指定应用程序使用类的实例 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 来提供成员身份服务，并将 `minRequiredNonalphanumericCharacters` 特性设置为一个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-752">It specifies that the application use an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class to provide membership services, and sets the `minRequiredNonalphanumericCharacters` attribute to one character.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          minRequiredNonalphanumericCharacters = "1" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-753">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> 实例前，访问了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-753">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-754">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-754">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MinRequiredPasswordLength">
      <MemberSignature Language="C#" Value="public override int MinRequiredPasswordLength { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinRequiredPasswordLength" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MinRequiredPasswordLength As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MinRequiredPasswordLength { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinRequiredPasswordLength : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-755">获取密码所需的最小长度。</span><span class="sxs-lookup"><span data-stu-id="9eb37-755">Gets the minimum length required for a password.</span></span></summary>
        <value><span data-ttu-id="9eb37-756">密码所需的最小长度。</span><span class="sxs-lookup"><span data-stu-id="9eb37-756">The minimum length required for a password.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-757"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A>属性获取创建有效密码时必须输入的最小字符数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-757">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> property gets the minimum number of characters that must be entered to create a valid password.</span></span>  
  
 <span data-ttu-id="9eb37-758"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A>属性值是使用 `minRequiredPasswordLength` [成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))配置元素的特性在应用程序配置中设置的。</span><span class="sxs-lookup"><span data-stu-id="9eb37-758">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> property value is set in the application configuration using the `minRequiredPasswordLength` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) configuration element.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-759">下面的示例显示应用程序 Web.config 文件的部分中的[成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))配置元素 `system.web` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-759">The following example shows the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) configuration element in the `system.web` section of the application's Web.config file.</span></span> <span data-ttu-id="9eb37-760">它指定应用程序使用类的实例 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 来提供成员身份服务，并将该属性设置 `minRequiredPasswordLength` 为七个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-760">It specifies that the application use an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class to provide membership services, and sets the `minRequiredPasswordLength` attribute to seven characters.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          minRequiredPasswordLength = "7" />  
  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-761">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> 实例前，访问了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-761">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-762">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-762">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordAnswerAttemptLockoutDuration">
      <MemberSignature Language="C#" Value="public int PasswordAnswerAttemptLockoutDuration { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 PasswordAnswerAttemptLockoutDuration" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property PasswordAnswerAttemptLockoutDuration As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int PasswordAnswerAttemptLockoutDuration { int get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordAnswerAttemptLockoutDuration : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-763">获取用户多次未能正确回答密码提示问题后用户帐户的锁定时间长度。</span><span class="sxs-lookup"><span data-stu-id="9eb37-763">Get the length of time for which a user account is locked out after the user makes too many bad password-answer attempts.</span></span></summary>
        <value><span data-ttu-id="9eb37-764">用户多次提供错误的密码提示问题答案后的锁定时间（以分钟为单位）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-764">The time, in minutes, that a user is locked out after providing too many incorrect password answers.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-765">当 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性为时 `true` ，用户必须回答密码问题才能重置其密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-765">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user must answer the password question to reset his or her password.</span></span> <span data-ttu-id="9eb37-766">如果用户在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> 由属性指定的观察时间段内不能提供正确的答案（等于属性值 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> ），则用户将被锁定，以确定属性中包含的分钟数 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-766">If the user fails to supply the correct answer a consecutive number of times equal to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property value within the observation time period specified by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property, the user is locked out of further attempts for the number of minutes contained in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9eb37-767">此属性不会设置用户在未能输入有效密码后锁定的持续时间。</span><span class="sxs-lookup"><span data-stu-id="9eb37-767">This property does not set the duration a user is locked out after failing to enter a valid password.</span></span> <span data-ttu-id="9eb37-768">Active Directory 服务器处理失败的登录尝试，并且不受此属性的值的影响。</span><span class="sxs-lookup"><span data-stu-id="9eb37-768">The Active Directory server handles failed logon attempts and is not affected by the value of this property.</span></span> <span data-ttu-id="9eb37-769">建议将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> 属性设置为与指定的帐户锁定持续时间相同的值，因为在 Active Directory 配置中失败的登录尝试次数过多。</span><span class="sxs-lookup"><span data-stu-id="9eb37-769">We recommend that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property be set to the same value as the account lockout duration specified for too many failed logon attempts in the Active Directory configuration.</span></span> <span data-ttu-id="9eb37-770">这将为用户提供一致的自动锁定行为，无论用户是否因登录尝试失败或密码答案是否被锁定。</span><span class="sxs-lookup"><span data-stu-id="9eb37-770">This will present consistent auto-lockout behavior for users regardless of whether they were locked out due to failed logon attempts or to bad password answers.</span></span>  
  
 <span data-ttu-id="9eb37-771">在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> 应用程序的配置文件中，使用 `passwordAnswerAttemptLockoutDuration` [成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素的特性设置该属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-771">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set in your application's configuration file using the `passwordAnswerAttemptLockoutDuration` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element.</span></span> <span data-ttu-id="9eb37-772">如果未在应用程序的配置文件中设置该属性，则该 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> 属性将设置为默认值30分钟。</span><span class="sxs-lookup"><span data-stu-id="9eb37-772">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set to the default value of 30 minutes.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-773">下面的代码示例演示了一个 Web.config 条目，该条目可将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例配置为锁定在10分钟时间范围内尝试输入密码答案的三次尝试失败的用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-773">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to lock out users who make three failed attempts to enter the password answer in a 10-minute time window.</span></span> <span data-ttu-id="9eb37-774">如果用户被锁定，则不会再进一步回答密码问题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-774">If the user is locked out, no further attempts to answer the password question may be made for 15 minutes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
          passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-775">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" /> 实例之前，已尝试访问 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-775">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-776">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-776">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordAttemptWindow">
      <MemberSignature Language="C#" Value="public override int PasswordAttemptWindow { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 PasswordAttemptWindow" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordAttemptWindow As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int PasswordAttemptWindow { int get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordAttemptWindow : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-777">获取时间长度，在该时间间隔内对提供有效密码或密码答案的连续失败尝试次数进行跟踪。</span><span class="sxs-lookup"><span data-stu-id="9eb37-777">Gets the time window during which consecutive failed attempts to provide a valid password or a valid password answer are tracked.</span></span></summary>
        <value><span data-ttu-id="9eb37-778">对未能提供有效密码或密码答案的连续尝试次数进行跟踪的时间长度（以分钟为单位）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-778">The time window, in minutes, during which consecutive failed attempts to provide a valid password or a valid password answer are tracked.</span></span> <span data-ttu-id="9eb37-779">默认值为 10 分钟。</span><span class="sxs-lookup"><span data-stu-id="9eb37-779">The default is 10 minutes.</span></span> <span data-ttu-id="9eb37-780">如果两次失败尝试之间的间隔大于 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> 属性设置，则 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 实例将每次失败尝试都视为第一次失败尝试。</span><span class="sxs-lookup"><span data-stu-id="9eb37-780">If the interval between each failed attempt is greater than the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> property setting, the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance treats each failed attempt as if it were the first failed attempt.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-781">此 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> 属性与属性结合使用 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> ，以帮助防止不需要的源通过重复尝试来猜测成员资格用户的密码或密码答案。</span><span class="sxs-lookup"><span data-stu-id="9eb37-781">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property works in conjunction with the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property to help guard against an unwanted source guessing the password or password answer of a membership user through repeated attempts.</span></span> <span data-ttu-id="9eb37-782">当用户尝试登录、更改其密码或重置其密码时，在指定的时间范围内只允许一定数量的连续尝试。</span><span class="sxs-lookup"><span data-stu-id="9eb37-782">When users are attempting to log in, change their password, or reset their password, only a certain number of consecutive attempts are allowed within a specified time window.</span></span> <span data-ttu-id="9eb37-783">时间范围的长度由 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> 属性指定，该属性用于标识无效尝试之间允许的分钟数。</span><span class="sxs-lookup"><span data-stu-id="9eb37-783">The length of the time window is specified by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property, which identifies the number of minutes allowed between invalid attempts.</span></span> <span data-ttu-id="9eb37-784">如果用户重置其密码的连续失败尝试次数等于属性中存储的值 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> ，并且自上次无效尝试以来所经过的时间小于为属性指定的分钟数 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> ，则用户帐户被锁定，以确定属性中包含的分钟数 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-784">If the number of consecutive failed attempts a user makes to reset his or her password equals the value stored in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property, and the time elapsed since the last invalid attempt is less than the number of minutes specified for the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property, then the user account s locked out for the number of minutes contained in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property.</span></span> <span data-ttu-id="9eb37-785">如果当前失败尝试与上次失败尝试之间的间隔大于 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> 属性设置，则当前的无效尝试将计为第一次尝试。</span><span class="sxs-lookup"><span data-stu-id="9eb37-785">If the interval between the current failed attempt and the last failed attempt is greater than the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property setting, the current invalid attempt is counted as the first attempt.</span></span> <span data-ttu-id="9eb37-786">如果在达到允许的最大尝试无效次数之前提供了有效密码答案，则无效密码答案尝试的计数将设置为零。</span><span class="sxs-lookup"><span data-stu-id="9eb37-786">If a valid password answer is supplied before the maximum number of allowed invalid attempts is reached, the count of invalid password-answer attempts is set to zero.</span></span> <span data-ttu-id="9eb37-787">如果在达到允许的最大尝试无效次数之前提供了有效密码，则无效密码尝试次数和无效密码答案尝试计数将设置为零。</span><span class="sxs-lookup"><span data-stu-id="9eb37-787">If a valid password is supplied before the maximum number of allowed invalid attempts is reached, the count of invalid password attempts and the count of invalid password-answer attempts are set to zero.</span></span>  
  
 <span data-ttu-id="9eb37-788">建议将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> 属性设置为与在 Active Directory 配置中为失败登录尝试次数指定的帐户锁定持续时间相同的值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-788">We recommend that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property be set to the same value as the account lockout duration that is specified for the maximum number of failed logon attempts in the Active Directory configuration.</span></span> <span data-ttu-id="9eb37-789">这将为用户提供一致的自动锁定行为，使用户无论登录尝试失败或密码提示答案是否被锁定。</span><span class="sxs-lookup"><span data-stu-id="9eb37-789">This will present consistent auto-lockout behavior for users whether they were locked out due to failed logon attempts or to bad password answers.</span></span>  
  
 <span data-ttu-id="9eb37-790">在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> 应用程序的配置文件中，使用 `passwordAttemptWindow` [成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素的特性设置该属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-790">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set in your application's configuration file using the `passwordAttemptWindow` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element.</span></span> <span data-ttu-id="9eb37-791">如果未在应用程序的配置文件中设置该属性，则该 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> 属性将设置为默认值10分钟。</span><span class="sxs-lookup"><span data-stu-id="9eb37-791">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set to the default value of 10 minutes.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-792">下面的代码示例演示了一个 Web.config 条目，该条目可将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例配置为锁定在10分钟时间范围内尝试输入密码答案的三次尝试失败的用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-792">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to lock out users who make three failed attempts to enter the password answer in a 10-minute time window.</span></span> <span data-ttu-id="9eb37-793">如果用户被锁定，则不会再进一步回答密码问题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-793">If the user is locked out, no further attempts to answer the password question may be made for 15 minutes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
        passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-794">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> 实例之前，已尝试访问 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-794">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-795">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-795">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordFormat">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipPasswordFormat PasswordFormat { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.Security.MembershipPasswordFormat PasswordFormat" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordFormat As MembershipPasswordFormat" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::Web::Security::MembershipPasswordFormat PasswordFormat { System::Web::Security::MembershipPasswordFormat get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordFormat : System.Web.Security.MembershipPasswordFormat" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipPasswordFormat</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-796">获取一个值，该值指示 Active Directory 数据存储区中的密码的格式。</span><span class="sxs-lookup"><span data-stu-id="9eb37-796">Gets a value indicating the format of passwords in the Active Directory data store.</span></span></summary>
        <value><span data-ttu-id="9eb37-797"><see cref="T:System.Web.Security.MembershipPasswordFormat" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="9eb37-797">One of the <see cref="T:System.Web.Security.MembershipPasswordFormat" /> values.</span></span> <span data-ttu-id="9eb37-798"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" /> 属性总是返回 <see cref="F:System.Web.Security.MembershipPasswordFormat.Hashed" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-798">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" /> property always returns <see cref="F:System.Web.Security.MembershipPasswordFormat.Hashed" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-799"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>属性不支持密码检索。</span><span class="sxs-lookup"><span data-stu-id="9eb37-799">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> property does not support password retrieval.</span></span> <span data-ttu-id="9eb37-800">对象的行为与 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 其他使用密码的提供程序相同 `Hashed` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-800">The behavior of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> object is the same as other providers working with `Hashed` passwords.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-801">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-801">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordStrengthRegularExpression">
      <MemberSignature Language="C#" Value="public override string PasswordStrengthRegularExpression { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string PasswordStrengthRegularExpression" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordStrengthRegularExpression As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ PasswordStrengthRegularExpression { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordStrengthRegularExpression : string" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-802">获取用于计算密码的正则表达式。</span><span class="sxs-lookup"><span data-stu-id="9eb37-802">Gets the regular expression used to evaluate a password.</span></span></summary>
        <value><span data-ttu-id="9eb37-803">用于计算密码的正则表达式。</span><span class="sxs-lookup"><span data-stu-id="9eb37-803">A regular expression used to evaluate a password.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-804"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>属性获取用于评估密码复杂性的正则表达式。</span><span class="sxs-lookup"><span data-stu-id="9eb37-804">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property gets the regular expression used to evaluate password complexity.</span></span>  
  
 <span data-ttu-id="9eb37-805">此 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> 属性不用于验证方法中自动生成的密码 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-805">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property is not used to validate auto-generated passwords in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method.</span></span>  
  
 <span data-ttu-id="9eb37-806">在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> 应用程序配置中，使用 `passwordStrengthRegularExpression` [成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))配置元素的属性设置该属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-806">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property is set in the application configuration using the `passwordStrengthRegularExpression` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) configuration element.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-807">下面的示例显示应用程序 Web.config 文件的部分中的[成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))配置元素 `system.web` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-807">The following example shows the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) configuration element in the `system.web` section of the application's Web.config file.</span></span> <span data-ttu-id="9eb37-808">它指定应用程序使用类的实例 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 来提供成员身份服务，并将特性设置 `passwordStrengthRegularExpression` 为一个正则表达式，该表达式用于验证密码是否满足以下条件：</span><span class="sxs-lookup"><span data-stu-id="9eb37-808">It specifies that the application use an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class to provide membership services and sets the `passwordStrengthRegularExpression` attribute to a regular expression that validates that the password meets the following criteria:</span></span>  
  
-   <span data-ttu-id="9eb37-809">超过7个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-809">Is greater than seven characters.</span></span>  
  
-   <span data-ttu-id="9eb37-810">包含至少一个数字。</span><span class="sxs-lookup"><span data-stu-id="9eb37-810">Contains at least one digit.</span></span>  
  
-   <span data-ttu-id="9eb37-811">包含至少一个特殊字符（非字母数字）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-811">Contains at least one special (non-alphanumeric) character.</span></span>  
  
 <span data-ttu-id="9eb37-812">如果密码不符合这些条件，则成员资格提供程序不接受该密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-812">If the password does not meet these criteria, the password is not accepted by the membership provider.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          passwordStrengthRegularExpression=  
            "@\"(?=.{6,})(?=(.*\d){1,})(?=(.*\W){1,})" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-813">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> 实例前，访问了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-813">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-814">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-814">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="RequiresQuestionAndAnswer">
      <MemberSignature Language="C#" Value="public override bool RequiresQuestionAndAnswer { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool RequiresQuestionAndAnswer" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property RequiresQuestionAndAnswer As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool RequiresQuestionAndAnswer { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.RequiresQuestionAndAnswer : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-815">获取一个值，该值指示成员资格提供程序是否配置为要求在创建用户时提供密码提示问题和答案。</span><span class="sxs-lookup"><span data-stu-id="9eb37-815">Gets a value indicating whether the membership provider is configured to require a password question and answer when creating a user.</span></span></summary>
        <value><span data-ttu-id="9eb37-816">如果 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 对象配置为需要用户的密码提示问题和答案，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-816"><see langword="true" /> if the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> object is configured to require a password question and answer for a user; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="9eb37-817">默认值为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-817">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-818">在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> 应用程序的配置文件中，使用 `requiresQuestionAndAnswer` [成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素的特性设置该属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-818">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property is set in your application's configuration file using the `requiresQuestionAndAnswer` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element.</span></span> <span data-ttu-id="9eb37-819">如果未在应用程序的配置文件中设置该属性，则 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> 属性将设置为的默认值 `false` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-819">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property is set to the default value of `false`.</span></span>  
  
 <span data-ttu-id="9eb37-820">当 `requiresQuestionAndAnswer` 属性设置为时 `true` ，还必须设置这些附加属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-820">When the `requiresQuestionAndAnswer` attribute is set to `true`, you must also set these additional attributes.</span></span>  
  
-   <span data-ttu-id="9eb37-821">`attributeMapPasswordQuestion`和 `attributeMapPasswordAnswer` 必须映射到 Active Directory 架构中的属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-821">`attributeMapPasswordQuestion` and `attributeMapPasswordAnswer` must be mapped to attributes in the Active Directory schema.</span></span>  
  
 <span data-ttu-id="9eb37-822">如果未满足上述条件， <xref:System.Configuration.Provider.ProviderException> 则在初始化时引发。</span><span class="sxs-lookup"><span data-stu-id="9eb37-822">If the above criteria are not met, a <xref:System.Configuration.Provider.ProviderException> is thrown at initialization.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9eb37-823">您可以在创建用户时要求密码问题和答案，但将属性设置 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 为， `false` 以防止用户使用类更改其密码 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-823">You can require a password question and answer when creating a user, but set the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property to `false` to prevent users from changing their passwords using the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-824">下面的代码示例演示了一个 Web.config 条目，该条目将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例配置为启用密码重置。</span><span class="sxs-lookup"><span data-stu-id="9eb37-824">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to enable password resets.</span></span> <span data-ttu-id="9eb37-825">它使用给定了 "重置密码" 访问权限的用户的显式凭据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-825">It uses the explicit credentials of a user given the "reset password" access right.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9eb37-826">在 Web.config 文件中放置用户凭据时，会存在潜在的安全威胁。</span><span class="sxs-lookup"><span data-stu-id="9eb37-826">When you place user credentials in your Web.config file, there are potential security threats.</span></span> <span data-ttu-id="9eb37-827">对包含 Web.config 文件的目录具有访问权限的用户可以读取该文件，从而查看凭据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-827">Users with access rights to the directory containing the Web.config file can read the file, and thus see the credentials.</span></span> <span data-ttu-id="9eb37-828">有关如何防范此威胁的详细信息，请参阅[使用受保护的配置加密配置信息](https://docs.microsoft.com/previous-versions/aspnet/53tyfkaw(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="9eb37-828">For details on how to protect against this threat, see [Encrypting Configuration Information Using Protected Configuration](https://docs.microsoft.com/previous-versions/aspnet/53tyfkaw(v=vs.100)).</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionUsername="UserWithResetPasswordRights"  
          connectionPassword="PasswordForUser"  
          enablePasswordReset="true"  
          requiresQuestionAndAnswer="true"  
          attributeMapPasswordQuestion="PasswordQuestionADAttribute"  
          attributeMapPasswordAnswer="PasswordAnswerADAttribute"  
          attributeMapFailedPasswordAnswerCount="AnswerCountADAttribute"  
          attributeMapFailedPasswordAnswerTime="AnswerTimeADAttribute"  
          attributeMapFailedPasswordAnswerLockoutTime="LockOutTimeADAttribute" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-829">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> 实例之前，已尝试访问 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-829">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-830">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-830">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="RequiresUniqueEmail">
      <MemberSignature Language="C#" Value="public override bool RequiresUniqueEmail { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool RequiresUniqueEmail" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property RequiresUniqueEmail As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool RequiresUniqueEmail { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.RequiresUniqueEmail : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="9eb37-831">获取一个值，该值指示 Active Directory 服务器中存储的电子邮件地址是否必须是唯一的。</span><span class="sxs-lookup"><span data-stu-id="9eb37-831">Gets a value indicating whether an email address stored on the Active Directory server must be unique.</span></span></summary>
        <value><span data-ttu-id="9eb37-832"><see langword="true" />如果电子邮件地址必须唯一，则为;否则为 <see langword="false" /> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-832"><see langword="true" /> if email addresses must be unique; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="9eb37-833">默认值为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-833">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-834">当 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> 属性为时 `true` ， <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 如果 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A> 调用或方法，实例将确保当前范围内的任何其他用户不会使用电子邮件地址 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-834">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> property is `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance ensures that the email address is not used by any other user within the current scope when either the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A> or <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A> method is called.</span></span>  
  
 <span data-ttu-id="9eb37-835">在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> 应用程序的配置文件中，使用 `requiresUniqueEmail` [成员资格元素（ASP.NET 设置架构）](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100))元素的特性设置该属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-835">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> property is set in your application's configuration file using the `requiresUniqueEmail` attribute of the [membership Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/1b9hw62f(v=vs.100)) element.</span></span> <span data-ttu-id="9eb37-836">如果未在应用程序的配置文件中设置该属性，则 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> 属性将设置为的默认值 `false` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-836">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> property is set to the default value of `false`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9eb37-837">下面的代码示例演示一个 Web.config 条目，该条目将 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例配置为在 Active Directory 服务器上存储的用户需要唯一的电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="9eb37-837">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to require unique email addresses for users stored on the Active Directory server.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          requiresUniqueEmail="true" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-838">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> 实例之前，已尝试访问 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-838">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-839">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-839">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ResetPassword">
      <MemberSignature Language="C#" Value="public override string ResetPassword (string username, string passwordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string ResetPassword(string username, string passwordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ResetPassword (username As String, passwordAnswer As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ ResetPassword(System::String ^ username, System::String ^ passwordAnswer);" />
      <MemberSignature Language="F#" Value="override this.ResetPassword : string * string -&gt; string" Usage="activeDirectoryMembershipProvider.ResetPassword (username, passwordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="9eb37-840">要为其重置密码的用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-840">The user to reset the password for.</span></span></param>
        <param name="passwordAnswer"><span data-ttu-id="9eb37-841">指定的用户的密码提示问题答案。</span><span class="sxs-lookup"><span data-stu-id="9eb37-841">The password answer for the specified user.</span></span></param>
        <summary><span data-ttu-id="9eb37-842">将用户密码重置为自动生成的新密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-842">Resets a user's password to a new, automatically generated password.</span></span></summary>
        <returns><span data-ttu-id="9eb37-843">指定的用户的新密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-843">The new password for the specified user.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-844">类调用方法，将 <xref:System.Web.Security.Membership> Active Directory 数据存储区中的用户的密码重置为新随机生成的值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-844">The method is called by the <xref:System.Web.Security.Membership> class to reset the password for a user in the Active Directory data store to a new randomly generated value.</span></span> <span data-ttu-id="9eb37-845">返回新密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-845">The new password is returned.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9eb37-846">不保证通过方法创建的随机密码 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> 在属性中传递正则表达式 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-846">The random password created by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method is not guaranteed to pass the regular expression in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property.</span></span> <span data-ttu-id="9eb37-847">但是，随机密码会满足和属性所建立的条件 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-847">However, the random password will meet the criteria established by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> and <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> properties.</span></span>  
  
 <span data-ttu-id="9eb37-848">如果为方法提供的答案不正确 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> ，则跟踪无效密码答案尝试的内部计数器会递增1。</span><span class="sxs-lookup"><span data-stu-id="9eb37-848">If an incorrect answer is supplied to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method, the internal counter that tracks invalid password-answer attempts is incremented by one.</span></span> <span data-ttu-id="9eb37-849">这可能会导致用户在通过调用方法清除锁定状态之前无法登录 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-849">This can result in the user being unable to log on until the lock status is cleared by a call to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A> method.</span></span> <span data-ttu-id="9eb37-850">如果提供了正确的密码答案并且用户当前未锁定，则跟踪无效密码尝试的内部计数器将重置为零。</span><span class="sxs-lookup"><span data-stu-id="9eb37-850">If the correct password answer is supplied and the user is not currently locked out, then the internal counter that tracks invalid password attempts is reset to zero.</span></span> <span data-ttu-id="9eb37-851">有关详细信息，请参阅 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> 和 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-851">For more information, see the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> and <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> properties.</span></span>  
  
 <span data-ttu-id="9eb37-852">将从所有参数值中去除前导空格和尾随空格。</span><span class="sxs-lookup"><span data-stu-id="9eb37-852">Leading and trailing spaces are trimmed from all parameter values.</span></span>  
  
 <span data-ttu-id="9eb37-853">您可以 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> 通过先从属性获取对实例的引用来直接调用方法 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> <xref:System.Web.Security.Membership.Provider%2A?displayProperty=nameWithType> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-853">You can call the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method directly by first obtaining a reference to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance from the <xref:System.Web.Security.Membership.Provider%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="9eb37-854">提供程序使用子树搜索，从连接字符串中指定的搜索点开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-854">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-855">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-855">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="9eb37-856">若要在 Active Directory 服务器上设置密码， `connectionProtection` 属性必须设置为 <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-856">To set passwords on an Active Directory server, the `connectionProtection` attribute must be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span></span>  
  
 <span data-ttu-id="9eb37-857">使用 ADAM 服务器时， `connectionProtection` 可以将属性设置为 <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None> ，但前提是你显式配置了 ADAM 服务器以允许通过不安全连接进行密码更改。</span><span class="sxs-lookup"><span data-stu-id="9eb37-857">When using an ADAM server, the `connectionProtection` attribute can be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, but only if you explicitly configure the ADAM server to allow password changes over unsecured connections.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9eb37-858">你无法重置密码，除非用于连接到 Active Directory 服务器的凭据具有域管理员权限（不推荐）或 "重置密码" 访问权限。</span><span class="sxs-lookup"><span data-stu-id="9eb37-858">You cannot reset passwords unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "reset password" access right.</span></span>  
  
 <span data-ttu-id="9eb37-859">若要重置密码，必须满足以下所有条件：</span><span class="sxs-lookup"><span data-stu-id="9eb37-859">To reset a password, all of the following conditions must be true:</span></span>  
  
-   <span data-ttu-id="9eb37-860"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性必须设置为 `true`。</span><span class="sxs-lookup"><span data-stu-id="9eb37-860">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property must be set to `true`.</span></span>  
  
-   <span data-ttu-id="9eb37-861">必须修改 Active Directory 架构，使其包含用于存储密码提示问题和答案的属性，以及用于密码答案更改的三个跟踪字段。</span><span class="sxs-lookup"><span data-stu-id="9eb37-861">The Active Directory schema must be modified to contain attributes for storing the password question and answer, and the three tracking fields for password answer changes.</span></span>  
  
-   <span data-ttu-id="9eb37-862">`attributeMapPasswordQuestion` `attributeMapPasswordAnswer` `attributeMapFailedPasswordAnswerCount` `attributeMapFailedPasswordAnswerTime` `attributeMapFailedPasswordAnswerLockedTime` 必须在应用程序配置文件中设置、、、和属性。</span><span class="sxs-lookup"><span data-stu-id="9eb37-862">The `attributeMapPasswordQuestion`, `attributeMapPasswordAnswer`, `attributeMapFailedPasswordAnswerCount`, `attributeMapFailedPasswordAnswerTime`, and `attributeMapFailedPasswordAnswerLockedTime` attributes must be set in the application configuration file.</span></span>  
  
-   <span data-ttu-id="9eb37-863"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> 属性必须设置为 `true`。</span><span class="sxs-lookup"><span data-stu-id="9eb37-863">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property must be set to `true`.</span></span>  
  
-   <span data-ttu-id="9eb37-864">用于连接到 Active Directory 数据存储（进程帐户或显式凭据）的安全上下文必须具有足够的权限来更改密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-864">The security context for connecting to the Active Directory data store (either the process account or the explicit credentials) must have sufficient privileges to change passwords.</span></span> <span data-ttu-id="9eb37-865">用于连接到 Active Directory 服务器的凭据具有域管理员权限（不推荐）或 "重置密码" 访问权限。</span><span class="sxs-lookup"><span data-stu-id="9eb37-865">The credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "reset password" access right.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9eb37-866">在 Active Directory 服务器上设置的安全策略可能会使方法无法 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> 生成满足策略的密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-866">Security policies set on the Active Directory server may make it impossible for the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method to generate a password that satisfies the policies.</span></span> <span data-ttu-id="9eb37-867">方法的默认实现 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A> 将在运行 Windows Server 2003 SP1 的域控制器上生成满足默认密码策略的密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-867">The default implementation of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A> method will generate passwords that satisfy the default password policies on domain controllers running Windows Server 2003 SP1.</span></span> <span data-ttu-id="9eb37-868">如果由于 Active Directory 服务器上的安全策略而无法重置密码，则 <xref:System.Configuration.Provider.ProviderException> 会引发。</span><span class="sxs-lookup"><span data-stu-id="9eb37-868">If the password cannot be reset due to security policies on the Active Directory server, a <xref:System.Configuration.Provider.ProviderException> is thrown.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-869">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword(System.String,System.String)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-869">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword(System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="9eb37-870"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> 属性值为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-870">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> property value is <see langword="false" />.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9eb37-871"><paramref name="passwordAnswer" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-871"><paramref name="passwordAnswer" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="9eb37-872">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-872">-or-</span></span> 
 <span data-ttu-id="9eb37-873"><paramref name="username" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-873"><paramref name="username" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-874">修整后，<paramref name="passwordAnswer" /> 为空</span><span class="sxs-lookup"><span data-stu-id="9eb37-874"><paramref name="passwordAnswer" /> is empty after trimming</span></span> 
<span data-ttu-id="9eb37-875">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-875">-or-</span></span> 
 <span data-ttu-id="9eb37-876"><paramref name="passwordAnswer" /> 的长度超过 128 个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-876"><paramref name="passwordAnswer" /> exceeds 128 characters.</span></span>  
  
<span data-ttu-id="9eb37-877">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-877">-or-</span></span> 
 <span data-ttu-id="9eb37-878"><paramref name="username" /> 为空，或超过用户名允许的最大长度（通常为 256 个字符）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-878"><paramref name="username" /> is empty, or exceeds the maximum length allowed for user names (usually 256 characters).</span></span>  
  
<span data-ttu-id="9eb37-879">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-879">-or-</span></span> 
 <span data-ttu-id="9eb37-880"><paramref name="username" /> 包含逗号。</span><span class="sxs-lookup"><span data-stu-id="9eb37-880"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="9eb37-881">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-881">-or-</span></span> 
<span data-ttu-id="9eb37-882">用户名映射到 <see langword="userPrincipalName" />，但 <paramref name="username" /> 参数包含反斜杠。</span><span class="sxs-lookup"><span data-stu-id="9eb37-882">The user name is mapped to <see langword="userPrincipalName" /> but the <paramref name="username" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.Web.Security.MembershipPasswordException"><span data-ttu-id="9eb37-883">由于多次登录失败或多次重置密码提示问题失败，用户被锁定。</span><span class="sxs-lookup"><span data-stu-id="9eb37-883">The user is locked out because of too many bad logon attempts or too many attempted password-answer reset attempts.</span></span>  
  
<span data-ttu-id="9eb37-884">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-884">-or-</span></span> 
 <span data-ttu-id="9eb37-885"><paramref name="passwordAnswer" /> 与存储的密码提示问题答案不一致。</span><span class="sxs-lookup"><span data-stu-id="9eb37-885"><paramref name="passwordAnswer" /> does not match the stored password answer.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="9eb37-886"><paramref name="username" /> 所指定的用户在 Active Directory 数据存储区中不存在。</span><span class="sxs-lookup"><span data-stu-id="9eb37-886">The user specified in <paramref name="username" /> does not exist in the Active Directory data store.</span></span>  
  
<span data-ttu-id="9eb37-887">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-887">-or-</span></span> 
<span data-ttu-id="9eb37-888">生成的密码不能传递自定义验证处理程序。</span><span class="sxs-lookup"><span data-stu-id="9eb37-888">A generated password does not pass a custom validation handler.</span></span>  
  
<span data-ttu-id="9eb37-889">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-889">-or-</span></span> 
<span data-ttu-id="9eb37-890">生成的密码不够复杂，无法满足 Active Directory 服务器所设置的自定义密码策略。</span><span class="sxs-lookup"><span data-stu-id="9eb37-890">The generated password is not complex enough to satisfy custom password policies set on the Active Directory server.</span></span>  
  
<span data-ttu-id="9eb37-891">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-891">-or-</span></span> 
<span data-ttu-id="9eb37-892">无法建立到 Active Directory 应用程序模式服务器的安全连接，因此不能设置新密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-892">A secure connection cannot be made to an Active Directory Application Mode server to set the new password.</span></span></exception>
        <exception cref="T:System.Exception"><span data-ttu-id="9eb37-893">发生了未经处理的异常。</span><span class="sxs-lookup"><span data-stu-id="9eb37-893">An unhandled exception occurred.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-894">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-894">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="UnlockUser">
      <MemberSignature Language="C#" Value="public override bool UnlockUser (string username);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool UnlockUser(string username) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function UnlockUser (username As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool UnlockUser(System::String ^ username);" />
      <MemberSignature Language="F#" Value="override this.UnlockUser : string -&gt; bool" Usage="activeDirectoryMembershipProvider.UnlockUser username" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="9eb37-895">要为其清除锁定状态的成员资格用户的名称。</span><span class="sxs-lookup"><span data-stu-id="9eb37-895">The name of the membership user to clear the lock status for.</span></span></param>
        <summary><span data-ttu-id="9eb37-896">清除锁定，以便成员资格用户能够进行验证。</span><span class="sxs-lookup"><span data-stu-id="9eb37-896">Clears a lock so that a membership user can be validated.</span></span></summary>
        <returns><span data-ttu-id="9eb37-897">如果成功解除成员资格用户的锁定，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-897"><see langword="true" /> if the membership user was successfully unlocked; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="9eb37-898">如果数据存储区中找不到该成员资格用户，<see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> 方法也会返回 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-898">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> method also returns <see langword="false" /> when the membership user is not found in the data store.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-899"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>当在 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> 属性中指定的时间内超过属性 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> 或使用错误的密码登录失败时，用户通常被锁定，并且不能通过方法进行验证。</span><span class="sxs-lookup"><span data-stu-id="9eb37-899">Users are most commonly locked out and cannot be validated by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property is exceeded within the time specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property or when too many attempts have been made to log on using the wrong password.</span></span>  
  
 <span data-ttu-id="9eb37-900">如果 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性为 `true` ，则当解锁用户时，会重置错误密码的计数器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-900">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, when a user is unlocked the counters for bad passwords are reset.</span></span>  
  
 <span data-ttu-id="9eb37-901">提供程序使用子树搜索，从连接字符串中指定的搜索点开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-901">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-902">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-902">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="9eb37-903">删除 `username` 参数值的前导和尾随空格。</span><span class="sxs-lookup"><span data-stu-id="9eb37-903">Leading and trailing spaces are trimmed from the `username` parameter value.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-904"><paramref name="username" /> 为空，或超过用户名允许的最大长度（通常为 256 个字符）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-904"><paramref name="username" /> is empty, or exceeds the maximum length allowed for user names (usually 256 characters).</span></span>  
  
<span data-ttu-id="9eb37-905">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-905">-or-</span></span> 
 <span data-ttu-id="9eb37-906"><paramref name="username" /> 包含逗号。</span><span class="sxs-lookup"><span data-stu-id="9eb37-906"><paramref name="username" /> contains commas.</span></span>  
  
<span data-ttu-id="9eb37-907">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-907">-or-</span></span> 
<span data-ttu-id="9eb37-908">用户名映射到 <see langword="userPrincipalName" />，但 <paramref name="username" /> 参数包含反斜杠。</span><span class="sxs-lookup"><span data-stu-id="9eb37-908">The user name is mapped to <see langword="userPrincipalName" /> but the <paramref name="username" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9eb37-909"><paramref name="username" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-909"><paramref name="username" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-910">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-910">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-911">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-911">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="UpdateUser">
      <MemberSignature Language="C#" Value="public override void UpdateUser (System.Web.Security.MembershipUser user);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void UpdateUser(class System.Web.Security.MembershipUser user) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub UpdateUser (user As MembershipUser)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void UpdateUser(System::Web::Security::MembershipUser ^ user);" />
      <MemberSignature Language="F#" Value="override this.UpdateUser : System.Web.Security.MembershipUser -&gt; unit" Usage="activeDirectoryMembershipProvider.UpdateUser user" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.Web.Security.MembershipUser" />
      </Parameters>
      <Docs>
        <param name="user"><span data-ttu-id="9eb37-912">一个 <see cref="T:System.Web.Security.MembershipUser" /> 实例，它表示要更新的用户以及该用户的更新信息。</span><span class="sxs-lookup"><span data-stu-id="9eb37-912">A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user to update and the updated information for the user.</span></span></param>
        <summary><span data-ttu-id="9eb37-913">更新 Active Directory 数据存储区中某个用户的信息。</span><span class="sxs-lookup"><span data-stu-id="9eb37-913">Updates information about a user in the Active Directory data store.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-914">此方法由 <xref:System.Web.Security.Membership> 类调用，以更新 Active Directory 的数据存储中的用户信息。</span><span class="sxs-lookup"><span data-stu-id="9eb37-914">This method is called by the <xref:System.Web.Security.Membership> class to update user information in the Active Directory data store.</span></span> <span data-ttu-id="9eb37-915"><xref:System.Web.Security.MembershipUser.Email%2A> <xref:System.Web.Security.MembershipUser.Comment%2A> <xref:System.Web.Security.MembershipUser.IsApproved%2A> 为指定的成员资格用户更新、和属性值。</span><span class="sxs-lookup"><span data-stu-id="9eb37-915">The <xref:System.Web.Security.MembershipUser.Email%2A>, <xref:System.Web.Security.MembershipUser.Comment%2A>, and <xref:System.Web.Security.MembershipUser.IsApproved%2A> property values are updated for the specified membership user.</span></span> <span data-ttu-id="9eb37-916">所有其他属性都被忽略。</span><span class="sxs-lookup"><span data-stu-id="9eb37-916">All other properties are ignored.</span></span>  
  
 <span data-ttu-id="9eb37-917">参数的最大长度 `username` 为256个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-917">The maximum length for the `username` parameter is 256 characters.</span></span> <span data-ttu-id="9eb37-918">属性的最大长度 <xref:System.Web.Security.MembershipUser.Email%2A> 为256个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-918">The maximum length for the <xref:System.Web.Security.MembershipUser.Email%2A> property is 256 characters.</span></span>  
  
 <span data-ttu-id="9eb37-919">成员资格用户的密码不能使用方法进行更新 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-919">The password for a membership user cannot be updated using the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A> method.</span></span> <span data-ttu-id="9eb37-920">若要更新成员资格用户的密码，请使用 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-920">To update the password for a membership user, use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A> method.</span></span>  
  
 <span data-ttu-id="9eb37-921">提供程序使用子树搜索，从连接字符串中指定的搜索点开始。</span><span class="sxs-lookup"><span data-stu-id="9eb37-921">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="9eb37-922">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-922">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-923">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-923">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9eb37-924"><paramref name="user" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-924"><paramref name="user" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="9eb37-925">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-925">-or-</span></span> 
<span data-ttu-id="9eb37-926"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> 属性为 <see langword="true" />，但所提供的 <see cref="T:System.Web.Security.MembershipUser" /> 实例的电子邮件地址为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-926">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property is <see langword="true" /> but the email address from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="9eb37-927">修整后，<see cref="P:System.Web.Security.MembershipUser.Email" /> 属性为空。</span><span class="sxs-lookup"><span data-stu-id="9eb37-927">The <see cref="P:System.Web.Security.MembershipUser.Email" /> property is empty after trimming.</span></span>  
  
<span data-ttu-id="9eb37-928">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-928">-or-</span></span> 
<span data-ttu-id="9eb37-929"><see cref="P:System.Web.Security.MembershipUser.Email" /> 属性超过 256 个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-929">The <see cref="P:System.Web.Security.MembershipUser.Email" /> property exceeds 256 characters.</span></span>  
  
<span data-ttu-id="9eb37-930">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-930">-or-</span></span> 
<span data-ttu-id="9eb37-931"><see cref="P:System.Web.Security.MembershipUser.Comment" /> 属性超过 1024 个字符。</span><span class="sxs-lookup"><span data-stu-id="9eb37-931">The <see cref="P:System.Web.Security.MembershipUser.Comment" /> property exceeds 1024 characters.</span></span>  
  
<span data-ttu-id="9eb37-932">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-932">-or-</span></span> 
<span data-ttu-id="9eb37-933"><see cref="P:System.Web.Security.MembershipUser.Comment" /> 属性为空。</span><span class="sxs-lookup"><span data-stu-id="9eb37-933">The <see cref="P:System.Web.Security.MembershipUser.Comment" /> property is empty.</span></span>  
  
<span data-ttu-id="9eb37-934">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-934">-or-</span></span> 
<span data-ttu-id="9eb37-935">所提供的 <see cref="T:System.Web.Security.MembershipUser" /> 实例的用户名为空，或超过用户名允许的最大长度（通常为 256 个字符）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-935">The user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance is empty, or exceeds the maximum length allowed for user names (usually 256 characters).</span></span>  
  
<span data-ttu-id="9eb37-936">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-936">-or-</span></span> 
<span data-ttu-id="9eb37-937">所提供的 <see cref="T:System.Web.Security.MembershipUser" /> 实例的用户名包含逗号。</span><span class="sxs-lookup"><span data-stu-id="9eb37-937">The user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance contains commas.</span></span>  
  
<span data-ttu-id="9eb37-938">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-938">-or-</span></span> 
<span data-ttu-id="9eb37-939">用户名已映射到 <see langword="userPrincipalName" />，但所提供的 <see cref="T:System.Web.Security.MembershipUser" /> 实例的用户名包含反斜杠。</span><span class="sxs-lookup"><span data-stu-id="9eb37-939">The user name is mapped to <see langword="userPrincipalName" /> but the user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance contains backslashes.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="9eb37-940">Active Directory 数据存储区中找不到指定的用户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-940">The specified user is not found in the Active Directory data store.</span></span>  
  
<span data-ttu-id="9eb37-941">- 或 -</span><span class="sxs-lookup"><span data-stu-id="9eb37-941">-or-</span></span> 
<span data-ttu-id="9eb37-942"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> 属性为 <see langword="true" />，而 <see cref="P:System.Web.Security.MembershipUser.Email" /> 属性的新值与现有电子邮件地址重复。</span><span class="sxs-lookup"><span data-stu-id="9eb37-942">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property is <see langword="true" />, and the new value of the <see cref="P:System.Web.Security.MembershipUser.Email" /> property duplicates an existing email address.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-943">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-943">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ValidateUser">
      <MemberSignature Language="C#" Value="public override bool ValidateUser (string username, string password);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ValidateUser(string username, string password) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ValidateUser (username As String, password As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ValidateUser(System::String ^ username, System::String ^ password);" />
      <MemberSignature Language="F#" Value="override this.ValidateUser : string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ValidateUser (username, password)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="9eb37-944">要验证的用户的名称。</span><span class="sxs-lookup"><span data-stu-id="9eb37-944">The name of the user to validate.</span></span></param>
        <param name="password"><span data-ttu-id="9eb37-945">指定的用户的密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-945">The password for the specified user.</span></span></param>
        <summary><span data-ttu-id="9eb37-946">验证 Active Directory 数据存储区中是否存在指定的用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="9eb37-946">Verifies that the specified user name and password exist in the Active Directory data store.</span></span></summary>
        <returns><span data-ttu-id="9eb37-947">如果指定的 <paramref name="username" /> 和 <paramref name="password" /> 有效，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-947"><see langword="true" /> if the specified <paramref name="username" /> and <paramref name="password" /> are valid; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="9eb37-948">如果 Active Directory 数据存储区中不存在指定的用户，<see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> 方法则返回 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9eb37-948">If the user specified does not exist in the Active Directory data store, the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> method returns <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9eb37-949">此方法由 <xref:System.Web.Security.Membership> 类调用，以根据 Active Directory 数据存储验证用户凭据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-949">This method is called by the <xref:System.Web.Security.Membership> class to validate user credentials against the Active Directory data store.</span></span>  
  
 <span data-ttu-id="9eb37-950">如果 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性为， `true` 并且提供的凭据有效，则会重置错误密码答案的用户跟踪计数器。</span><span class="sxs-lookup"><span data-stu-id="9eb37-950">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true` and the supplied credentials are valid, the user's tracking counters for bad password answers are reset.</span></span>  
  
 <span data-ttu-id="9eb37-951"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> `false` 如果在以下情况下提供了正确的凭据，则该方法可能会返回：</span><span class="sxs-lookup"><span data-stu-id="9eb37-951">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method may return `false` when the correct credentials are supplied, under the following circumstances:</span></span>  
  
1.  <span data-ttu-id="9eb37-952">由于登录尝试失败次数过多，目录服务器已锁定用户帐户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-952">The user account was locked out by the directory server because of too many failed logon attempts.</span></span> <span data-ttu-id="9eb37-953">在目录的锁定持续时间通过之前，用户将无法登录。</span><span class="sxs-lookup"><span data-stu-id="9eb37-953">The user will not be able to log on until the directory's lockout duration passes.</span></span>  
  
2.  <span data-ttu-id="9eb37-954">如果 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性为 `true` ，则当用户提供错误密码答案太多次时，用户帐户将被锁定。</span><span class="sxs-lookup"><span data-stu-id="9eb37-954">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user account will be locked if the user supplied a bad password answer too many times.</span></span> <span data-ttu-id="9eb37-955">用户的帐户将在属性中指定的时间过后解除锁定 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-955">The user's account will unlock after the time specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property has passed.</span></span>  
  
3.  <span data-ttu-id="9eb37-956">用户必须存在于连接字符串中指定的容器中。</span><span class="sxs-lookup"><span data-stu-id="9eb37-956">The user must exist in the container specified in the connection string.</span></span> <span data-ttu-id="9eb37-957">为位于不同容器或不同域中的用户帐户提供有效的凭据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-957">Valid credentials are supplied for a user account located in a different container or in a different domain.</span></span> <span data-ttu-id="9eb37-958">用户必须存在于连接字符串中指定的容器中。</span><span class="sxs-lookup"><span data-stu-id="9eb37-958">The user must exist in the container specified in the connection string.</span></span>  
  
 <span data-ttu-id="9eb37-959">验证用户时，提供程序通过使用指定的用户名和密码（而不是在应用程序配置文件中配置的凭据）连接到 Active Directory 的数据存储区来验证凭据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-959">When validating a user, the provider validates the credentials by connecting to the Active Directory data store using the specified user name and password, not the credentials configured in the application configuration file.</span></span>  
  
 <span data-ttu-id="9eb37-960">不过， <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 由于以下原因，实例将使用配置的凭据连接到目录。</span><span class="sxs-lookup"><span data-stu-id="9eb37-960">However, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will connect to the directory using the configured credentials for the following reasons.</span></span>  
  
-   <span data-ttu-id="9eb37-961">若要确认用户在搜索范围内是否存在由 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例的连接字符串确定的。</span><span class="sxs-lookup"><span data-stu-id="9eb37-961">To confirm that a user exists within the search scope as determined by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance's connection string.</span></span> <span data-ttu-id="9eb37-962">提供程序在连接字符串中指定的搜索点处开始使用子树搜索来确定用户是否存在。</span><span class="sxs-lookup"><span data-stu-id="9eb37-962">The provider uses a subtree search starting at the search point specified in the connection string to determine whether a user exists.</span></span> <span data-ttu-id="9eb37-963">用户必须存在于指定的容器中。</span><span class="sxs-lookup"><span data-stu-id="9eb37-963">The user must exist in the specified container.</span></span> <span data-ttu-id="9eb37-964">不会验证在连接字符串的指定容器外有效的凭据。</span><span class="sxs-lookup"><span data-stu-id="9eb37-964">Credentials that are valid outside the connection string's specified container will not be validated.</span></span> <span data-ttu-id="9eb37-965">有关 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 连接字符串的详细信息，请参阅类主题。</span><span class="sxs-lookup"><span data-stu-id="9eb37-965">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
-   <span data-ttu-id="9eb37-966">如果 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> 属性为 `true` ，则 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 实例将使用配置的凭据来加载用户实例，以检查用户是否已被锁定，因为他（她）的尝试更改密码答案失败了太多。</span><span class="sxs-lookup"><span data-stu-id="9eb37-966">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will use the configured credentials to load the user instance to check whether the user has been locked out because he or she has made too many failed attempts to change the password answer.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9eb37-967">连接到已启用 "来宾" 帐户的 Active Directory 域控制器是一个潜在的安全威胁。</span><span class="sxs-lookup"><span data-stu-id="9eb37-967">Connecting to an Active Directory domain controller with the "Guest" account enabled is a potential security threat.</span></span> <span data-ttu-id="9eb37-968">在启用了 "来宾" 帐户的 Active Directory 域控制器上进行的所有验证尝试都将成功。</span><span class="sxs-lookup"><span data-stu-id="9eb37-968">All validation attempts made on an Active Directory domain controller with the "Guest" account enabled will succeed.</span></span> <span data-ttu-id="9eb37-969">若要在使用 Active Directory 域控制器时提高安全性，应禁用域控制器上的 "来宾" 帐户。</span><span class="sxs-lookup"><span data-stu-id="9eb37-969">To improve security when using an Active Directory domain controller, you should disable the "Guest" account on the domain controller.</span></span>  
  
 <span data-ttu-id="9eb37-970"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>当满足以下条件之一时，实例将尝试对 Active Directory 进行并发绑定：</span><span class="sxs-lookup"><span data-stu-id="9eb37-970">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will attempt a concurrent bind against Active Directory when one of the following conditions is met:</span></span>  
  
-   <span data-ttu-id="9eb37-971"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> 属性设置为 <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>。</span><span class="sxs-lookup"><span data-stu-id="9eb37-971">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property is set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>.</span></span>  
  
-   <span data-ttu-id="9eb37-972"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A>属性设置为 <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> ，并且实例选择 SSL <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 来保护连接。</span><span class="sxs-lookup"><span data-stu-id="9eb37-972">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property is set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> and SSL is chosen by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to secure the connection.</span></span>  
  
 <span data-ttu-id="9eb37-973">此外，若要进行并发绑定，必须满足以下条件：</span><span class="sxs-lookup"><span data-stu-id="9eb37-973">In addition, for a concurrent bind to be made, the following conditions must be true:</span></span>  
  
-   <span data-ttu-id="9eb37-974">目录服务器必须在 Windows Server 2003 上运行。</span><span class="sxs-lookup"><span data-stu-id="9eb37-974">The directory server must be running on Windows Server 2003.</span></span>  
  
-   <span data-ttu-id="9eb37-975">运行实例的 Web 服务器的操作系统 <xref:System.Web.Security.ActiveDirectoryMembershipProvider> 必须支持并发绑定（例如，Windows server 2003）。</span><span class="sxs-lookup"><span data-stu-id="9eb37-975">The operating system of the Web server running the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance must support concurrent binds (for example, Windows Server 2003).</span></span>  
  
 <span data-ttu-id="9eb37-976">使用并发绑定时，不会在目录中更新用户的上次登录日期;因此，该 <xref:System.Web.Security.ActiveDirectoryMembershipUser.LastLoginDate%2A> 属性不能依赖于。</span><span class="sxs-lookup"><span data-stu-id="9eb37-976">When a concurrent bind is used, the last logon date for the user is not updated in the directory; therefore, the <xref:System.Web.Security.ActiveDirectoryMembershipUser.LastLoginDate%2A> property cannot be relied on.</span></span>  
  
 <span data-ttu-id="9eb37-977">前导空格和尾随空格从参数中去除 `username` 。</span><span class="sxs-lookup"><span data-stu-id="9eb37-977">Leading and trailing spaces are trimmed from the `username` parameter.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="9eb37-978">在初始化 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> 实例前，调用了 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9eb37-978">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/yh26yfzy(v=vs.100)"><span data-ttu-id="9eb37-979">ASP.NET 成员资格简介</span><span class="sxs-lookup"><span data-stu-id="9eb37-979">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
  </Members>
</Type>
