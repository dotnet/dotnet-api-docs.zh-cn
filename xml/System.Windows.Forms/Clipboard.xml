<Type Name="Clipboard" FullName="System.Windows.Forms.Clipboard">
  <Metadata><Meta Name="ms.openlocfilehash" Value="2d3c7533ae6dc76dd26563bf194ddcc4e643a764" /><Meta Name="ms.sourcegitcommit" Value="b6b9d5f3f9c7eb43f14a8a1a68d044603cb8ed73" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="05/18/2020" /><Meta Name="ms.locfileid" Value="83522359" /></Metadata><TypeSignature Language="C#" Value="public static class Clipboard" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi abstract sealed beforefieldinit Clipboard extends System.Object" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0" />
  <TypeSignature Language="DocId" Value="T:System.Windows.Forms.Clipboard" />
  <TypeSignature Language="VB.NET" Value="Public Class Clipboard" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0" />
  <TypeSignature Language="C++ CLI" Value="public ref class Clipboard abstract sealed" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0" />
  <TypeSignature Language="F#" Value="type Clipboard = class" />
  <TypeSignature Language="C#" Value="public sealed class Clipboard" FrameworkAlternate="netcore-3.0;netcore-3.1;netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit Clipboard extends System.Object" FrameworkAlternate="netcore-3.0;netcore-3.1;netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class Clipboard" FrameworkAlternate="netcore-3.0;netcore-3.1;netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
  <TypeSignature Language="C++ CLI" Value="public ref class Clipboard sealed" FrameworkAlternate="netcore-3.0;netcore-3.1;netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
  <AssemblyInfo>
    <AssemblyName>System.Windows.Forms</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>5.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="c61a3-101">提供将数据置于系统剪贴板中以及从中检索数据的方法。</span><span class="sxs-lookup"><span data-stu-id="c61a3-101">Provides methods to place data on and retrieve data from the system Clipboard.</span></span> <span data-ttu-id="c61a3-102">无法继承此类。</span><span class="sxs-lookup"><span data-stu-id="c61a3-102">This class cannot be inherited.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-103">有关要用于 <xref:System.Windows.Forms.Clipboard> 类的预定义格式的列表，请参见 <xref:System.Windows.Forms.DataFormats> 类。</span><span class="sxs-lookup"><span data-stu-id="c61a3-103">For a list of predefined formats to use with the <xref:System.Windows.Forms.Clipboard> class, see the <xref:System.Windows.Forms.DataFormats> class.</span></span>  
  
 <span data-ttu-id="c61a3-104">调用 <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> 将数据放置在剪贴板上，并替换其当前内容。</span><span class="sxs-lookup"><span data-stu-id="c61a3-104">Call <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> to put data on the Clipboard, replacing its current contents.</span></span> <span data-ttu-id="c61a3-105">若要在剪贴板上放置数据的持久性副本，请将 `copy` 参数设置为 `true`。</span><span class="sxs-lookup"><span data-stu-id="c61a3-105">To place a persistent copy of the data on the Clipboard, set the `copy` parameter to `true`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-106">若要以多种格式将数据置于剪贴板，请使用 <xref:System.Windows.Forms.DataObject> 类或 <xref:System.Windows.Forms.IDataObject> 实现。</span><span class="sxs-lookup"><span data-stu-id="c61a3-106">To place data on the Clipboard in multiple formats, use the <xref:System.Windows.Forms.DataObject> class or an <xref:System.Windows.Forms.IDataObject> implementation.</span></span> <span data-ttu-id="c61a3-107">将数据置于剪贴板中的多种格式，以最大程度地提高可能不知道其格式要求的目标应用程序可以成功检索数据的可能性。</span><span class="sxs-lookup"><span data-stu-id="c61a3-107">Place data on the Clipboard in multiple formats to maximize the possibility that a target application, whose format requirements you might not know, can successfully retrieve the data.</span></span>  
  
 <span data-ttu-id="c61a3-108">调用 <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> 从剪贴板检索数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-108">Call <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> to retrieve data from the Clipboard.</span></span> <span data-ttu-id="c61a3-109">数据作为实现 <xref:System.Windows.Forms.IDataObject> 接口的对象返回。</span><span class="sxs-lookup"><span data-stu-id="c61a3-109">The data is returned as an object that implements the <xref:System.Windows.Forms.IDataObject> interface.</span></span> <span data-ttu-id="c61a3-110">使用 <xref:System.Windows.Forms.DataFormats> 中 <xref:System.Windows.Forms.IDataObject> 和字段指定的方法从对象中提取数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-110">Use the methods specified by <xref:System.Windows.Forms.IDataObject> and fields in <xref:System.Windows.Forms.DataFormats> to extract the data from the object.</span></span> <span data-ttu-id="c61a3-111">如果您不知道您检索的数据的格式，请调用 <xref:System.Windows.Forms.IDataObject> 接口的 <xref:System.Windows.Forms.IDataObject.GetFormats%2A> 方法，以获取存储数据的所有格式的列表。</span><span class="sxs-lookup"><span data-stu-id="c61a3-111">If you do not know the format of the data you retrieved, call the <xref:System.Windows.Forms.IDataObject.GetFormats%2A> method of the <xref:System.Windows.Forms.IDataObject> interface to get a list of all formats that data is stored in.</span></span> <span data-ttu-id="c61a3-112">然后调用 <xref:System.Windows.Forms.IDataObject> 接口的 <xref:System.Windows.Forms.IDataObject.GetData%2A> 方法，并指定应用程序可以使用的格式。</span><span class="sxs-lookup"><span data-stu-id="c61a3-112">Then call the <xref:System.Windows.Forms.IDataObject.GetData%2A> method of the <xref:System.Windows.Forms.IDataObject> interface, and specify a format that your application can use.</span></span>  
  
 <span data-ttu-id="c61a3-113">在 [!INCLUDE[dnprdnext](~/includes/dnprdnext-md.md)]中，<xref:System.Windows.Forms.Clipboard> 类提供其他方法，使系统剪贴板更易于使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-113">In [!INCLUDE[dnprdnext](~/includes/dnprdnext-md.md)], the <xref:System.Windows.Forms.Clipboard> class provides additional methods that make it easier to work with the system Clipboard.</span></span> <span data-ttu-id="c61a3-114">调用 <xref:System.Windows.Forms.Clipboard.Clear%2A> 方法从剪贴板中删除所有数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-114">Call the <xref:System.Windows.Forms.Clipboard.Clear%2A> method to remove all data from the Clipboard.</span></span> <span data-ttu-id="c61a3-115">若要向剪贴板添加特定格式的数据，并替换现有数据，请调用相应的 `Set`*格式*方法（如 <xref:System.Windows.Forms.Clipboard.SetText%2A>），或调用 <xref:System.Windows.Forms.Clipboard.SetData%2A> 方法来指定格式。</span><span class="sxs-lookup"><span data-stu-id="c61a3-115">To add data of a particular format to the Clipboard, replacing the existing data, call the appropriate `Set`*Format* method, such as <xref:System.Windows.Forms.Clipboard.SetText%2A>, or call the <xref:System.Windows.Forms.Clipboard.SetData%2A> method to specify the format.</span></span> <span data-ttu-id="c61a3-116">若要从剪贴板检索特定格式的数据，请首先调用适当的 `Contains`*格式*方法（如 <xref:System.Windows.Forms.Clipboard.ContainsText%2A>）方法，以确定剪贴板是否包含该格式的数据，然后调用相应的 `Get`*格式*方法（如 <xref:System.Windows.Forms.Clipboard.GetText%2A>），以便在剪贴板包含数据时检索数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-116">To retrieve data of a particular format from the Clipboard, first call the appropriate `Contains`*Format* method (such as <xref:System.Windows.Forms.Clipboard.ContainsText%2A>) method to determine whether the Clipboard contains data in that format, and then call the appropriate `Get`*Format* method (such as <xref:System.Windows.Forms.Clipboard.GetText%2A>) to retrieve the data if the Clipboard contains it.</span></span> <span data-ttu-id="c61a3-117">若要指定这些操作中的格式，请改为调用 <xref:System.Windows.Forms.Clipboard.ContainsData%2A> 和 <xref:System.Windows.Forms.Clipboard.GetData%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="c61a3-117">To specify the format in these operations, call the <xref:System.Windows.Forms.Clipboard.ContainsData%2A> and <xref:System.Windows.Forms.Clipboard.GetData%2A> methods instead.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-118">所有基于 Windows 的应用程序共享系统剪贴板，因此当你切换到另一个应用程序时，内容可能会更改。</span><span class="sxs-lookup"><span data-stu-id="c61a3-118">All Windows-based applications share the system Clipboard, so the contents are subject to change when you switch to another application.</span></span>  
>   
>  <span data-ttu-id="c61a3-119">对象必须是可序列化的，才能将其放在剪贴板上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-119">An object must be serializable for it to be put on the Clipboard.</span></span> <span data-ttu-id="c61a3-120">如果将非序列化对象传递到剪贴板方法，则该方法将失败，且不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="c61a3-120">If you pass a non-serializable object to a Clipboard method, the method will fail without throwing an exception.</span></span> <span data-ttu-id="c61a3-121">有关序列化的详细信息，请参阅 <xref:System.Runtime.Serialization>。</span><span class="sxs-lookup"><span data-stu-id="c61a3-121">See <xref:System.Runtime.Serialization> for more information on serialization.</span></span> <span data-ttu-id="c61a3-122">如果目标应用程序需要非常具体的数据格式，则在序列化过程中添加到数据的标头可能会阻止应用程序识别数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-122">If your target application requires a very specific data format, the headers added to the data in the serialization process may prevent the application from recognizing your data.</span></span> <span data-ttu-id="c61a3-123">若要保留数据格式，请将数据作为 <xref:System.Byte> 数组添加到 <xref:System.IO.MemoryStream> 并将 <xref:System.IO.MemoryStream> 传递到 <xref:System.Windows.Forms.DataObject.SetData%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="c61a3-123">To preserve your data format, add your data as a <xref:System.Byte> array to a <xref:System.IO.MemoryStream> and pass the <xref:System.IO.MemoryStream> to the <xref:System.Windows.Forms.DataObject.SetData%2A> method.</span></span>  
>   
>  <span data-ttu-id="c61a3-124"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-124">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-125">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-125">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
>   
>  <span data-ttu-id="c61a3-126">使用带有剪贴板的图元文件格式时，可能需要特别注意。</span><span class="sxs-lookup"><span data-stu-id="c61a3-126">Special considerations may be necessary when using the metafile format with the Clipboard.</span></span> <span data-ttu-id="c61a3-127">由于 <xref:System.Windows.Forms.DataObject> 类的当前实现中存在限制，因此使用较旧的图元文件格式的应用程序可能无法识别 .NET Framework 使用的图元文件格式。</span><span class="sxs-lookup"><span data-stu-id="c61a3-127">Due to a limitation in the current implementation of the <xref:System.Windows.Forms.DataObject> class, the metafile format used by the .NET Framework may not be recognized by applications that use an older metafile format.</span></span> <span data-ttu-id="c61a3-128">在这种情况下，必须与 Win32 剪贴板应用程序编程接口（Api）进行互操作。</span><span class="sxs-lookup"><span data-stu-id="c61a3-128">In this case, you must interoperate with the Win32 Clipboard application programming interfaces (APIs).</span></span>
  
   
  
## Examples  
 <span data-ttu-id="c61a3-129">下面的代码示例使用 <xref:System.Windows.Forms.Clipboard> 方法将数据放置在系统剪贴板上并从中检索数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-129">The following code example uses <xref:System.Windows.Forms.Clipboard> methods to place data on and retrieve it from the system Clipboard.</span></span> <span data-ttu-id="c61a3-130">此代码假定已创建 `button1`、`button2`、`textBox1`和 `textBox2`，并将其放置在窗体上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-130">This code assumes `button1`, `button2`, `textBox1`, and `textBox2` have been created and placed on the form.</span></span>  
  
 <span data-ttu-id="c61a3-131">`button1_Click` 方法将调用 <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> 以获取文本框中的选定文本，并将其放置在系统剪贴板上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-131">The `button1_Click` method calls <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> to take selected text from the text box and place it on the system Clipboard.</span></span>  
  
 <span data-ttu-id="c61a3-132">`button2_Click` 方法调用 <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> 从系统剪贴板检索数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-132">The `button2_Click` method calls <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> to retrieve data from the system Clipboard.</span></span> <span data-ttu-id="c61a3-133">代码使用 <xref:System.Windows.Forms.IDataObject> 和 <xref:System.Windows.Forms.DataFormats> 提取返回的数据，并在 `textBox2`中显示数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-133">The code uses <xref:System.Windows.Forms.IDataObject> and <xref:System.Windows.Forms.DataFormats> to extract the data returned and displays the data in `textBox2`.</span></span>  
  
 [!code-cpp[Classic Clipboard Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic Clipboard Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Clipboard Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic Clipboard Example/CS/source.cs#1)]
 [!code-vb[Classic Clipboard Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic Clipboard Example/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Windows.Forms.DataObject" />
    <altmember cref="T:System.Windows.Forms.DataFormats" />
    <altmember cref="T:System.Windows.Forms.IDataObject" />
    <related type="Article" href="https://msdn.microsoft.com/library/15abda8b-0527-47c7-aedb-77ab595f2bf1"><span data-ttu-id="c61a3-134">Windows 窗体中的其他安全注意事项</span><span class="sxs-lookup"><span data-stu-id="c61a3-134">Additional Security Considerations in Windows Forms</span></span></related>
  </Docs>
  <Members>
    <Member MemberName="Clear">
      <MemberSignature Language="C#" Value="public static void Clear ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Clear() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.Clear" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Clear ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Clear();" />
      <MemberSignature Language="F#" Value="static member Clear : unit -&gt; unit" Usage="System.Windows.Forms.Clipboard.Clear " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c61a3-135">从剪贴板中移除所有数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-135">Removes all data from the Clipboard.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-136">由于剪贴板由多个进程共享，因此调用此方法可能会影响这些进程。</span><span class="sxs-lookup"><span data-stu-id="c61a3-136">Because the Clipboard is shared by multiple processes, calling this method may have an impact on those processes.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-137"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-137">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-138">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-138">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-139">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-139">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#1)]
 [!code-vb[System.Windows.Forms.Clipboard#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-140">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-140">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-141">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-141">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-142">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-142">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-143">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-143">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="ContainsAudio">
      <MemberSignature Language="C#" Value="public static bool ContainsAudio ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool ContainsAudio() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.ContainsAudio" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ContainsAudio () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool ContainsAudio();" />
      <MemberSignature Language="F#" Value="static member ContainsAudio : unit -&gt; bool" Usage="System.Windows.Forms.Clipboard.ContainsAudio " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c61a3-144">指示在剪贴板中是否存在 <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> 格式的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-144">Indicates whether there is data on the Clipboard in the <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> format.</span></span></summary>
        <returns><span data-ttu-id="c61a3-145">如果剪贴板中有音频数据，则为 <see langword="true" />；否则为，<see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-145"><see langword="true" /> if there is audio data on the Clipboard; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-146">使用此方法可以在使用 <xref:System.Windows.Forms.Clipboard.GetAudioStream%2A> 方法检索音频数据之前，确定剪贴板是否包含音频数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-146">Use this method to determine whether the Clipboard contains audio data before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetAudioStream%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-147"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-147">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-148">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-148">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-149">下面的代码示例演示如何使用此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-149">The following code example demonstrates the use of this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#20](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#20)]
 [!code-vb[System.Windows.Forms.Clipboard#20](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-150">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-150">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-151">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-151">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-152">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-152">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-153">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-153">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <altmember cref="F:System.Windows.Forms.DataFormats.WaveAudio" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetAudioStream" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.SetAudio" />
      </Docs>
    </Member>
    <Member MemberName="ContainsData">
      <MemberSignature Language="C#" Value="public static bool ContainsData (string format);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool ContainsData(string format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.ContainsData(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ContainsData (format As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool ContainsData(System::String ^ format);" />
      <MemberSignature Language="F#" Value="static member ContainsData : string -&gt; bool" Usage="System.Windows.Forms.Clipboard.ContainsData format" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.String" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="c61a3-154">要查找的数据格式。</span><span class="sxs-lookup"><span data-stu-id="c61a3-154">The format of the data to look for.</span></span> <span data-ttu-id="c61a3-155">请参见 <see cref="T:System.Windows.Forms.DataFormats" /> 以获取预定义的格式。</span><span class="sxs-lookup"><span data-stu-id="c61a3-155">See <see cref="T:System.Windows.Forms.DataFormats" /> for predefined formats.</span></span></param>
        <summary><span data-ttu-id="c61a3-156">指示剪贴板中是否存在指定格式的数据，或可转换成此格式的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-156">Indicates whether there is data on the Clipboard that is in the specified format or can be converted to that format.</span></span></summary>
        <returns><span data-ttu-id="c61a3-157">如果在剪贴板中存在指定 <paramref name="format" /> 或可以转换成该格式的数据，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-157"><see langword="true" /> if there is data on the Clipboard that is in the specified <paramref name="format" /> or can be converted to that format; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-158"><xref:System.Windows.Forms.DataFormats> 类包含可与此方法一起使用的预定义格式名称。</span><span class="sxs-lookup"><span data-stu-id="c61a3-158">The <xref:System.Windows.Forms.DataFormats> class contains pre-defined format names that you can use with this method.</span></span>  
  
 <span data-ttu-id="c61a3-159">使用此方法来确定剪贴板是否包含指定格式的数据或兼容的格式，然后再使用 <xref:System.Windows.Forms.Clipboard.GetData%2A> 方法检索数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-159">Use this method to determine whether the Clipboard contains data in the specified format or a compatible format before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetData%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-160">如果数据已存储，则可以将其转换为另一种格式，这种格式指定允许该转换，并且请求的格式与存储格式兼容。</span><span class="sxs-lookup"><span data-stu-id="c61a3-160">Data can be converted to another format if it was stored specifying that conversion is allowed, and if the requested format is compatible with the stored format.</span></span> <span data-ttu-id="c61a3-161">例如，以 Unicode 形式存储的数据可以转换为文本。</span><span class="sxs-lookup"><span data-stu-id="c61a3-161">For example, data stored as Unicode can be converted to text.</span></span>  
>   
>  <span data-ttu-id="c61a3-162"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-162">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-163">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-163">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-164">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-164">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#10)]
 [!code-vb[System.Windows.Forms.Clipboard#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-165">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-165">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-166">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-166">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-167">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-167">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-168">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-168">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetData(System.String)" />
        <altmember cref="M:System.Windows.Forms.Clipboard.SetData(System.String,System.Object)" />
      </Docs>
    </Member>
    <Member MemberName="ContainsFileDropList">
      <MemberSignature Language="C#" Value="public static bool ContainsFileDropList ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool ContainsFileDropList() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.ContainsFileDropList" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ContainsFileDropList () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool ContainsFileDropList();" />
      <MemberSignature Language="F#" Value="static member ContainsFileDropList : unit -&gt; bool" Usage="System.Windows.Forms.Clipboard.ContainsFileDropList " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c61a3-169">指示剪贴板中是否存在 <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> 格式或可转换成此格式的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-169">Indicates whether there is data on the Clipboard that is in the <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> format or can be converted to that format.</span></span></summary>
        <returns><span data-ttu-id="c61a3-170">如果剪贴板中有文件放置列表，则为 <see langword="true" />；否则为，<see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-170"><see langword="true" /> if there is a file drop list on the Clipboard; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-171">文件放置列表是包含文件的路径信息的字符串的集合。</span><span class="sxs-lookup"><span data-stu-id="c61a3-171">A file drop list is a collection of strings containing path information for files.</span></span>  
  
 <span data-ttu-id="c61a3-172">使用此方法来确定剪贴板是否包含文件放置列表，然后再使用 <xref:System.Windows.Forms.Clipboard.GetFileDropList%2A> 方法进行检索。</span><span class="sxs-lookup"><span data-stu-id="c61a3-172">Use this method to determine whether the Clipboard contains a file drop list before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetFileDropList%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-173"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-173">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-174">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-174">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-175">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-175">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#30](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#30)]
 [!code-vb[System.Windows.Forms.Clipboard#30](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#30)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-176">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-176">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-177">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-177">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-178">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-178">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-179">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-179">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <altmember cref="F:System.Windows.Forms.DataFormats.FileDrop" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetFileDropList" />
        <altmember cref="M:System.Windows.Forms.Clipboard.SetFileDropList(System.Collections.Specialized.StringCollection)" />
      </Docs>
    </Member>
    <Member MemberName="ContainsImage">
      <MemberSignature Language="C#" Value="public static bool ContainsImage ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool ContainsImage() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.ContainsImage" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ContainsImage () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool ContainsImage();" />
      <MemberSignature Language="F#" Value="static member ContainsImage : unit -&gt; bool" Usage="System.Windows.Forms.Clipboard.ContainsImage " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c61a3-180">指示剪贴板中是否存在 <see cref="F:System.Windows.Forms.DataFormats.Bitmap" /> 格式或可转换成此格式的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-180">Indicates whether there is data on the Clipboard that is in the <see cref="F:System.Windows.Forms.DataFormats.Bitmap" /> format or can be converted to that format.</span></span></summary>
        <returns><span data-ttu-id="c61a3-181">如果剪贴板中存在图像数据，则为 <see langword="true" />；否则为，<see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-181"><see langword="true" /> if there is image data on the Clipboard; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-182">使用此方法可以在使用 <xref:System.Windows.Forms.Clipboard.GetImage%2A> 方法进行检索之前，确定剪贴板是否包含图像数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-182">Use this method to determine whether the Clipboard contains image data before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetImage%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-183"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-183">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-184">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-184">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-185">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-185">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#40](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#40)]
 [!code-vb[System.Windows.Forms.Clipboard#40](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#40)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-186">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-186">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-187">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-187">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-188">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-188">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-189">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-189">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <altmember cref="F:System.Windows.Forms.DataFormats.Bitmap" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetImage" />
        <altmember cref="M:System.Windows.Forms.Clipboard.SetImage(System.Drawing.Image)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ContainsText">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="c61a3-190">指示剪贴板中是否存在文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-190">Indicates whether there is text data on the Clipboard.</span></span></summary>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.GetText" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.SetText" />
      </Docs>
    </MemberGroup>
    <Member MemberName="ContainsText">
      <MemberSignature Language="C#" Value="public static bool ContainsText ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool ContainsText() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.ContainsText" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ContainsText () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool ContainsText();" />
      <MemberSignature Language="F#" Value="static member ContainsText : unit -&gt; bool" Usage="System.Windows.Forms.Clipboard.ContainsText " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c61a3-191">指示剪贴板中是否存在 <see cref="F:System.Windows.Forms.TextDataFormat.Text" /> 或 <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> 格式的数据（取决于操作系统）。</span><span class="sxs-lookup"><span data-stu-id="c61a3-191">Indicates whether there is data on the Clipboard in the <see cref="F:System.Windows.Forms.TextDataFormat.Text" /> or <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> format, depending on the operating system.</span></span></summary>
        <returns><span data-ttu-id="c61a3-192">如果剪贴板中存在文本数据，则为 <see langword="true" />；否则为，<see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-192"><see langword="true" /> if there is text data on the Clipboard; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-193">此方法检查 [!INCLUDE[WinXpFamily](~/includes/winxpfamily-md.md)] 和 [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)]上是否存在 <xref:System.Windows.Forms.TextDataFormat.UnicodeText> 格式的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-193">This method checks for the presence of data in the <xref:System.Windows.Forms.TextDataFormat.UnicodeText> format on [!INCLUDE[WinXpFamily](~/includes/winxpfamily-md.md)] and [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)].</span></span> <span data-ttu-id="c61a3-194">否则，此方法会检查 <xref:System.Windows.Forms.TextDataFormat.Text> 格式的数据是否存在。</span><span class="sxs-lookup"><span data-stu-id="c61a3-194">Otherwise, this method checks for the presence of data in the <xref:System.Windows.Forms.TextDataFormat.Text> format.</span></span>  
  
 <span data-ttu-id="c61a3-195">使用此方法可以在使用 <xref:System.Windows.Forms.Clipboard.GetText%2A> 方法检索剪贴板之前，确定剪贴板是否包含文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-195">Use this method to determine whether the Clipboard contains text data before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetText%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-196"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-196">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-197">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-197">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-198">下面的示例演示类似于此重载的 <xref:System.Windows.Forms.Clipboard.ContainsText%2A> 方法的重载。</span><span class="sxs-lookup"><span data-stu-id="c61a3-198">The following example demonstrates an overload of the <xref:System.Windows.Forms.Clipboard.ContainsText%2A> method that is similar to this overload.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#50](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#50)]
 [!code-vb[System.Windows.Forms.Clipboard#50](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#50)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-199">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-199">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-200">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-200">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-201">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-201">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-202">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-202">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="F:System.Windows.Forms.TextDataFormat.Text" />
        <altmember cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.GetText" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.SetText" />
      </Docs>
    </Member>
    <Member MemberName="ContainsText">
      <MemberSignature Language="C#" Value="public static bool ContainsText (System.Windows.Forms.TextDataFormat format);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool ContainsText(valuetype System.Windows.Forms.TextDataFormat format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.ContainsText(System.Windows.Forms.TextDataFormat)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ContainsText (format As TextDataFormat) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool ContainsText(System::Windows::Forms::TextDataFormat format);" />
      <MemberSignature Language="F#" Value="static member ContainsText : System.Windows.Forms.TextDataFormat -&gt; bool" Usage="System.Windows.Forms.Clipboard.ContainsText format" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.Windows.Forms.TextDataFormat" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="c61a3-203"><see cref="T:System.Windows.Forms.TextDataFormat" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="c61a3-203">One of the <see cref="T:System.Windows.Forms.TextDataFormat" /> values.</span></span></param>
        <summary><span data-ttu-id="c61a3-204">指示剪贴板中是否存在具有指定的 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值所指示的格式的文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-204">Indicates whether there is text data on the Clipboard in the format indicated by the specified <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></summary>
        <returns><span data-ttu-id="c61a3-205">如果剪贴板中存在格式值为指定 <paramref name="format" /> 的文本数据，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-205"><see langword="true" /> if there is text data on the Clipboard in the value specified for <paramref name="format" />; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-206">使用此方法可以在使用 <xref:System.Windows.Forms.Clipboard.GetText%2A> 方法检索剪贴板之前，确定剪贴板是否包含文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-206">Use this method to determine whether the Clipboard contains text data before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetText%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-207"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-207">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-208">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-208">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-209">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-209">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#50](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#50)]
 [!code-vb[System.Windows.Forms.Clipboard#50](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#50)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-210">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-210">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-211">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-211">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-212">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-212">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-213">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-213">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="c61a3-214"><paramref name="format" /> 不是有效的 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值。</span><span class="sxs-lookup"><span data-stu-id="c61a3-214"><paramref name="format" /> is not a valid <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.GetText" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.SetText" />
      </Docs>
    </Member>
    <Member MemberName="GetAudioStream">
      <MemberSignature Language="C#" Value="public static System.IO.Stream GetAudioStream ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.IO.Stream GetAudioStream() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.GetAudioStream" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetAudioStream () As Stream" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::IO::Stream ^ GetAudioStream();" />
      <MemberSignature Language="F#" Value="static member GetAudioStream : unit -&gt; System.IO.Stream" Usage="System.Windows.Forms.Clipboard.GetAudioStream " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.Stream</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c61a3-215">检索剪贴板上的音频流。</span><span class="sxs-lookup"><span data-stu-id="c61a3-215">Retrieves an audio stream from the Clipboard.</span></span></summary>
        <returns><span data-ttu-id="c61a3-216">包含音频数据的 <see cref="T:System.IO.Stream" />；如果剪贴板不包含任何 <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> 格式的数据，则为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-216">A <see cref="T:System.IO.Stream" /> containing audio data or <see langword="null" /> if the Clipboard does not contain any data in the <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> format.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-217">使用 <xref:System.Windows.Forms.Clipboard.ContainsAudio%2A> 方法来确定剪贴板是否包含音频数据，然后再使用此方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="c61a3-217">Use the <xref:System.Windows.Forms.Clipboard.ContainsAudio%2A> method to determine whether the Clipboard contains audio data before retrieving it with this method.</span></span>  
  
 <span data-ttu-id="c61a3-218">使用 <xref:System.Windows.Forms.Clipboard.SetAudio%2A> 方法将音频数据添加到剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-218">Use the <xref:System.Windows.Forms.Clipboard.SetAudio%2A> method to add audio data to the Clipboard.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-219"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-219">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-220">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-220">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-221">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-221">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#20](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#20)]
 [!code-vb[System.Windows.Forms.Clipboard#20](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-222">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-222">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-223">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-223">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-224">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-224">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-225">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-225">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <altmember cref="T:System.IO.Stream" />
        <altmember cref="F:System.Windows.Forms.DataFormats.WaveAudio" />
        <altmember cref="M:System.Windows.Forms.Clipboard.ContainsAudio" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.SetAudio" />
      </Docs>
    </Member>
    <Member MemberName="GetData">
      <MemberSignature Language="C#" Value="public static object GetData (string format);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig object GetData(string format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.GetData(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetData (format As String) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Object ^ GetData(System::String ^ format);" />
      <MemberSignature Language="F#" Value="static member GetData : string -&gt; obj" Usage="System.Windows.Forms.Clipboard.GetData format" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.String" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="c61a3-226">要检索的数据的格式。</span><span class="sxs-lookup"><span data-stu-id="c61a3-226">The format of the data to retrieve.</span></span> <span data-ttu-id="c61a3-227">请参见 <see cref="T:System.Windows.Forms.DataFormats" /> 以获取预定义的格式。</span><span class="sxs-lookup"><span data-stu-id="c61a3-227">See <see cref="T:System.Windows.Forms.DataFormats" /> for predefined formats.</span></span></param>
        <summary><span data-ttu-id="c61a3-228">从剪贴板中检索指定格式的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-228">Retrieves data from the Clipboard in the specified format.</span></span></summary>
        <returns><span data-ttu-id="c61a3-229">表示剪贴板数据的 <see cref="T:System.Object" />；如果剪贴板中包含的数据都不是指定 <paramref name="format" />，也无法转换为该格式，则为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-229">An <see cref="T:System.Object" /> representing the Clipboard data or <see langword="null" /> if the Clipboard does not contain any data that is in the specified <paramref name="format" /> or can be converted to that format.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-230">使用 <xref:System.Windows.Forms.Clipboard.ContainsData%2A> 方法来确定剪贴板是否包含指定格式的数据或兼容的格式，然后再使用此方法检索数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-230">Use the <xref:System.Windows.Forms.Clipboard.ContainsData%2A> method to determine whether the Clipboard contains data in the specified format or a compatible format before retrieving it with this method.</span></span>  
  
 <span data-ttu-id="c61a3-231">如果此方法无法找到具有指定格式的数据，则会尝试将数据转换为格式。</span><span class="sxs-lookup"><span data-stu-id="c61a3-231">If this method cannot find data in the specified format, it attempts to convert the data to the format.</span></span> <span data-ttu-id="c61a3-232">如果数据无法转换为指定的格式，或者如果数据是通过自动转换设置为 `false`进行存储的，则此方法将返回 `null`。</span><span class="sxs-lookup"><span data-stu-id="c61a3-232">If the data cannot be converted to the specified format, or if the data was stored with automatic conversion set to `false`, this method returns `null`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-233">如果数据已存储，则可以将其转换为另一种格式，这种格式指定允许该转换，并且请求的格式与存储格式兼容。</span><span class="sxs-lookup"><span data-stu-id="c61a3-233">Data can be converted to another format if it was stored specifying that conversion is allowed, and if the requested format is compatible with the stored format.</span></span> <span data-ttu-id="c61a3-234">例如，以 Unicode 形式存储的数据可以转换为文本。</span><span class="sxs-lookup"><span data-stu-id="c61a3-234">For example, data stored as Unicode can be converted to text.</span></span>  
>   
>  <span data-ttu-id="c61a3-235"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-235">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-236">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-236">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
 <span data-ttu-id="c61a3-237">使用 <xref:System.Windows.Forms.Clipboard.SetData%2A> 方法以特定格式将数据添加到剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-237">Use the <xref:System.Windows.Forms.Clipboard.SetData%2A> method to add data to the Clipboard in a particular format.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-238">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-238">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#10)]
 [!code-vb[System.Windows.Forms.Clipboard#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-239">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-239">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-240">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-240">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-241">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-241">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-242">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-242">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <altmember cref="T:System.Object" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.Clipboard.ContainsData(System.String)" />
        <altmember cref="M:System.Windows.Forms.Clipboard.SetData(System.String,System.Object)" />
      </Docs>
    </Member>
    <Member MemberName="GetDataObject">
      <MemberSignature Language="C#" Value="public static System.Windows.Forms.IDataObject GetDataObject ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Windows.Forms.IDataObject GetDataObject() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.GetDataObject" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetDataObject () As IDataObject" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Windows::Forms::IDataObject ^ GetDataObject();" />
      <MemberSignature Language="F#" Value="static member GetDataObject : unit -&gt; System.Windows.Forms.IDataObject" Usage="System.Windows.Forms.Clipboard.GetDataObject " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Windows.Forms.IDataObject</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c61a3-243">检索当前位于系统剪贴板中的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-243">Retrieves the data that is currently on the system Clipboard.</span></span></summary>
        <returns><span data-ttu-id="c61a3-244"><see cref="T:System.Windows.Forms.IDataObject" />，表示系统剪贴板中当前的数据；如果剪贴板中没有数据，则为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-244">An <see cref="T:System.Windows.Forms.IDataObject" /> that represents the data currently on the Clipboard, or <see langword="null" /> if there is no data on the Clipboard.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-245">由于从剪贴板返回的对象的数据类型可能会有所不同，因此此方法返回 <xref:System.Windows.Forms.IDataObject>中的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-245">Because the data type of the object returned from the Clipboard can vary, this method returns the data in an <xref:System.Windows.Forms.IDataObject>.</span></span> <span data-ttu-id="c61a3-246">然后，可以使用 <xref:System.Windows.Forms.IDataObject> 接口的方法，以正确的数据类型来提取数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-246">Then you can use methods of the <xref:System.Windows.Forms.IDataObject> interface to extract the data in its proper data type.</span></span>  
  
 <span data-ttu-id="c61a3-247">此方法尝试以100毫秒的间隔将数据获取十次，如果所有尝试均失败，则会引发 <xref:System.Runtime.InteropServices.ExternalException>。</span><span class="sxs-lookup"><span data-stu-id="c61a3-247">This method attempts to get the data ten times in 100-millisecond intervals, and throws an <xref:System.Runtime.InteropServices.ExternalException> if all attempts are unsuccessful.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-248"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-248">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-249">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-249">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-250">下面的代码示例使用 <xref:System.Windows.Forms.Clipboard> 方法将数据放置在系统剪贴板上并从中检索数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-250">The following code example uses <xref:System.Windows.Forms.Clipboard> methods to place data on and retrieve it from the system Clipboard.</span></span> <span data-ttu-id="c61a3-251">此代码假设已在窗体上放置 `button1`、`button2`、`textBox1`和 `textBox2`。</span><span class="sxs-lookup"><span data-stu-id="c61a3-251">This code assumes `button1`, `button2`, `textBox1`, and `textBox2` have been placed on the form.</span></span>  
  
 <span data-ttu-id="c61a3-252">`button1_Click` 方法将调用 <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> 以获取文本框中的选定文本，并将其放置在系统剪贴板上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-252">The `button1_Click` method calls <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> to take selected text from the text box and place it on the system Clipboard.</span></span>  
  
 <span data-ttu-id="c61a3-253">`button2_Click` 方法调用 <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> 从系统剪贴板检索数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-253">The `button2_Click` method calls <xref:System.Windows.Forms.Clipboard.GetDataObject%2A> to retrieve data from the system Clipboard.</span></span> <span data-ttu-id="c61a3-254">代码使用 <xref:System.Windows.Forms.IDataObject> 和 <xref:System.Windows.Forms.DataFormats> 提取返回的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-254">The code uses <xref:System.Windows.Forms.IDataObject> and <xref:System.Windows.Forms.DataFormats> to extract the data returned.</span></span> <span data-ttu-id="c61a3-255">数据显示在 `textBox2`中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-255">The data is displayed in `textBox2`.</span></span>  
  
 [!code-cpp[Classic Clipboard Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic Clipboard Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Clipboard Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic Clipboard Example/CS/source.cs#1)]
 [!code-vb[Classic Clipboard Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic Clipboard Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-256">未能从剪贴板中检索到数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-256">Data could not be retrieved from the Clipboard.</span></span> <span data-ttu-id="c61a3-257">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-257">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-258">当前线程未处于单线程单元 (STA) 模式下，且 <see cref="P:System.Windows.Forms.Application.MessageLoop" /> 属性值为 <see langword="true" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-258">The current thread is not in single-threaded apartment (STA) mode and the <see cref="P:System.Windows.Forms.Application.MessageLoop" /> property value is <see langword="true" />.</span></span> <span data-ttu-id="c61a3-259">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-259">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.DataObject" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.Clipboard.SetDataObject(System.Object)" />
        <altmember cref="T:System.Windows.Forms.IDataObject" />
      </Docs>
    </Member>
    <Member MemberName="GetFileDropList">
      <MemberSignature Language="C#" Value="public static System.Collections.Specialized.StringCollection GetFileDropList ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Collections.Specialized.StringCollection GetFileDropList() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.GetFileDropList" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetFileDropList () As StringCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Collections::Specialized::StringCollection ^ GetFileDropList();" />
      <MemberSignature Language="F#" Value="static member GetFileDropList : unit -&gt; System.Collections.Specialized.StringCollection" Usage="System.Windows.Forms.Clipboard.GetFileDropList " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.Specialized.StringCollection</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c61a3-260">从剪贴板中检索文件名的集合。</span><span class="sxs-lookup"><span data-stu-id="c61a3-260">Retrieves a collection of file names from the Clipboard.</span></span></summary>
        <returns><span data-ttu-id="c61a3-261">包含文件名的 <see cref="T:System.Collections.Specialized.StringCollection" />；如果剪贴板中不包含任何格式为 <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> 或可转换为该格式的数据，则为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-261">A <see cref="T:System.Collections.Specialized.StringCollection" /> containing file names or <see langword="null" /> if the Clipboard does not contain any data that is in the <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> format or can be converted to that format.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-262">文件放置列表是包含文件的路径信息的字符串的集合。</span><span class="sxs-lookup"><span data-stu-id="c61a3-262">A file drop list is a collection of strings containing path information for files.</span></span>  
  
 <span data-ttu-id="c61a3-263">文件放置列表作为 <xref:System.String> 数组存储在剪贴板上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-263">A file drop list is stored on the Clipboard as a <xref:System.String> array.</span></span> <span data-ttu-id="c61a3-264">此方法将此数组转换为 <xref:System.Collections.Specialized.StringCollection> 并返回集合。</span><span class="sxs-lookup"><span data-stu-id="c61a3-264">This method converts this array to a <xref:System.Collections.Specialized.StringCollection> and returns the collection.</span></span>  
  
 <span data-ttu-id="c61a3-265">使用 <xref:System.Windows.Forms.Clipboard.ContainsFileDropList%2A> 方法来确定剪贴板是否包含文件放置列表，然后再使用此方法检索它。</span><span class="sxs-lookup"><span data-stu-id="c61a3-265">Use the <xref:System.Windows.Forms.Clipboard.ContainsFileDropList%2A> method to determine whether the Clipboard contains a file drop list before retrieving it with this method.</span></span>  
  
 <span data-ttu-id="c61a3-266">使用 <xref:System.Windows.Forms.Clipboard.SetFileDropList%2A> 方法可向剪贴板添加文件放置列表。</span><span class="sxs-lookup"><span data-stu-id="c61a3-266">Use the <xref:System.Windows.Forms.Clipboard.SetFileDropList%2A> method to add a file drop list to the Clipboard.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-267"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-267">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-268">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-268">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-269">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-269">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#30](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#30)]
 [!code-vb[System.Windows.Forms.Clipboard#30](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#30)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-270">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-270">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-271">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-271">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-272">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-272">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-273">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-273">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <altmember cref="T:System.Collections.Specialized.StringCollection" />
        <altmember cref="F:System.Windows.Forms.DataFormats.FileDrop" />
        <altmember cref="M:System.Windows.Forms.Clipboard.ContainsFileDropList" />
        <altmember cref="M:System.Windows.Forms.Clipboard.SetFileDropList(System.Collections.Specialized.StringCollection)" />
      </Docs>
    </Member>
    <Member MemberName="GetImage">
      <MemberSignature Language="C#" Value="public static System.Drawing.Image GetImage ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Drawing.Image GetImage() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.GetImage" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetImage () As Image" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Drawing::Image ^ GetImage();" />
      <MemberSignature Language="F#" Value="static member GetImage : unit -&gt; System.Drawing.Image" Usage="System.Windows.Forms.Clipboard.GetImage " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Image</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c61a3-274">检索剪贴板上的图像。</span><span class="sxs-lookup"><span data-stu-id="c61a3-274">Retrieves an image from the Clipboard.</span></span></summary>
        <returns><span data-ttu-id="c61a3-275">表示剪贴板图像数据的 <see cref="T:System.Drawing.Image" />；如果剪贴板中不包含任何 <see cref="F:System.Windows.Forms.DataFormats.Bitmap" /> 格式或可转换成该格式的数据，则为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-275">An <see cref="T:System.Drawing.Image" /> representing the Clipboard image data or <see langword="null" /> if the Clipboard does not contain any data that is in the <see cref="F:System.Windows.Forms.DataFormats.Bitmap" /> format or can be converted to that format.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-276">使用 <xref:System.Windows.Forms.Clipboard.ContainsImage%2A> 方法来确定剪贴板是否包含图像数据，然后再使用此方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="c61a3-276">Use the <xref:System.Windows.Forms.Clipboard.ContainsImage%2A> method to determine whether the Clipboard contains image data before retrieving it with this method.</span></span>  
  
 <span data-ttu-id="c61a3-277">使用 <xref:System.Windows.Forms.Clipboard.SetImage%2A> 方法将图像数据添加到剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-277">Use the <xref:System.Windows.Forms.Clipboard.SetImage%2A> method to add image data to the Clipboard.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-278"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-278">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-279">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-279">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-280">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-280">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#40](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#40)]
 [!code-vb[System.Windows.Forms.Clipboard#40](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#40)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-281">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-281">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-282">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-282">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-283">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-283">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-284">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-284">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <altmember cref="T:System.Drawing.Image" />
        <altmember cref="F:System.Windows.Forms.DataFormats.Bitmap" />
        <altmember cref="M:System.Windows.Forms.Clipboard.ContainsImage" />
        <altmember cref="M:System.Windows.Forms.Clipboard.SetImage(System.Drawing.Image)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetText">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="c61a3-285">从剪贴板中检索文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-285">Retrieves text data from the Clipboard.</span></span></summary>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.SetText" />
      </Docs>
    </MemberGroup>
    <Member MemberName="GetText">
      <MemberSignature Language="C#" Value="public static string GetText ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string GetText() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.GetText" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetText () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ GetText();" />
      <MemberSignature Language="F#" Value="static member GetText : unit -&gt; string" Usage="System.Windows.Forms.Clipboard.GetText " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c61a3-286">从剪贴板中检索 <see cref="F:System.Windows.Forms.TextDataFormat.Text" /> 或 <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> 格式的文本数据（取决于操作系统）。</span><span class="sxs-lookup"><span data-stu-id="c61a3-286">Retrieves text data from the Clipboard in the <see cref="F:System.Windows.Forms.TextDataFormat.Text" /> or <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> format, depending on the operating system.</span></span></summary>
        <returns><span data-ttu-id="c61a3-287">剪贴板文本数据；如果剪贴板中不包含 <see cref="F:System.String.Empty" /> 或 <see cref="F:System.Windows.Forms.TextDataFormat.Text" /> 格式的数据（取决于操作系统），则为 <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-287">The Clipboard text data or <see cref="F:System.String.Empty" /> if the Clipboard does not contain data in the <see cref="F:System.Windows.Forms.TextDataFormat.Text" /> or <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> format, depending on the operating system.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-288">此方法在 [!INCLUDE[WinXpFamily](~/includes/winxpfamily-md.md)] 和 [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)]上返回 <xref:System.Windows.Forms.TextDataFormat.UnicodeText> 格式的文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-288">This method returns text data in the <xref:System.Windows.Forms.TextDataFormat.UnicodeText> format on [!INCLUDE[WinXpFamily](~/includes/winxpfamily-md.md)] and [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)].</span></span> <span data-ttu-id="c61a3-289">否则，此方法将返回 <xref:System.Windows.Forms.TextDataFormat.Text> 格式的文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-289">Otherwise, this method returns text data in the <xref:System.Windows.Forms.TextDataFormat.Text> format.</span></span>  
  
 <span data-ttu-id="c61a3-290">使用 <xref:System.Windows.Forms.Clipboard.ContainsText%2A> 方法来确定剪贴板是否包含文本数据，然后再使用此方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="c61a3-290">Use the <xref:System.Windows.Forms.Clipboard.ContainsText%2A> method to determine whether the Clipboard contains text data before retrieving it with this method.</span></span>  
  
 <span data-ttu-id="c61a3-291">使用 <xref:System.Windows.Forms.Clipboard.SetText%2A> 方法可向剪贴板添加文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-291">Use the <xref:System.Windows.Forms.Clipboard.SetText%2A> method to add text data to the Clipboard.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-292"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-292">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-293">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-293">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-294">下面的示例演示类似于此重载的 <xref:System.Windows.Forms.Clipboard.GetText%2A> 方法的重载。</span><span class="sxs-lookup"><span data-stu-id="c61a3-294">The following example demonstrates an overload of the <xref:System.Windows.Forms.Clipboard.GetText%2A> method that is similar to this overload.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#50](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#50)]
 [!code-vb[System.Windows.Forms.Clipboard#50](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#50)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-295">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-295">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-296">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-296">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-297">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-297">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-298">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-298">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.SetText" />
      </Docs>
    </Member>
    <Member MemberName="GetText">
      <MemberSignature Language="C#" Value="public static string GetText (System.Windows.Forms.TextDataFormat format);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string GetText(valuetype System.Windows.Forms.TextDataFormat format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.GetText(System.Windows.Forms.TextDataFormat)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetText (format As TextDataFormat) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ GetText(System::Windows::Forms::TextDataFormat format);" />
      <MemberSignature Language="F#" Value="static member GetText : System.Windows.Forms.TextDataFormat -&gt; string" Usage="System.Windows.Forms.Clipboard.GetText format" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.Windows.Forms.TextDataFormat" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="c61a3-299"><see cref="T:System.Windows.Forms.TextDataFormat" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="c61a3-299">One of the <see cref="T:System.Windows.Forms.TextDataFormat" /> values.</span></span></param>
        <summary><span data-ttu-id="c61a3-300">从剪贴板中检索由指定的 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值表示的格式的文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-300">Retrieves text data from the Clipboard in the format indicated by the specified <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></summary>
        <returns><span data-ttu-id="c61a3-301">剪贴板文本数据；如果剪贴板中不包含指定格式的数据，则为 <see cref="F:System.String.Empty" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-301">The Clipboard text data or <see cref="F:System.String.Empty" /> if the Clipboard does not contain data in the specified format.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-302">使用 <xref:System.Windows.Forms.Clipboard.ContainsText%2A> 方法来确定剪贴板是否包含文本数据，然后再使用此方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="c61a3-302">Use the <xref:System.Windows.Forms.Clipboard.ContainsText%2A> method to determine whether the Clipboard contains text data before retrieving it with this method.</span></span>  
  
 <span data-ttu-id="c61a3-303">使用 <xref:System.Windows.Forms.Clipboard.SetText%2A> 方法可向剪贴板添加文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-303">Use the <xref:System.Windows.Forms.Clipboard.SetText%2A> method to add text data to the Clipboard.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-304"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-304">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-305">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-305">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-306">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-306">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#50](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#50)]
 [!code-vb[System.Windows.Forms.Clipboard#50](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#50)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-307">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-307">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-308">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-308">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-309">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-309">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-310">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-310">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="c61a3-311"><paramref name="format" /> 不是有效的 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值。</span><span class="sxs-lookup"><span data-stu-id="c61a3-311"><paramref name="format" /> is not a valid <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.SetText" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetAudio">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="c61a3-312">清除剪贴板，然后以 <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> 格式添加数据，替换现有数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-312">Clears the Clipboard and then adds data in the <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> format, replacing the existing data.</span></span></summary>
        <altmember cref="F:System.Windows.Forms.DataFormats.WaveAudio" />
        <altmember cref="M:System.Windows.Forms.Clipboard.ContainsAudio" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetAudioStream" />
      </Docs>
    </MemberGroup>
    <Member MemberName="SetAudio">
      <MemberSignature Language="C#" Value="public static void SetAudio (byte[] audioBytes);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetAudio(unsigned int8[] audioBytes) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.SetAudio(System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetAudio (audioBytes As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetAudio(cli::array &lt;System::Byte&gt; ^ audioBytes);" />
      <MemberSignature Language="F#" Value="static member SetAudio : byte[] -&gt; unit" Usage="System.Windows.Forms.Clipboard.SetAudio audioBytes" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="audioBytes" Type="System.Byte[]" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="audioBytes"><span data-ttu-id="c61a3-313">包含音频数据的 <see cref="T:System.Byte" /> 数组。</span><span class="sxs-lookup"><span data-stu-id="c61a3-313">A <see cref="T:System.Byte" /> array containing the audio data.</span></span></param>
        <summary><span data-ttu-id="c61a3-314">清除剪贴板然后以 <see cref="T:System.Byte" /> 格式添加 <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> 数组，这种情况发生在将其转换为 <see cref="T:System.IO.Stream" /> 之后。</span><span class="sxs-lookup"><span data-stu-id="c61a3-314">Clears the Clipboard and then adds a <see cref="T:System.Byte" /> array in the <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> format after converting it to a <see cref="T:System.IO.Stream" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-315">若要从剪贴板检索音频数据，请首先使用 <xref:System.Windows.Forms.Clipboard.ContainsAudio%2A> 方法来确定剪贴板是否包含音频数据，然后再使用 <xref:System.Windows.Forms.Clipboard.GetAudioStream%2A> 方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="c61a3-315">To retrieve audio data from the Clipboard, first use the <xref:System.Windows.Forms.Clipboard.ContainsAudio%2A> method to determine whether the Clipboard contains audio data before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetAudioStream%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-316"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-316">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-317">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-317">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-318">下面的示例演示类似于此重载的 <xref:System.Windows.Forms.Clipboard.SetAudio%2A> 方法的重载。</span><span class="sxs-lookup"><span data-stu-id="c61a3-318">The following example demonstrates an overload of the <xref:System.Windows.Forms.Clipboard.SetAudio%2A> method that is similar to this overload.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#20](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#20)]
 [!code-vb[System.Windows.Forms.Clipboard#20](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-319">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-319">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-320">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-320">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-321">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-321">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-322">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-322">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="c61a3-323"><paramref name="audioBytes" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-323"><paramref name="audioBytes" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="F:System.Windows.Forms.DataFormats.WaveAudio" />
        <altmember cref="M:System.Windows.Forms.Clipboard.ContainsAudio" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetAudioStream" />
      </Docs>
    </Member>
    <Member MemberName="SetAudio">
      <MemberSignature Language="C#" Value="public static void SetAudio (System.IO.Stream audioStream);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetAudio(class System.IO.Stream audioStream) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.SetAudio(System.IO.Stream)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetAudio (audioStream As Stream)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetAudio(System::IO::Stream ^ audioStream);" />
      <MemberSignature Language="F#" Value="static member SetAudio : System.IO.Stream -&gt; unit" Usage="System.Windows.Forms.Clipboard.SetAudio audioStream" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="audioStream" Type="System.IO.Stream" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="audioStream"><span data-ttu-id="c61a3-324">包含音频数据的 <see cref="T:System.IO.Stream" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-324">A <see cref="T:System.IO.Stream" /> containing the audio data.</span></span></param>
        <summary><span data-ttu-id="c61a3-325">清除剪贴板然后以 <see cref="T:System.IO.Stream" /> 格式添加 <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-325">Clears the Clipboard and then adds a <see cref="T:System.IO.Stream" /> in the <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-326">若要从剪贴板检索音频数据，请首先使用 <xref:System.Windows.Forms.Clipboard.ContainsAudio%2A> 方法来确定剪贴板是否包含音频数据，然后再使用 <xref:System.Windows.Forms.Clipboard.GetAudioStream%2A> 方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="c61a3-326">To retrieve audio data from the Clipboard, first use the <xref:System.Windows.Forms.Clipboard.ContainsAudio%2A> method to determine whether the Clipboard contains audio data before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetAudioStream%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-327"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-327">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-328">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-328">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-329">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-329">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#20](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#20)]
 [!code-vb[System.Windows.Forms.Clipboard#20](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-330">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-330">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-331">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-331">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-332">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-332">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-333">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-333">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="c61a3-334"><paramref name="audioStream" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-334"><paramref name="audioStream" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="F:System.Windows.Forms.DataFormats.WaveAudio" />
        <altmember cref="M:System.Windows.Forms.Clipboard.ContainsAudio" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetAudioStream" />
      </Docs>
    </Member>
    <Member MemberName="SetData">
      <MemberSignature Language="C#" Value="public static void SetData (string format, object data);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetData(string format, object data) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.SetData(System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetData (format As String, data As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetData(System::String ^ format, System::Object ^ data);" />
      <MemberSignature Language="F#" Value="static member SetData : string * obj -&gt; unit" Usage="System.Windows.Forms.Clipboard.SetData (format, data)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.String" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="data" Type="System.Object" Index="1" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="c61a3-335">要设置的数据格式。</span><span class="sxs-lookup"><span data-stu-id="c61a3-335">The format of the data to set.</span></span> <span data-ttu-id="c61a3-336">请参见 <see cref="T:System.Windows.Forms.DataFormats" /> 以获取预定义的格式。</span><span class="sxs-lookup"><span data-stu-id="c61a3-336">See <see cref="T:System.Windows.Forms.DataFormats" /> for predefined formats.</span></span></param>
        <param name="data"><span data-ttu-id="c61a3-337">表示要添加的数据的 <see cref="T:System.Object" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-337">An <see cref="T:System.Object" /> representing the data to add.</span></span></param>
        <summary><span data-ttu-id="c61a3-338">清除剪贴板然后以所指定的格式添加数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-338">Clears the Clipboard and then adds data in the specified format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-339">如果您不知道目标应用程序的格式，则可以使用此方法以多种格式存储数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-339">If you do not know the format of the target application, you can store data in multiple formats using this method.</span></span>  
  
 <span data-ttu-id="c61a3-340">在检索使用此方法存储的数据时，可以将其转换为兼容的格式。</span><span class="sxs-lookup"><span data-stu-id="c61a3-340">Data stored using this method can be converted to a compatible format when it is retrieved.</span></span>  
  
 <span data-ttu-id="c61a3-341">若要以特定格式从剪贴板检索数据，请先使用 <xref:System.Windows.Forms.Clipboard.ContainsData%2A> 方法来确定剪贴板是否包含格式的数据，然后再使用 <xref:System.Windows.Forms.Clipboard.GetData%2A> 方法检索数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-341">To retrieve data from the Clipboard in a particular format, first use the <xref:System.Windows.Forms.Clipboard.ContainsData%2A> method to determine whether the Clipboard contains data in that format before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetData%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-342"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-342">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-343">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-343">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-344">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-344">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#10)]
 [!code-vb[System.Windows.Forms.Clipboard#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-345">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-345">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-346">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-346">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-347">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-347">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-348">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-348">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="c61a3-349"><paramref name="data" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-349"><paramref name="data" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.Clipboard.ContainsData(System.String)" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetData(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetDataObject">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="c61a3-350">清除剪贴板然后，然后在其中添加数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-350">Clears the Clipboard and then adds data to it.</span></span></summary>
        <altmember cref="T:System.Windows.Forms.DataObject" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="T:System.Windows.Forms.IDataObject" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetDataObject" />
      </Docs>
    </MemberGroup>
    <Member MemberName="SetDataObject">
      <MemberSignature Language="C#" Value="public static void SetDataObject (object data);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetDataObject(object data) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.SetDataObject(System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetDataObject (data As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetDataObject(System::Object ^ data);" />
      <MemberSignature Language="F#" Value="static member SetDataObject : obj -&gt; unit" Usage="System.Windows.Forms.Clipboard.SetDataObject data" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="data" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="data"><span data-ttu-id="c61a3-351">要置于剪贴板中的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-351">The data to place on the Clipboard.</span></span></param>
        <summary><span data-ttu-id="c61a3-352">清除剪贴板然后，然后将非持久性数据置于其中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-352">Clears the Clipboard and then places nonpersistent data on it.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-353">当应用程序退出时，将从系统剪贴板中删除数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-353">Data will be deleted from system Clipboard when the application exits.</span></span>  
  
 <span data-ttu-id="c61a3-354">此方法尝试以100毫秒间隔将数据设置为十次，如果所有尝试均失败，则会引发 <xref:System.Runtime.InteropServices.ExternalException>。</span><span class="sxs-lookup"><span data-stu-id="c61a3-354">This method attempts to set the data ten times in 100-millisecond intervals, and throws an <xref:System.Runtime.InteropServices.ExternalException> if all attempts are unsuccessful.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-355">对象必须是可序列化的，才能将其放在剪贴板上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-355">An object must be serializable for it to be put on the Clipboard.</span></span> <span data-ttu-id="c61a3-356">如果将不可序列化的对象传递给此方法，则它将失败，且不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="c61a3-356">If you pass a non-serializable object to this method, it will fail without throwing an exception.</span></span> <span data-ttu-id="c61a3-357">有关序列化的详细信息，请参阅 <xref:System.Runtime.Serialization>。</span><span class="sxs-lookup"><span data-stu-id="c61a3-357">See <xref:System.Runtime.Serialization> for more information on serialization.</span></span>  
>   
>  <span data-ttu-id="c61a3-358"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-358">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-359">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-359">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-360">下面的代码示例使用 <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> 将非持久性文本数据置于系统剪贴板上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-360">The following code example uses <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> to place nonpersistent text data onto the system Clipboard.</span></span> <span data-ttu-id="c61a3-361">在 `button1_Click` 方法中，将从 `textBox1` 中复制所选文本，并将其粘贴到剪贴板上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-361">In the `button1_Click` method, the selected text is copied from `textBox1` and pasted on the Clipboard.</span></span> <span data-ttu-id="c61a3-362">在 `button2_Click` 方法中，将从剪贴板检索信息，并将其显示在 `textBox2`中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-362">In the `button2_Click` method, the information is retrieved from the Clipboard and displayed in `textBox2`.</span></span> <span data-ttu-id="c61a3-363">此代码假定已创建 `button1`、`button2`、`textBox1`和 `textBox2`，并将其放置在窗体上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-363">This code assumes `button1`, `button2`, `textBox1`, and `textBox2` have been created and placed on a form.</span></span>  
  
 [!code-cpp[Classic Clipboard Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic Clipboard Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Clipboard Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic Clipboard Example/CS/source.cs#1)]
 [!code-vb[Classic Clipboard Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic Clipboard Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-364">未能将数据置于剪贴板中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-364">Data could not be placed on the Clipboard.</span></span> <span data-ttu-id="c61a3-365">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-365">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-366">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-366">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-367">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-367">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="c61a3-368"><paramref name="data" /> 的值为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-368">The value of <paramref name="data" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.DataObject" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="T:System.Windows.Forms.IDataObject" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetDataObject" />
      </Docs>
    </Member>
    <Member MemberName="SetDataObject">
      <MemberSignature Language="C#" Value="public static void SetDataObject (object data, bool copy);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetDataObject(object data, bool copy) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.SetDataObject(System.Object,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetDataObject (data As Object, copy As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetDataObject(System::Object ^ data, bool copy);" />
      <MemberSignature Language="F#" Value="static member SetDataObject : obj * bool -&gt; unit" Usage="System.Windows.Forms.Clipboard.SetDataObject (data, copy)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="data" Type="System.Object" />
        <Parameter Name="copy" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="data"><span data-ttu-id="c61a3-369">要置于剪贴板中的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-369">The data to place on the Clipboard.</span></span></param>
        <param name="copy"><span data-ttu-id="c61a3-370">如果想在退出应用程序后将数据保留在剪贴板中，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-370"><see langword="true" /> if you want data to remain on the Clipboard after this application exits; otherwise, <see langword="false" />.</span></span></param>
        <summary><span data-ttu-id="c61a3-371">清除剪贴板并将数据置于系统剪贴板中，且指定在退出应用程序后是否将数据保留在剪贴板中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-371">Clears the Clipboard and then places data on it and specifies whether the data should remain after the application exits.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-372">如果 `copy` 参数 `false`，则在应用程序退出时将从系统剪贴板中删除数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-372">If the `copy` parameter is `false`, the data will be deleted from system Clipboard when the application exits.</span></span>  
  
 <span data-ttu-id="c61a3-373">此方法尝试以100毫秒间隔将数据设置为十次，如果所有尝试均失败，则会引发 <xref:System.Runtime.InteropServices.ExternalException>。</span><span class="sxs-lookup"><span data-stu-id="c61a3-373">This method attempts to set the data ten times in 100-millisecond intervals, and throws an <xref:System.Runtime.InteropServices.ExternalException> if all attempts are unsuccessful.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-374">对象必须是可序列化的，才能将其放在剪贴板上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-374">An object must be serializable for it to be put on the Clipboard.</span></span> <span data-ttu-id="c61a3-375">如果将不可序列化的对象传递给此方法，则它将失败，且不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="c61a3-375">If you pass a non-serializable object to this method, it will fail without throwing an exception.</span></span> <span data-ttu-id="c61a3-376">有关序列化的详细信息，请参阅 <xref:System.Runtime.Serialization>。</span><span class="sxs-lookup"><span data-stu-id="c61a3-376">See <xref:System.Runtime.Serialization> for more information on serialization.</span></span>  
>   
>  <span data-ttu-id="c61a3-377"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-377">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-378">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-378">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-379">下面的方法在应用程序中运行。</span><span class="sxs-lookup"><span data-stu-id="c61a3-379">The following method is run in an application.</span></span> <span data-ttu-id="c61a3-380">它在系统剪贴板上的文本框中放置所选文本数据的持久性副本。</span><span class="sxs-lookup"><span data-stu-id="c61a3-380">It places a persistent copy of the selected text data in the text box on the system Clipboard.</span></span> <span data-ttu-id="c61a3-381">此代码假定已创建 `button1`、`textBox1`和 `textBox2`，并将其放置在窗体上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-381">This code assumes `button1`, `textBox1`, and `textBox2` have been created and placed on a form.</span></span>  
  
 [!code-cpp[Classic Clipboard.SetDataObject1 Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic Clipboard.SetDataObject1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Clipboard.SetDataObject1 Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic Clipboard.SetDataObject1 Example/CS/source.cs#1)]
 [!code-vb[Classic Clipboard.SetDataObject1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic Clipboard.SetDataObject1 Example/VB/source.vb#1)]  
  
 <span data-ttu-id="c61a3-382">在不同的应用程序中，以下方法检索系统剪贴板中的文本，并将文本粘贴到 `textBox2`中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-382">In a different application, the following method retrieves the text from the system Clipboard and pastes the text into `textBox2`.</span></span> <span data-ttu-id="c61a3-383">此代码假定已创建 `button2` 和 `textBox2` 并将其放置在窗体上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-383">This code assumes `button2` and `textBox2` have been created and placed on a form.</span></span>  
  
 [!code-cpp[Classic Clipboard.SetDataObject1 Example#2](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic Clipboard.SetDataObject1 Example/CPP/source.cpp#2)]
 [!code-csharp[Classic Clipboard.SetDataObject1 Example#2](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic Clipboard.SetDataObject1 Example/CS/source.cs#2)]
 [!code-vb[Classic Clipboard.SetDataObject1 Example#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic Clipboard.SetDataObject1 Example/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-384">未能将数据置于剪贴板中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-384">Data could not be placed on the Clipboard.</span></span> <span data-ttu-id="c61a3-385">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-385">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-386">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-386">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-387">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-387">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="c61a3-388"><paramref name="data" /> 的值为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-388">The value of <paramref name="data" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.DataObject" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="T:System.Windows.Forms.IDataObject" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetDataObject" />
      </Docs>
    </Member>
    <Member MemberName="SetDataObject">
      <MemberSignature Language="C#" Value="public static void SetDataObject (object data, bool copy, int retryTimes, int retryDelay);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetDataObject(object data, bool copy, int32 retryTimes, int32 retryDelay) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.SetDataObject(System.Object,System.Boolean,System.Int32,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetDataObject (data As Object, copy As Boolean, retryTimes As Integer, retryDelay As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetDataObject(System::Object ^ data, bool copy, int retryTimes, int retryDelay);" />
      <MemberSignature Language="F#" Value="static member SetDataObject : obj * bool * int * int -&gt; unit" Usage="System.Windows.Forms.Clipboard.SetDataObject (data, copy, retryTimes, retryDelay)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="data" Type="System.Object" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="copy" Type="System.Boolean" Index="1" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="retryTimes" Type="System.Int32" Index="2" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="retryDelay" Type="System.Int32" Index="3" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="data"><span data-ttu-id="c61a3-389">要置于剪贴板中的数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-389">The data to place on the Clipboard.</span></span></param>
        <param name="copy"><span data-ttu-id="c61a3-390">如果想在退出应用程序后将数据保留在剪贴板中，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-390"><see langword="true" /> if you want data to remain on the Clipboard after this application exits; otherwise, <see langword="false" />.</span></span></param>
        <param name="retryTimes"><span data-ttu-id="c61a3-391">尝试将数据置于剪贴板中的次数。</span><span class="sxs-lookup"><span data-stu-id="c61a3-391">The number of times to attempt placing the data on the Clipboard.</span></span></param>
        <param name="retryDelay"><span data-ttu-id="c61a3-392">两次尝试之间暂停的毫秒数。</span><span class="sxs-lookup"><span data-stu-id="c61a3-392">The number of milliseconds to pause between attempts.</span></span></param>
        <summary><span data-ttu-id="c61a3-393">清除剪贴板并尝试指定的次数，以将数据置于系统剪贴板中，且两次尝试之间具有指定的延迟，可以选择在退出应用程序后将数据保留在剪贴板中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-393">Clears the Clipboard and then attempts to place data on it the specified number of times and with the specified delay between attempts, optionally leaving the data on the Clipboard after the application exits.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-394">如果剪贴板正忙于其他线程或应用程序，将数据添加到剪贴板有时会失败。</span><span class="sxs-lookup"><span data-stu-id="c61a3-394">Adding data to the Clipboard can occasionally fail if the Clipboard is busy with another thread or application.</span></span> <span data-ttu-id="c61a3-395">此方法可用于在使用繁重剪贴板的环境中解决此问题。</span><span class="sxs-lookup"><span data-stu-id="c61a3-395">This method is useful to work around this issue in environments with heavy Clipboard use.</span></span>  
  
 <span data-ttu-id="c61a3-396">如果 `copy` 参数 `false`，则在应用程序退出时将从系统剪贴板中删除数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-396">If the `copy` parameter is `false`, the data will be deleted from system Clipboard when the application exits.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-397">对象必须是可序列化的，才能将其放在剪贴板上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-397">An object must be serializable for it to be put on the Clipboard.</span></span> <span data-ttu-id="c61a3-398">如果将不可序列化的对象传递给此方法，则它将失败，且不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="c61a3-398">If you pass a non-serializable object to this method, it will fail without throwing an exception.</span></span> <span data-ttu-id="c61a3-399">有关序列化的详细信息，请参阅 <xref:System.Runtime.Serialization>。</span><span class="sxs-lookup"><span data-stu-id="c61a3-399">See <xref:System.Runtime.Serialization> for more information on serialization.</span></span>  
>   
>  <span data-ttu-id="c61a3-400"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-400">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-401">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-401">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-402">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-402">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-403">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-403">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="c61a3-404"><paramref name="data" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-404"><paramref name="data" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="c61a3-405"><paramref name="retryTimes" /> 小于零。</span><span class="sxs-lookup"><span data-stu-id="c61a3-405"><paramref name="retryTimes" /> is less than zero.</span></span>  
  
<span data-ttu-id="c61a3-406">- 或 -</span><span class="sxs-lookup"><span data-stu-id="c61a3-406">-or-</span></span> 
 <span data-ttu-id="c61a3-407"><paramref name="retryDelay" /> 小于零。</span><span class="sxs-lookup"><span data-stu-id="c61a3-407"><paramref name="retryDelay" /> is less than zero.</span></span></exception>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-408">未能将数据置于剪贴板中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-408">Data could not be placed on the Clipboard.</span></span> <span data-ttu-id="c61a3-409">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-409">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.DataObject" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="T:System.Windows.Forms.IDataObject" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetDataObject" />
      </Docs>
    </Member>
    <Member MemberName="SetFileDropList">
      <MemberSignature Language="C#" Value="public static void SetFileDropList (System.Collections.Specialized.StringCollection filePaths);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetFileDropList(class System.Collections.Specialized.StringCollection filePaths) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.SetFileDropList(System.Collections.Specialized.StringCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetFileDropList (filePaths As StringCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetFileDropList(System::Collections::Specialized::StringCollection ^ filePaths);" />
      <MemberSignature Language="F#" Value="static member SetFileDropList : System.Collections.Specialized.StringCollection -&gt; unit" Usage="System.Windows.Forms.Clipboard.SetFileDropList filePaths" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="filePaths" Type="System.Collections.Specialized.StringCollection" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="filePaths"><span data-ttu-id="c61a3-410">包含这些文件名的 <see cref="T:System.Collections.Specialized.StringCollection" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-410">A <see cref="T:System.Collections.Specialized.StringCollection" /> containing the file names.</span></span></param>
        <summary><span data-ttu-id="c61a3-411">清除剪贴板，然后添加 <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> 格式中的文件名集合。</span><span class="sxs-lookup"><span data-stu-id="c61a3-411">Clears the Clipboard and then adds a collection of file names in the <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-412">文件放置列表是包含文件的路径信息的字符串的集合。</span><span class="sxs-lookup"><span data-stu-id="c61a3-412">A file drop list is a collection of strings containing path information for files.</span></span>  
  
 <span data-ttu-id="c61a3-413">文件放置列表作为 <xref:System.String> 数组存储在剪贴板上。</span><span class="sxs-lookup"><span data-stu-id="c61a3-413">A file drop list is stored on the Clipboard as a <xref:System.String> array.</span></span> <span data-ttu-id="c61a3-414">此方法将 `filePaths` 转换为 <xref:System.String> 数组，然后将其添加到剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-414">This method converts `filePaths` to a <xref:System.String> array before adding it to the Clipboard.</span></span>  
  
 <span data-ttu-id="c61a3-415">若要从剪贴板检索文件放置列表，请首先使用 <xref:System.Windows.Forms.Clipboard.ContainsFileDropList%2A> 方法来确定剪贴板是否包含格式的数据，然后再使用 <xref:System.Windows.Forms.Clipboard.GetFileDropList%2A> 方法检索数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-415">To retrieve a file drop list from the Clipboard, first use the <xref:System.Windows.Forms.Clipboard.ContainsFileDropList%2A> method to determine whether the Clipboard contains data in that format before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetFileDropList%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-416"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-416">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-417">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-417">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-418">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-418">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#30](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#30)]
 [!code-vb[System.Windows.Forms.Clipboard#30](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#30)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-419">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-419">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-420">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-420">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-421">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-421">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-422">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-422">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="c61a3-423"><paramref name="filePaths" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-423"><paramref name="filePaths" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="c61a3-424"><paramref name="filePaths" /> 中不包含任何字符串。</span><span class="sxs-lookup"><span data-stu-id="c61a3-424"><paramref name="filePaths" /> does not contain any strings.</span></span>  
  
<span data-ttu-id="c61a3-425">- 或 -</span><span class="sxs-lookup"><span data-stu-id="c61a3-425">-or-</span></span> 
<span data-ttu-id="c61a3-426">在 <paramref name="filePaths" /> 中至少有一个字符串为以下情况之一：为 <see cref="F:System.String.Empty" />、仅包含空白、包含一个或多个 <see cref="F:System.IO.Path.InvalidPathChars" /> 定义的无效字符、值为 <see langword="null" />、包含冒号 (:)、或超出系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="c61a3-426">At least one of the strings in <paramref name="filePaths" /> is <see cref="F:System.String.Empty" />, contains only white space, contains one or more invalid characters as defined by <see cref="F:System.IO.Path.InvalidPathChars" />, is <see langword="null" />, contains a colon (:), or exceeds the system-defined maximum length.</span></span>  
  
<span data-ttu-id="c61a3-427">有关更多信息，请参见 <see cref="P:System.Exception.InnerException" /> 的 <see cref="T:System.ArgumentException" /> 属性。</span><span class="sxs-lookup"><span data-stu-id="c61a3-427">See the <see cref="P:System.Exception.InnerException" /> property of the <see cref="T:System.ArgumentException" /> for more information.</span></span></exception>
        <altmember cref="F:System.Windows.Forms.DataFormats.FileDrop" />
        <altmember cref="M:System.Windows.Forms.Clipboard.ContainsFileDropList" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetFileDropList" />
      </Docs>
    </Member>
    <Member MemberName="SetImage">
      <MemberSignature Language="C#" Value="public static void SetImage (System.Drawing.Image image);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetImage(class System.Drawing.Image image) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.SetImage(System.Drawing.Image)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetImage (image As Image)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetImage(System::Drawing::Image ^ image);" />
      <MemberSignature Language="F#" Value="static member SetImage : System.Drawing.Image -&gt; unit" Usage="System.Windows.Forms.Clipboard.SetImage image" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="image" Type="System.Drawing.Image" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="image"><span data-ttu-id="c61a3-428">要添加到剪贴板中的 <see cref="T:System.Drawing.Image" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-428">The <see cref="T:System.Drawing.Image" /> to add to the Clipboard.</span></span></param>
        <summary><span data-ttu-id="c61a3-429">清除剪贴板然后以 <see cref="T:System.Drawing.Image" /> 格式添加 <see cref="F:System.Windows.Forms.DataFormats.Bitmap" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-429">Clears the Clipboard and then adds an <see cref="T:System.Drawing.Image" /> in the <see cref="F:System.Windows.Forms.DataFormats.Bitmap" /> format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-430">若要从剪贴板检索图像数据，请首先使用 <xref:System.Windows.Forms.Clipboard.ContainsImage%2A> 方法来确定剪贴板是否包含图像数据，然后再使用 <xref:System.Windows.Forms.Clipboard.GetImage%2A> 方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="c61a3-430">To retrieve image data from the Clipboard, first use the <xref:System.Windows.Forms.Clipboard.ContainsImage%2A> method to determine whether the Clipboard contains image data before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetImage%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-431"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-431">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-432">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-432">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-433">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-433">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#40](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#40)]
 [!code-vb[System.Windows.Forms.Clipboard#40](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#40)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-434">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-434">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-435">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-435">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-436">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-436">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-437">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-437">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="c61a3-438"><paramref name="image" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-438"><paramref name="image" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="F:System.Windows.Forms.DataFormats.Bitmap" />
        <altmember cref="M:System.Windows.Forms.Clipboard.ContainsImage" />
        <altmember cref="M:System.Windows.Forms.Clipboard.GetImage" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetText">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="c61a3-439">清除剪贴板然后，然后在其中添加文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-439">Clears the Clipboard and then adds text data to it.</span></span></summary>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.GetText" />
      </Docs>
    </MemberGroup>
    <Member MemberName="SetText">
      <MemberSignature Language="C#" Value="public static void SetText (string text);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetText(string text) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.SetText(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetText (text As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetText(System::String ^ text);" />
      <MemberSignature Language="F#" Value="static member SetText : string -&gt; unit" Usage="System.Windows.Forms.Clipboard.SetText text" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="text" Type="System.String" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="text"><span data-ttu-id="c61a3-440">要添加到剪贴板中的文本。</span><span class="sxs-lookup"><span data-stu-id="c61a3-440">The text to add to the Clipboard.</span></span></param>
        <summary><span data-ttu-id="c61a3-441">清除剪贴板然后，然后以 <see cref="F:System.Windows.Forms.TextDataFormat.Text" /> 或 <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> 格式添加文本数据，这取决于操作系统。</span><span class="sxs-lookup"><span data-stu-id="c61a3-441">Clears the Clipboard and then adds text data in the <see cref="F:System.Windows.Forms.TextDataFormat.Text" /> or <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> format, depending on the operating system.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-442">此方法 [!INCLUDE[WinXpFamily](~/includes/winxpfamily-md.md)] 和 [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)]上的 <xref:System.Windows.Forms.TextDataFormat.UnicodeText> 格式添加文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-442">This method adds text data in the <xref:System.Windows.Forms.TextDataFormat.UnicodeText> format on [!INCLUDE[WinXpFamily](~/includes/winxpfamily-md.md)] and [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)].</span></span> <span data-ttu-id="c61a3-443">否则，此方法会以 <xref:System.Windows.Forms.TextDataFormat.Text> 格式添加文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-443">Otherwise, this method adds text data in the <xref:System.Windows.Forms.TextDataFormat.Text> format.</span></span>  
  
 <span data-ttu-id="c61a3-444">若要从剪贴板检索文本数据，请先使用 <xref:System.Windows.Forms.Clipboard.ContainsText%2A> 方法来确定剪贴板是否包含文本数据，然后再使用 <xref:System.Windows.Forms.Clipboard.GetText%2A> 方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="c61a3-444">To retrieve text data from the Clipboard, first use the <xref:System.Windows.Forms.Clipboard.ContainsText%2A> method to determine whether the Clipboard contains text data before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetText%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-445"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-445">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-446">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-446">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-447">下面的示例演示类似于此重载的 <xref:System.Windows.Forms.Clipboard.SetText%2A> 方法的重载。</span><span class="sxs-lookup"><span data-stu-id="c61a3-447">The following example demonstrates an overload of the <xref:System.Windows.Forms.Clipboard.SetText%2A> method that is similar to this overload.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#50](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#50)]
 [!code-vb[System.Windows.Forms.Clipboard#50](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#50)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-448">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-448">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-449">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-449">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-450">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-450">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-451">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-451">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="c61a3-452"><paramref name="text" /> 是 <see langword="null" /> 或 <see cref="F:System.String.Empty" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-452"><paramref name="text" /> is <see langword="null" /> or <see cref="F:System.String.Empty" />.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.GetText" />
      </Docs>
    </Member>
    <Member MemberName="SetText">
      <MemberSignature Language="C#" Value="public static void SetText (string text, System.Windows.Forms.TextDataFormat format);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetText(string text, valuetype System.Windows.Forms.TextDataFormat format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.Clipboard.SetText(System.String,System.Windows.Forms.TextDataFormat)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetText (text As String, format As TextDataFormat)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetText(System::String ^ text, System::Windows::Forms::TextDataFormat format);" />
      <MemberSignature Language="F#" Value="static member SetText : string * System.Windows.Forms.TextDataFormat -&gt; unit" Usage="System.Windows.Forms.Clipboard.SetText (text, format)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>5.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="text" Type="System.String" Index="0" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="format" Type="System.Windows.Forms.TextDataFormat" Index="1" FrameworkAlternate="dotnet-plat-ext-5.0;net-5.0;netcore-3.0;netcore-3.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="text"><span data-ttu-id="c61a3-453">要添加到剪贴板中的文本。</span><span class="sxs-lookup"><span data-stu-id="c61a3-453">The text to add to the Clipboard.</span></span></param>
        <param name="format"><span data-ttu-id="c61a3-454"><see cref="T:System.Windows.Forms.TextDataFormat" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="c61a3-454">One of the <see cref="T:System.Windows.Forms.TextDataFormat" /> values.</span></span></param>
        <summary><span data-ttu-id="c61a3-455">除剪贴板然后，然后以所指定 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值指示的格式添加文本数据。</span><span class="sxs-lookup"><span data-stu-id="c61a3-455">Clears the Clipboard and then adds text data in the format indicated by the specified <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c61a3-456">若要从剪贴板检索文本数据，请先使用 <xref:System.Windows.Forms.Clipboard.ContainsText%2A> 方法来确定剪贴板是否包含文本数据，然后再使用 <xref:System.Windows.Forms.Clipboard.GetText%2A> 方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="c61a3-456">To retrieve text data from the Clipboard, first use the <xref:System.Windows.Forms.Clipboard.ContainsText%2A> method to determine whether the Clipboard contains text data before retrieving it with the <xref:System.Windows.Forms.Clipboard.GetText%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c61a3-457"><xref:System.Windows.Forms.Clipboard> 类只能在设置为单线程单元（STA）模式的线程中使用。</span><span class="sxs-lookup"><span data-stu-id="c61a3-457">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-458">若要使用此类，请确保 `Main` 方法使用 <xref:System.STAThreadAttribute> 属性进行标记。</span><span class="sxs-lookup"><span data-stu-id="c61a3-458">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c61a3-459">下面的示例演示了此成员。</span><span class="sxs-lookup"><span data-stu-id="c61a3-459">The following example demonstrates this member.</span></span>  
  
 [!code-csharp[System.Windows.Forms.Clipboard#50](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#50)]
 [!code-vb[System.Windows.Forms.Clipboard#50](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#50)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Runtime.InteropServices.ExternalException"><span data-ttu-id="c61a3-460">未能清空剪贴板。</span><span class="sxs-lookup"><span data-stu-id="c61a3-460">The Clipboard could not be cleared.</span></span> <span data-ttu-id="c61a3-461">这种情况通常发生在剪贴板正在被其他进程使用的时候。</span><span class="sxs-lookup"><span data-stu-id="c61a3-461">This typically occurs when the Clipboard is being used by another process.</span></span></exception>
        <exception cref="T:System.Threading.ThreadStateException"><span data-ttu-id="c61a3-462">当前线程未处于单线程单元 (STA) 模式下。</span><span class="sxs-lookup"><span data-stu-id="c61a3-462">The current thread is not in single-threaded apartment (STA) mode.</span></span> <span data-ttu-id="c61a3-463">请将 <see cref="T:System.STAThreadAttribute" /> 添加到应用程序的 <see langword="Main" /> 方法中。</span><span class="sxs-lookup"><span data-stu-id="c61a3-463">Add the <see cref="T:System.STAThreadAttribute" /> to your application's <see langword="Main" /> method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="c61a3-464"><paramref name="text" /> 是 <see langword="null" /> 或 <see cref="F:System.String.Empty" />。</span><span class="sxs-lookup"><span data-stu-id="c61a3-464"><paramref name="text" /> is <see langword="null" /> or <see cref="F:System.String.Empty" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="c61a3-465"><paramref name="format" /> 不是有效的 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值。</span><span class="sxs-lookup"><span data-stu-id="c61a3-465"><paramref name="format" /> is not a valid <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.Clipboard.GetText" />
      </Docs>
    </Member>
  </Members>
</Type>
