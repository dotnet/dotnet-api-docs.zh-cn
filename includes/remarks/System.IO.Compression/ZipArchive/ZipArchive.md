---
ms.openlocfilehash: 3e3bdbd22f3d20ce35972ff68a8d5ce7db7d53aa
ms.sourcegitcommit: 9f423345753728e8cad38d4a22663a109e69ea91
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/04/2021
ms.locfileid: "102076764"
---
<span data-ttu-id="9af58-101">操作 zip 存档及其文件条目的方法分布于三个类： <xref:System.IO.Compression.ZipFile> 、 <xref:System.IO.Compression.ZipArchive> 和 <xref:System.IO.Compression.ZipArchiveEntry> 。</span><span class="sxs-lookup"><span data-stu-id="9af58-101">The methods for manipulating zip archives and their file entries are spread across three classes: <xref:System.IO.Compression.ZipFile>, <xref:System.IO.Compression.ZipArchive>, and <xref:System.IO.Compression.ZipArchiveEntry>.</span></span>

|<span data-ttu-id="9af58-102">功能</span><span class="sxs-lookup"><span data-stu-id="9af58-102">To</span></span>|<span data-ttu-id="9af58-103">使用</span><span class="sxs-lookup"><span data-stu-id="9af58-103">Use</span></span>|
|--------|---------|
|<span data-ttu-id="9af58-104">从目录创建 zip 存档</span><span class="sxs-lookup"><span data-stu-id="9af58-104">Create a zip archive from a directory</span></span>|<xref:System.IO.Compression.ZipFile.CreateFromDirectory%2A?displayProperty=nameWithType>|
|<span data-ttu-id="9af58-105">将 zip 存档的内容提取到目录</span><span class="sxs-lookup"><span data-stu-id="9af58-105">Extract the contents of a zip archive to a directory</span></span>|<xref:System.IO.Compression.ZipFile.ExtractToDirectory%2A?displayProperty=nameWithType>|
|<span data-ttu-id="9af58-106">将新文件添加到现有 zip 存档</span><span class="sxs-lookup"><span data-stu-id="9af58-106">Add new files to an existing zip archive</span></span>|<xref:System.IO.Compression.ZipArchive.CreateEntry%2A?displayProperty=nameWithType>|
|<span data-ttu-id="9af58-107">从 zip 存档中检索文件</span><span class="sxs-lookup"><span data-stu-id="9af58-107">Retrieve a file from a zip archive</span></span>|<xref:System.IO.Compression.ZipArchive.GetEntry%2A?displayProperty=nameWithType>|
|<span data-ttu-id="9af58-108">检索 zip 存档中的所有文件</span><span class="sxs-lookup"><span data-stu-id="9af58-108">Retrieve all the files from a zip archive</span></span>|<xref:System.IO.Compression.ZipArchive.Entries%2A?displayProperty=nameWithType>|
|<span data-ttu-id="9af58-109">打开 zip 存档中包含的单个文件的流</span><span class="sxs-lookup"><span data-stu-id="9af58-109">Open a stream to a single file contained in a zip archive</span></span>|<xref:System.IO.Compression.ZipArchiveEntry.Open%2A?displayProperty=nameWithType>|
|<span data-ttu-id="9af58-110">删除 zip 存档中的文件</span><span class="sxs-lookup"><span data-stu-id="9af58-110">Delete a file from a zip archive</span></span>|<xref:System.IO.Compression.ZipArchiveEntry.Delete%2A?displayProperty=nameWithType>|

<span data-ttu-id="9af58-111">当你创建新项时，该文件将被压缩并添加到 zip 包。</span><span class="sxs-lookup"><span data-stu-id="9af58-111">When you create a new entry, the file is compressed and added to the zip package.</span></span> <span data-ttu-id="9af58-112">使用 <xref:System.IO.Compression.ZipArchive.CreateEntry%2A> 方法，可以在添加项时指定目录层次结构。</span><span class="sxs-lookup"><span data-stu-id="9af58-112">The <xref:System.IO.Compression.ZipArchive.CreateEntry%2A> method enables you to specify a directory hierarchy when adding the entry.</span></span> <span data-ttu-id="9af58-113">在 zip 包中包含新项的相对路径。</span><span class="sxs-lookup"><span data-stu-id="9af58-113">You include the relative path of the new entry within the zip package.</span></span> <span data-ttu-id="9af58-114">例如，使用相对路径创建新条目将 `AddedFolder\NewFile.txt` 在名为 AddedFolder 的目录中创建一个压缩的文本文件。</span><span class="sxs-lookup"><span data-stu-id="9af58-114">For example, creating a new entry with a relative path of `AddedFolder\NewFile.txt` creates a compressed text file in a directory named AddedFolder.</span></span>

<span data-ttu-id="9af58-115">如果在 `System.IO.Compression.FileSystem` 项目中引用程序集，则可以从类的类) 访问四个扩展方法 (<xref:System.IO.Compression.ZipFileExtensions> <xref:System.IO.Compression.ZipArchive> ： <xref:System.IO.Compression.ZipFileExtensions.CreateEntryFromFile(System.IO.Compression.ZipArchive,System.String,System.String)> 、 <xref:System.IO.Compression.ZipFileExtensions.CreateEntryFromFile(System.IO.Compression.ZipArchive,System.String,System.String,System.IO.Compression.CompressionLevel)> 、 <xref:System.IO.Compression.ZipFileExtensions.ExtractToDirectory(System.IO.Compression.ZipArchive,System.String)> 和 <xref:System.IO.Compression.ZipFileExtensions.ExtractToDirectory(System.IO.Compression.ZipArchive,System.String,System.Boolean)> (，.net Core 2.0 和更高版本) 中提供了该方法。</span><span class="sxs-lookup"><span data-stu-id="9af58-115">If you reference the `System.IO.Compression.FileSystem` assembly in your project, you can access four extension methods (from the <xref:System.IO.Compression.ZipFileExtensions> class) for the <xref:System.IO.Compression.ZipArchive> class: <xref:System.IO.Compression.ZipFileExtensions.CreateEntryFromFile(System.IO.Compression.ZipArchive,System.String,System.String)>, <xref:System.IO.Compression.ZipFileExtensions.CreateEntryFromFile(System.IO.Compression.ZipArchive,System.String,System.String,System.IO.Compression.CompressionLevel)>, <xref:System.IO.Compression.ZipFileExtensions.ExtractToDirectory(System.IO.Compression.ZipArchive,System.String)>, and <xref:System.IO.Compression.ZipFileExtensions.ExtractToDirectory(System.IO.Compression.ZipArchive,System.String,System.Boolean)> (available in .NET Core 2.0 and later versions).</span></span> <span data-ttu-id="9af58-116">使用这些扩展方法可以将项的内容压缩和解压缩到文件中。</span><span class="sxs-lookup"><span data-stu-id="9af58-116">These extension methods enable you to compress and decompress the contents of the entry to a file.</span></span> <span data-ttu-id="9af58-117">此 `System.IO.Compression.FileSystem` 程序集不适用于 Windows 8.x 应用商店应用。</span><span class="sxs-lookup"><span data-stu-id="9af58-117">The `System.IO.Compression.FileSystem` assembly is not available for Windows 8.x Store apps.</span></span> <span data-ttu-id="9af58-118">在 Windows 8.x 应用商店应用程序中，可以使用或类压缩和解压缩文件 <xref:System.IO.Compression.DeflateStream> <xref:System.IO.Compression.GZipStream> ，也可以使用 Windows 运行时类型的 [压缩](https://go.microsoft.com/fwlink/p/?LinkID=246357) 程序和 [解压缩](https://go.microsoft.com/fwlink/p/?LinkID=246358)程序。</span><span class="sxs-lookup"><span data-stu-id="9af58-118">In Windows 8.x Store apps, you can compress and decompress files by using the <xref:System.IO.Compression.DeflateStream> or <xref:System.IO.Compression.GZipStream> class, or you can use the Windows Runtime types [Compressor](https://go.microsoft.com/fwlink/p/?LinkID=246357) and [Decompressor](https://go.microsoft.com/fwlink/p/?LinkID=246358).</span></span>

## <a name="examples"></a><span data-ttu-id="9af58-119">示例</span><span class="sxs-lookup"><span data-stu-id="9af58-119">Examples</span></span>

<span data-ttu-id="9af58-120">第一个示例演示如何使用流创建新条目并写入该条目。</span><span class="sxs-lookup"><span data-stu-id="9af58-120">The first example shows how to create a new entry and write to it by using a stream.</span></span>

[!code-csharp[System.IO.Compression.ZipArchiveMode#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.ziparchivemode/cs/program1.cs#1)]
[!code-vb[System.IO.Compression.ZipArchiveMode#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.ziparchivemode/vb/program1.vb#1)]

<span data-ttu-id="9af58-121">下面的示例演示如何打开 zip 存档并循环访问项的集合。</span><span class="sxs-lookup"><span data-stu-id="9af58-121">The following example shows how to open a zip archive and iterate through the collection of entries.</span></span>

[!code-csharp[System.IO.Compression.ZipArchive#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.ziparchive/cs/program1.cs#1)]
[!code-vb[System.IO.Compression.ZipArchive#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.ziparchive/vb/program1.vb#1)]

<span data-ttu-id="9af58-122">第三个示例演示如何使用扩展方法从现有文件在 zip 存档中创建新条目，并提取存档内容。</span><span class="sxs-lookup"><span data-stu-id="9af58-122">The third example shows how to use extension methods to create a new entry in a zip archive from an existing file and extract the archive contents.</span></span> <span data-ttu-id="9af58-123">必须引用 `System.IO.Compression.FileSystem` 程序集才能执行此代码。</span><span class="sxs-lookup"><span data-stu-id="9af58-123">You must reference the `System.IO.Compression.FileSystem` assembly to execute the code.</span></span>

[!code-csharp[System.IO.Compression.ZipArchive#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.ziparchive/cs/program3.cs#3)]
[!code-vb[System.IO.Compression.ZipArchive#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.ziparchive/vb/program3.vb#3)]
