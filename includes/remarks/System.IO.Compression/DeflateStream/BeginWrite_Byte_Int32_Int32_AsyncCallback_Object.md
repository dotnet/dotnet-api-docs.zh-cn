---
ms.openlocfilehash: 53607fe7d1d4c5b6ff109575d13c4058d3b2bc1f
ms.sourcegitcommit: 9f423345753728e8cad38d4a22663a109e69ea91
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/04/2021
ms.locfileid: "102084866"
---
<span data-ttu-id="c6d12-101">从 .NET Framework 4.5 开始，可以使用方法执行异步写入操作 <xref:System.IO.Stream.WriteAsync%2A> 。</span><span class="sxs-lookup"><span data-stu-id="c6d12-101">Starting with the .NET Framework 4.5, you can perform asynchronous write operations by using the <xref:System.IO.Stream.WriteAsync%2A> method.</span></span> <span data-ttu-id="c6d12-102"><xref:System.IO.Compression.DeflateStream.BeginWrite%2A>方法在 .NET Framework 4.5 中仍可用以支持旧代码，但你可以使用新的异步方法更轻松地实现异步 i/o 操作。</span><span class="sxs-lookup"><span data-stu-id="c6d12-102">The <xref:System.IO.Compression.DeflateStream.BeginWrite%2A> method is still available in the .NET Framework 4.5 to support legacy code; however, you can implement asynchronous I/O operations more easily by using the new async methods.</span></span> <span data-ttu-id="c6d12-103">有关详细信息，请参阅[异步文件 I/O](/dotnet/standard/io/asynchronous-file-i-o)。</span><span class="sxs-lookup"><span data-stu-id="c6d12-103">For more information, see [Asynchronous File I/O](/dotnet/standard/io/asynchronous-file-i-o).</span></span>

<span data-ttu-id="c6d12-104">将 <xref:System.IAsyncResult> 当前方法返回的对象传递给 <xref:System.IO.Compression.DeflateStream.EndWrite%2A> ，以确保写入完成并适当释放资源。</span><span class="sxs-lookup"><span data-stu-id="c6d12-104">Pass the <xref:System.IAsyncResult> object returned by the current method to <xref:System.IO.Compression.DeflateStream.EndWrite%2A> to ensure that the write completes and frees resources appropriately.</span></span> <span data-ttu-id="c6d12-105">可以通过在传递给的回调中使用调用或的相同代码来执行此操作 <xref:System.IO.Compression.DeflateStream.BeginWrite%2A> <xref:System.IO.Compression.DeflateStream.BeginWrite%2A> 。</span><span class="sxs-lookup"><span data-stu-id="c6d12-105">You can do this either by using the same code that called <xref:System.IO.Compression.DeflateStream.BeginWrite%2A> or in a callback passed to <xref:System.IO.Compression.DeflateStream.BeginWrite%2A>.</span></span> <span data-ttu-id="c6d12-106">如果在异步写入操作过程中发生错误，则在 <xref:System.IO.Compression.DeflateStream.EndWrite%2A> 使用此方法返回的调用之前，将不会引发异常 <xref:System.IAsyncResult> 。</span><span class="sxs-lookup"><span data-stu-id="c6d12-106">If an error occurs during an asynchronous write operation, an exception will not be thrown until <xref:System.IO.Compression.DeflateStream.EndWrite%2A> is called with the <xref:System.IAsyncResult> returned by this method.</span></span>

<span data-ttu-id="c6d12-107">如果流可写，则在流的末尾写入会扩展流。</span><span class="sxs-lookup"><span data-stu-id="c6d12-107">If a stream is writable, writing at the end of the stream expands the stream.</span></span>

<span data-ttu-id="c6d12-108">发出异步读取或写入操作时，将更新流中的当前位置，而不是在 i/o 操作完成时进行更新。</span><span class="sxs-lookup"><span data-stu-id="c6d12-108">The current position in the stream is updated when you issue the asynchronous read or write operation, not when the I/O operation completes.</span></span> <span data-ttu-id="c6d12-109">多个同时进行的异步请求会导致不确定请求完成顺序。</span><span class="sxs-lookup"><span data-stu-id="c6d12-109">Multiple simultaneous asynchronous requests render the request completion order uncertain.</span></span>

<span data-ttu-id="c6d12-110">使用 <xref:System.IO.Compression.DeflateStream.CanWrite%2A> 属性可确定当前 <xref:System.IO.Compression.DeflateStream> 对象是否支持写入。</span><span class="sxs-lookup"><span data-stu-id="c6d12-110">Use the <xref:System.IO.Compression.DeflateStream.CanWrite%2A> property to determine whether the current <xref:System.IO.Compression.DeflateStream> object supports writing.</span></span>

<span data-ttu-id="c6d12-111">如果流已关闭或传递的参数无效，则会立即从中引发异常 <xref:System.IO.Compression.DeflateStream.BeginWrite%2A> 。</span><span class="sxs-lookup"><span data-stu-id="c6d12-111">If a stream is closed or you pass an invalid argument, exceptions are thrown immediately from <xref:System.IO.Compression.DeflateStream.BeginWrite%2A>.</span></span> <span data-ttu-id="c6d12-112">在异步写入请求期间发生的错误（例如，i/o 请求过程中的磁盘故障）将在线程池线程上发生，并在调用时引发异常 <xref:System.IO.Compression.DeflateStream.EndWrite%2A> 。</span><span class="sxs-lookup"><span data-stu-id="c6d12-112">Errors that occur during an asynchronous write request, such as a disk failure during the I/O request, occur on the thread pool thread and throw exceptions when calling <xref:System.IO.Compression.DeflateStream.EndWrite%2A>.</span></span>
